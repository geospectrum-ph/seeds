function Db(i,o){for(var c=0;c<o.length;c++){const y=o[c];if(typeof y!="string"&&!Array.isArray(y)){for(const x in y)if(x!=="default"&&!(x in i)){const T=Object.getOwnPropertyDescriptor(y,x);T&&Object.defineProperty(i,x,T.get?T:{enumerable:!0,get:()=>y[x]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))y(x);new MutationObserver(x=>{for(const T of x)if(T.type==="childList")for(const S of T.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&y(S)}).observe(document,{childList:!0,subtree:!0});function c(x){const T={};return x.integrity&&(T.integrity=x.integrity),x.referrerPolicy&&(T.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?T.credentials="include":x.crossOrigin==="anonymous"?T.credentials="omit":T.credentials="same-origin",T}function y(x){if(x.ep)return;x.ep=!0;const T=c(x);fetch(x.href,T)}})();var Lb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function m0(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var g0={exports:{}},dp={},y0={exports:{}},Pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nh=Symbol.for("react.element"),Rb=Symbol.for("react.portal"),Fb=Symbol.for("react.fragment"),Bb=Symbol.for("react.strict_mode"),jb=Symbol.for("react.profiler"),Ob=Symbol.for("react.provider"),Nb=Symbol.for("react.context"),Vb=Symbol.for("react.forward_ref"),Ub=Symbol.for("react.suspense"),$b=Symbol.for("react.memo"),Zb=Symbol.for("react.lazy"),J_=Symbol.iterator;function qb(i){return i===null||typeof i!="object"?null:(i=J_&&i[J_]||i["@@iterator"],typeof i=="function"?i:null)}var _0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v0=Object.assign,x0={};function nu(i,o,c){this.props=i,this.context=o,this.refs=x0,this.updater=c||_0}nu.prototype.isReactComponent={};nu.prototype.setState=function(i,o){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,o,"setState")};nu.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function w0(){}w0.prototype=nu.prototype;function _g(i,o,c){this.props=i,this.context=o,this.refs=x0,this.updater=c||_0}var vg=_g.prototype=new w0;vg.constructor=_g;v0(vg,nu.prototype);vg.isPureReactComponent=!0;var Y_=Array.isArray,b0=Object.prototype.hasOwnProperty,xg={current:null},S0={key:!0,ref:!0,__self:!0,__source:!0};function T0(i,o,c){var y,x={},T=null,S=null;if(o!=null)for(y in o.ref!==void 0&&(S=o.ref),o.key!==void 0&&(T=""+o.key),o)b0.call(o,y)&&!S0.hasOwnProperty(y)&&(x[y]=o[y]);var d=arguments.length-2;if(d===1)x.children=c;else if(1<d){for(var U=Array(d),ee=0;ee<d;ee++)U[ee]=arguments[ee+2];x.children=U}if(i&&i.defaultProps)for(y in d=i.defaultProps,d)x[y]===void 0&&(x[y]=d[y]);return{$$typeof:nh,type:i,key:T,ref:S,props:x,_owner:xg.current}}function Gb(i,o){return{$$typeof:nh,type:i.type,key:o,ref:i.ref,props:i.props,_owner:i._owner}}function wg(i){return typeof i=="object"&&i!==null&&i.$$typeof===nh}function Hb(i){var o={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(c){return o[c]})}var Q_=/\/+/g;function Wf(i,o){return typeof i=="object"&&i!==null&&i.key!=null?Hb(""+i.key):o.toString(36)}function Cd(i,o,c,y,x){var T=typeof i;(T==="undefined"||T==="boolean")&&(i=null);var S=!1;if(i===null)S=!0;else switch(T){case"string":case"number":S=!0;break;case"object":switch(i.$$typeof){case nh:case Rb:S=!0}}if(S)return S=i,x=x(S),i=y===""?"."+Wf(S,0):y,Y_(x)?(c="",i!=null&&(c=i.replace(Q_,"$&/")+"/"),Cd(x,o,c,"",function(ee){return ee})):x!=null&&(wg(x)&&(x=Gb(x,c+(!x.key||S&&S.key===x.key?"":(""+x.key).replace(Q_,"$&/")+"/")+i)),o.push(x)),1;if(S=0,y=y===""?".":y+":",Y_(i))for(var d=0;d<i.length;d++){T=i[d];var U=y+Wf(T,d);S+=Cd(T,o,c,U,x)}else if(U=qb(i),typeof U=="function")for(i=U.call(i),d=0;!(T=i.next()).done;)T=T.value,U=y+Wf(T,d++),S+=Cd(T,o,c,U,x);else if(T==="object")throw o=String(i),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return S}function hd(i,o,c){if(i==null)return i;var y=[],x=0;return Cd(i,y,"","",function(T){return o.call(c,T,x++)}),y}function Wb(i){if(i._status===-1){var o=i._result;o=o(),o.then(function(c){(i._status===0||i._status===-1)&&(i._status=1,i._result=c)},function(c){(i._status===0||i._status===-1)&&(i._status=2,i._result=c)}),i._status===-1&&(i._status=0,i._result=o)}if(i._status===1)return i._result.default;throw i._result}var En={current:null},Pd={transition:null},Xb={ReactCurrentDispatcher:En,ReactCurrentBatchConfig:Pd,ReactCurrentOwner:xg};function I0(){throw Error("act(...) is not supported in production builds of React.")}Pt.Children={map:hd,forEach:function(i,o,c){hd(i,function(){o.apply(this,arguments)},c)},count:function(i){var o=0;return hd(i,function(){o++}),o},toArray:function(i){return hd(i,function(o){return o})||[]},only:function(i){if(!wg(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};Pt.Component=nu;Pt.Fragment=Fb;Pt.Profiler=jb;Pt.PureComponent=_g;Pt.StrictMode=Bb;Pt.Suspense=Ub;Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xb;Pt.act=I0;Pt.cloneElement=function(i,o,c){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var y=v0({},i.props),x=i.key,T=i.ref,S=i._owner;if(o!=null){if(o.ref!==void 0&&(T=o.ref,S=xg.current),o.key!==void 0&&(x=""+o.key),i.type&&i.type.defaultProps)var d=i.type.defaultProps;for(U in o)b0.call(o,U)&&!S0.hasOwnProperty(U)&&(y[U]=o[U]===void 0&&d!==void 0?d[U]:o[U])}var U=arguments.length-2;if(U===1)y.children=c;else if(1<U){d=Array(U);for(var ee=0;ee<U;ee++)d[ee]=arguments[ee+2];y.children=d}return{$$typeof:nh,type:i.type,key:x,ref:T,props:y,_owner:S}};Pt.createContext=function(i){return i={$$typeof:Nb,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:Ob,_context:i},i.Consumer=i};Pt.createElement=T0;Pt.createFactory=function(i){var o=T0.bind(null,i);return o.type=i,o};Pt.createRef=function(){return{current:null}};Pt.forwardRef=function(i){return{$$typeof:Vb,render:i}};Pt.isValidElement=wg;Pt.lazy=function(i){return{$$typeof:Zb,_payload:{_status:-1,_result:i},_init:Wb}};Pt.memo=function(i,o){return{$$typeof:$b,type:i,compare:o===void 0?null:o}};Pt.startTransition=function(i){var o=Pd.transition;Pd.transition={};try{i()}finally{Pd.transition=o}};Pt.unstable_act=I0;Pt.useCallback=function(i,o){return En.current.useCallback(i,o)};Pt.useContext=function(i){return En.current.useContext(i)};Pt.useDebugValue=function(){};Pt.useDeferredValue=function(i){return En.current.useDeferredValue(i)};Pt.useEffect=function(i,o){return En.current.useEffect(i,o)};Pt.useId=function(){return En.current.useId()};Pt.useImperativeHandle=function(i,o,c){return En.current.useImperativeHandle(i,o,c)};Pt.useInsertionEffect=function(i,o){return En.current.useInsertionEffect(i,o)};Pt.useLayoutEffect=function(i,o){return En.current.useLayoutEffect(i,o)};Pt.useMemo=function(i,o){return En.current.useMemo(i,o)};Pt.useReducer=function(i,o,c){return En.current.useReducer(i,o,c)};Pt.useRef=function(i){return En.current.useRef(i)};Pt.useState=function(i){return En.current.useState(i)};Pt.useSyncExternalStore=function(i,o,c){return En.current.useSyncExternalStore(i,o,c)};Pt.useTransition=function(){return En.current.useTransition()};Pt.version="18.3.1";y0.exports=Pt;var nt=y0.exports;const ru=m0(nt),Kb=Db({__proto__:null,default:ru},[nt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jb=nt,Yb=Symbol.for("react.element"),Qb=Symbol.for("react.fragment"),e2=Object.prototype.hasOwnProperty,t2=Jb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i2={key:!0,ref:!0,__self:!0,__source:!0};function k0(i,o,c){var y,x={},T=null,S=null;c!==void 0&&(T=""+c),o.key!==void 0&&(T=""+o.key),o.ref!==void 0&&(S=o.ref);for(y in o)e2.call(o,y)&&!i2.hasOwnProperty(y)&&(x[y]=o[y]);if(i&&i.defaultProps)for(y in o=i.defaultProps,o)x[y]===void 0&&(x[y]=o[y]);return{$$typeof:Yb,type:i,key:T,ref:S,props:x,_owner:t2.current}}dp.Fragment=Qb;dp.jsx=k0;dp.jsxs=k0;g0.exports=dp;var B=g0.exports,bm={},E0={exports:{}},ur={},C0={exports:{}},P0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function o(We,dt){var pt=We.length;We.push(dt);e:for(;0<pt;){var kt=pt-1>>>1,Bt=We[kt];if(0<x(Bt,dt))We[kt]=dt,We[pt]=Bt,pt=kt;else break e}}function c(We){return We.length===0?null:We[0]}function y(We){if(We.length===0)return null;var dt=We[0],pt=We.pop();if(pt!==dt){We[0]=pt;e:for(var kt=0,Bt=We.length,Zn=Bt>>>1;kt<Zn;){var Li=2*(kt+1)-1,tn=We[Li],nn=Li+1,bi=We[nn];if(0>x(tn,pt))nn<Bt&&0>x(bi,tn)?(We[kt]=bi,We[nn]=pt,kt=nn):(We[kt]=tn,We[Li]=pt,kt=Li);else if(nn<Bt&&0>x(bi,pt))We[kt]=bi,We[nn]=pt,kt=nn;else break e}}return dt}function x(We,dt){var pt=We.sortIndex-dt.sortIndex;return pt!==0?pt:We.id-dt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var T=performance;i.unstable_now=function(){return T.now()}}else{var S=Date,d=S.now();i.unstable_now=function(){return S.now()-d}}var U=[],ee=[],me=1,X=null,Z=3,ke=!1,Ee=!1,Ie=!1,$e=typeof setTimeout=="function"?setTimeout:null,le=typeof clearTimeout=="function"?clearTimeout:null,ne=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ue(We){for(var dt=c(ee);dt!==null;){if(dt.callback===null)y(ee);else if(dt.startTime<=We)y(ee),dt.sortIndex=dt.expirationTime,o(U,dt);else break;dt=c(ee)}}function Se(We){if(Ie=!1,ue(We),!Ee)if(c(U)!==null)Ee=!0,dr(je);else{var dt=c(ee);dt!==null&&en(Se,dt.startTime-We)}}function je(We,dt){Ee=!1,Ie&&(Ie=!1,le(ot),ot=-1),ke=!0;var pt=Z;try{for(ue(dt),X=c(U);X!==null&&(!(X.expirationTime>dt)||We&&!xt());){var kt=X.callback;if(typeof kt=="function"){X.callback=null,Z=X.priorityLevel;var Bt=kt(X.expirationTime<=dt);dt=i.unstable_now(),typeof Bt=="function"?X.callback=Bt:X===c(U)&&y(U),ue(dt)}else y(U);X=c(U)}if(X!==null)var Zn=!0;else{var Li=c(ee);Li!==null&&en(Se,Li.startTime-dt),Zn=!1}return Zn}finally{X=null,Z=pt,ke=!1}}var Je=!1,He=null,ot=-1,Lt=5,vt=-1;function xt(){return!(i.unstable_now()-vt<Lt)}function hr(){if(He!==null){var We=i.unstable_now();vt=We;var dt=!0;try{dt=He(!0,We)}finally{dt?oi():(Je=!1,He=null)}}else Je=!1}var oi;if(typeof ne=="function")oi=function(){ne(hr)};else if(typeof MessageChannel<"u"){var wi=new MessageChannel,$n=wi.port2;wi.port1.onmessage=hr,oi=function(){$n.postMessage(null)}}else oi=function(){$e(hr,0)};function dr(We){He=We,Je||(Je=!0,oi())}function en(We,dt){ot=$e(function(){We(i.unstable_now())},dt)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(We){We.callback=null},i.unstable_continueExecution=function(){Ee||ke||(Ee=!0,dr(je))},i.unstable_forceFrameRate=function(We){0>We||125<We?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Lt=0<We?Math.floor(1e3/We):5},i.unstable_getCurrentPriorityLevel=function(){return Z},i.unstable_getFirstCallbackNode=function(){return c(U)},i.unstable_next=function(We){switch(Z){case 1:case 2:case 3:var dt=3;break;default:dt=Z}var pt=Z;Z=dt;try{return We()}finally{Z=pt}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(We,dt){switch(We){case 1:case 2:case 3:case 4:case 5:break;default:We=3}var pt=Z;Z=We;try{return dt()}finally{Z=pt}},i.unstable_scheduleCallback=function(We,dt,pt){var kt=i.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?kt+pt:kt):pt=kt,We){case 1:var Bt=-1;break;case 2:Bt=250;break;case 5:Bt=1073741823;break;case 4:Bt=1e4;break;default:Bt=5e3}return Bt=pt+Bt,We={id:me++,callback:dt,priorityLevel:We,startTime:pt,expirationTime:Bt,sortIndex:-1},pt>kt?(We.sortIndex=pt,o(ee,We),c(U)===null&&We===c(ee)&&(Ie?(le(ot),ot=-1):Ie=!0,en(Se,pt-kt))):(We.sortIndex=Bt,o(U,We),Ee||ke||(Ee=!0,dr(je))),We},i.unstable_shouldYield=xt,i.unstable_wrapCallback=function(We){var dt=Z;return function(){var pt=Z;Z=dt;try{return We.apply(this,arguments)}finally{Z=pt}}}})(P0);C0.exports=P0;var n2=C0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r2=nt,lr=n2;function Me(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M0=new Set,jc={};function Da(i,o){Kl(i,o),Kl(i+"Capture",o)}function Kl(i,o){for(jc[i]=o,i=0;i<o.length;i++)M0.add(o[i])}var Lo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sm=Object.prototype.hasOwnProperty,o2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ev={},tv={};function s2(i){return Sm.call(tv,i)?!0:Sm.call(ev,i)?!1:o2.test(i)?tv[i]=!0:(ev[i]=!0,!1)}function a2(i,o,c,y){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return y?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function l2(i,o,c,y){if(o===null||typeof o>"u"||a2(i,o,c,y))return!0;if(y)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Cn(i,o,c,y,x,T,S){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=y,this.attributeNamespace=x,this.mustUseProperty=c,this.propertyName=i,this.type=o,this.sanitizeURL=T,this.removeEmptyString=S}var Qi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Qi[i]=new Cn(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];Qi[o]=new Cn(o,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Qi[i]=new Cn(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Qi[i]=new Cn(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Qi[i]=new Cn(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Qi[i]=new Cn(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Qi[i]=new Cn(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Qi[i]=new Cn(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Qi[i]=new Cn(i,5,!1,i.toLowerCase(),null,!1,!1)});var bg=/[\-:]([a-z])/g;function Sg(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(bg,Sg);Qi[o]=new Cn(o,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(bg,Sg);Qi[o]=new Cn(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(bg,Sg);Qi[o]=new Cn(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Qi[i]=new Cn(i,1,!1,i.toLowerCase(),null,!1,!1)});Qi.xlinkHref=new Cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Qi[i]=new Cn(i,1,!1,i.toLowerCase(),null,!0,!0)});function Tg(i,o,c,y){var x=Qi.hasOwnProperty(o)?Qi[o]:null;(x!==null?x.type!==0:y||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(l2(o,c,x,y)&&(c=null),y||x===null?s2(o)&&(c===null?i.removeAttribute(o):i.setAttribute(o,""+c)):x.mustUseProperty?i[x.propertyName]=c===null?x.type===3?!1:"":c:(o=x.attributeName,y=x.attributeNamespace,c===null?i.removeAttribute(o):(x=x.type,c=x===3||x===4&&c===!0?"":""+c,y?i.setAttributeNS(y,o,c):i.setAttribute(o,c))))}var jo=r2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dd=Symbol.for("react.element"),Al=Symbol.for("react.portal"),Dl=Symbol.for("react.fragment"),Ig=Symbol.for("react.strict_mode"),Tm=Symbol.for("react.profiler"),z0=Symbol.for("react.provider"),A0=Symbol.for("react.context"),kg=Symbol.for("react.forward_ref"),Im=Symbol.for("react.suspense"),km=Symbol.for("react.suspense_list"),Eg=Symbol.for("react.memo"),bs=Symbol.for("react.lazy"),D0=Symbol.for("react.offscreen"),iv=Symbol.iterator;function gc(i){return i===null||typeof i!="object"?null:(i=iv&&i[iv]||i["@@iterator"],typeof i=="function"?i:null)}var fi=Object.assign,Xf;function Ic(i){if(Xf===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Xf=o&&o[1]||""}return`
`+Xf+i}var Kf=!1;function Jf(i,o){if(!i||Kf)return"";Kf=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(ee){var y=ee}Reflect.construct(i,[],o)}else{try{o.call()}catch(ee){y=ee}i.call(o.prototype)}else{try{throw Error()}catch(ee){y=ee}i()}}catch(ee){if(ee&&y&&typeof ee.stack=="string"){for(var x=ee.stack.split(`
`),T=y.stack.split(`
`),S=x.length-1,d=T.length-1;1<=S&&0<=d&&x[S]!==T[d];)d--;for(;1<=S&&0<=d;S--,d--)if(x[S]!==T[d]){if(S!==1||d!==1)do if(S--,d--,0>d||x[S]!==T[d]){var U=`
`+x[S].replace(" at new "," at ");return i.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",i.displayName)),U}while(1<=S&&0<=d);break}}}finally{Kf=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?Ic(i):""}function u2(i){switch(i.tag){case 5:return Ic(i.type);case 16:return Ic("Lazy");case 13:return Ic("Suspense");case 19:return Ic("SuspenseList");case 0:case 2:case 15:return i=Jf(i.type,!1),i;case 11:return i=Jf(i.type.render,!1),i;case 1:return i=Jf(i.type,!0),i;default:return""}}function Em(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Dl:return"Fragment";case Al:return"Portal";case Tm:return"Profiler";case Ig:return"StrictMode";case Im:return"Suspense";case km:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case A0:return(i.displayName||"Context")+".Consumer";case z0:return(i._context.displayName||"Context")+".Provider";case kg:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Eg:return o=i.displayName||null,o!==null?o:Em(i.type)||"Memo";case bs:o=i._payload,i=i._init;try{return Em(i(o))}catch{}}return null}function c2(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Em(o);case 8:return o===Ig?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function js(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function L0(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function h2(i){var o=L0(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),y=""+i[o];if(!i.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var x=c.get,T=c.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return x.call(this)},set:function(S){y=""+S,T.call(this,S)}}),Object.defineProperty(i,o,{enumerable:c.enumerable}),{getValue:function(){return y},setValue:function(S){y=""+S},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function pd(i){i._valueTracker||(i._valueTracker=h2(i))}function R0(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),y="";return i&&(y=L0(i)?i.checked?"true":"false":i.value),i=y,i!==c?(o.setValue(i),!0):!1}function Nd(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Cm(i,o){var c=o.checked;return fi({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function nv(i,o){var c=o.defaultValue==null?"":o.defaultValue,y=o.checked!=null?o.checked:o.defaultChecked;c=js(o.value!=null?o.value:c),i._wrapperState={initialChecked:y,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function F0(i,o){o=o.checked,o!=null&&Tg(i,"checked",o,!1)}function Pm(i,o){F0(i,o);var c=js(o.value),y=o.type;if(c!=null)y==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(y==="submit"||y==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Mm(i,o.type,c):o.hasOwnProperty("defaultValue")&&Mm(i,o.type,js(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function rv(i,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var y=o.type;if(!(y!=="submit"&&y!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,c||o===i.value||(i.value=o),i.defaultValue=o}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function Mm(i,o,c){(o!=="number"||Nd(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var kc=Array.isArray;function Zl(i,o,c,y){if(i=i.options,o){o={};for(var x=0;x<c.length;x++)o["$"+c[x]]=!0;for(c=0;c<i.length;c++)x=o.hasOwnProperty("$"+i[c].value),i[c].selected!==x&&(i[c].selected=x),x&&y&&(i[c].defaultSelected=!0)}else{for(c=""+js(c),o=null,x=0;x<i.length;x++){if(i[x].value===c){i[x].selected=!0,y&&(i[x].defaultSelected=!0);return}o!==null||i[x].disabled||(o=i[x])}o!==null&&(o.selected=!0)}}function zm(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Me(91));return fi({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function ov(i,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(Me(92));if(kc(c)){if(1<c.length)throw Error(Me(93));c=c[0]}o=c}o==null&&(o=""),c=o}i._wrapperState={initialValue:js(c)}}function B0(i,o){var c=js(o.value),y=js(o.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),o.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),y!=null&&(i.defaultValue=""+y)}function sv(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function j0(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Am(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?j0(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var fd,O0=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,c,y,x){MSApp.execUnsafeLocalFunction(function(){return i(o,c,y,x)})}:i}(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(fd=fd||document.createElement("div"),fd.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=fd.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function Oc(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var Pc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},d2=["Webkit","ms","Moz","O"];Object.keys(Pc).forEach(function(i){d2.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Pc[o]=Pc[i]})});function N0(i,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||Pc.hasOwnProperty(i)&&Pc[i]?(""+o).trim():o+"px"}function V0(i,o){i=i.style;for(var c in o)if(o.hasOwnProperty(c)){var y=c.indexOf("--")===0,x=N0(c,o[c],y);c==="float"&&(c="cssFloat"),y?i.setProperty(c,x):i[c]=x}}var p2=fi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dm(i,o){if(o){if(p2[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Me(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Me(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Me(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Me(62))}}function Lm(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rm=null;function Cg(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Fm=null,ql=null,Gl=null;function av(i){if(i=sh(i)){if(typeof Fm!="function")throw Error(Me(280));var o=i.stateNode;o&&(o=yp(o),Fm(i.stateNode,i.type,o))}}function U0(i){ql?Gl?Gl.push(i):Gl=[i]:ql=i}function $0(){if(ql){var i=ql,o=Gl;if(Gl=ql=null,av(i),o)for(i=0;i<o.length;i++)av(o[i])}}function Z0(i,o){return i(o)}function q0(){}var Yf=!1;function G0(i,o,c){if(Yf)return i(o,c);Yf=!0;try{return Z0(i,o,c)}finally{Yf=!1,(ql!==null||Gl!==null)&&(q0(),$0())}}function Nc(i,o){var c=i.stateNode;if(c===null)return null;var y=yp(c);if(y===null)return null;c=y[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(i=i.type,y=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!y;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(Me(231,o,typeof c));return c}var Bm=!1;if(Lo)try{var yc={};Object.defineProperty(yc,"passive",{get:function(){Bm=!0}}),window.addEventListener("test",yc,yc),window.removeEventListener("test",yc,yc)}catch{Bm=!1}function f2(i,o,c,y,x,T,S,d,U){var ee=Array.prototype.slice.call(arguments,3);try{o.apply(c,ee)}catch(me){this.onError(me)}}var Mc=!1,Vd=null,Ud=!1,jm=null,m2={onError:function(i){Mc=!0,Vd=i}};function g2(i,o,c,y,x,T,S,d,U){Mc=!1,Vd=null,f2.apply(m2,arguments)}function y2(i,o,c,y,x,T,S,d,U){if(g2.apply(this,arguments),Mc){if(Mc){var ee=Vd;Mc=!1,Vd=null}else throw Error(Me(198));Ud||(Ud=!0,jm=ee)}}function La(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,o.flags&4098&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function H0(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function lv(i){if(La(i)!==i)throw Error(Me(188))}function _2(i){var o=i.alternate;if(!o){if(o=La(i),o===null)throw Error(Me(188));return o!==i?null:i}for(var c=i,y=o;;){var x=c.return;if(x===null)break;var T=x.alternate;if(T===null){if(y=x.return,y!==null){c=y;continue}break}if(x.child===T.child){for(T=x.child;T;){if(T===c)return lv(x),i;if(T===y)return lv(x),o;T=T.sibling}throw Error(Me(188))}if(c.return!==y.return)c=x,y=T;else{for(var S=!1,d=x.child;d;){if(d===c){S=!0,c=x,y=T;break}if(d===y){S=!0,y=x,c=T;break}d=d.sibling}if(!S){for(d=T.child;d;){if(d===c){S=!0,c=T,y=x;break}if(d===y){S=!0,y=T,c=x;break}d=d.sibling}if(!S)throw Error(Me(189))}}if(c.alternate!==y)throw Error(Me(190))}if(c.tag!==3)throw Error(Me(188));return c.stateNode.current===c?i:o}function W0(i){return i=_2(i),i!==null?X0(i):null}function X0(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=X0(i);if(o!==null)return o;i=i.sibling}return null}var K0=lr.unstable_scheduleCallback,uv=lr.unstable_cancelCallback,v2=lr.unstable_shouldYield,x2=lr.unstable_requestPaint,xi=lr.unstable_now,w2=lr.unstable_getCurrentPriorityLevel,Pg=lr.unstable_ImmediatePriority,J0=lr.unstable_UserBlockingPriority,$d=lr.unstable_NormalPriority,b2=lr.unstable_LowPriority,Y0=lr.unstable_IdlePriority,pp=null,so=null;function S2(i){if(so&&typeof so.onCommitFiberRoot=="function")try{so.onCommitFiberRoot(pp,i,void 0,(i.current.flags&128)===128)}catch{}}var Vr=Math.clz32?Math.clz32:k2,T2=Math.log,I2=Math.LN2;function k2(i){return i>>>=0,i===0?32:31-(T2(i)/I2|0)|0}var md=64,gd=4194304;function Ec(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Zd(i,o){var c=i.pendingLanes;if(c===0)return 0;var y=0,x=i.suspendedLanes,T=i.pingedLanes,S=c&268435455;if(S!==0){var d=S&~x;d!==0?y=Ec(d):(T&=S,T!==0&&(y=Ec(T)))}else S=c&~x,S!==0?y=Ec(S):T!==0&&(y=Ec(T));if(y===0)return 0;if(o!==0&&o!==y&&!(o&x)&&(x=y&-y,T=o&-o,x>=T||x===16&&(T&4194240)!==0))return o;if(y&4&&(y|=c&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=y;0<o;)c=31-Vr(o),x=1<<c,y|=i[c],o&=~x;return y}function E2(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function C2(i,o){for(var c=i.suspendedLanes,y=i.pingedLanes,x=i.expirationTimes,T=i.pendingLanes;0<T;){var S=31-Vr(T),d=1<<S,U=x[S];U===-1?(!(d&c)||d&y)&&(x[S]=E2(d,o)):U<=o&&(i.expiredLanes|=d),T&=~d}}function Om(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Q0(){var i=md;return md<<=1,!(md&4194240)&&(md=64),i}function Qf(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function rh(i,o,c){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Vr(o),i[o]=c}function P2(i,o){var c=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var y=i.eventTimes;for(i=i.expirationTimes;0<c;){var x=31-Vr(c),T=1<<x;o[x]=0,y[x]=-1,i[x]=-1,c&=~T}}function Mg(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var y=31-Vr(c),x=1<<y;x&o|i[y]&o&&(i[y]|=o),c&=~x}}var Gt=0;function ex(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var tx,zg,ix,nx,rx,Nm=!1,yd=[],Ps=null,Ms=null,zs=null,Vc=new Map,Uc=new Map,Ts=[],M2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cv(i,o){switch(i){case"focusin":case"focusout":Ps=null;break;case"dragenter":case"dragleave":Ms=null;break;case"mouseover":case"mouseout":zs=null;break;case"pointerover":case"pointerout":Vc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uc.delete(o.pointerId)}}function _c(i,o,c,y,x,T){return i===null||i.nativeEvent!==T?(i={blockedOn:o,domEventName:c,eventSystemFlags:y,nativeEvent:T,targetContainers:[x]},o!==null&&(o=sh(o),o!==null&&zg(o)),i):(i.eventSystemFlags|=y,o=i.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),i)}function z2(i,o,c,y,x){switch(o){case"focusin":return Ps=_c(Ps,i,o,c,y,x),!0;case"dragenter":return Ms=_c(Ms,i,o,c,y,x),!0;case"mouseover":return zs=_c(zs,i,o,c,y,x),!0;case"pointerover":var T=x.pointerId;return Vc.set(T,_c(Vc.get(T)||null,i,o,c,y,x)),!0;case"gotpointercapture":return T=x.pointerId,Uc.set(T,_c(Uc.get(T)||null,i,o,c,y,x)),!0}return!1}function ox(i){var o=Sa(i.target);if(o!==null){var c=La(o);if(c!==null){if(o=c.tag,o===13){if(o=H0(c),o!==null){i.blockedOn=o,rx(i.priority,function(){ix(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Md(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=Vm(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var y=new c.constructor(c.type,c);Rm=y,c.target.dispatchEvent(y),Rm=null}else return o=sh(c),o!==null&&zg(o),i.blockedOn=c,!1;o.shift()}return!0}function hv(i,o,c){Md(i)&&c.delete(o)}function A2(){Nm=!1,Ps!==null&&Md(Ps)&&(Ps=null),Ms!==null&&Md(Ms)&&(Ms=null),zs!==null&&Md(zs)&&(zs=null),Vc.forEach(hv),Uc.forEach(hv)}function vc(i,o){i.blockedOn===o&&(i.blockedOn=null,Nm||(Nm=!0,lr.unstable_scheduleCallback(lr.unstable_NormalPriority,A2)))}function $c(i){function o(x){return vc(x,i)}if(0<yd.length){vc(yd[0],i);for(var c=1;c<yd.length;c++){var y=yd[c];y.blockedOn===i&&(y.blockedOn=null)}}for(Ps!==null&&vc(Ps,i),Ms!==null&&vc(Ms,i),zs!==null&&vc(zs,i),Vc.forEach(o),Uc.forEach(o),c=0;c<Ts.length;c++)y=Ts[c],y.blockedOn===i&&(y.blockedOn=null);for(;0<Ts.length&&(c=Ts[0],c.blockedOn===null);)ox(c),c.blockedOn===null&&Ts.shift()}var Hl=jo.ReactCurrentBatchConfig,qd=!0;function D2(i,o,c,y){var x=Gt,T=Hl.transition;Hl.transition=null;try{Gt=1,Ag(i,o,c,y)}finally{Gt=x,Hl.transition=T}}function L2(i,o,c,y){var x=Gt,T=Hl.transition;Hl.transition=null;try{Gt=4,Ag(i,o,c,y)}finally{Gt=x,Hl.transition=T}}function Ag(i,o,c,y){if(qd){var x=Vm(i,o,c,y);if(x===null)um(i,o,y,Gd,c),cv(i,y);else if(z2(x,i,o,c,y))y.stopPropagation();else if(cv(i,y),o&4&&-1<M2.indexOf(i)){for(;x!==null;){var T=sh(x);if(T!==null&&tx(T),T=Vm(i,o,c,y),T===null&&um(i,o,y,Gd,c),T===x)break;x=T}x!==null&&y.stopPropagation()}else um(i,o,y,null,c)}}var Gd=null;function Vm(i,o,c,y){if(Gd=null,i=Cg(y),i=Sa(i),i!==null)if(o=La(i),o===null)i=null;else if(c=o.tag,c===13){if(i=H0(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Gd=i,null}function sx(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(w2()){case Pg:return 1;case J0:return 4;case $d:case b2:return 16;case Y0:return 536870912;default:return 16}default:return 16}}var ks=null,Dg=null,zd=null;function ax(){if(zd)return zd;var i,o=Dg,c=o.length,y,x="value"in ks?ks.value:ks.textContent,T=x.length;for(i=0;i<c&&o[i]===x[i];i++);var S=c-i;for(y=1;y<=S&&o[c-y]===x[T-y];y++);return zd=x.slice(i,1<y?1-y:void 0)}function Ad(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function _d(){return!0}function dv(){return!1}function cr(i){function o(c,y,x,T,S){this._reactName=c,this._targetInst=x,this.type=y,this.nativeEvent=T,this.target=S,this.currentTarget=null;for(var d in i)i.hasOwnProperty(d)&&(c=i[d],this[d]=c?c(T):T[d]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?_d:dv,this.isPropagationStopped=dv,this}return fi(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=_d)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=_d)},persist:function(){},isPersistent:_d}),o}var ou={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lg=cr(ou),oh=fi({},ou,{view:0,detail:0}),R2=cr(oh),em,tm,xc,fp=fi({},oh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rg,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==xc&&(xc&&i.type==="mousemove"?(em=i.screenX-xc.screenX,tm=i.screenY-xc.screenY):tm=em=0,xc=i),em)},movementY:function(i){return"movementY"in i?i.movementY:tm}}),pv=cr(fp),F2=fi({},fp,{dataTransfer:0}),B2=cr(F2),j2=fi({},oh,{relatedTarget:0}),im=cr(j2),O2=fi({},ou,{animationName:0,elapsedTime:0,pseudoElement:0}),N2=cr(O2),V2=fi({},ou,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),U2=cr(V2),$2=fi({},ou,{data:0}),fv=cr($2),Z2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H2(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=G2[i])?!!o[i]:!1}function Rg(){return H2}var W2=fi({},oh,{key:function(i){if(i.key){var o=Z2[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Ad(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?q2[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rg,charCode:function(i){return i.type==="keypress"?Ad(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ad(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),X2=cr(W2),K2=fi({},fp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mv=cr(K2),J2=fi({},oh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rg}),Y2=cr(J2),Q2=fi({},ou,{propertyName:0,elapsedTime:0,pseudoElement:0}),eS=cr(Q2),tS=fi({},fp,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),iS=cr(tS),nS=[9,13,27,32],Fg=Lo&&"CompositionEvent"in window,zc=null;Lo&&"documentMode"in document&&(zc=document.documentMode);var rS=Lo&&"TextEvent"in window&&!zc,lx=Lo&&(!Fg||zc&&8<zc&&11>=zc),gv=" ",yv=!1;function ux(i,o){switch(i){case"keyup":return nS.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cx(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ll=!1;function oS(i,o){switch(i){case"compositionend":return cx(o);case"keypress":return o.which!==32?null:(yv=!0,gv);case"textInput":return i=o.data,i===gv&&yv?null:i;default:return null}}function sS(i,o){if(Ll)return i==="compositionend"||!Fg&&ux(i,o)?(i=ax(),zd=Dg=ks=null,Ll=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return lx&&o.locale!=="ko"?null:o.data;default:return null}}var aS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _v(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!aS[i.type]:o==="textarea"}function hx(i,o,c,y){U0(y),o=Hd(o,"onChange"),0<o.length&&(c=new Lg("onChange","change",null,c,y),i.push({event:c,listeners:o}))}var Ac=null,Zc=null;function lS(i){bx(i,0)}function mp(i){var o=Bl(i);if(R0(o))return i}function uS(i,o){if(i==="change")return o}var dx=!1;if(Lo){var nm;if(Lo){var rm="oninput"in document;if(!rm){var vv=document.createElement("div");vv.setAttribute("oninput","return;"),rm=typeof vv.oninput=="function"}nm=rm}else nm=!1;dx=nm&&(!document.documentMode||9<document.documentMode)}function xv(){Ac&&(Ac.detachEvent("onpropertychange",px),Zc=Ac=null)}function px(i){if(i.propertyName==="value"&&mp(Zc)){var o=[];hx(o,Zc,i,Cg(i)),G0(lS,o)}}function cS(i,o,c){i==="focusin"?(xv(),Ac=o,Zc=c,Ac.attachEvent("onpropertychange",px)):i==="focusout"&&xv()}function hS(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return mp(Zc)}function dS(i,o){if(i==="click")return mp(o)}function pS(i,o){if(i==="input"||i==="change")return mp(o)}function fS(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var $r=typeof Object.is=="function"?Object.is:fS;function qc(i,o){if($r(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),y=Object.keys(o);if(c.length!==y.length)return!1;for(y=0;y<c.length;y++){var x=c[y];if(!Sm.call(o,x)||!$r(i[x],o[x]))return!1}return!0}function wv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function bv(i,o){var c=wv(i);i=0;for(var y;c;){if(c.nodeType===3){if(y=i+c.textContent.length,i<=o&&y>=o)return{node:c,offset:o-i};i=y}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=wv(c)}}function fx(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?fx(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function mx(){for(var i=window,o=Nd();o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=Nd(i.document)}return o}function Bg(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function mS(i){var o=mx(),c=i.focusedElem,y=i.selectionRange;if(o!==c&&c&&c.ownerDocument&&fx(c.ownerDocument.documentElement,c)){if(y!==null&&Bg(c)){if(o=y.start,i=y.end,i===void 0&&(i=o),"selectionStart"in c)c.selectionStart=o,c.selectionEnd=Math.min(i,c.value.length);else if(i=(o=c.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var x=c.textContent.length,T=Math.min(y.start,x);y=y.end===void 0?T:Math.min(y.end,x),!i.extend&&T>y&&(x=y,y=T,T=x),x=bv(c,T);var S=bv(c,y);x&&S&&(i.rangeCount!==1||i.anchorNode!==x.node||i.anchorOffset!==x.offset||i.focusNode!==S.node||i.focusOffset!==S.offset)&&(o=o.createRange(),o.setStart(x.node,x.offset),i.removeAllRanges(),T>y?(i.addRange(o),i.extend(S.node,S.offset)):(o.setEnd(S.node,S.offset),i.addRange(o)))}}for(o=[],i=c;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<o.length;c++)i=o[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var gS=Lo&&"documentMode"in document&&11>=document.documentMode,Rl=null,Um=null,Dc=null,$m=!1;function Sv(i,o,c){var y=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;$m||Rl==null||Rl!==Nd(y)||(y=Rl,"selectionStart"in y&&Bg(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Dc&&qc(Dc,y)||(Dc=y,y=Hd(Um,"onSelect"),0<y.length&&(o=new Lg("onSelect","select",null,o,c),i.push({event:o,listeners:y}),o.target=Rl)))}function vd(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var Fl={animationend:vd("Animation","AnimationEnd"),animationiteration:vd("Animation","AnimationIteration"),animationstart:vd("Animation","AnimationStart"),transitionend:vd("Transition","TransitionEnd")},om={},gx={};Lo&&(gx=document.createElement("div").style,"AnimationEvent"in window||(delete Fl.animationend.animation,delete Fl.animationiteration.animation,delete Fl.animationstart.animation),"TransitionEvent"in window||delete Fl.transitionend.transition);function gp(i){if(om[i])return om[i];if(!Fl[i])return i;var o=Fl[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in gx)return om[i]=o[c];return i}var yx=gp("animationend"),_x=gp("animationiteration"),vx=gp("animationstart"),xx=gp("transitionend"),wx=new Map,Tv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ns(i,o){wx.set(i,o),Da(o,[i])}for(var sm=0;sm<Tv.length;sm++){var am=Tv[sm],yS=am.toLowerCase(),_S=am[0].toUpperCase()+am.slice(1);Ns(yS,"on"+_S)}Ns(yx,"onAnimationEnd");Ns(_x,"onAnimationIteration");Ns(vx,"onAnimationStart");Ns("dblclick","onDoubleClick");Ns("focusin","onFocus");Ns("focusout","onBlur");Ns(xx,"onTransitionEnd");Kl("onMouseEnter",["mouseout","mouseover"]);Kl("onMouseLeave",["mouseout","mouseover"]);Kl("onPointerEnter",["pointerout","pointerover"]);Kl("onPointerLeave",["pointerout","pointerover"]);Da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Da("onBeforeInput",["compositionend","keypress","textInput","paste"]);Da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cc));function Iv(i,o,c){var y=i.type||"unknown-event";i.currentTarget=c,y2(y,o,void 0,i),i.currentTarget=null}function bx(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var y=i[c],x=y.event;y=y.listeners;e:{var T=void 0;if(o)for(var S=y.length-1;0<=S;S--){var d=y[S],U=d.instance,ee=d.currentTarget;if(d=d.listener,U!==T&&x.isPropagationStopped())break e;Iv(x,d,ee),T=U}else for(S=0;S<y.length;S++){if(d=y[S],U=d.instance,ee=d.currentTarget,d=d.listener,U!==T&&x.isPropagationStopped())break e;Iv(x,d,ee),T=U}}}if(Ud)throw i=jm,Ud=!1,jm=null,i}function ni(i,o){var c=o[Wm];c===void 0&&(c=o[Wm]=new Set);var y=i+"__bubble";c.has(y)||(Sx(o,i,2,!1),c.add(y))}function lm(i,o,c){var y=0;o&&(y|=4),Sx(c,i,y,o)}var xd="_reactListening"+Math.random().toString(36).slice(2);function Gc(i){if(!i[xd]){i[xd]=!0,M0.forEach(function(c){c!=="selectionchange"&&(vS.has(c)||lm(c,!1,i),lm(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[xd]||(o[xd]=!0,lm("selectionchange",!1,o))}}function Sx(i,o,c,y){switch(sx(o)){case 1:var x=D2;break;case 4:x=L2;break;default:x=Ag}c=x.bind(null,o,c,i),x=void 0,!Bm||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),y?x!==void 0?i.addEventListener(o,c,{capture:!0,passive:x}):i.addEventListener(o,c,!0):x!==void 0?i.addEventListener(o,c,{passive:x}):i.addEventListener(o,c,!1)}function um(i,o,c,y,x){var T=y;if(!(o&1)&&!(o&2)&&y!==null)e:for(;;){if(y===null)return;var S=y.tag;if(S===3||S===4){var d=y.stateNode.containerInfo;if(d===x||d.nodeType===8&&d.parentNode===x)break;if(S===4)for(S=y.return;S!==null;){var U=S.tag;if((U===3||U===4)&&(U=S.stateNode.containerInfo,U===x||U.nodeType===8&&U.parentNode===x))return;S=S.return}for(;d!==null;){if(S=Sa(d),S===null)return;if(U=S.tag,U===5||U===6){y=T=S;continue e}d=d.parentNode}}y=y.return}G0(function(){var ee=T,me=Cg(c),X=[];e:{var Z=wx.get(i);if(Z!==void 0){var ke=Lg,Ee=i;switch(i){case"keypress":if(Ad(c)===0)break e;case"keydown":case"keyup":ke=X2;break;case"focusin":Ee="focus",ke=im;break;case"focusout":Ee="blur",ke=im;break;case"beforeblur":case"afterblur":ke=im;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=pv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=B2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=Y2;break;case yx:case _x:case vx:ke=N2;break;case xx:ke=eS;break;case"scroll":ke=R2;break;case"wheel":ke=iS;break;case"copy":case"cut":case"paste":ke=U2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=mv}var Ie=(o&4)!==0,$e=!Ie&&i==="scroll",le=Ie?Z!==null?Z+"Capture":null:Z;Ie=[];for(var ne=ee,ue;ne!==null;){ue=ne;var Se=ue.stateNode;if(ue.tag===5&&Se!==null&&(ue=Se,le!==null&&(Se=Nc(ne,le),Se!=null&&Ie.push(Hc(ne,Se,ue)))),$e)break;ne=ne.return}0<Ie.length&&(Z=new ke(Z,Ee,null,c,me),X.push({event:Z,listeners:Ie}))}}if(!(o&7)){e:{if(Z=i==="mouseover"||i==="pointerover",ke=i==="mouseout"||i==="pointerout",Z&&c!==Rm&&(Ee=c.relatedTarget||c.fromElement)&&(Sa(Ee)||Ee[Ro]))break e;if((ke||Z)&&(Z=me.window===me?me:(Z=me.ownerDocument)?Z.defaultView||Z.parentWindow:window,ke?(Ee=c.relatedTarget||c.toElement,ke=ee,Ee=Ee?Sa(Ee):null,Ee!==null&&($e=La(Ee),Ee!==$e||Ee.tag!==5&&Ee.tag!==6)&&(Ee=null)):(ke=null,Ee=ee),ke!==Ee)){if(Ie=pv,Se="onMouseLeave",le="onMouseEnter",ne="mouse",(i==="pointerout"||i==="pointerover")&&(Ie=mv,Se="onPointerLeave",le="onPointerEnter",ne="pointer"),$e=ke==null?Z:Bl(ke),ue=Ee==null?Z:Bl(Ee),Z=new Ie(Se,ne+"leave",ke,c,me),Z.target=$e,Z.relatedTarget=ue,Se=null,Sa(me)===ee&&(Ie=new Ie(le,ne+"enter",Ee,c,me),Ie.target=ue,Ie.relatedTarget=$e,Se=Ie),$e=Se,ke&&Ee)t:{for(Ie=ke,le=Ee,ne=0,ue=Ie;ue;ue=zl(ue))ne++;for(ue=0,Se=le;Se;Se=zl(Se))ue++;for(;0<ne-ue;)Ie=zl(Ie),ne--;for(;0<ue-ne;)le=zl(le),ue--;for(;ne--;){if(Ie===le||le!==null&&Ie===le.alternate)break t;Ie=zl(Ie),le=zl(le)}Ie=null}else Ie=null;ke!==null&&kv(X,Z,ke,Ie,!1),Ee!==null&&$e!==null&&kv(X,$e,Ee,Ie,!0)}}e:{if(Z=ee?Bl(ee):window,ke=Z.nodeName&&Z.nodeName.toLowerCase(),ke==="select"||ke==="input"&&Z.type==="file")var je=uS;else if(_v(Z))if(dx)je=pS;else{je=hS;var Je=cS}else(ke=Z.nodeName)&&ke.toLowerCase()==="input"&&(Z.type==="checkbox"||Z.type==="radio")&&(je=dS);if(je&&(je=je(i,ee))){hx(X,je,c,me);break e}Je&&Je(i,Z,ee),i==="focusout"&&(Je=Z._wrapperState)&&Je.controlled&&Z.type==="number"&&Mm(Z,"number",Z.value)}switch(Je=ee?Bl(ee):window,i){case"focusin":(_v(Je)||Je.contentEditable==="true")&&(Rl=Je,Um=ee,Dc=null);break;case"focusout":Dc=Um=Rl=null;break;case"mousedown":$m=!0;break;case"contextmenu":case"mouseup":case"dragend":$m=!1,Sv(X,c,me);break;case"selectionchange":if(gS)break;case"keydown":case"keyup":Sv(X,c,me)}var He;if(Fg)e:{switch(i){case"compositionstart":var ot="onCompositionStart";break e;case"compositionend":ot="onCompositionEnd";break e;case"compositionupdate":ot="onCompositionUpdate";break e}ot=void 0}else Ll?ux(i,c)&&(ot="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(ot="onCompositionStart");ot&&(lx&&c.locale!=="ko"&&(Ll||ot!=="onCompositionStart"?ot==="onCompositionEnd"&&Ll&&(He=ax()):(ks=me,Dg="value"in ks?ks.value:ks.textContent,Ll=!0)),Je=Hd(ee,ot),0<Je.length&&(ot=new fv(ot,i,null,c,me),X.push({event:ot,listeners:Je}),He?ot.data=He:(He=cx(c),He!==null&&(ot.data=He)))),(He=rS?oS(i,c):sS(i,c))&&(ee=Hd(ee,"onBeforeInput"),0<ee.length&&(me=new fv("onBeforeInput","beforeinput",null,c,me),X.push({event:me,listeners:ee}),me.data=He))}bx(X,o)})}function Hc(i,o,c){return{instance:i,listener:o,currentTarget:c}}function Hd(i,o){for(var c=o+"Capture",y=[];i!==null;){var x=i,T=x.stateNode;x.tag===5&&T!==null&&(x=T,T=Nc(i,c),T!=null&&y.unshift(Hc(i,T,x)),T=Nc(i,o),T!=null&&y.push(Hc(i,T,x))),i=i.return}return y}function zl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function kv(i,o,c,y,x){for(var T=o._reactName,S=[];c!==null&&c!==y;){var d=c,U=d.alternate,ee=d.stateNode;if(U!==null&&U===y)break;d.tag===5&&ee!==null&&(d=ee,x?(U=Nc(c,T),U!=null&&S.unshift(Hc(c,U,d))):x||(U=Nc(c,T),U!=null&&S.push(Hc(c,U,d)))),c=c.return}S.length!==0&&i.push({event:o,listeners:S})}var xS=/\r\n?/g,wS=/\u0000|\uFFFD/g;function Ev(i){return(typeof i=="string"?i:""+i).replace(xS,`
`).replace(wS,"")}function wd(i,o,c){if(o=Ev(o),Ev(i)!==o&&c)throw Error(Me(425))}function Wd(){}var Zm=null,qm=null;function Gm(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Hm=typeof setTimeout=="function"?setTimeout:void 0,bS=typeof clearTimeout=="function"?clearTimeout:void 0,Cv=typeof Promise=="function"?Promise:void 0,SS=typeof queueMicrotask=="function"?queueMicrotask:typeof Cv<"u"?function(i){return Cv.resolve(null).then(i).catch(TS)}:Hm;function TS(i){setTimeout(function(){throw i})}function cm(i,o){var c=o,y=0;do{var x=c.nextSibling;if(i.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"){if(y===0){i.removeChild(x),$c(o);return}y--}else c!=="$"&&c!=="$?"&&c!=="$!"||y++;c=x}while(c);$c(o)}function As(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Pv(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return i;o--}else c==="/$"&&o++}i=i.previousSibling}return null}var su=Math.random().toString(36).slice(2),oo="__reactFiber$"+su,Wc="__reactProps$"+su,Ro="__reactContainer$"+su,Wm="__reactEvents$"+su,IS="__reactListeners$"+su,kS="__reactHandles$"+su;function Sa(i){var o=i[oo];if(o)return o;for(var c=i.parentNode;c;){if(o=c[Ro]||c[oo]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=Pv(i);i!==null;){if(c=i[oo])return c;i=Pv(i)}return o}i=c,c=i.parentNode}return null}function sh(i){return i=i[oo]||i[Ro],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Bl(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Me(33))}function yp(i){return i[Wc]||null}var Xm=[],jl=-1;function Vs(i){return{current:i}}function ri(i){0>jl||(i.current=Xm[jl],Xm[jl]=null,jl--)}function Qt(i,o){jl++,Xm[jl]=i.current,i.current=o}var Os={},gn=Vs(Os),Nn=Vs(!1),Ca=Os;function Jl(i,o){var c=i.type.contextTypes;if(!c)return Os;var y=i.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===o)return y.__reactInternalMemoizedMaskedChildContext;var x={},T;for(T in c)x[T]=o[T];return y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=x),x}function Vn(i){return i=i.childContextTypes,i!=null}function Xd(){ri(Nn),ri(gn)}function Mv(i,o,c){if(gn.current!==Os)throw Error(Me(168));Qt(gn,o),Qt(Nn,c)}function Tx(i,o,c){var y=i.stateNode;if(o=o.childContextTypes,typeof y.getChildContext!="function")return c;y=y.getChildContext();for(var x in y)if(!(x in o))throw Error(Me(108,c2(i)||"Unknown",x));return fi({},c,y)}function Kd(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Os,Ca=gn.current,Qt(gn,i),Qt(Nn,Nn.current),!0}function zv(i,o,c){var y=i.stateNode;if(!y)throw Error(Me(169));c?(i=Tx(i,o,Ca),y.__reactInternalMemoizedMergedChildContext=i,ri(Nn),ri(gn),Qt(gn,i)):ri(Nn),Qt(Nn,c)}var Mo=null,_p=!1,hm=!1;function Ix(i){Mo===null?Mo=[i]:Mo.push(i)}function ES(i){_p=!0,Ix(i)}function Us(){if(!hm&&Mo!==null){hm=!0;var i=0,o=Gt;try{var c=Mo;for(Gt=1;i<c.length;i++){var y=c[i];do y=y(!0);while(y!==null)}Mo=null,_p=!1}catch(x){throw Mo!==null&&(Mo=Mo.slice(i+1)),K0(Pg,Us),x}finally{Gt=o,hm=!1}}return null}var Ol=[],Nl=0,Jd=null,Yd=0,Sr=[],Tr=0,Pa=null,zo=1,Ao="";function xa(i,o){Ol[Nl++]=Yd,Ol[Nl++]=Jd,Jd=i,Yd=o}function kx(i,o,c){Sr[Tr++]=zo,Sr[Tr++]=Ao,Sr[Tr++]=Pa,Pa=i;var y=zo;i=Ao;var x=32-Vr(y)-1;y&=~(1<<x),c+=1;var T=32-Vr(o)+x;if(30<T){var S=x-x%5;T=(y&(1<<S)-1).toString(32),y>>=S,x-=S,zo=1<<32-Vr(o)+x|c<<x|y,Ao=T+i}else zo=1<<T|c<<x|y,Ao=i}function jg(i){i.return!==null&&(xa(i,1),kx(i,1,0))}function Og(i){for(;i===Jd;)Jd=Ol[--Nl],Ol[Nl]=null,Yd=Ol[--Nl],Ol[Nl]=null;for(;i===Pa;)Pa=Sr[--Tr],Sr[Tr]=null,Ao=Sr[--Tr],Sr[Tr]=null,zo=Sr[--Tr],Sr[Tr]=null}var ar=null,sr=null,ui=!1,Nr=null;function Ex(i,o){var c=Ir(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=i,o=i.deletions,o===null?(i.deletions=[c],i.flags|=16):o.push(c)}function Av(i,o){switch(i.tag){case 5:var c=i.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,ar=i,sr=As(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,ar=i,sr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(c=Pa!==null?{id:zo,overflow:Ao}:null,i.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},c=Ir(18,null,null,0),c.stateNode=o,c.return=i,i.child=c,ar=i,sr=null,!0):!1;default:return!1}}function Km(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Jm(i){if(ui){var o=sr;if(o){var c=o;if(!Av(i,o)){if(Km(i))throw Error(Me(418));o=As(c.nextSibling);var y=ar;o&&Av(i,o)?Ex(y,c):(i.flags=i.flags&-4097|2,ui=!1,ar=i)}}else{if(Km(i))throw Error(Me(418));i.flags=i.flags&-4097|2,ui=!1,ar=i}}}function Dv(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;ar=i}function bd(i){if(i!==ar)return!1;if(!ui)return Dv(i),ui=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Gm(i.type,i.memoizedProps)),o&&(o=sr)){if(Km(i))throw Cx(),Error(Me(418));for(;o;)Ex(i,o),o=As(o.nextSibling)}if(Dv(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Me(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(o===0){sr=As(i.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}i=i.nextSibling}sr=null}}else sr=ar?As(i.stateNode.nextSibling):null;return!0}function Cx(){for(var i=sr;i;)i=As(i.nextSibling)}function Yl(){sr=ar=null,ui=!1}function Ng(i){Nr===null?Nr=[i]:Nr.push(i)}var CS=jo.ReactCurrentBatchConfig;function wc(i,o,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(Me(309));var y=c.stateNode}if(!y)throw Error(Me(147,i));var x=y,T=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===T?o.ref:(o=function(S){var d=x.refs;S===null?delete d[T]:d[T]=S},o._stringRef=T,o)}if(typeof i!="string")throw Error(Me(284));if(!c._owner)throw Error(Me(290,i))}return i}function Sd(i,o){throw i=Object.prototype.toString.call(o),Error(Me(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Lv(i){var o=i._init;return o(i._payload)}function Px(i){function o(le,ne){if(i){var ue=le.deletions;ue===null?(le.deletions=[ne],le.flags|=16):ue.push(ne)}}function c(le,ne){if(!i)return null;for(;ne!==null;)o(le,ne),ne=ne.sibling;return null}function y(le,ne){for(le=new Map;ne!==null;)ne.key!==null?le.set(ne.key,ne):le.set(ne.index,ne),ne=ne.sibling;return le}function x(le,ne){return le=Fs(le,ne),le.index=0,le.sibling=null,le}function T(le,ne,ue){return le.index=ue,i?(ue=le.alternate,ue!==null?(ue=ue.index,ue<ne?(le.flags|=2,ne):ue):(le.flags|=2,ne)):(le.flags|=1048576,ne)}function S(le){return i&&le.alternate===null&&(le.flags|=2),le}function d(le,ne,ue,Se){return ne===null||ne.tag!==6?(ne=_m(ue,le.mode,Se),ne.return=le,ne):(ne=x(ne,ue),ne.return=le,ne)}function U(le,ne,ue,Se){var je=ue.type;return je===Dl?me(le,ne,ue.props.children,Se,ue.key):ne!==null&&(ne.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===bs&&Lv(je)===ne.type)?(Se=x(ne,ue.props),Se.ref=wc(le,ne,ue),Se.return=le,Se):(Se=Od(ue.type,ue.key,ue.props,null,le.mode,Se),Se.ref=wc(le,ne,ue),Se.return=le,Se)}function ee(le,ne,ue,Se){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==ue.containerInfo||ne.stateNode.implementation!==ue.implementation?(ne=vm(ue,le.mode,Se),ne.return=le,ne):(ne=x(ne,ue.children||[]),ne.return=le,ne)}function me(le,ne,ue,Se,je){return ne===null||ne.tag!==7?(ne=Ea(ue,le.mode,Se,je),ne.return=le,ne):(ne=x(ne,ue),ne.return=le,ne)}function X(le,ne,ue){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ne=_m(""+ne,le.mode,ue),ne.return=le,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case dd:return ue=Od(ne.type,ne.key,ne.props,null,le.mode,ue),ue.ref=wc(le,null,ne),ue.return=le,ue;case Al:return ne=vm(ne,le.mode,ue),ne.return=le,ne;case bs:var Se=ne._init;return X(le,Se(ne._payload),ue)}if(kc(ne)||gc(ne))return ne=Ea(ne,le.mode,ue,null),ne.return=le,ne;Sd(le,ne)}return null}function Z(le,ne,ue,Se){var je=ne!==null?ne.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return je!==null?null:d(le,ne,""+ue,Se);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case dd:return ue.key===je?U(le,ne,ue,Se):null;case Al:return ue.key===je?ee(le,ne,ue,Se):null;case bs:return je=ue._init,Z(le,ne,je(ue._payload),Se)}if(kc(ue)||gc(ue))return je!==null?null:me(le,ne,ue,Se,null);Sd(le,ue)}return null}function ke(le,ne,ue,Se,je){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return le=le.get(ue)||null,d(ne,le,""+Se,je);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case dd:return le=le.get(Se.key===null?ue:Se.key)||null,U(ne,le,Se,je);case Al:return le=le.get(Se.key===null?ue:Se.key)||null,ee(ne,le,Se,je);case bs:var Je=Se._init;return ke(le,ne,ue,Je(Se._payload),je)}if(kc(Se)||gc(Se))return le=le.get(ue)||null,me(ne,le,Se,je,null);Sd(ne,Se)}return null}function Ee(le,ne,ue,Se){for(var je=null,Je=null,He=ne,ot=ne=0,Lt=null;He!==null&&ot<ue.length;ot++){He.index>ot?(Lt=He,He=null):Lt=He.sibling;var vt=Z(le,He,ue[ot],Se);if(vt===null){He===null&&(He=Lt);break}i&&He&&vt.alternate===null&&o(le,He),ne=T(vt,ne,ot),Je===null?je=vt:Je.sibling=vt,Je=vt,He=Lt}if(ot===ue.length)return c(le,He),ui&&xa(le,ot),je;if(He===null){for(;ot<ue.length;ot++)He=X(le,ue[ot],Se),He!==null&&(ne=T(He,ne,ot),Je===null?je=He:Je.sibling=He,Je=He);return ui&&xa(le,ot),je}for(He=y(le,He);ot<ue.length;ot++)Lt=ke(He,le,ot,ue[ot],Se),Lt!==null&&(i&&Lt.alternate!==null&&He.delete(Lt.key===null?ot:Lt.key),ne=T(Lt,ne,ot),Je===null?je=Lt:Je.sibling=Lt,Je=Lt);return i&&He.forEach(function(xt){return o(le,xt)}),ui&&xa(le,ot),je}function Ie(le,ne,ue,Se){var je=gc(ue);if(typeof je!="function")throw Error(Me(150));if(ue=je.call(ue),ue==null)throw Error(Me(151));for(var Je=je=null,He=ne,ot=ne=0,Lt=null,vt=ue.next();He!==null&&!vt.done;ot++,vt=ue.next()){He.index>ot?(Lt=He,He=null):Lt=He.sibling;var xt=Z(le,He,vt.value,Se);if(xt===null){He===null&&(He=Lt);break}i&&He&&xt.alternate===null&&o(le,He),ne=T(xt,ne,ot),Je===null?je=xt:Je.sibling=xt,Je=xt,He=Lt}if(vt.done)return c(le,He),ui&&xa(le,ot),je;if(He===null){for(;!vt.done;ot++,vt=ue.next())vt=X(le,vt.value,Se),vt!==null&&(ne=T(vt,ne,ot),Je===null?je=vt:Je.sibling=vt,Je=vt);return ui&&xa(le,ot),je}for(He=y(le,He);!vt.done;ot++,vt=ue.next())vt=ke(He,le,ot,vt.value,Se),vt!==null&&(i&&vt.alternate!==null&&He.delete(vt.key===null?ot:vt.key),ne=T(vt,ne,ot),Je===null?je=vt:Je.sibling=vt,Je=vt);return i&&He.forEach(function(hr){return o(le,hr)}),ui&&xa(le,ot),je}function $e(le,ne,ue,Se){if(typeof ue=="object"&&ue!==null&&ue.type===Dl&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case dd:e:{for(var je=ue.key,Je=ne;Je!==null;){if(Je.key===je){if(je=ue.type,je===Dl){if(Je.tag===7){c(le,Je.sibling),ne=x(Je,ue.props.children),ne.return=le,le=ne;break e}}else if(Je.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===bs&&Lv(je)===Je.type){c(le,Je.sibling),ne=x(Je,ue.props),ne.ref=wc(le,Je,ue),ne.return=le,le=ne;break e}c(le,Je);break}else o(le,Je);Je=Je.sibling}ue.type===Dl?(ne=Ea(ue.props.children,le.mode,Se,ue.key),ne.return=le,le=ne):(Se=Od(ue.type,ue.key,ue.props,null,le.mode,Se),Se.ref=wc(le,ne,ue),Se.return=le,le=Se)}return S(le);case Al:e:{for(Je=ue.key;ne!==null;){if(ne.key===Je)if(ne.tag===4&&ne.stateNode.containerInfo===ue.containerInfo&&ne.stateNode.implementation===ue.implementation){c(le,ne.sibling),ne=x(ne,ue.children||[]),ne.return=le,le=ne;break e}else{c(le,ne);break}else o(le,ne);ne=ne.sibling}ne=vm(ue,le.mode,Se),ne.return=le,le=ne}return S(le);case bs:return Je=ue._init,$e(le,ne,Je(ue._payload),Se)}if(kc(ue))return Ee(le,ne,ue,Se);if(gc(ue))return Ie(le,ne,ue,Se);Sd(le,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,ne!==null&&ne.tag===6?(c(le,ne.sibling),ne=x(ne,ue),ne.return=le,le=ne):(c(le,ne),ne=_m(ue,le.mode,Se),ne.return=le,le=ne),S(le)):c(le,ne)}return $e}var Ql=Px(!0),Mx=Px(!1),Qd=Vs(null),ep=null,Vl=null,Vg=null;function Ug(){Vg=Vl=ep=null}function $g(i){var o=Qd.current;ri(Qd),i._currentValue=o}function Ym(i,o,c){for(;i!==null;){var y=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,y!==null&&(y.childLanes|=o)):y!==null&&(y.childLanes&o)!==o&&(y.childLanes|=o),i===c)break;i=i.return}}function Wl(i,o){ep=i,Vg=Vl=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&o&&(On=!0),i.firstContext=null)}function Er(i){var o=i._currentValue;if(Vg!==i)if(i={context:i,memoizedValue:o,next:null},Vl===null){if(ep===null)throw Error(Me(308));Vl=i,ep.dependencies={lanes:0,firstContext:i}}else Vl=Vl.next=i;return o}var Ta=null;function Zg(i){Ta===null?Ta=[i]:Ta.push(i)}function zx(i,o,c,y){var x=o.interleaved;return x===null?(c.next=c,Zg(o)):(c.next=x.next,x.next=c),o.interleaved=c,Fo(i,y)}function Fo(i,o){i.lanes|=o;var c=i.alternate;for(c!==null&&(c.lanes|=o),c=i,i=i.return;i!==null;)i.childLanes|=o,c=i.alternate,c!==null&&(c.childLanes|=o),c=i,i=i.return;return c.tag===3?c.stateNode:null}var Ss=!1;function qg(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ax(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Do(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Ds(i,o,c){var y=i.updateQueue;if(y===null)return null;if(y=y.shared,Ft&2){var x=y.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),y.pending=o,Fo(i,c)}return x=y.interleaved,x===null?(o.next=o,Zg(y)):(o.next=x.next,x.next=o),y.interleaved=o,Fo(i,c)}function Dd(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194240)!==0)){var y=o.lanes;y&=i.pendingLanes,c|=y,o.lanes=c,Mg(i,c)}}function Rv(i,o){var c=i.updateQueue,y=i.alternate;if(y!==null&&(y=y.updateQueue,c===y)){var x=null,T=null;if(c=c.firstBaseUpdate,c!==null){do{var S={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};T===null?x=T=S:T=T.next=S,c=c.next}while(c!==null);T===null?x=T=o:T=T.next=o}else x=T=o;c={baseState:y.baseState,firstBaseUpdate:x,lastBaseUpdate:T,shared:y.shared,effects:y.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}function tp(i,o,c,y){var x=i.updateQueue;Ss=!1;var T=x.firstBaseUpdate,S=x.lastBaseUpdate,d=x.shared.pending;if(d!==null){x.shared.pending=null;var U=d,ee=U.next;U.next=null,S===null?T=ee:S.next=ee,S=U;var me=i.alternate;me!==null&&(me=me.updateQueue,d=me.lastBaseUpdate,d!==S&&(d===null?me.firstBaseUpdate=ee:d.next=ee,me.lastBaseUpdate=U))}if(T!==null){var X=x.baseState;S=0,me=ee=U=null,d=T;do{var Z=d.lane,ke=d.eventTime;if((y&Z)===Z){me!==null&&(me=me.next={eventTime:ke,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var Ee=i,Ie=d;switch(Z=o,ke=c,Ie.tag){case 1:if(Ee=Ie.payload,typeof Ee=="function"){X=Ee.call(ke,X,Z);break e}X=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Ie.payload,Z=typeof Ee=="function"?Ee.call(ke,X,Z):Ee,Z==null)break e;X=fi({},X,Z);break e;case 2:Ss=!0}}d.callback!==null&&d.lane!==0&&(i.flags|=64,Z=x.effects,Z===null?x.effects=[d]:Z.push(d))}else ke={eventTime:ke,lane:Z,tag:d.tag,payload:d.payload,callback:d.callback,next:null},me===null?(ee=me=ke,U=X):me=me.next=ke,S|=Z;if(d=d.next,d===null){if(d=x.shared.pending,d===null)break;Z=d,d=Z.next,Z.next=null,x.lastBaseUpdate=Z,x.shared.pending=null}}while(!0);if(me===null&&(U=X),x.baseState=U,x.firstBaseUpdate=ee,x.lastBaseUpdate=me,o=x.shared.interleaved,o!==null){x=o;do S|=x.lane,x=x.next;while(x!==o)}else T===null&&(x.shared.lanes=0);za|=S,i.lanes=S,i.memoizedState=X}}function Fv(i,o,c){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var y=i[o],x=y.callback;if(x!==null){if(y.callback=null,y=c,typeof x!="function")throw Error(Me(191,x));x.call(y)}}}var ah={},ao=Vs(ah),Xc=Vs(ah),Kc=Vs(ah);function Ia(i){if(i===ah)throw Error(Me(174));return i}function Gg(i,o){switch(Qt(Kc,o),Qt(Xc,i),Qt(ao,ah),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Am(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Am(o,i)}ri(ao),Qt(ao,o)}function eu(){ri(ao),ri(Xc),ri(Kc)}function Dx(i){Ia(Kc.current);var o=Ia(ao.current),c=Am(o,i.type);o!==c&&(Qt(Xc,i),Qt(ao,c))}function Hg(i){Xc.current===i&&(ri(ao),ri(Xc))}var di=Vs(0);function ip(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var dm=[];function Wg(){for(var i=0;i<dm.length;i++)dm[i]._workInProgressVersionPrimary=null;dm.length=0}var Ld=jo.ReactCurrentDispatcher,pm=jo.ReactCurrentBatchConfig,Ma=0,pi=null,Ai=null,$i=null,np=!1,Lc=!1,Jc=0,PS=0;function pn(){throw Error(Me(321))}function Xg(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!$r(i[c],o[c]))return!1;return!0}function Kg(i,o,c,y,x,T){if(Ma=T,pi=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ld.current=i===null||i.memoizedState===null?DS:LS,i=c(y,x),Lc){T=0;do{if(Lc=!1,Jc=0,25<=T)throw Error(Me(301));T+=1,$i=Ai=null,o.updateQueue=null,Ld.current=RS,i=c(y,x)}while(Lc)}if(Ld.current=rp,o=Ai!==null&&Ai.next!==null,Ma=0,$i=Ai=pi=null,np=!1,o)throw Error(Me(300));return i}function Jg(){var i=Jc!==0;return Jc=0,i}function ro(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $i===null?pi.memoizedState=$i=i:$i=$i.next=i,$i}function Cr(){if(Ai===null){var i=pi.alternate;i=i!==null?i.memoizedState:null}else i=Ai.next;var o=$i===null?pi.memoizedState:$i.next;if(o!==null)$i=o,Ai=i;else{if(i===null)throw Error(Me(310));Ai=i,i={memoizedState:Ai.memoizedState,baseState:Ai.baseState,baseQueue:Ai.baseQueue,queue:Ai.queue,next:null},$i===null?pi.memoizedState=$i=i:$i=$i.next=i}return $i}function Yc(i,o){return typeof o=="function"?o(i):o}function fm(i){var o=Cr(),c=o.queue;if(c===null)throw Error(Me(311));c.lastRenderedReducer=i;var y=Ai,x=y.baseQueue,T=c.pending;if(T!==null){if(x!==null){var S=x.next;x.next=T.next,T.next=S}y.baseQueue=x=T,c.pending=null}if(x!==null){T=x.next,y=y.baseState;var d=S=null,U=null,ee=T;do{var me=ee.lane;if((Ma&me)===me)U!==null&&(U=U.next={lane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),y=ee.hasEagerState?ee.eagerState:i(y,ee.action);else{var X={lane:me,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null};U===null?(d=U=X,S=y):U=U.next=X,pi.lanes|=me,za|=me}ee=ee.next}while(ee!==null&&ee!==T);U===null?S=y:U.next=d,$r(y,o.memoizedState)||(On=!0),o.memoizedState=y,o.baseState=S,o.baseQueue=U,c.lastRenderedState=y}if(i=c.interleaved,i!==null){x=i;do T=x.lane,pi.lanes|=T,za|=T,x=x.next;while(x!==i)}else x===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function mm(i){var o=Cr(),c=o.queue;if(c===null)throw Error(Me(311));c.lastRenderedReducer=i;var y=c.dispatch,x=c.pending,T=o.memoizedState;if(x!==null){c.pending=null;var S=x=x.next;do T=i(T,S.action),S=S.next;while(S!==x);$r(T,o.memoizedState)||(On=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),c.lastRenderedState=T}return[T,y]}function Lx(){}function Rx(i,o){var c=pi,y=Cr(),x=o(),T=!$r(y.memoizedState,x);if(T&&(y.memoizedState=x,On=!0),y=y.queue,Yg(jx.bind(null,c,y,i),[i]),y.getSnapshot!==o||T||$i!==null&&$i.memoizedState.tag&1){if(c.flags|=2048,Qc(9,Bx.bind(null,c,y,x,o),void 0,null),Zi===null)throw Error(Me(349));Ma&30||Fx(c,o,x)}return x}function Fx(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=pi.updateQueue,o===null?(o={lastEffect:null,stores:null},pi.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function Bx(i,o,c,y){o.value=c,o.getSnapshot=y,Ox(o)&&Nx(i)}function jx(i,o,c){return c(function(){Ox(o)&&Nx(i)})}function Ox(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!$r(i,c)}catch{return!0}}function Nx(i){var o=Fo(i,1);o!==null&&Ur(o,i,1,-1)}function Bv(i){var o=ro();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yc,lastRenderedState:i},o.queue=i,i=i.dispatch=AS.bind(null,pi,i),[o.memoizedState,i]}function Qc(i,o,c,y){return i={tag:i,create:o,destroy:c,deps:y,next:null},o=pi.updateQueue,o===null?(o={lastEffect:null,stores:null},pi.updateQueue=o,o.lastEffect=i.next=i):(c=o.lastEffect,c===null?o.lastEffect=i.next=i:(y=c.next,c.next=i,i.next=y,o.lastEffect=i)),i}function Vx(){return Cr().memoizedState}function Rd(i,o,c,y){var x=ro();pi.flags|=i,x.memoizedState=Qc(1|o,c,void 0,y===void 0?null:y)}function vp(i,o,c,y){var x=Cr();y=y===void 0?null:y;var T=void 0;if(Ai!==null){var S=Ai.memoizedState;if(T=S.destroy,y!==null&&Xg(y,S.deps)){x.memoizedState=Qc(o,c,T,y);return}}pi.flags|=i,x.memoizedState=Qc(1|o,c,T,y)}function jv(i,o){return Rd(8390656,8,i,o)}function Yg(i,o){return vp(2048,8,i,o)}function Ux(i,o){return vp(4,2,i,o)}function $x(i,o){return vp(4,4,i,o)}function Zx(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function qx(i,o,c){return c=c!=null?c.concat([i]):null,vp(4,4,Zx.bind(null,o,i),c)}function Qg(){}function Gx(i,o){var c=Cr();o=o===void 0?null:o;var y=c.memoizedState;return y!==null&&o!==null&&Xg(o,y[1])?y[0]:(c.memoizedState=[i,o],i)}function Hx(i,o){var c=Cr();o=o===void 0?null:o;var y=c.memoizedState;return y!==null&&o!==null&&Xg(o,y[1])?y[0]:(i=i(),c.memoizedState=[i,o],i)}function Wx(i,o,c){return Ma&21?($r(c,o)||(c=Q0(),pi.lanes|=c,za|=c,i.baseState=!0),o):(i.baseState&&(i.baseState=!1,On=!0),i.memoizedState=c)}function MS(i,o){var c=Gt;Gt=c!==0&&4>c?c:4,i(!0);var y=pm.transition;pm.transition={};try{i(!1),o()}finally{Gt=c,pm.transition=y}}function Xx(){return Cr().memoizedState}function zS(i,o,c){var y=Rs(i);if(c={lane:y,action:c,hasEagerState:!1,eagerState:null,next:null},Kx(i))Jx(o,c);else if(c=zx(i,o,c,y),c!==null){var x=kn();Ur(c,i,y,x),Yx(c,o,y)}}function AS(i,o,c){var y=Rs(i),x={lane:y,action:c,hasEagerState:!1,eagerState:null,next:null};if(Kx(i))Jx(o,x);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=o.lastRenderedReducer,T!==null))try{var S=o.lastRenderedState,d=T(S,c);if(x.hasEagerState=!0,x.eagerState=d,$r(d,S)){var U=o.interleaved;U===null?(x.next=x,Zg(o)):(x.next=U.next,U.next=x),o.interleaved=x;return}}catch{}finally{}c=zx(i,o,x,y),c!==null&&(x=kn(),Ur(c,i,y,x),Yx(c,o,y))}}function Kx(i){var o=i.alternate;return i===pi||o!==null&&o===pi}function Jx(i,o){Lc=np=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function Yx(i,o,c){if(c&4194240){var y=o.lanes;y&=i.pendingLanes,c|=y,o.lanes=c,Mg(i,c)}}var rp={readContext:Er,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useInsertionEffect:pn,useLayoutEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useMutableSource:pn,useSyncExternalStore:pn,useId:pn,unstable_isNewReconciler:!1},DS={readContext:Er,useCallback:function(i,o){return ro().memoizedState=[i,o===void 0?null:o],i},useContext:Er,useEffect:jv,useImperativeHandle:function(i,o,c){return c=c!=null?c.concat([i]):null,Rd(4194308,4,Zx.bind(null,o,i),c)},useLayoutEffect:function(i,o){return Rd(4194308,4,i,o)},useInsertionEffect:function(i,o){return Rd(4,2,i,o)},useMemo:function(i,o){var c=ro();return o=o===void 0?null:o,i=i(),c.memoizedState=[i,o],i},useReducer:function(i,o,c){var y=ro();return o=c!==void 0?c(o):o,y.memoizedState=y.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},y.queue=i,i=i.dispatch=zS.bind(null,pi,i),[y.memoizedState,i]},useRef:function(i){var o=ro();return i={current:i},o.memoizedState=i},useState:Bv,useDebugValue:Qg,useDeferredValue:function(i){return ro().memoizedState=i},useTransition:function(){var i=Bv(!1),o=i[0];return i=MS.bind(null,i[1]),ro().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,c){var y=pi,x=ro();if(ui){if(c===void 0)throw Error(Me(407));c=c()}else{if(c=o(),Zi===null)throw Error(Me(349));Ma&30||Fx(y,o,c)}x.memoizedState=c;var T={value:c,getSnapshot:o};return x.queue=T,jv(jx.bind(null,y,T,i),[i]),y.flags|=2048,Qc(9,Bx.bind(null,y,T,c,o),void 0,null),c},useId:function(){var i=ro(),o=Zi.identifierPrefix;if(ui){var c=Ao,y=zo;c=(y&~(1<<32-Vr(y)-1)).toString(32)+c,o=":"+o+"R"+c,c=Jc++,0<c&&(o+="H"+c.toString(32)),o+=":"}else c=PS++,o=":"+o+"r"+c.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},LS={readContext:Er,useCallback:Gx,useContext:Er,useEffect:Yg,useImperativeHandle:qx,useInsertionEffect:Ux,useLayoutEffect:$x,useMemo:Hx,useReducer:fm,useRef:Vx,useState:function(){return fm(Yc)},useDebugValue:Qg,useDeferredValue:function(i){var o=Cr();return Wx(o,Ai.memoizedState,i)},useTransition:function(){var i=fm(Yc)[0],o=Cr().memoizedState;return[i,o]},useMutableSource:Lx,useSyncExternalStore:Rx,useId:Xx,unstable_isNewReconciler:!1},RS={readContext:Er,useCallback:Gx,useContext:Er,useEffect:Yg,useImperativeHandle:qx,useInsertionEffect:Ux,useLayoutEffect:$x,useMemo:Hx,useReducer:mm,useRef:Vx,useState:function(){return mm(Yc)},useDebugValue:Qg,useDeferredValue:function(i){var o=Cr();return Ai===null?o.memoizedState=i:Wx(o,Ai.memoizedState,i)},useTransition:function(){var i=mm(Yc)[0],o=Cr().memoizedState;return[i,o]},useMutableSource:Lx,useSyncExternalStore:Rx,useId:Xx,unstable_isNewReconciler:!1};function jr(i,o){if(i&&i.defaultProps){o=fi({},o),i=i.defaultProps;for(var c in i)o[c]===void 0&&(o[c]=i[c]);return o}return o}function Qm(i,o,c,y){o=i.memoizedState,c=c(y,o),c=c==null?o:fi({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var xp={isMounted:function(i){return(i=i._reactInternals)?La(i)===i:!1},enqueueSetState:function(i,o,c){i=i._reactInternals;var y=kn(),x=Rs(i),T=Do(y,x);T.payload=o,c!=null&&(T.callback=c),o=Ds(i,T,x),o!==null&&(Ur(o,i,x,y),Dd(o,i,x))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var y=kn(),x=Rs(i),T=Do(y,x);T.tag=1,T.payload=o,c!=null&&(T.callback=c),o=Ds(i,T,x),o!==null&&(Ur(o,i,x,y),Dd(o,i,x))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=kn(),y=Rs(i),x=Do(c,y);x.tag=2,o!=null&&(x.callback=o),o=Ds(i,x,y),o!==null&&(Ur(o,i,y,c),Dd(o,i,y))}};function Ov(i,o,c,y,x,T,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(y,T,S):o.prototype&&o.prototype.isPureReactComponent?!qc(c,y)||!qc(x,T):!0}function Qx(i,o,c){var y=!1,x=Os,T=o.contextType;return typeof T=="object"&&T!==null?T=Er(T):(x=Vn(o)?Ca:gn.current,y=o.contextTypes,T=(y=y!=null)?Jl(i,x):Os),o=new o(c,T),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=xp,i.stateNode=o,o._reactInternals=i,y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=x,i.__reactInternalMemoizedMaskedChildContext=T),o}function Nv(i,o,c,y){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,y),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,y),o.state!==i&&xp.enqueueReplaceState(o,o.state,null)}function eg(i,o,c,y){var x=i.stateNode;x.props=c,x.state=i.memoizedState,x.refs={},qg(i);var T=o.contextType;typeof T=="object"&&T!==null?x.context=Er(T):(T=Vn(o)?Ca:gn.current,x.context=Jl(i,T)),x.state=i.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(Qm(i,o,T,c),x.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(o=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),o!==x.state&&xp.enqueueReplaceState(x,x.state,null),tp(i,c,x,y),x.state=i.memoizedState),typeof x.componentDidMount=="function"&&(i.flags|=4194308)}function tu(i,o){try{var c="",y=o;do c+=u2(y),y=y.return;while(y);var x=c}catch(T){x=`
Error generating stack: `+T.message+`
`+T.stack}return{value:i,source:o,stack:x,digest:null}}function gm(i,o,c){return{value:i,source:null,stack:c??null,digest:o??null}}function tg(i,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var FS=typeof WeakMap=="function"?WeakMap:Map;function e1(i,o,c){c=Do(-1,c),c.tag=3,c.payload={element:null};var y=o.value;return c.callback=function(){sp||(sp=!0,hg=y),tg(i,o)},c}function t1(i,o,c){c=Do(-1,c),c.tag=3;var y=i.type.getDerivedStateFromError;if(typeof y=="function"){var x=o.value;c.payload=function(){return y(x)},c.callback=function(){tg(i,o)}}var T=i.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(c.callback=function(){tg(i,o),typeof y!="function"&&(Ls===null?Ls=new Set([this]):Ls.add(this));var S=o.stack;this.componentDidCatch(o.value,{componentStack:S!==null?S:""})}),c}function Vv(i,o,c){var y=i.pingCache;if(y===null){y=i.pingCache=new FS;var x=new Set;y.set(o,x)}else x=y.get(o),x===void 0&&(x=new Set,y.set(o,x));x.has(c)||(x.add(c),i=KS.bind(null,i,o,c),o.then(i,i))}function Uv(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function $v(i,o,c,y,x){return i.mode&1?(i.flags|=65536,i.lanes=x,i):(i===o?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(o=Do(-1,1),o.tag=2,Ds(c,o,1))),c.lanes|=1),i)}var BS=jo.ReactCurrentOwner,On=!1;function In(i,o,c,y){o.child=i===null?Mx(o,null,c,y):Ql(o,i.child,c,y)}function Zv(i,o,c,y,x){c=c.render;var T=o.ref;return Wl(o,x),y=Kg(i,o,c,y,T,x),c=Jg(),i!==null&&!On?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~x,Bo(i,o,x)):(ui&&c&&jg(o),o.flags|=1,In(i,o,y,x),o.child)}function qv(i,o,c,y,x){if(i===null){var T=c.type;return typeof T=="function"&&!ay(T)&&T.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=T,i1(i,o,T,y,x)):(i=Od(c.type,null,y,o,o.mode,x),i.ref=o.ref,i.return=o,o.child=i)}if(T=i.child,!(i.lanes&x)){var S=T.memoizedProps;if(c=c.compare,c=c!==null?c:qc,c(S,y)&&i.ref===o.ref)return Bo(i,o,x)}return o.flags|=1,i=Fs(T,y),i.ref=o.ref,i.return=o,o.child=i}function i1(i,o,c,y,x){if(i!==null){var T=i.memoizedProps;if(qc(T,y)&&i.ref===o.ref)if(On=!1,o.pendingProps=y=T,(i.lanes&x)!==0)i.flags&131072&&(On=!0);else return o.lanes=i.lanes,Bo(i,o,x)}return ig(i,o,c,y,x)}function n1(i,o,c){var y=o.pendingProps,x=y.children,T=i!==null?i.memoizedState:null;if(y.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt($l,or),or|=c;else{if(!(c&1073741824))return i=T!==null?T.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Qt($l,or),or|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=T!==null?T.baseLanes:c,Qt($l,or),or|=y}else T!==null?(y=T.baseLanes|c,o.memoizedState=null):y=c,Qt($l,or),or|=y;return In(i,o,x,c),o.child}function r1(i,o){var c=o.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function ig(i,o,c,y,x){var T=Vn(c)?Ca:gn.current;return T=Jl(o,T),Wl(o,x),c=Kg(i,o,c,y,T,x),y=Jg(),i!==null&&!On?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~x,Bo(i,o,x)):(ui&&y&&jg(o),o.flags|=1,In(i,o,c,x),o.child)}function Gv(i,o,c,y,x){if(Vn(c)){var T=!0;Kd(o)}else T=!1;if(Wl(o,x),o.stateNode===null)Fd(i,o),Qx(o,c,y),eg(o,c,y,x),y=!0;else if(i===null){var S=o.stateNode,d=o.memoizedProps;S.props=d;var U=S.context,ee=c.contextType;typeof ee=="object"&&ee!==null?ee=Er(ee):(ee=Vn(c)?Ca:gn.current,ee=Jl(o,ee));var me=c.getDerivedStateFromProps,X=typeof me=="function"||typeof S.getSnapshotBeforeUpdate=="function";X||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(d!==y||U!==ee)&&Nv(o,S,y,ee),Ss=!1;var Z=o.memoizedState;S.state=Z,tp(o,y,S,x),U=o.memoizedState,d!==y||Z!==U||Nn.current||Ss?(typeof me=="function"&&(Qm(o,c,me,y),U=o.memoizedState),(d=Ss||Ov(o,c,d,y,Z,U,ee))?(X||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(o.flags|=4194308)):(typeof S.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=y,o.memoizedState=U),S.props=y,S.state=U,S.context=ee,y=d):(typeof S.componentDidMount=="function"&&(o.flags|=4194308),y=!1)}else{S=o.stateNode,Ax(i,o),d=o.memoizedProps,ee=o.type===o.elementType?d:jr(o.type,d),S.props=ee,X=o.pendingProps,Z=S.context,U=c.contextType,typeof U=="object"&&U!==null?U=Er(U):(U=Vn(c)?Ca:gn.current,U=Jl(o,U));var ke=c.getDerivedStateFromProps;(me=typeof ke=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(d!==X||Z!==U)&&Nv(o,S,y,U),Ss=!1,Z=o.memoizedState,S.state=Z,tp(o,y,S,x);var Ee=o.memoizedState;d!==X||Z!==Ee||Nn.current||Ss?(typeof ke=="function"&&(Qm(o,c,ke,y),Ee=o.memoizedState),(ee=Ss||Ov(o,c,ee,y,Z,Ee,U)||!1)?(me||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(y,Ee,U),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(y,Ee,U)),typeof S.componentDidUpdate=="function"&&(o.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof S.componentDidUpdate!="function"||d===i.memoizedProps&&Z===i.memoizedState||(o.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||d===i.memoizedProps&&Z===i.memoizedState||(o.flags|=1024),o.memoizedProps=y,o.memoizedState=Ee),S.props=y,S.state=Ee,S.context=U,y=ee):(typeof S.componentDidUpdate!="function"||d===i.memoizedProps&&Z===i.memoizedState||(o.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||d===i.memoizedProps&&Z===i.memoizedState||(o.flags|=1024),y=!1)}return ng(i,o,c,y,T,x)}function ng(i,o,c,y,x,T){r1(i,o);var S=(o.flags&128)!==0;if(!y&&!S)return x&&zv(o,c,!1),Bo(i,o,T);y=o.stateNode,BS.current=o;var d=S&&typeof c.getDerivedStateFromError!="function"?null:y.render();return o.flags|=1,i!==null&&S?(o.child=Ql(o,i.child,null,T),o.child=Ql(o,null,d,T)):In(i,o,d,T),o.memoizedState=y.state,x&&zv(o,c,!0),o.child}function o1(i){var o=i.stateNode;o.pendingContext?Mv(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Mv(i,o.context,!1),Gg(i,o.containerInfo)}function Hv(i,o,c,y,x){return Yl(),Ng(x),o.flags|=256,In(i,o,c,y),o.child}var rg={dehydrated:null,treeContext:null,retryLane:0};function og(i){return{baseLanes:i,cachePool:null,transitions:null}}function s1(i,o,c){var y=o.pendingProps,x=di.current,T=!1,S=(o.flags&128)!==0,d;if((d=S)||(d=i!==null&&i.memoizedState===null?!1:(x&2)!==0),d?(T=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(x|=1),Qt(di,x&1),i===null)return Jm(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(o.mode&1?i.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(S=y.children,i=y.fallback,T?(y=o.mode,T=o.child,S={mode:"hidden",children:S},!(y&1)&&T!==null?(T.childLanes=0,T.pendingProps=S):T=Sp(S,y,0,null),i=Ea(i,y,c,null),T.return=o,i.return=o,T.sibling=i,o.child=T,o.child.memoizedState=og(c),o.memoizedState=rg,i):ey(o,S));if(x=i.memoizedState,x!==null&&(d=x.dehydrated,d!==null))return jS(i,o,S,y,d,x,c);if(T){T=y.fallback,S=o.mode,x=i.child,d=x.sibling;var U={mode:"hidden",children:y.children};return!(S&1)&&o.child!==x?(y=o.child,y.childLanes=0,y.pendingProps=U,o.deletions=null):(y=Fs(x,U),y.subtreeFlags=x.subtreeFlags&14680064),d!==null?T=Fs(d,T):(T=Ea(T,S,c,null),T.flags|=2),T.return=o,y.return=o,y.sibling=T,o.child=y,y=T,T=o.child,S=i.child.memoizedState,S=S===null?og(c):{baseLanes:S.baseLanes|c,cachePool:null,transitions:S.transitions},T.memoizedState=S,T.childLanes=i.childLanes&~c,o.memoizedState=rg,y}return T=i.child,i=T.sibling,y=Fs(T,{mode:"visible",children:y.children}),!(o.mode&1)&&(y.lanes=c),y.return=o,y.sibling=null,i!==null&&(c=o.deletions,c===null?(o.deletions=[i],o.flags|=16):c.push(i)),o.child=y,o.memoizedState=null,y}function ey(i,o){return o=Sp({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Td(i,o,c,y){return y!==null&&Ng(y),Ql(o,i.child,null,c),i=ey(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function jS(i,o,c,y,x,T,S){if(c)return o.flags&256?(o.flags&=-257,y=gm(Error(Me(422))),Td(i,o,S,y)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(T=y.fallback,x=o.mode,y=Sp({mode:"visible",children:y.children},x,0,null),T=Ea(T,x,S,null),T.flags|=2,y.return=o,T.return=o,y.sibling=T,o.child=y,o.mode&1&&Ql(o,i.child,null,S),o.child.memoizedState=og(S),o.memoizedState=rg,T);if(!(o.mode&1))return Td(i,o,S,null);if(x.data==="$!"){if(y=x.nextSibling&&x.nextSibling.dataset,y)var d=y.dgst;return y=d,T=Error(Me(419)),y=gm(T,y,void 0),Td(i,o,S,y)}if(d=(S&i.childLanes)!==0,On||d){if(y=Zi,y!==null){switch(S&-S){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=x&(y.suspendedLanes|S)?0:x,x!==0&&x!==T.retryLane&&(T.retryLane=x,Fo(i,x),Ur(y,i,x,-1))}return sy(),y=gm(Error(Me(421))),Td(i,o,S,y)}return x.data==="$?"?(o.flags|=128,o.child=i.child,o=JS.bind(null,i),x._reactRetry=o,null):(i=T.treeContext,sr=As(x.nextSibling),ar=o,ui=!0,Nr=null,i!==null&&(Sr[Tr++]=zo,Sr[Tr++]=Ao,Sr[Tr++]=Pa,zo=i.id,Ao=i.overflow,Pa=o),o=ey(o,y.children),o.flags|=4096,o)}function Wv(i,o,c){i.lanes|=o;var y=i.alternate;y!==null&&(y.lanes|=o),Ym(i.return,o,c)}function ym(i,o,c,y,x){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:y,tail:c,tailMode:x}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=y,T.tail=c,T.tailMode=x)}function a1(i,o,c){var y=o.pendingProps,x=y.revealOrder,T=y.tail;if(In(i,o,y.children,c),y=di.current,y&2)y=y&1|2,o.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Wv(i,c,o);else if(i.tag===19)Wv(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}y&=1}if(Qt(di,y),!(o.mode&1))o.memoizedState=null;else switch(x){case"forwards":for(c=o.child,x=null;c!==null;)i=c.alternate,i!==null&&ip(i)===null&&(x=c),c=c.sibling;c=x,c===null?(x=o.child,o.child=null):(x=c.sibling,c.sibling=null),ym(o,!1,x,c,T);break;case"backwards":for(c=null,x=o.child,o.child=null;x!==null;){if(i=x.alternate,i!==null&&ip(i)===null){o.child=x;break}i=x.sibling,x.sibling=c,c=x,x=i}ym(o,!0,c,null,T);break;case"together":ym(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Fd(i,o){!(o.mode&1)&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Bo(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),za|=o.lanes,!(c&o.childLanes))return null;if(i!==null&&o.child!==i.child)throw Error(Me(153));if(o.child!==null){for(i=o.child,c=Fs(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=Fs(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function OS(i,o,c){switch(o.tag){case 3:o1(o),Yl();break;case 5:Dx(o);break;case 1:Vn(o.type)&&Kd(o);break;case 4:Gg(o,o.stateNode.containerInfo);break;case 10:var y=o.type._context,x=o.memoizedProps.value;Qt(Qd,y._currentValue),y._currentValue=x;break;case 13:if(y=o.memoizedState,y!==null)return y.dehydrated!==null?(Qt(di,di.current&1),o.flags|=128,null):c&o.child.childLanes?s1(i,o,c):(Qt(di,di.current&1),i=Bo(i,o,c),i!==null?i.sibling:null);Qt(di,di.current&1);break;case 19:if(y=(c&o.childLanes)!==0,i.flags&128){if(y)return a1(i,o,c);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Qt(di,di.current),y)break;return null;case 22:case 23:return o.lanes=0,n1(i,o,c)}return Bo(i,o,c)}var l1,sg,u1,c1;l1=function(i,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}};sg=function(){};u1=function(i,o,c,y){var x=i.memoizedProps;if(x!==y){i=o.stateNode,Ia(ao.current);var T=null;switch(c){case"input":x=Cm(i,x),y=Cm(i,y),T=[];break;case"select":x=fi({},x,{value:void 0}),y=fi({},y,{value:void 0}),T=[];break;case"textarea":x=zm(i,x),y=zm(i,y),T=[];break;default:typeof x.onClick!="function"&&typeof y.onClick=="function"&&(i.onclick=Wd)}Dm(c,y);var S;c=null;for(ee in x)if(!y.hasOwnProperty(ee)&&x.hasOwnProperty(ee)&&x[ee]!=null)if(ee==="style"){var d=x[ee];for(S in d)d.hasOwnProperty(S)&&(c||(c={}),c[S]="")}else ee!=="dangerouslySetInnerHTML"&&ee!=="children"&&ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(jc.hasOwnProperty(ee)?T||(T=[]):(T=T||[]).push(ee,null));for(ee in y){var U=y[ee];if(d=x!=null?x[ee]:void 0,y.hasOwnProperty(ee)&&U!==d&&(U!=null||d!=null))if(ee==="style")if(d){for(S in d)!d.hasOwnProperty(S)||U&&U.hasOwnProperty(S)||(c||(c={}),c[S]="");for(S in U)U.hasOwnProperty(S)&&d[S]!==U[S]&&(c||(c={}),c[S]=U[S])}else c||(T||(T=[]),T.push(ee,c)),c=U;else ee==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,d=d?d.__html:void 0,U!=null&&d!==U&&(T=T||[]).push(ee,U)):ee==="children"?typeof U!="string"&&typeof U!="number"||(T=T||[]).push(ee,""+U):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&(jc.hasOwnProperty(ee)?(U!=null&&ee==="onScroll"&&ni("scroll",i),T||d===U||(T=[])):(T=T||[]).push(ee,U))}c&&(T=T||[]).push("style",c);var ee=T;(o.updateQueue=ee)&&(o.flags|=4)}};c1=function(i,o,c,y){c!==y&&(o.flags|=4)};function bc(i,o){if(!ui)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var y=null;c!==null;)c.alternate!==null&&(y=c),c=c.sibling;y===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:y.sibling=null}}function fn(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,y=0;if(o)for(var x=i.child;x!==null;)c|=x.lanes|x.childLanes,y|=x.subtreeFlags&14680064,y|=x.flags&14680064,x.return=i,x=x.sibling;else for(x=i.child;x!==null;)c|=x.lanes|x.childLanes,y|=x.subtreeFlags,y|=x.flags,x.return=i,x=x.sibling;return i.subtreeFlags|=y,i.childLanes=c,o}function NS(i,o,c){var y=o.pendingProps;switch(Og(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fn(o),null;case 1:return Vn(o.type)&&Xd(),fn(o),null;case 3:return y=o.stateNode,eu(),ri(Nn),ri(gn),Wg(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(i===null||i.child===null)&&(bd(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Nr!==null&&(fg(Nr),Nr=null))),sg(i,o),fn(o),null;case 5:Hg(o);var x=Ia(Kc.current);if(c=o.type,i!==null&&o.stateNode!=null)u1(i,o,c,y,x),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!y){if(o.stateNode===null)throw Error(Me(166));return fn(o),null}if(i=Ia(ao.current),bd(o)){y=o.stateNode,c=o.type;var T=o.memoizedProps;switch(y[oo]=o,y[Wc]=T,i=(o.mode&1)!==0,c){case"dialog":ni("cancel",y),ni("close",y);break;case"iframe":case"object":case"embed":ni("load",y);break;case"video":case"audio":for(x=0;x<Cc.length;x++)ni(Cc[x],y);break;case"source":ni("error",y);break;case"img":case"image":case"link":ni("error",y),ni("load",y);break;case"details":ni("toggle",y);break;case"input":nv(y,T),ni("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!T.multiple},ni("invalid",y);break;case"textarea":ov(y,T),ni("invalid",y)}Dm(c,T),x=null;for(var S in T)if(T.hasOwnProperty(S)){var d=T[S];S==="children"?typeof d=="string"?y.textContent!==d&&(T.suppressHydrationWarning!==!0&&wd(y.textContent,d,i),x=["children",d]):typeof d=="number"&&y.textContent!==""+d&&(T.suppressHydrationWarning!==!0&&wd(y.textContent,d,i),x=["children",""+d]):jc.hasOwnProperty(S)&&d!=null&&S==="onScroll"&&ni("scroll",y)}switch(c){case"input":pd(y),rv(y,T,!0);break;case"textarea":pd(y),sv(y);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(y.onclick=Wd)}y=x,o.updateQueue=y,y!==null&&(o.flags|=4)}else{S=x.nodeType===9?x:x.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=j0(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=S.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof y.is=="string"?i=S.createElement(c,{is:y.is}):(i=S.createElement(c),c==="select"&&(S=i,y.multiple?S.multiple=!0:y.size&&(S.size=y.size))):i=S.createElementNS(i,c),i[oo]=o,i[Wc]=y,l1(i,o,!1,!1),o.stateNode=i;e:{switch(S=Lm(c,y),c){case"dialog":ni("cancel",i),ni("close",i),x=y;break;case"iframe":case"object":case"embed":ni("load",i),x=y;break;case"video":case"audio":for(x=0;x<Cc.length;x++)ni(Cc[x],i);x=y;break;case"source":ni("error",i),x=y;break;case"img":case"image":case"link":ni("error",i),ni("load",i),x=y;break;case"details":ni("toggle",i),x=y;break;case"input":nv(i,y),x=Cm(i,y),ni("invalid",i);break;case"option":x=y;break;case"select":i._wrapperState={wasMultiple:!!y.multiple},x=fi({},y,{value:void 0}),ni("invalid",i);break;case"textarea":ov(i,y),x=zm(i,y),ni("invalid",i);break;default:x=y}Dm(c,x),d=x;for(T in d)if(d.hasOwnProperty(T)){var U=d[T];T==="style"?V0(i,U):T==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&O0(i,U)):T==="children"?typeof U=="string"?(c!=="textarea"||U!=="")&&Oc(i,U):typeof U=="number"&&Oc(i,""+U):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(jc.hasOwnProperty(T)?U!=null&&T==="onScroll"&&ni("scroll",i):U!=null&&Tg(i,T,U,S))}switch(c){case"input":pd(i),rv(i,y,!1);break;case"textarea":pd(i),sv(i);break;case"option":y.value!=null&&i.setAttribute("value",""+js(y.value));break;case"select":i.multiple=!!y.multiple,T=y.value,T!=null?Zl(i,!!y.multiple,T,!1):y.defaultValue!=null&&Zl(i,!!y.multiple,y.defaultValue,!0);break;default:typeof x.onClick=="function"&&(i.onclick=Wd)}switch(c){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return fn(o),null;case 6:if(i&&o.stateNode!=null)c1(i,o,i.memoizedProps,y);else{if(typeof y!="string"&&o.stateNode===null)throw Error(Me(166));if(c=Ia(Kc.current),Ia(ao.current),bd(o)){if(y=o.stateNode,c=o.memoizedProps,y[oo]=o,(T=y.nodeValue!==c)&&(i=ar,i!==null))switch(i.tag){case 3:wd(y.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&wd(y.nodeValue,c,(i.mode&1)!==0)}T&&(o.flags|=4)}else y=(c.nodeType===9?c:c.ownerDocument).createTextNode(y),y[oo]=o,o.stateNode=y}return fn(o),null;case 13:if(ri(di),y=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(ui&&sr!==null&&o.mode&1&&!(o.flags&128))Cx(),Yl(),o.flags|=98560,T=!1;else if(T=bd(o),y!==null&&y.dehydrated!==null){if(i===null){if(!T)throw Error(Me(318));if(T=o.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(Me(317));T[oo]=o}else Yl(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;fn(o),T=!1}else Nr!==null&&(fg(Nr),Nr=null),T=!0;if(!T)return o.flags&65536?o:null}return o.flags&128?(o.lanes=c,o):(y=y!==null,y!==(i!==null&&i.memoizedState!==null)&&y&&(o.child.flags|=8192,o.mode&1&&(i===null||di.current&1?Di===0&&(Di=3):sy())),o.updateQueue!==null&&(o.flags|=4),fn(o),null);case 4:return eu(),sg(i,o),i===null&&Gc(o.stateNode.containerInfo),fn(o),null;case 10:return $g(o.type._context),fn(o),null;case 17:return Vn(o.type)&&Xd(),fn(o),null;case 19:if(ri(di),T=o.memoizedState,T===null)return fn(o),null;if(y=(o.flags&128)!==0,S=T.rendering,S===null)if(y)bc(T,!1);else{if(Di!==0||i!==null&&i.flags&128)for(i=o.child;i!==null;){if(S=ip(i),S!==null){for(o.flags|=128,bc(T,!1),y=S.updateQueue,y!==null&&(o.updateQueue=y,o.flags|=4),o.subtreeFlags=0,y=c,c=o.child;c!==null;)T=c,i=y,T.flags&=14680066,S=T.alternate,S===null?(T.childLanes=0,T.lanes=i,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=S.childLanes,T.lanes=S.lanes,T.child=S.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=S.memoizedProps,T.memoizedState=S.memoizedState,T.updateQueue=S.updateQueue,T.type=S.type,i=S.dependencies,T.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return Qt(di,di.current&1|2),o.child}i=i.sibling}T.tail!==null&&xi()>iu&&(o.flags|=128,y=!0,bc(T,!1),o.lanes=4194304)}else{if(!y)if(i=ip(S),i!==null){if(o.flags|=128,y=!0,c=i.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),bc(T,!0),T.tail===null&&T.tailMode==="hidden"&&!S.alternate&&!ui)return fn(o),null}else 2*xi()-T.renderingStartTime>iu&&c!==1073741824&&(o.flags|=128,y=!0,bc(T,!1),o.lanes=4194304);T.isBackwards?(S.sibling=o.child,o.child=S):(c=T.last,c!==null?c.sibling=S:o.child=S,T.last=S)}return T.tail!==null?(o=T.tail,T.rendering=o,T.tail=o.sibling,T.renderingStartTime=xi(),o.sibling=null,c=di.current,Qt(di,y?c&1|2:c&1),o):(fn(o),null);case 22:case 23:return oy(),y=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==y&&(o.flags|=8192),y&&o.mode&1?or&1073741824&&(fn(o),o.subtreeFlags&6&&(o.flags|=8192)):fn(o),null;case 24:return null;case 25:return null}throw Error(Me(156,o.tag))}function VS(i,o){switch(Og(o),o.tag){case 1:return Vn(o.type)&&Xd(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return eu(),ri(Nn),ri(gn),Wg(),i=o.flags,i&65536&&!(i&128)?(o.flags=i&-65537|128,o):null;case 5:return Hg(o),null;case 13:if(ri(di),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(Me(340));Yl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return ri(di),null;case 4:return eu(),null;case 10:return $g(o.type._context),null;case 22:case 23:return oy(),null;case 24:return null;default:return null}}var Id=!1,mn=!1,US=typeof WeakSet=="function"?WeakSet:Set,it=null;function Ul(i,o){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(y){_i(i,o,y)}else c.current=null}function ag(i,o,c){try{c()}catch(y){_i(i,o,y)}}var Xv=!1;function $S(i,o){if(Zm=qd,i=mx(),Bg(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var y=c.getSelection&&c.getSelection();if(y&&y.rangeCount!==0){c=y.anchorNode;var x=y.anchorOffset,T=y.focusNode;y=y.focusOffset;try{c.nodeType,T.nodeType}catch{c=null;break e}var S=0,d=-1,U=-1,ee=0,me=0,X=i,Z=null;t:for(;;){for(var ke;X!==c||x!==0&&X.nodeType!==3||(d=S+x),X!==T||y!==0&&X.nodeType!==3||(U=S+y),X.nodeType===3&&(S+=X.nodeValue.length),(ke=X.firstChild)!==null;)Z=X,X=ke;for(;;){if(X===i)break t;if(Z===c&&++ee===x&&(d=S),Z===T&&++me===y&&(U=S),(ke=X.nextSibling)!==null)break;X=Z,Z=X.parentNode}X=ke}c=d===-1||U===-1?null:{start:d,end:U}}else c=null}c=c||{start:0,end:0}}else c=null;for(qm={focusedElem:i,selectionRange:c},qd=!1,it=o;it!==null;)if(o=it,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,it=i;else for(;it!==null;){o=it;try{var Ee=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Ee!==null){var Ie=Ee.memoizedProps,$e=Ee.memoizedState,le=o.stateNode,ne=le.getSnapshotBeforeUpdate(o.elementType===o.type?Ie:jr(o.type,Ie),$e);le.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:var ue=o.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(Se){_i(o,o.return,Se)}if(i=o.sibling,i!==null){i.return=o.return,it=i;break}it=o.return}return Ee=Xv,Xv=!1,Ee}function Rc(i,o,c){var y=o.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var x=y=y.next;do{if((x.tag&i)===i){var T=x.destroy;x.destroy=void 0,T!==void 0&&ag(o,c,T)}x=x.next}while(x!==y)}}function wp(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&i)===i){var y=c.create;c.destroy=y()}c=c.next}while(c!==o)}}function lg(i){var o=i.ref;if(o!==null){var c=i.stateNode;switch(i.tag){case 5:i=c;break;default:i=c}typeof o=="function"?o(i):o.current=i}}function h1(i){var o=i.alternate;o!==null&&(i.alternate=null,h1(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[oo],delete o[Wc],delete o[Wm],delete o[IS],delete o[kS])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function d1(i){return i.tag===5||i.tag===3||i.tag===4}function Kv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||d1(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function ug(i,o,c){var y=i.tag;if(y===5||y===6)i=i.stateNode,o?c.nodeType===8?c.parentNode.insertBefore(i,o):c.insertBefore(i,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(i,c)):(o=c,o.appendChild(i)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Wd));else if(y!==4&&(i=i.child,i!==null))for(ug(i,o,c),i=i.sibling;i!==null;)ug(i,o,c),i=i.sibling}function cg(i,o,c){var y=i.tag;if(y===5||y===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(y!==4&&(i=i.child,i!==null))for(cg(i,o,c),i=i.sibling;i!==null;)cg(i,o,c),i=i.sibling}var Ji=null,Or=!1;function ws(i,o,c){for(c=c.child;c!==null;)p1(i,o,c),c=c.sibling}function p1(i,o,c){if(so&&typeof so.onCommitFiberUnmount=="function")try{so.onCommitFiberUnmount(pp,c)}catch{}switch(c.tag){case 5:mn||Ul(c,o);case 6:var y=Ji,x=Or;Ji=null,ws(i,o,c),Ji=y,Or=x,Ji!==null&&(Or?(i=Ji,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):Ji.removeChild(c.stateNode));break;case 18:Ji!==null&&(Or?(i=Ji,c=c.stateNode,i.nodeType===8?cm(i.parentNode,c):i.nodeType===1&&cm(i,c),$c(i)):cm(Ji,c.stateNode));break;case 4:y=Ji,x=Or,Ji=c.stateNode.containerInfo,Or=!0,ws(i,o,c),Ji=y,Or=x;break;case 0:case 11:case 14:case 15:if(!mn&&(y=c.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){x=y=y.next;do{var T=x,S=T.destroy;T=T.tag,S!==void 0&&(T&2||T&4)&&ag(c,o,S),x=x.next}while(x!==y)}ws(i,o,c);break;case 1:if(!mn&&(Ul(c,o),y=c.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=c.memoizedProps,y.state=c.memoizedState,y.componentWillUnmount()}catch(d){_i(c,o,d)}ws(i,o,c);break;case 21:ws(i,o,c);break;case 22:c.mode&1?(mn=(y=mn)||c.memoizedState!==null,ws(i,o,c),mn=y):ws(i,o,c);break;default:ws(i,o,c)}}function Jv(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new US),o.forEach(function(y){var x=YS.bind(null,i,y);c.has(y)||(c.add(y),y.then(x,x))})}}function Br(i,o){var c=o.deletions;if(c!==null)for(var y=0;y<c.length;y++){var x=c[y];try{var T=i,S=o,d=S;e:for(;d!==null;){switch(d.tag){case 5:Ji=d.stateNode,Or=!1;break e;case 3:Ji=d.stateNode.containerInfo,Or=!0;break e;case 4:Ji=d.stateNode.containerInfo,Or=!0;break e}d=d.return}if(Ji===null)throw Error(Me(160));p1(T,S,x),Ji=null,Or=!1;var U=x.alternate;U!==null&&(U.return=null),x.return=null}catch(ee){_i(x,o,ee)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)f1(o,i),o=o.sibling}function f1(i,o){var c=i.alternate,y=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Br(o,i),no(i),y&4){try{Rc(3,i,i.return),wp(3,i)}catch(Ie){_i(i,i.return,Ie)}try{Rc(5,i,i.return)}catch(Ie){_i(i,i.return,Ie)}}break;case 1:Br(o,i),no(i),y&512&&c!==null&&Ul(c,c.return);break;case 5:if(Br(o,i),no(i),y&512&&c!==null&&Ul(c,c.return),i.flags&32){var x=i.stateNode;try{Oc(x,"")}catch(Ie){_i(i,i.return,Ie)}}if(y&4&&(x=i.stateNode,x!=null)){var T=i.memoizedProps,S=c!==null?c.memoizedProps:T,d=i.type,U=i.updateQueue;if(i.updateQueue=null,U!==null)try{d==="input"&&T.type==="radio"&&T.name!=null&&F0(x,T),Lm(d,S);var ee=Lm(d,T);for(S=0;S<U.length;S+=2){var me=U[S],X=U[S+1];me==="style"?V0(x,X):me==="dangerouslySetInnerHTML"?O0(x,X):me==="children"?Oc(x,X):Tg(x,me,X,ee)}switch(d){case"input":Pm(x,T);break;case"textarea":B0(x,T);break;case"select":var Z=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!T.multiple;var ke=T.value;ke!=null?Zl(x,!!T.multiple,ke,!1):Z!==!!T.multiple&&(T.defaultValue!=null?Zl(x,!!T.multiple,T.defaultValue,!0):Zl(x,!!T.multiple,T.multiple?[]:"",!1))}x[Wc]=T}catch(Ie){_i(i,i.return,Ie)}}break;case 6:if(Br(o,i),no(i),y&4){if(i.stateNode===null)throw Error(Me(162));x=i.stateNode,T=i.memoizedProps;try{x.nodeValue=T}catch(Ie){_i(i,i.return,Ie)}}break;case 3:if(Br(o,i),no(i),y&4&&c!==null&&c.memoizedState.isDehydrated)try{$c(o.containerInfo)}catch(Ie){_i(i,i.return,Ie)}break;case 4:Br(o,i),no(i);break;case 13:Br(o,i),no(i),x=i.child,x.flags&8192&&(T=x.memoizedState!==null,x.stateNode.isHidden=T,!T||x.alternate!==null&&x.alternate.memoizedState!==null||(ny=xi())),y&4&&Jv(i);break;case 22:if(me=c!==null&&c.memoizedState!==null,i.mode&1?(mn=(ee=mn)||me,Br(o,i),mn=ee):Br(o,i),no(i),y&8192){if(ee=i.memoizedState!==null,(i.stateNode.isHidden=ee)&&!me&&i.mode&1)for(it=i,me=i.child;me!==null;){for(X=it=me;it!==null;){switch(Z=it,ke=Z.child,Z.tag){case 0:case 11:case 14:case 15:Rc(4,Z,Z.return);break;case 1:Ul(Z,Z.return);var Ee=Z.stateNode;if(typeof Ee.componentWillUnmount=="function"){y=Z,c=Z.return;try{o=y,Ee.props=o.memoizedProps,Ee.state=o.memoizedState,Ee.componentWillUnmount()}catch(Ie){_i(y,c,Ie)}}break;case 5:Ul(Z,Z.return);break;case 22:if(Z.memoizedState!==null){Qv(X);continue}}ke!==null?(ke.return=Z,it=ke):Qv(X)}me=me.sibling}e:for(me=null,X=i;;){if(X.tag===5){if(me===null){me=X;try{x=X.stateNode,ee?(T=x.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(d=X.stateNode,U=X.memoizedProps.style,S=U!=null&&U.hasOwnProperty("display")?U.display:null,d.style.display=N0("display",S))}catch(Ie){_i(i,i.return,Ie)}}}else if(X.tag===6){if(me===null)try{X.stateNode.nodeValue=ee?"":X.memoizedProps}catch(Ie){_i(i,i.return,Ie)}}else if((X.tag!==22&&X.tag!==23||X.memoizedState===null||X===i)&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===i)break e;for(;X.sibling===null;){if(X.return===null||X.return===i)break e;me===X&&(me=null),X=X.return}me===X&&(me=null),X.sibling.return=X.return,X=X.sibling}}break;case 19:Br(o,i),no(i),y&4&&Jv(i);break;case 21:break;default:Br(o,i),no(i)}}function no(i){var o=i.flags;if(o&2){try{e:{for(var c=i.return;c!==null;){if(d1(c)){var y=c;break e}c=c.return}throw Error(Me(160))}switch(y.tag){case 5:var x=y.stateNode;y.flags&32&&(Oc(x,""),y.flags&=-33);var T=Kv(i);cg(i,T,x);break;case 3:case 4:var S=y.stateNode.containerInfo,d=Kv(i);ug(i,d,S);break;default:throw Error(Me(161))}}catch(U){_i(i,i.return,U)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function ZS(i,o,c){it=i,m1(i)}function m1(i,o,c){for(var y=(i.mode&1)!==0;it!==null;){var x=it,T=x.child;if(x.tag===22&&y){var S=x.memoizedState!==null||Id;if(!S){var d=x.alternate,U=d!==null&&d.memoizedState!==null||mn;d=Id;var ee=mn;if(Id=S,(mn=U)&&!ee)for(it=x;it!==null;)S=it,U=S.child,S.tag===22&&S.memoizedState!==null?e0(x):U!==null?(U.return=S,it=U):e0(x);for(;T!==null;)it=T,m1(T),T=T.sibling;it=x,Id=d,mn=ee}Yv(i)}else x.subtreeFlags&8772&&T!==null?(T.return=x,it=T):Yv(i)}}function Yv(i){for(;it!==null;){var o=it;if(o.flags&8772){var c=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:mn||wp(5,o);break;case 1:var y=o.stateNode;if(o.flags&4&&!mn)if(c===null)y.componentDidMount();else{var x=o.elementType===o.type?c.memoizedProps:jr(o.type,c.memoizedProps);y.componentDidUpdate(x,c.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var T=o.updateQueue;T!==null&&Fv(o,T,y);break;case 3:var S=o.updateQueue;if(S!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=o.child.stateNode;break;case 1:c=o.child.stateNode}Fv(o,S,c)}break;case 5:var d=o.stateNode;if(c===null&&o.flags&4){c=d;var U=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&c.focus();break;case"img":U.src&&(c.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var ee=o.alternate;if(ee!==null){var me=ee.memoizedState;if(me!==null){var X=me.dehydrated;X!==null&&$c(X)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}mn||o.flags&512&&lg(o)}catch(Z){_i(o,o.return,Z)}}if(o===i){it=null;break}if(c=o.sibling,c!==null){c.return=o.return,it=c;break}it=o.return}}function Qv(i){for(;it!==null;){var o=it;if(o===i){it=null;break}var c=o.sibling;if(c!==null){c.return=o.return,it=c;break}it=o.return}}function e0(i){for(;it!==null;){var o=it;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{wp(4,o)}catch(U){_i(o,c,U)}break;case 1:var y=o.stateNode;if(typeof y.componentDidMount=="function"){var x=o.return;try{y.componentDidMount()}catch(U){_i(o,x,U)}}var T=o.return;try{lg(o)}catch(U){_i(o,T,U)}break;case 5:var S=o.return;try{lg(o)}catch(U){_i(o,S,U)}}}catch(U){_i(o,o.return,U)}if(o===i){it=null;break}var d=o.sibling;if(d!==null){d.return=o.return,it=d;break}it=o.return}}var qS=Math.ceil,op=jo.ReactCurrentDispatcher,ty=jo.ReactCurrentOwner,kr=jo.ReactCurrentBatchConfig,Ft=0,Zi=null,Ei=null,Yi=0,or=0,$l=Vs(0),Di=0,eh=null,za=0,bp=0,iy=0,Fc=null,jn=null,ny=0,iu=1/0,Po=null,sp=!1,hg=null,Ls=null,kd=!1,Es=null,ap=0,Bc=0,dg=null,Bd=-1,jd=0;function kn(){return Ft&6?xi():Bd!==-1?Bd:Bd=xi()}function Rs(i){return i.mode&1?Ft&2&&Yi!==0?Yi&-Yi:CS.transition!==null?(jd===0&&(jd=Q0()),jd):(i=Gt,i!==0||(i=window.event,i=i===void 0?16:sx(i.type)),i):1}function Ur(i,o,c,y){if(50<Bc)throw Bc=0,dg=null,Error(Me(185));rh(i,c,y),(!(Ft&2)||i!==Zi)&&(i===Zi&&(!(Ft&2)&&(bp|=c),Di===4&&Is(i,Yi)),Un(i,y),c===1&&Ft===0&&!(o.mode&1)&&(iu=xi()+500,_p&&Us()))}function Un(i,o){var c=i.callbackNode;C2(i,o);var y=Zd(i,i===Zi?Yi:0);if(y===0)c!==null&&uv(c),i.callbackNode=null,i.callbackPriority=0;else if(o=y&-y,i.callbackPriority!==o){if(c!=null&&uv(c),o===1)i.tag===0?ES(t0.bind(null,i)):Ix(t0.bind(null,i)),SS(function(){!(Ft&6)&&Us()}),c=null;else{switch(ex(y)){case 1:c=Pg;break;case 4:c=J0;break;case 16:c=$d;break;case 536870912:c=Y0;break;default:c=$d}c=S1(c,g1.bind(null,i))}i.callbackPriority=o,i.callbackNode=c}}function g1(i,o){if(Bd=-1,jd=0,Ft&6)throw Error(Me(327));var c=i.callbackNode;if(Xl()&&i.callbackNode!==c)return null;var y=Zd(i,i===Zi?Yi:0);if(y===0)return null;if(y&30||y&i.expiredLanes||o)o=lp(i,y);else{o=y;var x=Ft;Ft|=2;var T=_1();(Zi!==i||Yi!==o)&&(Po=null,iu=xi()+500,ka(i,o));do try{WS();break}catch(d){y1(i,d)}while(!0);Ug(),op.current=T,Ft=x,Ei!==null?o=0:(Zi=null,Yi=0,o=Di)}if(o!==0){if(o===2&&(x=Om(i),x!==0&&(y=x,o=pg(i,x))),o===1)throw c=eh,ka(i,0),Is(i,y),Un(i,xi()),c;if(o===6)Is(i,y);else{if(x=i.current.alternate,!(y&30)&&!GS(x)&&(o=lp(i,y),o===2&&(T=Om(i),T!==0&&(y=T,o=pg(i,T))),o===1))throw c=eh,ka(i,0),Is(i,y),Un(i,xi()),c;switch(i.finishedWork=x,i.finishedLanes=y,o){case 0:case 1:throw Error(Me(345));case 2:wa(i,jn,Po);break;case 3:if(Is(i,y),(y&130023424)===y&&(o=ny+500-xi(),10<o)){if(Zd(i,0)!==0)break;if(x=i.suspendedLanes,(x&y)!==y){kn(),i.pingedLanes|=i.suspendedLanes&x;break}i.timeoutHandle=Hm(wa.bind(null,i,jn,Po),o);break}wa(i,jn,Po);break;case 4:if(Is(i,y),(y&4194240)===y)break;for(o=i.eventTimes,x=-1;0<y;){var S=31-Vr(y);T=1<<S,S=o[S],S>x&&(x=S),y&=~T}if(y=x,y=xi()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*qS(y/1960))-y,10<y){i.timeoutHandle=Hm(wa.bind(null,i,jn,Po),y);break}wa(i,jn,Po);break;case 5:wa(i,jn,Po);break;default:throw Error(Me(329))}}}return Un(i,xi()),i.callbackNode===c?g1.bind(null,i):null}function pg(i,o){var c=Fc;return i.current.memoizedState.isDehydrated&&(ka(i,o).flags|=256),i=lp(i,o),i!==2&&(o=jn,jn=c,o!==null&&fg(o)),i}function fg(i){jn===null?jn=i:jn.push.apply(jn,i)}function GS(i){for(var o=i;;){if(o.flags&16384){var c=o.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var y=0;y<c.length;y++){var x=c[y],T=x.getSnapshot;x=x.value;try{if(!$r(T(),x))return!1}catch{return!1}}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Is(i,o){for(o&=~iy,o&=~bp,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var c=31-Vr(o),y=1<<c;i[c]=-1,o&=~y}}function t0(i){if(Ft&6)throw Error(Me(327));Xl();var o=Zd(i,0);if(!(o&1))return Un(i,xi()),null;var c=lp(i,o);if(i.tag!==0&&c===2){var y=Om(i);y!==0&&(o=y,c=pg(i,y))}if(c===1)throw c=eh,ka(i,0),Is(i,o),Un(i,xi()),c;if(c===6)throw Error(Me(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,wa(i,jn,Po),Un(i,xi()),null}function ry(i,o){var c=Ft;Ft|=1;try{return i(o)}finally{Ft=c,Ft===0&&(iu=xi()+500,_p&&Us())}}function Aa(i){Es!==null&&Es.tag===0&&!(Ft&6)&&Xl();var o=Ft;Ft|=1;var c=kr.transition,y=Gt;try{if(kr.transition=null,Gt=1,i)return i()}finally{Gt=y,kr.transition=c,Ft=o,!(Ft&6)&&Us()}}function oy(){or=$l.current,ri($l)}function ka(i,o){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,bS(c)),Ei!==null)for(c=Ei.return;c!==null;){var y=c;switch(Og(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Xd();break;case 3:eu(),ri(Nn),ri(gn),Wg();break;case 5:Hg(y);break;case 4:eu();break;case 13:ri(di);break;case 19:ri(di);break;case 10:$g(y.type._context);break;case 22:case 23:oy()}c=c.return}if(Zi=i,Ei=i=Fs(i.current,null),Yi=or=o,Di=0,eh=null,iy=bp=za=0,jn=Fc=null,Ta!==null){for(o=0;o<Ta.length;o++)if(c=Ta[o],y=c.interleaved,y!==null){c.interleaved=null;var x=y.next,T=c.pending;if(T!==null){var S=T.next;T.next=x,y.next=S}c.pending=y}Ta=null}return i}function y1(i,o){do{var c=Ei;try{if(Ug(),Ld.current=rp,np){for(var y=pi.memoizedState;y!==null;){var x=y.queue;x!==null&&(x.pending=null),y=y.next}np=!1}if(Ma=0,$i=Ai=pi=null,Lc=!1,Jc=0,ty.current=null,c===null||c.return===null){Di=1,eh=o,Ei=null;break}e:{var T=i,S=c.return,d=c,U=o;if(o=Yi,d.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var ee=U,me=d,X=me.tag;if(!(me.mode&1)&&(X===0||X===11||X===15)){var Z=me.alternate;Z?(me.updateQueue=Z.updateQueue,me.memoizedState=Z.memoizedState,me.lanes=Z.lanes):(me.updateQueue=null,me.memoizedState=null)}var ke=Uv(S);if(ke!==null){ke.flags&=-257,$v(ke,S,d,T,o),ke.mode&1&&Vv(T,ee,o),o=ke,U=ee;var Ee=o.updateQueue;if(Ee===null){var Ie=new Set;Ie.add(U),o.updateQueue=Ie}else Ee.add(U);break e}else{if(!(o&1)){Vv(T,ee,o),sy();break e}U=Error(Me(426))}}else if(ui&&d.mode&1){var $e=Uv(S);if($e!==null){!($e.flags&65536)&&($e.flags|=256),$v($e,S,d,T,o),Ng(tu(U,d));break e}}T=U=tu(U,d),Di!==4&&(Di=2),Fc===null?Fc=[T]:Fc.push(T),T=S;do{switch(T.tag){case 3:T.flags|=65536,o&=-o,T.lanes|=o;var le=e1(T,U,o);Rv(T,le);break e;case 1:d=U;var ne=T.type,ue=T.stateNode;if(!(T.flags&128)&&(typeof ne.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(Ls===null||!Ls.has(ue)))){T.flags|=65536,o&=-o,T.lanes|=o;var Se=t1(T,d,o);Rv(T,Se);break e}}T=T.return}while(T!==null)}x1(c)}catch(je){o=je,Ei===c&&c!==null&&(Ei=c=c.return);continue}break}while(!0)}function _1(){var i=op.current;return op.current=rp,i===null?rp:i}function sy(){(Di===0||Di===3||Di===2)&&(Di=4),Zi===null||!(za&268435455)&&!(bp&268435455)||Is(Zi,Yi)}function lp(i,o){var c=Ft;Ft|=2;var y=_1();(Zi!==i||Yi!==o)&&(Po=null,ka(i,o));do try{HS();break}catch(x){y1(i,x)}while(!0);if(Ug(),Ft=c,op.current=y,Ei!==null)throw Error(Me(261));return Zi=null,Yi=0,Di}function HS(){for(;Ei!==null;)v1(Ei)}function WS(){for(;Ei!==null&&!v2();)v1(Ei)}function v1(i){var o=b1(i.alternate,i,or);i.memoizedProps=i.pendingProps,o===null?x1(i):Ei=o,ty.current=null}function x1(i){var o=i;do{var c=o.alternate;if(i=o.return,o.flags&32768){if(c=VS(c,o),c!==null){c.flags&=32767,Ei=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Di=6,Ei=null;return}}else if(c=NS(c,o,or),c!==null){Ei=c;return}if(o=o.sibling,o!==null){Ei=o;return}Ei=o=i}while(o!==null);Di===0&&(Di=5)}function wa(i,o,c){var y=Gt,x=kr.transition;try{kr.transition=null,Gt=1,XS(i,o,c,y)}finally{kr.transition=x,Gt=y}return null}function XS(i,o,c,y){do Xl();while(Es!==null);if(Ft&6)throw Error(Me(327));c=i.finishedWork;var x=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(Me(177));i.callbackNode=null,i.callbackPriority=0;var T=c.lanes|c.childLanes;if(P2(i,T),i===Zi&&(Ei=Zi=null,Yi=0),!(c.subtreeFlags&2064)&&!(c.flags&2064)||kd||(kd=!0,S1($d,function(){return Xl(),null})),T=(c.flags&15990)!==0,c.subtreeFlags&15990||T){T=kr.transition,kr.transition=null;var S=Gt;Gt=1;var d=Ft;Ft|=4,ty.current=null,$S(i,c),f1(c,i),mS(qm),qd=!!Zm,qm=Zm=null,i.current=c,ZS(c),x2(),Ft=d,Gt=S,kr.transition=T}else i.current=c;if(kd&&(kd=!1,Es=i,ap=x),T=i.pendingLanes,T===0&&(Ls=null),S2(c.stateNode),Un(i,xi()),o!==null)for(y=i.onRecoverableError,c=0;c<o.length;c++)x=o[c],y(x.value,{componentStack:x.stack,digest:x.digest});if(sp)throw sp=!1,i=hg,hg=null,i;return ap&1&&i.tag!==0&&Xl(),T=i.pendingLanes,T&1?i===dg?Bc++:(Bc=0,dg=i):Bc=0,Us(),null}function Xl(){if(Es!==null){var i=ex(ap),o=kr.transition,c=Gt;try{if(kr.transition=null,Gt=16>i?16:i,Es===null)var y=!1;else{if(i=Es,Es=null,ap=0,Ft&6)throw Error(Me(331));var x=Ft;for(Ft|=4,it=i.current;it!==null;){var T=it,S=T.child;if(it.flags&16){var d=T.deletions;if(d!==null){for(var U=0;U<d.length;U++){var ee=d[U];for(it=ee;it!==null;){var me=it;switch(me.tag){case 0:case 11:case 15:Rc(8,me,T)}var X=me.child;if(X!==null)X.return=me,it=X;else for(;it!==null;){me=it;var Z=me.sibling,ke=me.return;if(h1(me),me===ee){it=null;break}if(Z!==null){Z.return=ke,it=Z;break}it=ke}}}var Ee=T.alternate;if(Ee!==null){var Ie=Ee.child;if(Ie!==null){Ee.child=null;do{var $e=Ie.sibling;Ie.sibling=null,Ie=$e}while(Ie!==null)}}it=T}}if(T.subtreeFlags&2064&&S!==null)S.return=T,it=S;else e:for(;it!==null;){if(T=it,T.flags&2048)switch(T.tag){case 0:case 11:case 15:Rc(9,T,T.return)}var le=T.sibling;if(le!==null){le.return=T.return,it=le;break e}it=T.return}}var ne=i.current;for(it=ne;it!==null;){S=it;var ue=S.child;if(S.subtreeFlags&2064&&ue!==null)ue.return=S,it=ue;else e:for(S=ne;it!==null;){if(d=it,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:wp(9,d)}}catch(je){_i(d,d.return,je)}if(d===S){it=null;break e}var Se=d.sibling;if(Se!==null){Se.return=d.return,it=Se;break e}it=d.return}}if(Ft=x,Us(),so&&typeof so.onPostCommitFiberRoot=="function")try{so.onPostCommitFiberRoot(pp,i)}catch{}y=!0}return y}finally{Gt=c,kr.transition=o}}return!1}function i0(i,o,c){o=tu(c,o),o=e1(i,o,1),i=Ds(i,o,1),o=kn(),i!==null&&(rh(i,1,o),Un(i,o))}function _i(i,o,c){if(i.tag===3)i0(i,i,c);else for(;o!==null;){if(o.tag===3){i0(o,i,c);break}else if(o.tag===1){var y=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Ls===null||!Ls.has(y))){i=tu(c,i),i=t1(o,i,1),o=Ds(o,i,1),i=kn(),o!==null&&(rh(o,1,i),Un(o,i));break}}o=o.return}}function KS(i,o,c){var y=i.pingCache;y!==null&&y.delete(o),o=kn(),i.pingedLanes|=i.suspendedLanes&c,Zi===i&&(Yi&c)===c&&(Di===4||Di===3&&(Yi&130023424)===Yi&&500>xi()-ny?ka(i,0):iy|=c),Un(i,o)}function w1(i,o){o===0&&(i.mode&1?(o=gd,gd<<=1,!(gd&130023424)&&(gd=4194304)):o=1);var c=kn();i=Fo(i,o),i!==null&&(rh(i,o,c),Un(i,c))}function JS(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),w1(i,c)}function YS(i,o){var c=0;switch(i.tag){case 13:var y=i.stateNode,x=i.memoizedState;x!==null&&(c=x.retryLane);break;case 19:y=i.stateNode;break;default:throw Error(Me(314))}y!==null&&y.delete(o),w1(i,c)}var b1;b1=function(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps||Nn.current)On=!0;else{if(!(i.lanes&c)&&!(o.flags&128))return On=!1,OS(i,o,c);On=!!(i.flags&131072)}else On=!1,ui&&o.flags&1048576&&kx(o,Yd,o.index);switch(o.lanes=0,o.tag){case 2:var y=o.type;Fd(i,o),i=o.pendingProps;var x=Jl(o,gn.current);Wl(o,c),x=Kg(null,o,y,i,x,c);var T=Jg();return o.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Vn(y)?(T=!0,Kd(o)):T=!1,o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,qg(o),x.updater=xp,o.stateNode=x,x._reactInternals=o,eg(o,y,i,c),o=ng(null,o,y,!0,T,c)):(o.tag=0,ui&&T&&jg(o),In(null,o,x,c),o=o.child),o;case 16:y=o.elementType;e:{switch(Fd(i,o),i=o.pendingProps,x=y._init,y=x(y._payload),o.type=y,x=o.tag=eT(y),i=jr(y,i),x){case 0:o=ig(null,o,y,i,c);break e;case 1:o=Gv(null,o,y,i,c);break e;case 11:o=Zv(null,o,y,i,c);break e;case 14:o=qv(null,o,y,jr(y.type,i),c);break e}throw Error(Me(306,y,""))}return o;case 0:return y=o.type,x=o.pendingProps,x=o.elementType===y?x:jr(y,x),ig(i,o,y,x,c);case 1:return y=o.type,x=o.pendingProps,x=o.elementType===y?x:jr(y,x),Gv(i,o,y,x,c);case 3:e:{if(o1(o),i===null)throw Error(Me(387));y=o.pendingProps,T=o.memoizedState,x=T.element,Ax(i,o),tp(o,y,null,c);var S=o.memoizedState;if(y=S.element,T.isDehydrated)if(T={element:y,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},o.updateQueue.baseState=T,o.memoizedState=T,o.flags&256){x=tu(Error(Me(423)),o),o=Hv(i,o,y,c,x);break e}else if(y!==x){x=tu(Error(Me(424)),o),o=Hv(i,o,y,c,x);break e}else for(sr=As(o.stateNode.containerInfo.firstChild),ar=o,ui=!0,Nr=null,c=Mx(o,null,y,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Yl(),y===x){o=Bo(i,o,c);break e}In(i,o,y,c)}o=o.child}return o;case 5:return Dx(o),i===null&&Jm(o),y=o.type,x=o.pendingProps,T=i!==null?i.memoizedProps:null,S=x.children,Gm(y,x)?S=null:T!==null&&Gm(y,T)&&(o.flags|=32),r1(i,o),In(i,o,S,c),o.child;case 6:return i===null&&Jm(o),null;case 13:return s1(i,o,c);case 4:return Gg(o,o.stateNode.containerInfo),y=o.pendingProps,i===null?o.child=Ql(o,null,y,c):In(i,o,y,c),o.child;case 11:return y=o.type,x=o.pendingProps,x=o.elementType===y?x:jr(y,x),Zv(i,o,y,x,c);case 7:return In(i,o,o.pendingProps,c),o.child;case 8:return In(i,o,o.pendingProps.children,c),o.child;case 12:return In(i,o,o.pendingProps.children,c),o.child;case 10:e:{if(y=o.type._context,x=o.pendingProps,T=o.memoizedProps,S=x.value,Qt(Qd,y._currentValue),y._currentValue=S,T!==null)if($r(T.value,S)){if(T.children===x.children&&!Nn.current){o=Bo(i,o,c);break e}}else for(T=o.child,T!==null&&(T.return=o);T!==null;){var d=T.dependencies;if(d!==null){S=T.child;for(var U=d.firstContext;U!==null;){if(U.context===y){if(T.tag===1){U=Do(-1,c&-c),U.tag=2;var ee=T.updateQueue;if(ee!==null){ee=ee.shared;var me=ee.pending;me===null?U.next=U:(U.next=me.next,me.next=U),ee.pending=U}}T.lanes|=c,U=T.alternate,U!==null&&(U.lanes|=c),Ym(T.return,c,o),d.lanes|=c;break}U=U.next}}else if(T.tag===10)S=T.type===o.type?null:T.child;else if(T.tag===18){if(S=T.return,S===null)throw Error(Me(341));S.lanes|=c,d=S.alternate,d!==null&&(d.lanes|=c),Ym(S,c,o),S=T.sibling}else S=T.child;if(S!==null)S.return=T;else for(S=T;S!==null;){if(S===o){S=null;break}if(T=S.sibling,T!==null){T.return=S.return,S=T;break}S=S.return}T=S}In(i,o,x.children,c),o=o.child}return o;case 9:return x=o.type,y=o.pendingProps.children,Wl(o,c),x=Er(x),y=y(x),o.flags|=1,In(i,o,y,c),o.child;case 14:return y=o.type,x=jr(y,o.pendingProps),x=jr(y.type,x),qv(i,o,y,x,c);case 15:return i1(i,o,o.type,o.pendingProps,c);case 17:return y=o.type,x=o.pendingProps,x=o.elementType===y?x:jr(y,x),Fd(i,o),o.tag=1,Vn(y)?(i=!0,Kd(o)):i=!1,Wl(o,c),Qx(o,y,x),eg(o,y,x,c),ng(null,o,y,!0,i,c);case 19:return a1(i,o,c);case 22:return n1(i,o,c)}throw Error(Me(156,o.tag))};function S1(i,o){return K0(i,o)}function QS(i,o,c,y){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(i,o,c,y){return new QS(i,o,c,y)}function ay(i){return i=i.prototype,!(!i||!i.isReactComponent)}function eT(i){if(typeof i=="function")return ay(i)?1:0;if(i!=null){if(i=i.$$typeof,i===kg)return 11;if(i===Eg)return 14}return 2}function Fs(i,o){var c=i.alternate;return c===null?(c=Ir(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function Od(i,o,c,y,x,T){var S=2;if(y=i,typeof i=="function")ay(i)&&(S=1);else if(typeof i=="string")S=5;else e:switch(i){case Dl:return Ea(c.children,x,T,o);case Ig:S=8,x|=8;break;case Tm:return i=Ir(12,c,o,x|2),i.elementType=Tm,i.lanes=T,i;case Im:return i=Ir(13,c,o,x),i.elementType=Im,i.lanes=T,i;case km:return i=Ir(19,c,o,x),i.elementType=km,i.lanes=T,i;case D0:return Sp(c,x,T,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case z0:S=10;break e;case A0:S=9;break e;case kg:S=11;break e;case Eg:S=14;break e;case bs:S=16,y=null;break e}throw Error(Me(130,i==null?i:typeof i,""))}return o=Ir(S,c,o,x),o.elementType=i,o.type=y,o.lanes=T,o}function Ea(i,o,c,y){return i=Ir(7,i,y,o),i.lanes=c,i}function Sp(i,o,c,y){return i=Ir(22,i,y,o),i.elementType=D0,i.lanes=c,i.stateNode={isHidden:!1},i}function _m(i,o,c){return i=Ir(6,i,null,o),i.lanes=c,i}function vm(i,o,c){return o=Ir(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function tT(i,o,c,y,x){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qf(0),this.expirationTimes=Qf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qf(0),this.identifierPrefix=y,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function ly(i,o,c,y,x,T,S,d,U){return i=new tT(i,o,c,d,U),o===1?(o=1,T===!0&&(o|=8)):o=0,T=Ir(3,null,null,o),i.current=T,T.stateNode=i,T.memoizedState={element:y,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},qg(T),i}function iT(i,o,c){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Al,key:y==null?null:""+y,children:i,containerInfo:o,implementation:c}}function T1(i){if(!i)return Os;i=i._reactInternals;e:{if(La(i)!==i||i.tag!==1)throw Error(Me(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Vn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Me(171))}if(i.tag===1){var c=i.type;if(Vn(c))return Tx(i,c,o)}return o}function I1(i,o,c,y,x,T,S,d,U){return i=ly(c,y,!0,i,x,T,S,d,U),i.context=T1(null),c=i.current,y=kn(),x=Rs(c),T=Do(y,x),T.callback=o??null,Ds(c,T,x),i.current.lanes=x,rh(i,x,y),Un(i,y),i}function Tp(i,o,c,y){var x=o.current,T=kn(),S=Rs(x);return c=T1(c),o.context===null?o.context=c:o.pendingContext=c,o=Do(T,S),o.payload={element:i},y=y===void 0?null:y,y!==null&&(o.callback=y),i=Ds(x,o,S),i!==null&&(Ur(i,x,S,T),Dd(i,x,S)),S}function up(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function n0(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function uy(i,o){n0(i,o),(i=i.alternate)&&n0(i,o)}function nT(){return null}var k1=typeof reportError=="function"?reportError:function(i){console.error(i)};function cy(i){this._internalRoot=i}Ip.prototype.render=cy.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(Me(409));Tp(i,o,null,null)};Ip.prototype.unmount=cy.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Aa(function(){Tp(null,i,null,null)}),o[Ro]=null}};function Ip(i){this._internalRoot=i}Ip.prototype.unstable_scheduleHydration=function(i){if(i){var o=nx();i={blockedOn:null,target:i,priority:o};for(var c=0;c<Ts.length&&o!==0&&o<Ts[c].priority;c++);Ts.splice(c,0,i),c===0&&ox(i)}};function hy(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function kp(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function r0(){}function rT(i,o,c,y,x){if(x){if(typeof y=="function"){var T=y;y=function(){var ee=up(S);T.call(ee)}}var S=I1(o,y,i,0,null,!1,!1,"",r0);return i._reactRootContainer=S,i[Ro]=S.current,Gc(i.nodeType===8?i.parentNode:i),Aa(),S}for(;x=i.lastChild;)i.removeChild(x);if(typeof y=="function"){var d=y;y=function(){var ee=up(U);d.call(ee)}}var U=ly(i,0,!1,null,null,!1,!1,"",r0);return i._reactRootContainer=U,i[Ro]=U.current,Gc(i.nodeType===8?i.parentNode:i),Aa(function(){Tp(o,U,c,y)}),U}function Ep(i,o,c,y,x){var T=c._reactRootContainer;if(T){var S=T;if(typeof x=="function"){var d=x;x=function(){var U=up(S);d.call(U)}}Tp(o,S,i,x)}else S=rT(c,o,i,x,y);return up(S)}tx=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var c=Ec(o.pendingLanes);c!==0&&(Mg(o,c|1),Un(o,xi()),!(Ft&6)&&(iu=xi()+500,Us()))}break;case 13:Aa(function(){var y=Fo(i,1);if(y!==null){var x=kn();Ur(y,i,1,x)}}),uy(i,1)}};zg=function(i){if(i.tag===13){var o=Fo(i,134217728);if(o!==null){var c=kn();Ur(o,i,134217728,c)}uy(i,134217728)}};ix=function(i){if(i.tag===13){var o=Rs(i),c=Fo(i,o);if(c!==null){var y=kn();Ur(c,i,o,y)}uy(i,o)}};nx=function(){return Gt};rx=function(i,o){var c=Gt;try{return Gt=i,o()}finally{Gt=c}};Fm=function(i,o,c){switch(o){case"input":if(Pm(i,c),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var y=c[o];if(y!==i&&y.form===i.form){var x=yp(y);if(!x)throw Error(Me(90));R0(y),Pm(y,x)}}}break;case"textarea":B0(i,c);break;case"select":o=c.value,o!=null&&Zl(i,!!c.multiple,o,!1)}};Z0=ry;q0=Aa;var oT={usingClientEntryPoint:!1,Events:[sh,Bl,yp,U0,$0,ry]},Sc={findFiberByHostInstance:Sa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sT={bundleType:Sc.bundleType,version:Sc.version,rendererPackageName:Sc.rendererPackageName,rendererConfig:Sc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:jo.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=W0(i),i===null?null:i.stateNode},findFiberByHostInstance:Sc.findFiberByHostInstance||nT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ed=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ed.isDisabled&&Ed.supportsFiber)try{pp=Ed.inject(sT),so=Ed}catch{}}ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oT;ur.createPortal=function(i,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hy(o))throw Error(Me(200));return iT(i,o,null,c)};ur.createRoot=function(i,o){if(!hy(i))throw Error(Me(299));var c=!1,y="",x=k1;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),o=ly(i,1,!1,null,null,c,!1,y,x),i[Ro]=o.current,Gc(i.nodeType===8?i.parentNode:i),new cy(o)};ur.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(Me(188)):(i=Object.keys(i).join(","),Error(Me(268,i)));return i=W0(o),i=i===null?null:i.stateNode,i};ur.flushSync=function(i){return Aa(i)};ur.hydrate=function(i,o,c){if(!kp(o))throw Error(Me(200));return Ep(null,i,o,!0,c)};ur.hydrateRoot=function(i,o,c){if(!hy(i))throw Error(Me(405));var y=c!=null&&c.hydratedSources||null,x=!1,T="",S=k1;if(c!=null&&(c.unstable_strictMode===!0&&(x=!0),c.identifierPrefix!==void 0&&(T=c.identifierPrefix),c.onRecoverableError!==void 0&&(S=c.onRecoverableError)),o=I1(o,null,i,1,c??null,x,!1,T,S),i[Ro]=o.current,Gc(i),y)for(i=0;i<y.length;i++)c=y[i],x=c._getVersion,x=x(c._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[c,x]:o.mutableSourceEagerHydrationData.push(c,x);return new Ip(o)};ur.render=function(i,o,c){if(!kp(o))throw Error(Me(200));return Ep(null,i,o,!1,c)};ur.unmountComponentAtNode=function(i){if(!kp(i))throw Error(Me(40));return i._reactRootContainer?(Aa(function(){Ep(null,null,i,!1,function(){i._reactRootContainer=null,i[Ro]=null})}),!0):!1};ur.unstable_batchedUpdates=ry;ur.unstable_renderSubtreeIntoContainer=function(i,o,c,y){if(!kp(c))throw Error(Me(200));if(i==null||i._reactInternals===void 0)throw Error(Me(38));return Ep(i,o,c,!1,y)};ur.version="18.3.1-next-f1338f8080-20240426";function E1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E1)}catch(i){console.error(i)}}E1(),E0.exports=ur;var aT=E0.exports,o0=aT;bm.createRoot=o0.createRoot,bm.hydrateRoot=o0.hydrateRoot;/**
 * @remix-run/router v1.19.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function th(){return th=Object.assign?Object.assign.bind():function(i){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var y in c)Object.prototype.hasOwnProperty.call(c,y)&&(i[y]=c[y])}return i},th.apply(this,arguments)}var Cs;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Cs||(Cs={}));const s0="popstate";function lT(i){i===void 0&&(i={});function o(y,x){let{pathname:T,search:S,hash:d}=y.location;return mg("",{pathname:T,search:S,hash:d},x.state&&x.state.usr||null,x.state&&x.state.key||"default")}function c(y,x){return typeof x=="string"?x:cp(x)}return cT(o,c,null,i)}function Ci(i,o){if(i===!1||i===null||typeof i>"u")throw new Error(o)}function C1(i,o){if(!i){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function uT(){return Math.random().toString(36).substr(2,8)}function a0(i,o){return{usr:i.state,key:i.key,idx:o}}function mg(i,o,c,y){return c===void 0&&(c=null),th({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof o=="string"?au(o):o,{state:c,key:o&&o.key||y||uT()})}function cp(i){let{pathname:o="/",search:c="",hash:y=""}=i;return c&&c!=="?"&&(o+=c.charAt(0)==="?"?c:"?"+c),y&&y!=="#"&&(o+=y.charAt(0)==="#"?y:"#"+y),o}function au(i){let o={};if(i){let c=i.indexOf("#");c>=0&&(o.hash=i.substr(c),i=i.substr(0,c));let y=i.indexOf("?");y>=0&&(o.search=i.substr(y),i=i.substr(0,y)),i&&(o.pathname=i)}return o}function cT(i,o,c,y){y===void 0&&(y={});let{window:x=document.defaultView,v5Compat:T=!1}=y,S=x.history,d=Cs.Pop,U=null,ee=me();ee==null&&(ee=0,S.replaceState(th({},S.state,{idx:ee}),""));function me(){return(S.state||{idx:null}).idx}function X(){d=Cs.Pop;let $e=me(),le=$e==null?null:$e-ee;ee=$e,U&&U({action:d,location:Ie.location,delta:le})}function Z($e,le){d=Cs.Push;let ne=mg(Ie.location,$e,le);ee=me()+1;let ue=a0(ne,ee),Se=Ie.createHref(ne);try{S.pushState(ue,"",Se)}catch(je){if(je instanceof DOMException&&je.name==="DataCloneError")throw je;x.location.assign(Se)}T&&U&&U({action:d,location:Ie.location,delta:1})}function ke($e,le){d=Cs.Replace;let ne=mg(Ie.location,$e,le);ee=me();let ue=a0(ne,ee),Se=Ie.createHref(ne);S.replaceState(ue,"",Se),T&&U&&U({action:d,location:Ie.location,delta:0})}function Ee($e){let le=x.location.origin!=="null"?x.location.origin:x.location.href,ne=typeof $e=="string"?$e:cp($e);return ne=ne.replace(/ $/,"%20"),Ci(le,"No window.location.(origin|href) available to create URL for href: "+ne),new URL(ne,le)}let Ie={get action(){return d},get location(){return i(x,S)},listen($e){if(U)throw new Error("A history only accepts one active listener");return x.addEventListener(s0,X),U=$e,()=>{x.removeEventListener(s0,X),U=null}},createHref($e){return o(x,$e)},createURL:Ee,encodeLocation($e){let le=Ee($e);return{pathname:le.pathname,search:le.search,hash:le.hash}},push:Z,replace:ke,go($e){return S.go($e)}};return Ie}var l0;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(l0||(l0={}));function hT(i,o,c){return c===void 0&&(c="/"),dT(i,o,c,!1)}function dT(i,o,c,y){let x=typeof o=="string"?au(o):o,T=dy(x.pathname||"/",c);if(T==null)return null;let S=P1(i);pT(S);let d=null;for(let U=0;d==null&&U<S.length;++U){let ee=TT(T);d=bT(S[U],ee,y)}return d}function P1(i,o,c,y){o===void 0&&(o=[]),c===void 0&&(c=[]),y===void 0&&(y="");let x=(T,S,d)=>{let U={relativePath:d===void 0?T.path||"":d,caseSensitive:T.caseSensitive===!0,childrenIndex:S,route:T};U.relativePath.startsWith("/")&&(Ci(U.relativePath.startsWith(y),'Absolute route path "'+U.relativePath+'" nested under path '+('"'+y+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),U.relativePath=U.relativePath.slice(y.length));let ee=Bs([y,U.relativePath]),me=c.concat(U);T.children&&T.children.length>0&&(Ci(T.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+ee+'".')),P1(T.children,o,me,ee)),!(T.path==null&&!T.index)&&o.push({path:ee,score:xT(ee,T.index),routesMeta:me})};return i.forEach((T,S)=>{var d;if(T.path===""||!((d=T.path)!=null&&d.includes("?")))x(T,S);else for(let U of M1(T.path))x(T,S,U)}),o}function M1(i){let o=i.split("/");if(o.length===0)return[];let[c,...y]=o,x=c.endsWith("?"),T=c.replace(/\?$/,"");if(y.length===0)return x?[T,""]:[T];let S=M1(y.join("/")),d=[];return d.push(...S.map(U=>U===""?T:[T,U].join("/"))),x&&d.push(...S),d.map(U=>i.startsWith("/")&&U===""?"/":U)}function pT(i){i.sort((o,c)=>o.score!==c.score?c.score-o.score:wT(o.routesMeta.map(y=>y.childrenIndex),c.routesMeta.map(y=>y.childrenIndex)))}const fT=/^:[\w-]+$/,mT=3,gT=2,yT=1,_T=10,vT=-2,u0=i=>i==="*";function xT(i,o){let c=i.split("/"),y=c.length;return c.some(u0)&&(y+=vT),o&&(y+=gT),c.filter(x=>!u0(x)).reduce((x,T)=>x+(fT.test(T)?mT:T===""?yT:_T),y)}function wT(i,o){return i.length===o.length&&i.slice(0,-1).every((y,x)=>y===o[x])?i[i.length-1]-o[o.length-1]:0}function bT(i,o,c){let{routesMeta:y}=i,x={},T="/",S=[];for(let d=0;d<y.length;++d){let U=y[d],ee=d===y.length-1,me=T==="/"?o:o.slice(T.length)||"/",X=c0({path:U.relativePath,caseSensitive:U.caseSensitive,end:ee},me),Z=U.route;if(!X&&ee&&c&&!y[y.length-1].route.index&&(X=c0({path:U.relativePath,caseSensitive:U.caseSensitive,end:!1},me)),!X)return null;Object.assign(x,X.params),S.push({params:x,pathname:Bs([T,X.pathname]),pathnameBase:CT(Bs([T,X.pathnameBase])),route:Z}),X.pathnameBase!=="/"&&(T=Bs([T,X.pathnameBase]))}return S}function c0(i,o){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[c,y]=ST(i.path,i.caseSensitive,i.end),x=o.match(c);if(!x)return null;let T=x[0],S=T.replace(/(.)\/+$/,"$1"),d=x.slice(1);return{params:y.reduce((ee,me,X)=>{let{paramName:Z,isOptional:ke}=me;if(Z==="*"){let Ie=d[X]||"";S=T.slice(0,T.length-Ie.length).replace(/(.)\/+$/,"$1")}const Ee=d[X];return ke&&!Ee?ee[Z]=void 0:ee[Z]=(Ee||"").replace(/%2F/g,"/"),ee},{}),pathname:T,pathnameBase:S,pattern:i}}function ST(i,o,c){o===void 0&&(o=!1),c===void 0&&(c=!0),C1(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let y=[],x="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(S,d,U)=>(y.push({paramName:d,isOptional:U!=null}),U?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(y.push({paramName:"*"}),x+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):c?x+="\\/*$":i!==""&&i!=="/"&&(x+="(?:(?=\\/|$))"),[new RegExp(x,o?void 0:"i"),y]}function TT(i){try{return i.split("/").map(o=>decodeURIComponent(o).replace(/\//g,"%2F")).join("/")}catch(o){return C1(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),i}}function dy(i,o){if(o==="/")return i;if(!i.toLowerCase().startsWith(o.toLowerCase()))return null;let c=o.endsWith("/")?o.length-1:o.length,y=i.charAt(c);return y&&y!=="/"?null:i.slice(c)||"/"}function IT(i,o){o===void 0&&(o="/");let{pathname:c,search:y="",hash:x=""}=typeof i=="string"?au(i):i;return{pathname:c?c.startsWith("/")?c:kT(c,o):o,search:PT(y),hash:MT(x)}}function kT(i,o){let c=o.replace(/\/+$/,"").split("/");return i.split("/").forEach(x=>{x===".."?c.length>1&&c.pop():x!=="."&&c.push(x)}),c.length>1?c.join("/"):"/"}function xm(i,o,c,y){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(y)+"].  Please separate it out to the ")+("`to."+c+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ET(i){return i.filter((o,c)=>c===0||o.route.path&&o.route.path.length>0)}function z1(i,o){let c=ET(i);return o?c.map((y,x)=>x===c.length-1?y.pathname:y.pathnameBase):c.map(y=>y.pathnameBase)}function A1(i,o,c,y){y===void 0&&(y=!1);let x;typeof i=="string"?x=au(i):(x=th({},i),Ci(!x.pathname||!x.pathname.includes("?"),xm("?","pathname","search",x)),Ci(!x.pathname||!x.pathname.includes("#"),xm("#","pathname","hash",x)),Ci(!x.search||!x.search.includes("#"),xm("#","search","hash",x)));let T=i===""||x.pathname==="",S=T?"/":x.pathname,d;if(S==null)d=c;else{let X=o.length-1;if(!y&&S.startsWith("..")){let Z=S.split("/");for(;Z[0]==="..";)Z.shift(),X-=1;x.pathname=Z.join("/")}d=X>=0?o[X]:"/"}let U=IT(x,d),ee=S&&S!=="/"&&S.endsWith("/"),me=(T||S===".")&&c.endsWith("/");return!U.pathname.endsWith("/")&&(ee||me)&&(U.pathname+="/"),U}const Bs=i=>i.join("/").replace(/\/\/+/g,"/"),CT=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),PT=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,MT=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function zT(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const D1=["post","put","patch","delete"];new Set(D1);const AT=["get",...D1];new Set(AT);/**
 * React Router v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ih(){return ih=Object.assign?Object.assign.bind():function(i){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var y in c)Object.prototype.hasOwnProperty.call(c,y)&&(i[y]=c[y])}return i},ih.apply(this,arguments)}const py=nt.createContext(null),DT=nt.createContext(null),Ra=nt.createContext(null),Cp=nt.createContext(null),Fa=nt.createContext({outlet:null,matches:[],isDataRoute:!1}),L1=nt.createContext(null);function LT(i,o){let{relative:c}=o===void 0?{}:o;lh()||Ci(!1);let{basename:y,navigator:x}=nt.useContext(Ra),{hash:T,pathname:S,search:d}=F1(i,{relative:c}),U=S;return y!=="/"&&(U=S==="/"?y:Bs([y,S])),x.createHref({pathname:U,search:d,hash:T})}function lh(){return nt.useContext(Cp)!=null}function Pp(){return lh()||Ci(!1),nt.useContext(Cp).location}function R1(i){nt.useContext(Ra).static||nt.useLayoutEffect(i)}function RT(){let{isDataRoute:i}=nt.useContext(Fa);return i?WT():FT()}function FT(){lh()||Ci(!1);let i=nt.useContext(py),{basename:o,future:c,navigator:y}=nt.useContext(Ra),{matches:x}=nt.useContext(Fa),{pathname:T}=Pp(),S=JSON.stringify(z1(x,c.v7_relativeSplatPath)),d=nt.useRef(!1);return R1(()=>{d.current=!0}),nt.useCallback(function(ee,me){if(me===void 0&&(me={}),!d.current)return;if(typeof ee=="number"){y.go(ee);return}let X=A1(ee,JSON.parse(S),T,me.relative==="path");i==null&&o!=="/"&&(X.pathname=X.pathname==="/"?o:Bs([o,X.pathname])),(me.replace?y.replace:y.push)(X,me.state,me)},[o,y,S,T,i])}function F1(i,o){let{relative:c}=o===void 0?{}:o,{future:y}=nt.useContext(Ra),{matches:x}=nt.useContext(Fa),{pathname:T}=Pp(),S=JSON.stringify(z1(x,y.v7_relativeSplatPath));return nt.useMemo(()=>A1(i,JSON.parse(S),T,c==="path"),[i,S,T,c])}function BT(i,o){return jT(i,o)}function jT(i,o,c,y){lh()||Ci(!1);let{navigator:x}=nt.useContext(Ra),{matches:T}=nt.useContext(Fa),S=T[T.length-1],d=S?S.params:{};S&&S.pathname;let U=S?S.pathnameBase:"/";S&&S.route;let ee=Pp(),me;if(o){var X;let $e=typeof o=="string"?au(o):o;U==="/"||(X=$e.pathname)!=null&&X.startsWith(U)||Ci(!1),me=$e}else me=ee;let Z=me.pathname||"/",ke=Z;if(U!=="/"){let $e=U.replace(/^\//,"").split("/");ke="/"+Z.replace(/^\//,"").split("/").slice($e.length).join("/")}let Ee=hT(i,{pathname:ke}),Ie=$T(Ee&&Ee.map($e=>Object.assign({},$e,{params:Object.assign({},d,$e.params),pathname:Bs([U,x.encodeLocation?x.encodeLocation($e.pathname).pathname:$e.pathname]),pathnameBase:$e.pathnameBase==="/"?U:Bs([U,x.encodeLocation?x.encodeLocation($e.pathnameBase).pathname:$e.pathnameBase])})),T,c,y);return o&&Ie?nt.createElement(Cp.Provider,{value:{location:ih({pathname:"/",search:"",hash:"",state:null,key:"default"},me),navigationType:Cs.Pop}},Ie):Ie}function OT(){let i=HT(),o=zT(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),c=i instanceof Error?i.stack:null,x={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return nt.createElement(nt.Fragment,null,nt.createElement("h2",null,"Unexpected Application Error!"),nt.createElement("h3",{style:{fontStyle:"italic"}},o),c?nt.createElement("pre",{style:x},c):null,null)}const NT=nt.createElement(OT,null);class VT extends nt.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,c){return c.location!==o.location||c.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error!==void 0?o.error:c.error,location:c.location,revalidation:o.revalidation||c.revalidation}}componentDidCatch(o,c){console.error("React Router caught the following error during render",o,c)}render(){return this.state.error!==void 0?nt.createElement(Fa.Provider,{value:this.props.routeContext},nt.createElement(L1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function UT(i){let{routeContext:o,match:c,children:y}=i,x=nt.useContext(py);return x&&x.static&&x.staticContext&&(c.route.errorElement||c.route.ErrorBoundary)&&(x.staticContext._deepestRenderedBoundaryId=c.route.id),nt.createElement(Fa.Provider,{value:o},y)}function $T(i,o,c,y){var x;if(o===void 0&&(o=[]),c===void 0&&(c=null),y===void 0&&(y=null),i==null){var T;if(!c)return null;if(c.errors)i=c.matches;else if((T=y)!=null&&T.v7_partialHydration&&o.length===0&&!c.initialized&&c.matches.length>0)i=c.matches;else return null}let S=i,d=(x=c)==null?void 0:x.errors;if(d!=null){let me=S.findIndex(X=>X.route.id&&(d==null?void 0:d[X.route.id])!==void 0);me>=0||Ci(!1),S=S.slice(0,Math.min(S.length,me+1))}let U=!1,ee=-1;if(c&&y&&y.v7_partialHydration)for(let me=0;me<S.length;me++){let X=S[me];if((X.route.HydrateFallback||X.route.hydrateFallbackElement)&&(ee=me),X.route.id){let{loaderData:Z,errors:ke}=c,Ee=X.route.loader&&Z[X.route.id]===void 0&&(!ke||ke[X.route.id]===void 0);if(X.route.lazy||Ee){U=!0,ee>=0?S=S.slice(0,ee+1):S=[S[0]];break}}}return S.reduceRight((me,X,Z)=>{let ke,Ee=!1,Ie=null,$e=null;c&&(ke=d&&X.route.id?d[X.route.id]:void 0,Ie=X.route.errorElement||NT,U&&(ee<0&&Z===0?(Ee=!0,$e=null):ee===Z&&(Ee=!0,$e=X.route.hydrateFallbackElement||null)));let le=o.concat(S.slice(0,Z+1)),ne=()=>{let ue;return ke?ue=Ie:Ee?ue=$e:X.route.Component?ue=nt.createElement(X.route.Component,null):X.route.element?ue=X.route.element:ue=me,nt.createElement(UT,{match:X,routeContext:{outlet:me,matches:le,isDataRoute:c!=null},children:ue})};return c&&(X.route.ErrorBoundary||X.route.errorElement||Z===0)?nt.createElement(VT,{location:c.location,revalidation:c.revalidation,component:Ie,error:ke,children:ne(),routeContext:{outlet:null,matches:le,isDataRoute:!0}}):ne()},null)}var B1=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(B1||{}),hp=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(hp||{});function ZT(i){let o=nt.useContext(py);return o||Ci(!1),o}function qT(i){let o=nt.useContext(DT);return o||Ci(!1),o}function GT(i){let o=nt.useContext(Fa);return o||Ci(!1),o}function j1(i){let o=GT(),c=o.matches[o.matches.length-1];return c.route.id||Ci(!1),c.route.id}function HT(){var i;let o=nt.useContext(L1),c=qT(hp.UseRouteError),y=j1(hp.UseRouteError);return o!==void 0?o:(i=c.errors)==null?void 0:i[y]}function WT(){let{router:i}=ZT(B1.UseNavigateStable),o=j1(hp.UseNavigateStable),c=nt.useRef(!1);return R1(()=>{c.current=!0}),nt.useCallback(function(x,T){T===void 0&&(T={}),c.current&&(typeof x=="number"?i.navigate(x):i.navigate(x,ih({fromRouteId:o},T)))},[i,o])}function ba(i){Ci(!1)}function XT(i){let{basename:o="/",children:c=null,location:y,navigationType:x=Cs.Pop,navigator:T,static:S=!1,future:d}=i;lh()&&Ci(!1);let U=o.replace(/^\/*/,"/"),ee=nt.useMemo(()=>({basename:U,navigator:T,static:S,future:ih({v7_relativeSplatPath:!1},d)}),[U,d,T,S]);typeof y=="string"&&(y=au(y));let{pathname:me="/",search:X="",hash:Z="",state:ke=null,key:Ee="default"}=y,Ie=nt.useMemo(()=>{let $e=dy(me,U);return $e==null?null:{location:{pathname:$e,search:X,hash:Z,state:ke,key:Ee},navigationType:x}},[U,me,X,Z,ke,Ee,x]);return Ie==null?null:nt.createElement(Ra.Provider,{value:ee},nt.createElement(Cp.Provider,{children:c,value:Ie}))}function KT(i){let{children:o,location:c}=i;return BT(gg(o),c)}new Promise(()=>{});function gg(i,o){o===void 0&&(o=[]);let c=[];return nt.Children.forEach(i,(y,x)=>{if(!nt.isValidElement(y))return;let T=[...o,x];if(y.type===nt.Fragment){c.push.apply(c,gg(y.props.children,T));return}y.type!==ba&&Ci(!1),!y.props.index||!y.props.children||Ci(!1);let S={id:y.props.id||T.join("-"),caseSensitive:y.props.caseSensitive,element:y.props.element,Component:y.props.Component,index:y.props.index,path:y.props.path,loader:y.props.loader,action:y.props.action,errorElement:y.props.errorElement,ErrorBoundary:y.props.ErrorBoundary,hasErrorBoundary:y.props.ErrorBoundary!=null||y.props.errorElement!=null,shouldRevalidate:y.props.shouldRevalidate,handle:y.props.handle,lazy:y.props.lazy};y.props.children&&(S.children=gg(y.props.children,T)),c.push(S)}),c}/**
 * React Router DOM v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yg(){return yg=Object.assign?Object.assign.bind():function(i){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var y in c)Object.prototype.hasOwnProperty.call(c,y)&&(i[y]=c[y])}return i},yg.apply(this,arguments)}function JT(i,o){if(i==null)return{};var c={},y=Object.keys(i),x,T;for(T=0;T<y.length;T++)x=y[T],!(o.indexOf(x)>=0)&&(c[x]=i[x]);return c}function YT(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function QT(i,o){return i.button===0&&(!o||o==="_self")&&!YT(i)}const eI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],tI="6";try{window.__reactRouterVersion=tI}catch{}const iI="startTransition",h0=Kb[iI];function nI(i){let{basename:o,children:c,future:y,window:x}=i,T=nt.useRef();T.current==null&&(T.current=lT({window:x,v5Compat:!0}));let S=T.current,[d,U]=nt.useState({action:S.action,location:S.location}),{v7_startTransition:ee}=y||{},me=nt.useCallback(X=>{ee&&h0?h0(()=>U(X)):U(X)},[U,ee]);return nt.useLayoutEffect(()=>S.listen(me),[S,me]),nt.createElement(XT,{basename:o,children:c,location:d.location,navigationType:d.action,navigator:S,future:y})}const rI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",oI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wm=nt.forwardRef(function(o,c){let{onClick:y,relative:x,reloadDocument:T,replace:S,state:d,target:U,to:ee,preventScrollReset:me,unstable_viewTransition:X}=o,Z=JT(o,eI),{basename:ke}=nt.useContext(Ra),Ee,Ie=!1;if(typeof ee=="string"&&oI.test(ee)&&(Ee=ee,rI))try{let ue=new URL(window.location.href),Se=ee.startsWith("//")?new URL(ue.protocol+ee):new URL(ee),je=dy(Se.pathname,ke);Se.origin===ue.origin&&je!=null?ee=je+Se.search+Se.hash:Ie=!0}catch{}let $e=LT(ee,{relative:x}),le=sI(ee,{replace:S,state:d,target:U,preventScrollReset:me,relative:x,unstable_viewTransition:X});function ne(ue){y&&y(ue),ue.defaultPrevented||le(ue)}return nt.createElement("a",yg({},Z,{href:Ee||$e,onClick:Ie||T?y:ne,ref:c,target:U}))});var d0;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(d0||(d0={}));var p0;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(p0||(p0={}));function sI(i,o){let{target:c,replace:y,state:x,preventScrollReset:T,relative:S,unstable_viewTransition:d}=o===void 0?{}:o,U=RT(),ee=Pp(),me=F1(i,{relative:S});return nt.useCallback(X=>{if(QT(X,c)){X.preventDefault();let Z=y!==void 0?y:cp(ee)===cp(me);U(i,{replace:Z,state:x,preventScrollReset:T,relative:S,unstable_viewTransition:d})}},[ee,U,me,y,x,c,i,T,S,d])}function Mp(){function i(o){const c=document.getElementById("header").getElementsByClassName("button");for(let y of c)y.innerText===o?y.classList.add("active"):y.classList.remove("active")}return ru.useEffect(function(){const o=localStorage.getItem("active_page");o&&i(o)},[]),B.jsxs("div",{id:"header",children:[B.jsxs("div",{children:[B.jsx("div",{children:""}),B.jsx("div",{children:"SEEDs"})]}),B.jsxs("div",{children:[B.jsx(wm,{to:"/home",children:B.jsx("div",{className:"button",onClick:function(){i("Home")},children:"Home"})}),B.jsx(wm,{to:"/about",children:B.jsx("div",{className:"button",onClick:function(){i("About")},children:"About"})}),B.jsx(wm,{to:"/login",children:B.jsx("div",{className:"button",onClick:function(){i("Log In")},children:"Log In"})})]})]})}function zp(){return B.jsxs("div",{id:"footer",children:[B.jsx("div",{children:"SEEDs  2024"}),B.jsx("div",{children:""}),B.jsx("div",{children:B.jsx("a",{href:"https://github.com/geospectrum-ph/seeds",target:"_blank",children:"Documentation"})}),B.jsx("div",{children:""}),B.jsx("div",{children:B.jsx("a",{children:"Terms of Use"})}),B.jsx("div",{children:""}),B.jsx("div",{children:B.jsx("a",{children:"Privacy Policy"})}),B.jsx("div",{children:""}),B.jsx("div",{children:B.jsx("a",{href:"https://geospectrum.com.ph",target:"_blank",children:"GEOSPECTRUM"})})]})}function f0(){return localStorage.setItem("active_page","Landing"),B.jsxs("div",{id:"landing",className:"page",children:[B.jsx(Mp,{}),B.jsx("div",{className:"body",children:B.jsxs("div",{children:[B.jsx("div",{children:"Welcome to"}),B.jsx("div",{children:"SEEDs"})]})}),B.jsx(zp,{})]})}function aI(){return localStorage.setItem("active_page","Log In"),B.jsxs("div",{id:"login",className:"page",children:[B.jsx(Mp,{}),B.jsx("div",{className:"body",children:B.jsx("div",{children:B.jsx("div",{children:"Log In!"})})}),B.jsx(zp,{})]})}var O1={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.0/LICENSE.txt
 */(function(i,o){(function(c,y){i.exports=y()})(Lb,function(){var c={},y={};function x(S,d,U){if(y[S]=U,S==="index"){var ee="var sharedModule = {}; ("+y.shared+")(sharedModule); ("+y.worker+")(sharedModule);",me={};return y.shared(me),y.index(c,me),typeof window<"u"&&c.setWorkerUrl(window.URL.createObjectURL(new Blob([ee],{type:"text/javascript"}))),c}}x("shared",["exports"],function(S){function d(n,t,r,a){return new(r||(r=Promise))(function(h,m){function g(k){try{w(a.next(k))}catch(E){m(E)}}function _(k){try{w(a.throw(k))}catch(E){m(E)}}function w(k){var E;k.done?h(k.value):(E=k.value,E instanceof r?E:new r(function(P){P(E)})).then(g,_)}w((a=a.apply(n,t||[])).next())})}function U(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}typeof SuppressedError=="function"&&SuppressedError;var ee=me;function me(n,t){this.x=n,this.y=t}me.prototype={clone:function(){return new me(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,t){return this.clone()._rotateAround(n,t)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var t=n.x-this.x,r=n.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,t){return Math.atan2(this.x*t-this.y*n,this.x*n+this.y*t)},_matMult:function(n){var t=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=t,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var t=Math.cos(n),r=Math.sin(n),a=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=a,this},_rotateAround:function(n,t){var r=Math.cos(n),a=Math.sin(n),h=t.y+a*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-a*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},me.convert=function(n){return n instanceof me?n:Array.isArray(n)?new me(n[0],n[1]):n};var X=U(ee),Z=ke;function ke(n,t,r,a){this.cx=3*n,this.bx=3*(r-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(a-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=t,this.p2x=r,this.p2y=a}ke.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,t){if(t===void 0&&(t=1e-6),n<0)return 0;if(n>1)return 1;for(var r=n,a=0;a<8;a++){var h=this.sampleCurveX(r)-n;if(Math.abs(h)<t)return r;var m=this.sampleCurveDerivativeX(r);if(Math.abs(m)<1e-6)break;r-=h/m}var g=0,_=1;for(r=n,a=0;a<20&&(h=this.sampleCurveX(r),!(Math.abs(h-n)<t));a++)n>h?g=r:_=r,r=.5*(_-g)+g;return r},solve:function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))}};var Ee=U(Z);let Ie,$e;function le(){return Ie==null&&(Ie=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ie}function ne(){if($e==null&&($e=!1,le())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let a=0;a<5*5;a++){const h=4*a;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(a%5,Math.floor(a/5),1,1)}const r=t.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&r[a]!==a){$e=!0;break}}}return $e||!1}function ue(n,t,r,a){const h=new Ee(n,t,r,a);return m=>h.solve(m)}const Se=ue(.25,.1,.25,1);function je(n,t,r){return Math.min(r,Math.max(t,n))}function Je(n,t,r){const a=r-t,h=((n-t)%a+a)%a+t;return h===t?r:h}function He(n,...t){for(const r of t)for(const a in r)n[a]=r[a];return n}let ot=1;function Lt(n,t,r){const a={};for(const h in n)a[h]=t.call(this,n[h],h,n);return a}function vt(n,t,r){const a={};for(const h in n)t.call(this,n[h],h,n)&&(a[h]=n[h]);return a}function xt(n){return Array.isArray(n)?n.map(xt):typeof n=="object"&&n?Lt(n,xt):n}const hr={};function oi(n){hr[n]||(typeof console<"u"&&console.warn(n),hr[n]=!0)}function wi(n,t,r){return(r.y-n.y)*(t.x-n.x)>(t.y-n.y)*(r.x-n.x)}function $n(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let dr=null;function en(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function dt(n,t,r,a,h){return d(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(n,{timestamp:0});try{const g=m==null?void 0:m.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const _=g.startsWith("BGR"),w=new Uint8ClampedArray(a*h*4);if(yield m.copyTo(w,function(k,E,P,A,R){const j=4*Math.max(-E,0),O=(Math.max(0,P)-P)*A*4+j,G=4*A,J=Math.max(0,E),pe=Math.max(0,P);return{rect:{x:J,y:pe,width:Math.min(k.width,E+A)-J,height:Math.min(k.height,P+R)-pe},layout:[{offset:O,stride:G}]}}(n,t,r,a,h)),_)for(let k=0;k<w.length;k+=4){const E=w[k];w[k]=w[k+2],w[k+2]=E}return w}finally{m.close()}})}let pt,kt;const Bt="AbortError";function Zn(){return new Error(Bt)}const Li={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function tn(n){return Li.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const nn="global-dispatcher";class bi extends Error{constructor(t,r,a,h){super(`AJAXError: ${r} (${t}): ${a}`),this.status=t,this.statusText=r,this.url=a,this.body=h}}const qn=()=>$n(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,lo=function(n,t){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const a=tn(n.url);if(a)return a(n,t);if($n(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:nn},t)}if(!(/^file:/.test(r=n.url)||/^file:/.test(qn())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(a,h){return d(this,void 0,void 0,function*(){const m=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:qn(),signal:h.signal});a.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");const g=yield fetch(m);if(!g.ok){const k=yield g.blob();throw new bi(g.status,g.statusText,a.url,k)}let _;_=a.type==="arrayBuffer"||a.type==="image"?g.arrayBuffer():a.type==="json"?g.json():g.text();const w=yield _;if(h.signal.aborted)throw Zn();return{data:w,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}})}(n,t);if($n(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:nn},t)}var r;return function(a,h){return new Promise((m,g)=>{var _;const w=new XMLHttpRequest;w.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(w.responseType="arraybuffer");for(const k in a.headers)w.setRequestHeader(k,a.headers[k]);a.type==="json"&&(w.responseType="text",!((_=a.headers)===null||_===void 0)&&_.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=a.credentials==="include",w.onerror=()=>{g(new Error(w.statusText))},w.onload=()=>{if(!h.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let k=w.response;if(a.type==="json")try{k=JSON.parse(w.response)}catch(E){return void g(E)}m({data:k,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{const k=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});g(new bi(w.status,w.statusText,a.url,k))}},h.signal.addEventListener("abort",()=>{w.abort(),g(Zn())}),w.send(a.body)})}(n,t)};function uo(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const t=new URL(n),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function $s(n,t,r){r[n]&&r[n].indexOf(t)!==-1||(r[n]=r[n]||[],r[n].push(t))}function Pr(n,t,r){if(r&&r[n]){const a=r[n].indexOf(t);a!==-1&&r[n].splice(a,1)}}class Zr{constructor(t,r={}){He(this,r),this.type=t}}class qr extends Zr{constructor(t,r={}){super("error",He({error:t},r))}}class Oo{on(t,r){return this._listeners=this._listeners||{},$s(t,r,this._listeners),this}off(t,r){return Pr(t,r,this._listeners),Pr(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},$s(t,r,this._oneTimeListeners),this):new Promise(a=>this.once(t,a))}fire(t,r){typeof t=="string"&&(t=new Zr(t,r||{}));const a=t.type;if(this.listens(a)){t.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const _ of h)_.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const _ of m)Pr(a,_,this._oneTimeListeners),_.call(this,t);const g=this._eventedParent;g&&(He(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof qr&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const co=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Zs(n,t){const r={};for(const a in n)a!=="ref"&&(r[a]=n[a]);return co.forEach(a=>{a in t&&(r[a]=t[a])}),r}function At(n,t){if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(let r=0;r<n.length;r++)if(!At(n[r],t[r]))return!1;return!0}if(typeof n=="object"&&n!==null&&t!==null){if(typeof t!="object"||Object.keys(n).length!==Object.keys(t).length)return!1;for(const r in n)if(!At(n[r],t[r]))return!1;return!0}return n===t}function ei(n,t){n.push(t)}function qs(n,t,r){ei(r,{command:"addSource",args:[n,t[n]]})}function Gr(n,t,r){ei(t,{command:"removeSource",args:[n]}),r[n]=!0}function Mr(n,t,r,a){Gr(n,r,a),qs(n,t,r)}function No(n,t,r){let a;for(a in n[r])if(Object.prototype.hasOwnProperty.call(n[r],a)&&a!=="data"&&!At(n[r][a],t[r][a]))return!1;for(a in t[r])if(Object.prototype.hasOwnProperty.call(t[r],a)&&a!=="data"&&!At(n[r][a],t[r][a]))return!1;return!0}function Pn(n,t,r,a,h,m){n=n||{},t=t||{};for(const g in n)Object.prototype.hasOwnProperty.call(n,g)&&(At(n[g],t[g])||r.push({command:m,args:[a,g,t[g],h]}));for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!Object.prototype.hasOwnProperty.call(n,g)&&(At(n[g],t[g])||r.push({command:m,args:[a,g,t[g],h]}))}function Gs(n){return n.id}function Hs(n,t){return n[t.id]=t,n}class Pe{constructor(t,r,a,h){this.message=(t?`${t}: `:"")+a,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function pr(n,...t){for(const r of t)for(const a in r)n[a]=r[a];return n}class qi extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class fr{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[a,h]of r)this.bindings[a]=h}concat(t){return new fr(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Hr={kind:"null"},Le={kind:"number"},yt={kind:"string"},lt={kind:"boolean"},rn={kind:"color"},Gn={kind:"object"},ft={kind:"value"},mr={kind:"collator"},zr={kind:"formatted"},Wr={kind:"padding"},gr={kind:"resolvedImage"},K={kind:"variableAnchorOffsetCollection"};function L(n,t){return{kind:"array",itemType:n,N:t}}function D(n){if(n.kind==="array"){const t=D(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const V=[Hr,Le,yt,lt,rn,zr,Gn,L(ft),Wr,gr,K];function H(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!H(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const r of V)if(!H(r,t))return null}}return`Expected ${D(n)} but found ${D(t)} instead.`}function oe(n,t){return t.some(r=>r.kind===n.kind)}function ae(n,t){return t.some(r=>r==="null"?n===null:r==="array"?Array.isArray(n):r==="object"?n&&!Array.isArray(n)&&typeof n=="object":r===typeof n)}function de(n,t){return n.kind==="array"&&t.kind==="array"?n.itemType.kind===t.itemType.kind&&typeof n.N=="number":n.kind===t.kind}const te=.96422,ve=.82521,be=4/29,ge=6/29,ze=3*ge*ge,tt=ge*ge*ge,rt=Math.PI/180,Et=180/Math.PI;function mt(n){return(n%=360)<0&&(n+=360),n}function Ct([n,t,r,a]){let h,m;const g=mi((.2225045*(n=bt(n))+.7168786*(t=bt(t))+.0606169*(r=bt(r)))/1);n===t&&t===r?h=m=g:(h=mi((.4360747*n+.3850649*t+.1430804*r)/te),m=mi((.0139322*n+.0971045*t+.7141733*r)/ve));const _=116*g-16;return[_<0?0:_,500*(h-g),200*(g-m),a]}function bt(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function mi(n){return n>tt?Math.pow(n,1/3):n/ze+be}function ti([n,t,r,a]){let h=(n+16)/116,m=isNaN(t)?h:h+t/500,g=isNaN(r)?h:h-r/200;return h=1*jt(h),m=te*jt(m),g=ve*jt(g),[_t(3.1338561*m-1.6168667*h-.4906146*g),_t(-.9787684*m+1.9161415*h+.033454*g),_t(.0719453*m-.2289914*h+1.4052427*g),a]}function _t(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function jt(n){return n>ge?n*n*n:ze*(n-be)}function Yt(n){return parseInt(n.padEnd(2,n),16)/255}function Si(n,t){return Pi(t?n/100:n,0,1)}function Pi(n,t,r){return Math.min(Math.max(t,n),r)}function Gi(n){return!n.some(Number.isNaN)}const Vo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ot{constructor(t,r,a,h=1,m=!0){this.r=t,this.g=r,this.b=a,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,r,a,h]))}static parse(t){if(t instanceof Ot)return t;if(typeof t!="string")return;const r=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Vo[a];if(h){const[g,_,w]=h;return[g/255,_/255,w/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const g=a.length<6?1:2;let _=1;return[Yt(a.slice(_,_+=g)),Yt(a.slice(_,_+=g)),Yt(a.slice(_,_+=g)),Yt(a.slice(_,_+g)||"ff")]}if(a.startsWith("rgb")){const g=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,w,k,E,P,A,R,j,O,G,J,pe]=g,re=[E||" ",R||" ",G].join("");if(re==="  "||re==="  /"||re===",,"||re===",,,"){const he=[k,A,O].join(""),_e=he==="%%%"?100:he===""?255:0;if(_e){const Te=[Pi(+w/_e,0,1),Pi(+P/_e,0,1),Pi(+j/_e,0,1),J?Si(+J,pe):1];if(Gi(Te))return Te}}return}}const m=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[g,_,w,k,E,P,A,R,j]=m,O=[w||" ",E||" ",A].join("");if(O==="  "||O==="  /"||O===",,"||O===",,,"){const G=[+_,Pi(+k,0,100),Pi(+P,0,100),R?Si(+R,j):1];if(Gi(G))return function([J,pe,re,he]){function _e(Te){const Ve=(Te+J/30)%12,st=pe*Math.min(re,1-re);return re-st*Math.max(-1,Math.min(Ve-3,9-Ve,1))}return J=mt(J),pe/=100,re/=100,[_e(0),_e(8),_e(4),he]}(G)}}}(t);return r?new Ot(...r,!1):void 0}get rgb(){const{r:t,g:r,b:a,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,r/m,a/m,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[r,a,h,m]=Ct(t),g=Math.sqrt(a*a+h*h);return[Math.round(1e4*g)?mt(Math.atan2(h,a)*Et):NaN,g,r,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ct(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,a,h]=this.rgb;return`rgba(${[t,r,a].map(m=>Math.round(255*m)).join(",")},${h})`}}Ot.black=new Ot(0,0,0,1),Ot.white=new Ot(1,1,1,1),Ot.transparent=new Ot(0,0,0,0),Ot.red=new Ot(1,0,0,1);class lu{constructor(t,r,a){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class uu{constructor(t,r,a,h,m){this.text=t,this.image=r,this.scale=a,this.fontStack=h,this.textColor=m}}class yn{constructor(t){this.sections=t}static fromString(t){return new yn([new uu(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof yn?t:yn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class _n{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof _n)return t;if(typeof t=="number")return new _n([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new _n(t)}}toString(){return JSON.stringify(this.values)}}const Ap=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Mn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Mn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){const a=t[r],h=t[r+1];if(typeof a!="string"||!Ap.has(a)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new Mn(t)}}toString(){return JSON.stringify(this.values)}}class vn{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new vn({name:t,available:!1}):null}}function Uo(n,t,r,a){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[n,t,r,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[n,t,r,a]:[n,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ho(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Ot||n instanceof lu||n instanceof yn||n instanceof _n||n instanceof Mn||n instanceof vn)return!0;if(Array.isArray(n)){for(const t of n)if(!ho(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!ho(n[t]))return!1;return!0}return!1}function gi(n){if(n===null)return Hr;if(typeof n=="string")return yt;if(typeof n=="boolean")return lt;if(typeof n=="number")return Le;if(n instanceof Ot)return rn;if(n instanceof lu)return mr;if(n instanceof yn)return zr;if(n instanceof _n)return Wr;if(n instanceof Mn)return K;if(n instanceof vn)return gr;if(Array.isArray(n)){const t=n.length;let r;for(const a of n){const h=gi(a);if(r){if(r===h)continue;r=ft;break}r=h}return L(r||ft,t)}return Gn}function Ws(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof Ot||n instanceof yn||n instanceof _n||n instanceof Mn||n instanceof vn?n.toString():JSON.stringify(n)}class Hn{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ho(t[1]))return r.error("invalid value");const a=t[1];let h=gi(a);const m=r.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new Hn(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ci{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Ba={string:yt,number:Le,boolean:lt,object:Gn};class Wn{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let a,h=1;const m=t[0];if(m==="array"){let _,w;if(t.length>2){const k=t[1];if(typeof k!="string"||!(k in Ba)||k==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);_=Ba[k],h++}else _=ft;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);w=t[2],h++}a=L(_,w)}else{if(!Ba[m])throw new Error(`Types doesn't contain name = ${m}`);a=Ba[m]}const g=[];for(;h<t.length;h++){const _=r.parse(t[h],h,ft);if(!_)return null;g.push(_)}return new Wn(a,g)}evaluate(t){for(let r=0;r<this.args.length;r++){const a=this.args[r].evaluate(t);if(!H(this.type,gi(a)))return a;if(r===this.args.length-1)throw new ci(`Expected value to be of type ${D(this.type)}, but found ${D(gi(a))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const cu={"to-boolean":lt,"to-color":rn,"to-number":Le,"to-string":yt};class Xn{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const a=t[0];if(!cu[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&t.length!==2)return r.error("Expected one argument.");const h=cu[a],m=[];for(let g=1;g<t.length;g++){const _=r.parse(t[g],g,ft);if(!_)return null;m.push(_)}return new Xn(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,a;for(const h of this.args){if(r=h.evaluate(t),a=null,r instanceof Ot)return r;if(typeof r=="string"){const m=t.parseColor(r);if(m)return m}else if(Array.isArray(r)&&(a=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Uo(r[0],r[1],r[2],r[3]),!a))return new Ot(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ci(a||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const a of this.args){r=a.evaluate(t);const h=_n.parse(r);if(h)return h}throw new ci(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const a of this.args){r=a.evaluate(t);const h=Mn.parse(r);if(h)return h}throw new ci(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const a of this.args){if(r=a.evaluate(t),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new ci(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return yn.fromString(Ws(this.args[0].evaluate(t)));case"resolvedImage":return vn.fromString(Ws(this.args[0].evaluate(t)));default:return Ws(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Dp=["Unknown","Point","LineString","Polygon"];class ja{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Dp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=Ot.parse(t)),r}}class po{constructor(t,r,a=[],h,m=new fr,g=[]){this.registry=t,this.path=a,this.key=a.map(_=>`[${_}]`).join(""),this.scope=m,this.errors=g,this.expectedType=h,this._isConstant=r}parse(t,r,a,h,m={}){return r?this.concat(r,a,h)._parse(t,m):this._parse(t,m)}_parse(t,r){function a(h,m,g){return g==="assert"?new Wn(m,[h]):g==="coerce"?new Xn(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let g=m.parse(t,this);if(!g)return null;if(this.expectedType){const _=this.expectedType,w=g.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||w.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string")if(_.kind!=="padding"||w.kind!=="value"&&w.kind!=="number"&&w.kind!=="array")if(_.kind!=="variableAnchorOffsetCollection"||w.kind!=="value"&&w.kind!=="array"){if(this.checkSubtype(_,w))return null}else g=a(g,_,r.typeAnnotation||"coerce");else g=a(g,_,r.typeAnnotation||"coerce");else g=a(g,_,r.typeAnnotation||"coerce");else g=a(g,_,r.typeAnnotation||"assert")}if(!(g instanceof Hn)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const _=new ja;try{g=new Hn(g.type,g.evaluate(_))}catch(w){return this.error(w.message),null}}return g}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,a){const h=typeof t=="number"?this.path.concat(t):this.path,m=a?this.scope.concat(a):this.scope;return new po(this.registry,this._isConstant,h,r||null,m,this.errors)}error(t,...r){const a=`${this.key}${r.map(h=>`[${h}]`).join("")}`;this.errors.push(new qi(a,t))}checkSubtype(t,r){const a=H(t,r);return a&&this.error(a),a}}class Xr{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const a=[];for(let m=1;m<t.length-1;m+=2){const g=t[m];if(typeof g!="string")return r.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return r.error("Variable names must contain only alphanumeric characters or '_'.",m);const _=r.parse(t[m+1],m+1);if(!_)return null;a.push([g,_])}const h=r.parse(t[t.length-1],t.length-1,r.expectedType,a);return h?new Xr(a,h):null}outputDefined(){return this.result.outputDefined()}}class Dt{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const a=t[1];return r.scope.has(a)?new Dt(a,r.scope.get(a)):r.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class hu{constructor(t,r,a){this.type=t,this.index=r,this.input=a}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=r.parse(t[1],1,Le),h=r.parse(t[2],2,L(r.expectedType||ft));return a&&h?new hu(h.type.itemType,a,h):null}evaluate(t){const r=this.index.evaluate(t),a=this.input.evaluate(t);if(r<0)throw new ci(`Array index out of bounds: ${r} < 0.`);if(r>=a.length)throw new ci(`Array index out of bounds: ${r} > ${a.length-1}.`);if(r!==Math.floor(r))throw new ci(`Array index must be an integer, but found ${r} instead.`);return a[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class du{constructor(t,r){this.type=lt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=r.parse(t[1],1,ft),h=r.parse(t[2],2,ft);return a&&h?oe(a.type,[lt,yt,Le,Hr,ft])?new du(a,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${D(a.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!a)return!1;if(!ae(r,["boolean","string","number","null"]))throw new ci(`Expected first argument to be of type boolean, string, number or null, but found ${D(gi(r))} instead.`);if(!ae(a,["string","array"]))throw new ci(`Expected second argument to be of type array or string, but found ${D(gi(a))} instead.`);return a.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class $o{constructor(t,r,a){this.type=Le,this.needle=t,this.haystack=r,this.fromIndex=a}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=r.parse(t[1],1,ft),h=r.parse(t[2],2,ft);if(!a||!h)return null;if(!oe(a.type,[lt,yt,Le,Hr,ft]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${D(a.type)} instead`);if(t.length===4){const m=r.parse(t[3],3,Le);return m?new $o(a,h,m):null}return new $o(a,h)}evaluate(t){const r=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!ae(r,["boolean","string","number","null"]))throw new ci(`Expected first argument to be of type boolean, string, number or null, but found ${D(gi(r))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),ae(a,["string"])){const m=a.indexOf(r,h);return m===-1?-1:[...a.slice(0,m)].length}if(ae(a,["array"]))return a.indexOf(r,h);throw new ci(`Expected second argument to be of type array or string, but found ${D(gi(a))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class pu{constructor(t,r,a,h,m,g){this.inputType=t,this.type=r,this.input=a,this.cases=h,this.outputs=m,this.otherwise=g}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let a,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const m={},g=[];for(let k=2;k<t.length-1;k+=2){let E=t[k];const P=t[k+1];Array.isArray(E)||(E=[E]);const A=r.concat(k);if(E.length===0)return A.error("Expected at least one branch label.");for(const j of E){if(typeof j!="number"&&typeof j!="string")return A.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return A.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return A.error("Numeric branch labels must be integer values.");if(a){if(A.checkSubtype(a,gi(j)))return null}else a=gi(j);if(m[String(j)]!==void 0)return A.error("Branch labels must be unique.");m[String(j)]=g.length}const R=r.parse(P,k,h);if(!R)return null;h=h||R.type,g.push(R)}const _=r.parse(t[1],1,ft);if(!_)return null;const w=r.parse(t[t.length-1],t.length-1,h);return w?_.type.kind!=="value"&&r.concat(1).checkSubtype(a,_.type)?null:new pu(a,h,_,m,g,w):null}evaluate(t){const r=this.input.evaluate(t);return(gi(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Oa{constructor(t,r,a){this.type=t,this.branches=r,this.otherwise=a}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let a;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);const h=[];for(let g=1;g<t.length-1;g+=2){const _=r.parse(t[g],g,lt);if(!_)return null;const w=r.parse(t[g+1],g+1,a);if(!w)return null;h.push([_,w]),a=a||w.type}const m=r.parse(t[t.length-1],t.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new Oa(a,h,m)}evaluate(t){for(const[r,a]of this.branches)if(r.evaluate(t))return a.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,a]of this.branches)t(r),t(a);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Xs{constructor(t,r,a,h){this.type=t,this.input=r,this.beginIndex=a,this.endIndex=h}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=r.parse(t[1],1,ft),h=r.parse(t[2],2,Le);if(!a||!h)return null;if(!oe(a.type,[L(ft),yt,ft]))return r.error(`Expected first argument to be of type array or string, but found ${D(a.type)} instead`);if(t.length===4){const m=r.parse(t[3],3,Le);return m?new Xs(a.type,a,h,m):null}return new Xs(a.type,a,h)}evaluate(t){const r=this.input.evaluate(t),a=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),ae(r,["string"]))return[...r].slice(a,h).join("");if(ae(r,["array"]))return r.slice(a,h);throw new ci(`Expected first argument to be of type array or string, but found ${D(gi(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Na(n,t){const r=n.length-1;let a,h,m=0,g=r,_=0;for(;m<=g;)if(_=Math.floor((m+g)/2),a=n[_],h=n[_+1],a<=t){if(_===r||t<h)return _;m=_+1}else{if(!(a>t))throw new ci("Input is not a number.");g=_-1}return 0}class Zo{constructor(t,r,a){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[h,m]of a)this.labels.push(h),this.outputs.push(m)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const a=r.parse(t[1],1,Le);if(!a)return null;const h=[];let m=null;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);for(let g=1;g<t.length;g+=2){const _=g===1?-1/0:t[g],w=t[g+1],k=g,E=g+1;if(typeof _!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(h.length&&h[h.length-1][0]>=_)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const P=r.parse(w,E,m);if(!P)return null;m=m||P.type,h.push([_,P])}return new Zo(m,a,h)}evaluate(t){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return a[0].evaluate(t);const m=r.length;return h>=r[m-1]?a[m-1].evaluate(t):a[Na(r,h)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function uh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Lp=ch;function ch(n,t,r,a){this.cx=3*n,this.bx=3*(r-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(a-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=t,this.p2x=r,this.p2y=a}ch.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,t){if(t===void 0&&(t=1e-6),n<0)return 0;if(n>1)return 1;for(var r=n,a=0;a<8;a++){var h=this.sampleCurveX(r)-n;if(Math.abs(h)<t)return r;var m=this.sampleCurveDerivativeX(r);if(Math.abs(m)<1e-6)break;r-=h/m}var g=0,_=1;for(r=n,a=0;a<20&&(h=this.sampleCurveX(r),!(Math.abs(h-n)<t));a++)n>h?g=r:_=r,r=.5*(_-g)+g;return r},solve:function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))}};var Rp=uh(Lp);function fo(n,t,r){return n+r*(t-n)}function Ks(n,t,r){return n.map((a,h)=>fo(a,t[h],r))}const on={number:fo,color:function(n,t,r,a="rgb"){switch(a){case"rgb":{const[h,m,g,_]=Ks(n.rgb,t.rgb,r);return new Ot(h,m,g,_,!1)}case"hcl":{const[h,m,g,_]=n.hcl,[w,k,E,P]=t.hcl;let A,R;if(isNaN(h)||isNaN(w))isNaN(h)?isNaN(w)?A=NaN:(A=w,g!==1&&g!==0||(R=k)):(A=h,E!==1&&E!==0||(R=m));else{let pe=w-h;w>h&&pe>180?pe-=360:w<h&&h-w>180&&(pe+=360),A=h+r*pe}const[j,O,G,J]=function([pe,re,he,_e]){return pe=isNaN(pe)?0:pe*rt,ti([he,Math.cos(pe)*re,Math.sin(pe)*re,_e])}([A,R??fo(m,k,r),fo(g,E,r),fo(_,P,r)]);return new Ot(j,O,G,J,!1)}case"lab":{const[h,m,g,_]=ti(Ks(n.lab,t.lab,r));return new Ot(h,m,g,_,!1)}}},array:Ks,padding:function(n,t,r){return new _n(Ks(n.values,t.values,r))},variableAnchorOffsetCollection:function(n,t,r){const a=n.values,h=t.values;if(a.length!==h.length)throw new ci(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${t.toString()}`);const m=[];for(let g=0;g<a.length;g+=2){if(a[g]!==h[g])throw new ci(`Cannot interpolate values containing mismatched anchors. from[${g}]: ${a[g]}, to[${g}]: ${h[g]}`);m.push(a[g]);const[_,w]=a[g+1],[k,E]=h[g+1];m.push([fo(_,k,r),fo(w,E,r)])}return new Mn(m)}};class sn{constructor(t,r,a,h,m){this.type=t,this.operator=r,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[g,_]of m)this.labels.push(g),this.outputs.push(_)}static interpolationFactor(t,r,a,h){let m=0;if(t.name==="exponential")m=Va(r,t.base,a,h);else if(t.name==="linear")m=Va(r,1,a,h);else if(t.name==="cubic-bezier"){const g=t.controlPoints;m=new Rp(g[0],g[1],g[2],g[3]).solve(Va(r,1,a,h))}return m}static parse(t,r){let[a,h,m,...g]=t;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const k=h[1];if(typeof k!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:k}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const k=h.slice(1);if(k.length!==4||k.some(E=>typeof E!="number"||E<0||E>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:k}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(m=r.parse(m,2,Le),!m)return null;const _=[];let w=null;a==="interpolate-hcl"||a==="interpolate-lab"?w=rn:r.expectedType&&r.expectedType.kind!=="value"&&(w=r.expectedType);for(let k=0;k<g.length;k+=2){const E=g[k],P=g[k+1],A=k+3,R=k+4;if(typeof E!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(_.length&&_[_.length-1][0]>=E)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',A);const j=r.parse(P,R,w);if(!j)return null;w=w||j.type,_.push([E,j])}return de(w,Le)||de(w,rn)||de(w,Wr)||de(w,K)||de(w,L(Le))?new sn(w,a,h,m,_):r.error(`Type ${D(w)} is not interpolatable.`)}evaluate(t){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return a[0].evaluate(t);const m=r.length;if(h>=r[m-1])return a[m-1].evaluate(t);const g=Na(r,h),_=sn.interpolationFactor(this.interpolation,h,r[g],r[g+1]),w=a[g].evaluate(t),k=a[g+1].evaluate(t);switch(this.operator){case"interpolate":return on[this.type.kind](w,k,_);case"interpolate-hcl":return on.color(w,k,_,"hcl");case"interpolate-lab":return on.color(w,k,_,"lab")}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Va(n,t,r,a){const h=a-r,m=n-r;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}class Ua{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let a=null;const h=r.expectedType;h&&h.kind!=="value"&&(a=h);const m=[];for(const _ of t.slice(1)){const w=r.parse(_,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!w)return null;a=a||w.type,m.push(w)}if(!a)throw new Error("No output type");const g=h&&m.some(_=>H(h,_.type));return new Ua(g?ft:a,m)}evaluate(t){let r,a=null,h=0;for(const m of this.args)if(h++,a=m.evaluate(t),a&&a instanceof vn&&!a.available&&(r||(r=a.name),a=null,h===this.args.length&&(a=r)),a!==null)break;return a}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function $a(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function hh(n,t,r,a){return a.compare(t,r)===0}function qo(n,t,r){const a=n!=="=="&&n!=="!=";return class N1{constructor(m,g,_){this.type=lt,this.lhs=m,this.rhs=g,this.collator=_,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const _=m[0];let w=g.parse(m[1],1,ft);if(!w)return null;if(!$a(_,w.type))return g.concat(1).error(`"${_}" comparisons are not supported for type '${D(w.type)}'.`);let k=g.parse(m[2],2,ft);if(!k)return null;if(!$a(_,k.type))return g.concat(2).error(`"${_}" comparisons are not supported for type '${D(k.type)}'.`);if(w.type.kind!==k.type.kind&&w.type.kind!=="value"&&k.type.kind!=="value")return g.error(`Cannot compare types '${D(w.type)}' and '${D(k.type)}'.`);a&&(w.type.kind==="value"&&k.type.kind!=="value"?w=new Wn(k.type,[w]):w.type.kind!=="value"&&k.type.kind==="value"&&(k=new Wn(w.type,[k])));let E=null;if(m.length===4){if(w.type.kind!=="string"&&k.type.kind!=="string"&&w.type.kind!=="value"&&k.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(E=g.parse(m[3],3,mr),!E)return null}return new N1(w,k,E)}evaluate(m){const g=this.lhs.evaluate(m),_=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const w=gi(g),k=gi(_);if(w.kind!==k.kind||w.kind!=="string"&&w.kind!=="number")throw new ci(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${w.kind}, ${k.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const w=gi(g),k=gi(_);if(w.kind!=="string"||k.kind!=="string")return t(m,g,_)}return this.collator?r(m,g,_,this.collator.evaluate(m)):t(m,g,_)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Fp=qo("==",function(n,t,r){return t===r},hh),dh=qo("!=",function(n,t,r){return t!==r},function(n,t,r,a){return!hh(0,t,r,a)}),ph=qo("<",function(n,t,r){return t<r},function(n,t,r,a){return a.compare(t,r)<0}),Bp=qo(">",function(n,t,r){return t>r},function(n,t,r,a){return a.compare(t,r)>0}),jp=qo("<=",function(n,t,r){return t<=r},function(n,t,r,a){return a.compare(t,r)<=0}),fh=qo(">=",function(n,t,r){return t>=r},function(n,t,r,a){return a.compare(t,r)>=0});class Js{constructor(t,r,a){this.type=mr,this.locale=a,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const a=t[1];if(typeof a!="object"||Array.isArray(a))return r.error("Collator options argument must be an object.");const h=r.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,lt);if(!h)return null;const m=r.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,lt);if(!m)return null;let g=null;return a.locale&&(g=r.parse(a.locale,1,yt),!g)?null:new Js(h,m,g)}evaluate(t){return new lu(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class fu{constructor(t,r,a,h,m){this.type=yt,this.number=t,this.locale=r,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const a=r.parse(t[1],1,Le);if(!a)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=r.parse(h.locale,1,yt),!m))return null;let g=null;if(h.currency&&(g=r.parse(h.currency,1,yt),!g))return null;let _=null;if(h["min-fraction-digits"]&&(_=r.parse(h["min-fraction-digits"],1,Le),!_))return null;let w=null;return h["max-fraction-digits"]&&(w=r.parse(h["max-fraction-digits"],1,Le),!w)?null:new fu(a,m,g,_,w)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Za{constructor(t){this.type=zr,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const a=t[1];if(!Array.isArray(a)&&typeof a=="object")return r.error("First argument must be an image or text section.");const h=[];let m=!1;for(let g=1;g<=t.length-1;++g){const _=t[g];if(m&&typeof _=="object"&&!Array.isArray(_)){m=!1;let w=null;if(_["font-scale"]&&(w=r.parse(_["font-scale"],1,Le),!w))return null;let k=null;if(_["text-font"]&&(k=r.parse(_["text-font"],1,L(yt)),!k))return null;let E=null;if(_["text-color"]&&(E=r.parse(_["text-color"],1,rn),!E))return null;const P=h[h.length-1];P.scale=w,P.font=k,P.textColor=E}else{const w=r.parse(t[g],1,ft);if(!w)return null;const k=w.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:w,scale:null,font:null,textColor:null})}}return new Za(h)}evaluate(t){return new yn(this.sections.map(r=>{const a=r.content.evaluate(t);return gi(a)===gr?new uu("",a,null,null,null):new uu(Ws(a),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}}class mu{constructor(t){this.type=gr,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const a=r.parse(t[1],1,yt);return a?new mu(a):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),a=vn.fromString(r);return a&&t.availableImages&&(a.available=t.availableImages.indexOf(r)>-1),a}eachChild(t){t(this.input)}outputDefined(){return!1}}class gu{constructor(t){this.type=Le,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const a=r.parse(t[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${D(a.type)} instead.`):new gu(a):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new ci(`Expected value to be of type string or array, but found ${D(gi(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const yr=8192;function Op(n,t){const r=(180+n[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(r*h*yr),Math.round(a*h*yr)]}function yu(n,t){const r=Math.pow(2,t.z);return[(h=(n[0]/yr+t.x)/r,360*h-180),(a=(n[1]/yr+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90)];var a,h}function mo(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function Kr(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function Rt(n,t,r){const a=n[0]-t[0],h=n[1]-t[1],m=n[0]-r[0],g=n[1]-r[1];return a*g-m*h==0&&a*m<=0&&h*g<=0}function qa(n,t,r,a){return(h=[a[0]-r[0],a[1]-r[1]])[0]*(m=[t[0]-n[0],t[1]-n[1]])[1]-h[1]*m[0]!=0&&!(!gh(n,t,r,a)||!gh(r,a,n,t));var h,m}function Np(n,t,r){for(const a of r)for(let h=0;h<a.length-1;++h)if(qa(n,t,a[h],a[h+1]))return!0;return!1}function Go(n,t,r=!1){let a=!1;for(const _ of t)for(let w=0;w<_.length-1;w++){if(Rt(n,_[w],_[w+1]))return r;(m=_[w])[1]>(h=n)[1]!=(g=_[w+1])[1]>h[1]&&h[0]<(g[0]-m[0])*(h[1]-m[1])/(g[1]-m[1])+m[0]&&(a=!a)}var h,m,g;return a}function Vp(n,t){for(const r of t)if(Go(n,r))return!0;return!1}function mh(n,t){for(const r of n)if(!Go(r,t))return!1;for(let r=0;r<n.length-1;++r)if(Np(n[r],n[r+1],t))return!1;return!0}function Up(n,t){for(const r of t)if(mh(n,r))return!0;return!1}function gh(n,t,r,a){const h=a[0]-r[0],m=a[1]-r[1],g=(n[0]-r[0])*m-h*(n[1]-r[1]),_=(t[0]-r[0])*m-h*(t[1]-r[1]);return g>0&&_<0||g<0&&_>0}function _u(n,t,r){const a=[];for(let h=0;h<n.length;h++){const m=[];for(let g=0;g<n[h].length;g++){const _=Op(n[h][g],r);mo(t,_),m.push(_)}a.push(m)}return a}function yh(n,t,r){const a=[];for(let h=0;h<n.length;h++){const m=_u(n[h],t,r);a.push(m)}return a}function _h(n,t,r,a){if(n[0]<r[0]||n[0]>r[2]){const h=.5*a;let m=n[0]-r[0]>h?-a:r[0]-n[0]>h?a:0;m===0&&(m=n[0]-r[2]>h?-a:r[2]-n[0]>h?a:0),n[0]+=m}mo(t,n)}function vh(n,t,r,a){const h=Math.pow(2,a.z)*yr,m=[a.x*yr,a.y*yr],g=[];for(const _ of n)for(const w of _){const k=[w.x+m[0],w.y+m[1]];_h(k,t,r,h),g.push(k)}return g}function xh(n,t,r,a){const h=Math.pow(2,a.z)*yr,m=[a.x*yr,a.y*yr],g=[];for(const w of n){const k=[];for(const E of w){const P=[E.x+m[0],E.y+m[1]];mo(t,P),k.push(P)}g.push(k)}if(t[2]-t[0]<=h/2){(_=t)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(const w of g)for(const k of w)_h(k,t,r,h)}var _;return g}class go{constructor(t,r){this.type=lt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ho(t[1])){const a=t[1];if(a.type==="FeatureCollection"){const h=[];for(const m of a.features){const{type:g,coordinates:_}=m.geometry;g==="Polygon"&&h.push(_),g==="MultiPolygon"&&h.push(..._)}if(h.length)return new go(a,{type:"MultiPolygon",coordinates:h})}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new go(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new go(a,a)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(a.type==="Polygon"){const _=_u(a.coordinates,m,g),w=vh(r.geometry(),h,m,g);if(!Kr(h,m))return!1;for(const k of w)if(!Go(k,_))return!1}if(a.type==="MultiPolygon"){const _=yh(a.coordinates,m,g),w=vh(r.geometry(),h,m,g);if(!Kr(h,m))return!1;for(const k of w)if(!Vp(k,_))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(a.type==="Polygon"){const _=_u(a.coordinates,m,g),w=xh(r.geometry(),h,m,g);if(!Kr(h,m))return!1;for(const k of w)if(!mh(k,_))return!1}if(a.type==="MultiPolygon"){const _=yh(a.coordinates,m,g),w=xh(r.geometry(),h,m,g);if(!Kr(h,m))return!1;for(const k of w)if(!Up(k,_))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let wh=class{constructor(n=[],t=(r,a)=>r<a?-1:r>a?1:0){if(this.data=n,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:t,compare:r}=this,a=t[n];for(;n>0;){const h=n-1>>1,m=t[h];if(r(a,m)>=0)break;t[n]=m,n=h}t[n]=a}_down(n){const{data:t,compare:r}=this,a=this.length>>1,h=t[n];for(;n<a;){let m=1+(n<<1);const g=m+1;if(g<this.length&&r(t[g],t[m])<0&&(m=g),r(t[m],h)>=0)break;t[n]=t[m],n=m}t[n]=h}};function $p(n,t,r,a,h){bh(n,t,r,a||n.length-1,h||Zp)}function bh(n,t,r,a,h){for(;a>r;){if(a-r>600){var m=a-r+1,g=t-r+1,_=Math.log(m),w=.5*Math.exp(2*_/3),k=.5*Math.sqrt(_*w*(m-w)/m)*(g-m/2<0?-1:1);bh(n,t,Math.max(r,Math.floor(t-g*w/m+k)),Math.min(a,Math.floor(t+(m-g)*w/m+k)),h)}var E=n[t],P=r,A=a;for(Ys(n,r,t),h(n[a],E)>0&&Ys(n,r,a);P<A;){for(Ys(n,P,A),P++,A--;h(n[P],E)<0;)P++;for(;h(n[A],E)>0;)A--}h(n[r],E)===0?Ys(n,r,A):Ys(n,++A,a),A<=t&&(r=A+1),t<=A&&(a=A-1)}}function Ys(n,t,r){var a=n[t];n[t]=n[r],n[r]=a}function Zp(n,t){return n<t?-1:n>t?1:0}function Ga(n,t){if(n.length<=1)return[n];const r=[];let a,h;for(const m of n){const g=Gp(m);g!==0&&(m.area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(a&&r.push(a),a=[m]):a.push(m))}if(a&&r.push(a),t>1)for(let m=0;m<r.length;m++)r[m].length<=t||($p(r[m],t,1,r[m].length-1,qp),r[m]=r[m].slice(0,t));return r}function qp(n,t){return t.area-n.area}function Gp(n){let t=0;for(let r,a,h=0,m=n.length,g=m-1;h<m;g=h++)r=n[h],a=n[g],t+=(a.x-r.x)*(r.y+a.y);return t}const Sh=1/298.257223563,Th=Sh*(2-Sh),Ih=Math.PI/180;class vu{constructor(t){const r=6378.137*Ih*1e3,a=Math.cos(t*Ih),h=1/(1-Th*(1-a*a)),m=Math.sqrt(h);this.kx=r*m*a,this.ky=r*m*h*(1-Th)}distance(t,r){const a=this.wrap(t[0]-r[0])*this.kx,h=(t[1]-r[1])*this.ky;return Math.sqrt(a*a+h*h)}pointOnLine(t,r){let a,h,m,g,_=1/0;for(let w=0;w<t.length-1;w++){let k=t[w][0],E=t[w][1],P=this.wrap(t[w+1][0]-k)*this.kx,A=(t[w+1][1]-E)*this.ky,R=0;P===0&&A===0||(R=(this.wrap(r[0]-k)*this.kx*P+(r[1]-E)*this.ky*A)/(P*P+A*A),R>1?(k=t[w+1][0],E=t[w+1][1]):R>0&&(k+=P/this.kx*R,E+=A/this.ky*R)),P=this.wrap(r[0]-k)*this.kx,A=(r[1]-E)*this.ky;const j=P*P+A*A;j<_&&(_=j,a=k,h=E,m=w,g=R)}return{point:[a,h],index:m,t:Math.max(0,Math.min(1,g))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function kh(n,t){return t[0]-n[0]}function Ha(n){return n[1]-n[0]+1}function Ar(n,t){return n[1]>=n[0]&&n[1]<t}function xu(n,t){if(n[0]>n[1])return[null,null];const r=Ha(n);if(t){if(r===2)return[n,null];const h=Math.floor(r/2);return[[n[0],n[0]+h],[n[0]+h,n[1]]]}if(r===1)return[n,null];const a=Math.floor(r/2)-1;return[[n[0],n[0]+a],[n[0]+a+1,n[1]]]}function wu(n,t){if(!Ar(t,n.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let a=t[0];a<=t[1];++a)mo(r,n[a]);return r}function bu(n){const t=[1/0,1/0,-1/0,-1/0];for(const r of n)for(const a of r)mo(t,a);return t}function Wa(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function Su(n,t,r){if(!Wa(n)||!Wa(t))return NaN;let a=0,h=0;return n[2]<t[0]&&(a=t[0]-n[2]),n[0]>t[2]&&(a=n[0]-t[2]),n[1]>t[3]&&(h=n[1]-t[3]),n[3]<t[1]&&(h=t[1]-n[3]),r.distance([0,0],[a,h])}function yo(n,t,r){const a=r.pointOnLine(t,n);return r.distance(n,a.point)}function Tu(n,t,r,a,h){const m=Math.min(yo(n,[r,a],h),yo(t,[r,a],h)),g=Math.min(yo(r,[n,t],h),yo(a,[n,t],h));return Math.min(m,g)}function Hp(n,t,r,a,h){if(!Ar(t,n.length)||!Ar(a,r.length))return 1/0;let m=1/0;for(let g=t[0];g<t[1];++g){const _=n[g],w=n[g+1];for(let k=a[0];k<a[1];++k){const E=r[k],P=r[k+1];if(qa(_,w,E,P))return 0;m=Math.min(m,Tu(_,w,E,P,h))}}return m}function si(n,t,r,a,h){if(!Ar(t,n.length)||!Ar(a,r.length))return NaN;let m=1/0;for(let g=t[0];g<=t[1];++g)for(let _=a[0];_<=a[1];++_)if(m=Math.min(m,h.distance(n[g],r[_])),m===0)return m;return m}function Wp(n,t,r){if(Go(n,t,!0))return 0;let a=1/0;for(const h of t){const m=h[0],g=h[h.length-1];if(m!==g&&(a=Math.min(a,yo(n,[g,m],r)),a===0))return a;const _=r.pointOnLine(h,n);if(a=Math.min(a,r.distance(n,_.point)),a===0)return a}return a}function wt(n,t,r,a){if(!Ar(t,n.length))return NaN;for(let m=t[0];m<=t[1];++m)if(Go(n[m],r,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const g=n[m],_=n[m+1];for(const w of r)for(let k=0,E=w.length,P=E-1;k<E;P=k++){const A=w[P],R=w[k];if(qa(g,_,A,R))return 0;h=Math.min(h,Tu(g,_,A,R,a))}}return h}function Xa(n,t){for(const r of n)for(const a of r)if(Go(a,t,!0))return!0;return!1}function Zt(n,t,r,a=1/0){const h=bu(n),m=bu(t);if(a!==1/0&&Su(h,m,r)>=a)return a;if(Kr(h,m)){if(Xa(n,t))return 0}else if(Xa(t,n))return 0;let g=1/0;for(const _ of n)for(let w=0,k=_.length,E=k-1;w<k;E=w++){const P=_[E],A=_[w];for(const R of t)for(let j=0,O=R.length,G=O-1;j<O;G=j++){const J=R[G],pe=R[j];if(qa(P,A,J,pe))return 0;g=Math.min(g,Tu(P,A,J,pe,r))}}return g}function Nt(n,t,r,a,h,m){if(!m)return;const g=Su(wu(a,m),h,r);g<t&&n.push([g,m,[0,0]])}function _o(n,t,r,a,h,m,g){if(!m||!g)return;const _=Su(wu(a,m),wu(h,g),r);_<t&&n.push([_,m,g])}function Qs(n,t,r,a,h=1/0){let m=Math.min(a.distance(n[0],r[0][0]),h);if(m===0)return m;const g=new wh([[0,[0,n.length-1],[0,0]]],kh),_=bu(r);for(;g.length>0;){const w=g.pop();if(w[0]>=m)continue;const k=w[1],E=t?50:100;if(Ha(k)<=E){if(!Ar(k,n.length))return NaN;if(t){const P=wt(n,k,r,a);if(isNaN(P)||P===0)return P;m=Math.min(m,P)}else for(let P=k[0];P<=k[1];++P){const A=Wp(n[P],r,a);if(m=Math.min(m,A),m===0)return 0}}else{const P=xu(k,t);Nt(g,m,a,n,_,P[0]),Nt(g,m,a,n,_,P[1])}}return m}function ea(n,t,r,a,h,m=1/0){let g=Math.min(m,h.distance(n[0],r[0]));if(g===0)return g;const _=new wh([[0,[0,n.length-1],[0,r.length-1]]],kh);for(;_.length>0;){const w=_.pop();if(w[0]>=g)continue;const k=w[1],E=w[2],P=t?50:100,A=a?50:100;if(Ha(k)<=P&&Ha(E)<=A){if(!Ar(k,n.length)&&Ar(E,r.length))return NaN;let R;if(t&&a)R=Hp(n,k,r,E,h),g=Math.min(g,R);else if(t&&!a){const j=n.slice(k[0],k[1]+1);for(let O=E[0];O<=E[1];++O)if(R=yo(r[O],j,h),g=Math.min(g,R),g===0)return g}else if(!t&&a){const j=r.slice(E[0],E[1]+1);for(let O=k[0];O<=k[1];++O)if(R=yo(n[O],j,h),g=Math.min(g,R),g===0)return g}else R=si(n,k,r,E,h),g=Math.min(g,R)}else{const R=xu(k,t),j=xu(E,a);_o(_,g,h,n,r,R[0],j[0]),_o(_,g,h,n,r,R[0],j[1]),_o(_,g,h,n,r,R[1],j[0]),_o(_,g,h,n,r,R[1],j[1])}}return g}function Iu(n){return n.type==="MultiPolygon"?n.coordinates.map(t=>({type:"Polygon",coordinates:t})):n.type==="MultiLineString"?n.coordinates.map(t=>({type:"LineString",coordinates:t})):n.type==="MultiPoint"?n.coordinates.map(t=>({type:"Point",coordinates:t})):[n]}class vo{constructor(t,r){this.type=Le,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ho(t[1])){const a=t[1];if(a.type==="FeatureCollection")return new vo(a,a.features.map(h=>Iu(h.geometry)).flat());if(a.type==="Feature")return new vo(a,Iu(a.geometry));if("type"in a&&"coordinates"in a)return new vo(a,Iu(a))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,a){const h=r.geometry(),m=h.flat().map(w=>yu([w.x,w.y],r.canonical));if(h.length===0)return NaN;const g=new vu(m[0][1]);let _=1/0;for(const w of a){switch(w.type){case"Point":_=Math.min(_,ea(m,!1,[w.coordinates],!1,g,_));break;case"LineString":_=Math.min(_,ea(m,!1,w.coordinates,!0,g,_));break;case"Polygon":_=Math.min(_,Qs(m,!1,w.coordinates,g,_))}if(_===0)return _}return _}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,a){const h=r.geometry(),m=h.flat().map(w=>yu([w.x,w.y],r.canonical));if(h.length===0)return NaN;const g=new vu(m[0][1]);let _=1/0;for(const w of a){switch(w.type){case"Point":_=Math.min(_,ea(m,!0,[w.coordinates],!1,g,_));break;case"LineString":_=Math.min(_,ea(m,!0,w.coordinates,!0,g,_));break;case"Polygon":_=Math.min(_,Qs(m,!0,w.coordinates,g,_))}if(_===0)return _}return _}(t,this.geometries);if(t.geometryType()==="Polygon")return function(r,a){const h=r.geometry();if(h.length===0||h[0].length===0)return NaN;const m=Ga(h,0).map(w=>w.map(k=>k.map(E=>yu([E.x,E.y],r.canonical)))),g=new vu(m[0][0][0][1]);let _=1/0;for(const w of a)for(const k of m){switch(w.type){case"Point":_=Math.min(_,Qs([w.coordinates],!1,k,g,_));break;case"LineString":_=Math.min(_,Qs(w.coordinates,!0,k,g,_));break;case"Polygon":_=Math.min(_,Zt(k,w.coordinates,g,_))}if(_===0)return _}return _}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ho={"==":Fp,"!=":dh,">":Bp,"<":ph,">=":fh,"<=":jp,array:Wn,at:hu,boolean:Wn,case:Oa,coalesce:Ua,collator:Js,format:Za,image:mu,in:du,"index-of":$o,interpolate:sn,"interpolate-hcl":sn,"interpolate-lab":sn,length:gu,let:Xr,literal:Hn,match:pu,number:Wn,"number-format":fu,object:Wn,slice:Xs,step:Zo,string:Wn,"to-boolean":Xn,"to-color":Xn,"to-number":Xn,"to-string":Xn,var:Dt,within:go,distance:vo};class zn{constructor(t,r,a,h){this.name=t,this.type=r,this._evaluate=a,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const a=t[0],h=zn.definitions[a];if(!h)return r.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,g=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,_=g.filter(([k])=>!Array.isArray(k)||k.length===t.length-1);let w=null;for(const[k,E]of _){w=new po(r.registry,ta,r.path,null,r.scope);const P=[];let A=!1;for(let R=1;R<t.length;R++){const j=t[R],O=Array.isArray(k)?k[R-1]:k.type,G=w.parse(j,1+P.length,O);if(!G){A=!0;break}P.push(G)}if(!A)if(Array.isArray(k)&&k.length!==P.length)w.error(`Expected ${k.length} arguments, but found ${P.length} instead.`);else{for(let R=0;R<P.length;R++){const j=Array.isArray(k)?k[R]:k.type,O=P[R];w.concat(R+1).checkSubtype(j,O.type)}if(w.errors.length===0)return new zn(a,m,E,P)}}if(_.length===1)r.errors.push(...w.errors);else{const k=(_.length?_:g).map(([P])=>{return A=P,Array.isArray(A)?`(${A.map(D).join(", ")})`:`(${D(A.type)}...)`;var A}).join(" | "),E=[];for(let P=1;P<t.length;P++){const A=r.parse(t[P],1+E.length);if(!A)return null;E.push(D(A.type))}r.error(`Expected arguments of type ${k}, but found (${E.join(", ")}) instead.`)}return null}static register(t,r){zn.definitions=r;for(const a in r)t[a]=zn}}function ku(n,[t,r,a,h]){t=t.evaluate(n),r=r.evaluate(n),a=a.evaluate(n);const m=h?h.evaluate(n):1,g=Uo(t,r,a,m);if(g)throw new ci(g);return new Ot(t/255,r/255,a/255,m,!1)}function Eu(n,t){return n in t}function Cu(n,t){const r=t[n];return r===void 0?null:r}function xo(n){return{type:n}}function ta(n){if(n instanceof Dt)return ta(n.boundExpression);if(n instanceof zn&&n.name==="error"||n instanceof Js||n instanceof go||n instanceof vo)return!1;const t=n instanceof Xn||n instanceof Wn;let r=!0;return n.eachChild(a=>{r=t?r&&ta(a):r&&a instanceof Hn}),!!r&&ia(n)&&na(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ia(n){if(n instanceof zn&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof go||n instanceof vo)return!1;let t=!0;return n.eachChild(r=>{t&&!ia(r)&&(t=!1)}),t}function Wo(n){if(n instanceof zn&&n.name==="feature-state")return!1;let t=!0;return n.eachChild(r=>{t&&!Wo(r)&&(t=!1)}),t}function na(n,t){if(n instanceof zn&&t.indexOf(n.name)>=0)return!1;let r=!0;return n.eachChild(a=>{r&&!na(a,t)&&(r=!1)}),r}function Ka(n){return{result:"success",value:n}}function Xo(n){return{result:"error",value:n}}function Ko(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function Eh(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function Pu(n){return!!n.expression&&n.expression.interpolated}function Mt(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Ja(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function Xp(n){return n}function Ch(n,t){const r=t.type==="color",a=n.stops&&typeof n.stops[0][0]=="object",h=a||!(a||n.property!==void 0),m=n.type||(Pu(t)?"exponential":"interval");if(r||t.type==="padding"){const E=r?Ot.parse:_n.parse;(n=pr({},n)).stops&&(n.stops=n.stops.map(P=>[P[0],E(P[1])])),n.default=E(n.default?n.default:t.default)}if(n.colorSpace&&(g=n.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var g;let _,w,k;if(m==="exponential")_=Mh;else if(m==="interval")_=Ya;else if(m==="categorical"){_=Ph,w=Object.create(null);for(const E of n.stops)w[E[0]]=E[1];k=typeof n.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);_=zh}if(a){const E={},P=[];for(let j=0;j<n.stops.length;j++){const O=n.stops[j],G=O[0].zoom;E[G]===void 0&&(E[G]={zoom:G,type:n.type,property:n.property,default:n.default,stops:[]},P.push(G)),E[G].stops.push([O[0].value,O[1]])}const A=[];for(const j of P)A.push([E[j].zoom,Ch(E[j],t)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:sn.interpolationFactor.bind(void 0,R),zoomStops:A.map(j=>j[0]),evaluate:({zoom:j},O)=>Mh({stops:A,base:n.base},t,j).evaluate(j,O)}}if(h){const E=m==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:sn.interpolationFactor.bind(void 0,E),zoomStops:n.stops.map(P=>P[0]),evaluate:({zoom:P})=>_(n,t,P,w,k)}}return{kind:"source",evaluate(E,P){const A=P&&P.properties?P.properties[n.property]:void 0;return A===void 0?Jo(n.default,t.default):_(n,t,A,w,k)}}}function Jo(n,t,r){return n!==void 0?n:t!==void 0?t:r!==void 0?r:void 0}function Ph(n,t,r,a,h){return Jo(typeof r===h?a[r]:void 0,n.default,t.default)}function Ya(n,t,r){if(Mt(r)!=="number")return Jo(n.default,t.default);const a=n.stops.length;if(a===1||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[a-1][0])return n.stops[a-1][1];const h=Na(n.stops.map(m=>m[0]),r);return n.stops[h][1]}function Mh(n,t,r){const a=n.base!==void 0?n.base:1;if(Mt(r)!=="number")return Jo(n.default,t.default);const h=n.stops.length;if(h===1||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[h-1][0])return n.stops[h-1][1];const m=Na(n.stops.map(E=>E[0]),r),g=function(E,P,A,R){const j=R-A,O=E-A;return j===0?0:P===1?O/j:(Math.pow(P,O)-1)/(Math.pow(P,j)-1)}(r,a,n.stops[m][0],n.stops[m+1][0]),_=n.stops[m][1],w=n.stops[m+1][1],k=on[t.type]||Xp;return typeof _.evaluate=="function"?{evaluate(...E){const P=_.evaluate.apply(void 0,E),A=w.evaluate.apply(void 0,E);if(P!==void 0&&A!==void 0)return k(P,A,g,n.colorSpace)}}:k(_,w,g,n.colorSpace)}function zh(n,t,r){switch(t.type){case"color":r=Ot.parse(r);break;case"formatted":r=yn.fromString(r.toString());break;case"resolvedImage":r=vn.fromString(r.toString());break;case"padding":r=_n.parse(r);break;default:Mt(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return Jo(r,n.default,t.default)}zn.register(Ho,{error:[{kind:"error"},[yt],(n,[t])=>{throw new ci(t.evaluate(n))}],typeof:[yt,[ft],(n,[t])=>D(gi(t.evaluate(n)))],"to-rgba":[L(Le,4),[rn],(n,[t])=>{const[r,a,h,m]=t.evaluate(n).rgb;return[255*r,255*a,255*h,m]}],rgb:[rn,[Le,Le,Le],ku],rgba:[rn,[Le,Le,Le,Le],ku],has:{type:lt,overloads:[[[yt],(n,[t])=>Eu(t.evaluate(n),n.properties())],[[yt,Gn],(n,[t,r])=>Eu(t.evaluate(n),r.evaluate(n))]]},get:{type:ft,overloads:[[[yt],(n,[t])=>Cu(t.evaluate(n),n.properties())],[[yt,Gn],(n,[t,r])=>Cu(t.evaluate(n),r.evaluate(n))]]},"feature-state":[ft,[yt],(n,[t])=>Cu(t.evaluate(n),n.featureState||{})],properties:[Gn,[],n=>n.properties()],"geometry-type":[yt,[],n=>n.geometryType()],id:[ft,[],n=>n.id()],zoom:[Le,[],n=>n.globals.zoom],"heatmap-density":[Le,[],n=>n.globals.heatmapDensity||0],"line-progress":[Le,[],n=>n.globals.lineProgress||0],accumulated:[ft,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[Le,xo(Le),(n,t)=>{let r=0;for(const a of t)r+=a.evaluate(n);return r}],"*":[Le,xo(Le),(n,t)=>{let r=1;for(const a of t)r*=a.evaluate(n);return r}],"-":{type:Le,overloads:[[[Le,Le],(n,[t,r])=>t.evaluate(n)-r.evaluate(n)],[[Le],(n,[t])=>-t.evaluate(n)]]},"/":[Le,[Le,Le],(n,[t,r])=>t.evaluate(n)/r.evaluate(n)],"%":[Le,[Le,Le],(n,[t,r])=>t.evaluate(n)%r.evaluate(n)],ln2:[Le,[],()=>Math.LN2],pi:[Le,[],()=>Math.PI],e:[Le,[],()=>Math.E],"^":[Le,[Le,Le],(n,[t,r])=>Math.pow(t.evaluate(n),r.evaluate(n))],sqrt:[Le,[Le],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[Le,[Le],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[Le,[Le],(n,[t])=>Math.log(t.evaluate(n))],log2:[Le,[Le],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[Le,[Le],(n,[t])=>Math.sin(t.evaluate(n))],cos:[Le,[Le],(n,[t])=>Math.cos(t.evaluate(n))],tan:[Le,[Le],(n,[t])=>Math.tan(t.evaluate(n))],asin:[Le,[Le],(n,[t])=>Math.asin(t.evaluate(n))],acos:[Le,[Le],(n,[t])=>Math.acos(t.evaluate(n))],atan:[Le,[Le],(n,[t])=>Math.atan(t.evaluate(n))],min:[Le,xo(Le),(n,t)=>Math.min(...t.map(r=>r.evaluate(n)))],max:[Le,xo(Le),(n,t)=>Math.max(...t.map(r=>r.evaluate(n)))],abs:[Le,[Le],(n,[t])=>Math.abs(t.evaluate(n))],round:[Le,[Le],(n,[t])=>{const r=t.evaluate(n);return r<0?-Math.round(-r):Math.round(r)}],floor:[Le,[Le],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[Le,[Le],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[lt,[yt,ft],(n,[t,r])=>n.properties()[t.value]===r.value],"filter-id-==":[lt,[ft],(n,[t])=>n.id()===t.value],"filter-type-==":[lt,[yt],(n,[t])=>n.geometryType()===t.value],"filter-<":[lt,[yt,ft],(n,[t,r])=>{const a=n.properties()[t.value],h=r.value;return typeof a==typeof h&&a<h}],"filter-id-<":[lt,[ft],(n,[t])=>{const r=n.id(),a=t.value;return typeof r==typeof a&&r<a}],"filter->":[lt,[yt,ft],(n,[t,r])=>{const a=n.properties()[t.value],h=r.value;return typeof a==typeof h&&a>h}],"filter-id->":[lt,[ft],(n,[t])=>{const r=n.id(),a=t.value;return typeof r==typeof a&&r>a}],"filter-<=":[lt,[yt,ft],(n,[t,r])=>{const a=n.properties()[t.value],h=r.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[lt,[ft],(n,[t])=>{const r=n.id(),a=t.value;return typeof r==typeof a&&r<=a}],"filter->=":[lt,[yt,ft],(n,[t,r])=>{const a=n.properties()[t.value],h=r.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[lt,[ft],(n,[t])=>{const r=n.id(),a=t.value;return typeof r==typeof a&&r>=a}],"filter-has":[lt,[ft],(n,[t])=>t.value in n.properties()],"filter-has-id":[lt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[lt,[L(yt)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[lt,[L(ft)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[lt,[yt,L(ft)],(n,[t,r])=>r.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[lt,[yt,L(ft)],(n,[t,r])=>function(a,h,m,g){for(;m<=g;){const _=m+g>>1;if(h[_]===a)return!0;h[_]>a?g=_-1:m=_+1}return!1}(n.properties()[t.value],r.value,0,r.value.length-1)],all:{type:lt,overloads:[[[lt,lt],(n,[t,r])=>t.evaluate(n)&&r.evaluate(n)],[xo(lt),(n,t)=>{for(const r of t)if(!r.evaluate(n))return!1;return!0}]]},any:{type:lt,overloads:[[[lt,lt],(n,[t,r])=>t.evaluate(n)||r.evaluate(n)],[xo(lt),(n,t)=>{for(const r of t)if(r.evaluate(n))return!0;return!1}]]},"!":[lt,[lt],(n,[t])=>!t.evaluate(n)],"is-supported-script":[lt,[yt],(n,[t])=>{const r=n.globals&&n.globals.isSupportedScript;return!r||r(t.evaluate(n))}],upcase:[yt,[yt],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[yt,[yt],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[yt,xo(ft),(n,t)=>t.map(r=>Ws(r.evaluate(n))).join("")],"resolved-locale":[yt,[mr],(n,[t])=>t.evaluate(n).resolvedLocale()]});class Qa{constructor(t,r){var a;this.expression=t,this._warningHistory={},this._evaluator=new ja,this._defaultValue=r?(a=r).type==="color"&&Ja(a.default)?new Ot(0,0,0,0):a.type==="color"?Ot.parse(a.default)||null:a.type==="padding"?_n.parse(a.default)||null:a.type==="variableAnchorOffsetCollection"?Mn.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,a,h,m,g){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=a,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(t,r,a,h,m,g){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null;try{const _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new ci(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(_)} instead.`);return _}catch(_){return this._warningHistory[_.message]||(this._warningHistory[_.message]=!0,typeof console<"u"&&console.warn(_.message)),this._defaultValue}}}function el(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Ho}function Yo(n,t){const r=new po(Ho,ta,[],t?function(h){const m={color:rn,string:yt,number:Le,enum:yt,boolean:lt,formatted:zr,padding:Wr,resolvedImage:gr,variableAnchorOffsetCollection:K};return h.type==="array"?L(m[h.value]||ft,h.length):m[h.type]}(t):void 0),a=r.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Ka(new Qa(a,t)):Xo(r.errors)}class Qo{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Wo(r.expression)}evaluateWithoutErrorHandling(t,r,a,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,r,a,h,m,g)}evaluate(t,r,a,h,m,g){return this._styleExpression.evaluate(t,r,a,h,m,g)}}class es{constructor(t,r,a,h){this.kind=t,this.zoomStops=a,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Wo(r.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,r,a,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,r,a,h,m,g)}evaluate(t,r,a,h,m,g){return this._styleExpression.evaluate(t,r,a,h,m,g)}interpolationFactor(t,r,a){return this.interpolationType?sn.interpolationFactor(this.interpolationType,t,r,a):0}}function Mu(n,t){const r=Yo(n,t);if(r.result==="error")return r;const a=r.value.expression,h=ia(a);if(!h&&!Ko(t))return Xo([new qi("","data expressions not supported")]);const m=na(a,["zoom"]);if(!m&&!Eh(t))return Xo([new qi("","zoom expressions not supported")]);const g=ra(a);return g||m?g instanceof qi?Xo([g]):g instanceof sn&&!Pu(t)?Xo([new qi("",'"interpolate" expressions cannot be used with this property')]):Ka(g?new es(h?"camera":"composite",r.value,g.labels,g instanceof sn?g.interpolation:void 0):new Qo(h?"constant":"source",r.value)):Xo([new qi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ts{constructor(t,r){this._parameters=t,this._specification=r,pr(this,Ch(this._parameters,this._specification))}static deserialize(t){return new ts(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function ra(n){let t=null;if(n instanceof Xr)t=ra(n.result);else if(n instanceof Ua){for(const r of n.args)if(t=ra(r),t)break}else(n instanceof Zo||n instanceof sn)&&n.input instanceof zn&&n.input.name==="zoom"&&(t=n);return t instanceof qi||n.eachChild(r=>{const a=ra(r);a instanceof qi?t=a:!t&&a?t=new qi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&a&&t!==a&&(t=new qi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function tl(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!tl(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const il={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function zu(n){if(n==null)return{filter:()=>!0,needGeometry:!1};tl(n)||(n=nl(n));const t=Yo(n,il);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,a,h)=>t.value.evaluate(r,a,{},h),needGeometry:Ah(n)}}function Kp(n,t){return n<t?-1:n>t?1:0}function Ah(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let t=1;t<n.length;t++)if(Ah(n[t]))return!0;return!1}function nl(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?Au(n[1],n[2],"=="):t==="!="?Ri(Au(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Au(n[1],n[2],t):t==="any"?(r=n.slice(1),["any"].concat(r.map(nl))):t==="all"?["all"].concat(n.slice(1).map(nl)):t==="none"?["all"].concat(n.slice(1).map(nl).map(Ri)):t==="in"?oa(n[1],n.slice(2)):t==="!in"?Ri(oa(n[1],n.slice(2))):t==="has"?sa(n[1]):t!=="!has"||Ri(sa(n[1]));var r}function Au(n,t,r){switch(n){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,n,t]}}function oa(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",n,["literal",t.sort(Kp)]]:["filter-in-small",n,["literal",t]]}}function sa(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Ri(n){return["!",n]}function wo(n){const t=typeof n;if(t==="number"||t==="boolean"||t==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let h="[";for(const m of n)h+=`${wo(m)},`;return`${h}]`}const r=Object.keys(n).sort();let a="{";for(let h=0;h<r.length;h++)a+=`${JSON.stringify(r[h])}:${wo(n[r[h]])},`;return`${a}}`}function Dh(n){let t="";for(const r of co)t+=`/${wo(n[r])}`;return t}function Lh(n){const t=n.value;return t?[new Pe(n.key,t,"constants have been deprecated as of v8")]:[]}function ai(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Kn(n){if(Array.isArray(n))return n.map(Kn);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const r in n)t[r]=Kn(n[r]);return t}return ai(n)}function xn(n){const t=n.key,r=n.value,a=n.valueSpec||{},h=n.objectElementValidators||{},m=n.style,g=n.styleSpec,_=n.validateSpec;let w=[];const k=Mt(r);if(k!=="object")return[new Pe(t,r,`object expected, ${k} found`)];for(const E in r){const P=E.split(".")[0],A=a[P]||a["*"];let R;if(h[P])R=h[P];else if(a[P])R=_;else if(h["*"])R=h["*"];else{if(!a["*"]){w.push(new Pe(t,r[E],`unknown property "${E}"`));continue}R=_}w=w.concat(R({key:(t&&`${t}.`)+E,value:r[E],valueSpec:A,style:m,styleSpec:g,object:r,objectKey:E,validateSpec:_},r))}for(const E in a)h[E]||a[E].required&&a[E].default===void 0&&r[E]===void 0&&w.push(new Pe(t,r,`missing required property "${E}"`));return w}function aa(n){const t=n.value,r=n.valueSpec,a=n.style,h=n.styleSpec,m=n.key,g=n.arrayElementValidator||n.validateSpec;if(Mt(t)!=="array")return[new Pe(m,t,`array expected, ${Mt(t)} found`)];if(r.length&&t.length!==r.length)return[new Pe(m,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Pe(m,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let _={type:r.value,values:r.values};h.$version<7&&(_.function=r.function),Mt(r.value)==="object"&&(_=r.value);let w=[];for(let k=0;k<t.length;k++)w=w.concat(g({array:t,arrayIndex:k,value:t[k],valueSpec:_,validateSpec:n.validateSpec,style:a,styleSpec:h,key:`${m}[${k}]`}));return w}function Du(n){const t=n.key,r=n.value,a=n.valueSpec;let h=Mt(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new Pe(t,r,`number expected, ${h} found`)]:"minimum"in a&&r<a.minimum?[new Pe(t,r,`${r} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&r>a.maximum?[new Pe(t,r,`${r} is greater than the maximum value ${a.maximum}`)]:[]}function rl(n){const t=n.valueSpec,r=ai(n.value.type);let a,h,m,g={};const _=r!=="categorical"&&n.value.property===void 0,w=!_,k=Mt(n.value.stops)==="array"&&Mt(n.value.stops[0])==="array"&&Mt(n.value.stops[0][0])==="object",E=xn({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(R){if(r==="identity")return[new Pe(R.key,R.value,'identity function may not have a "stops" property')];let j=[];const O=R.value;return j=j.concat(aa({key:R.key,value:O,valueSpec:R.valueSpec,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:P})),Mt(O)==="array"&&O.length===0&&j.push(new Pe(R.key,O,"array must have at least one stop")),j},default:function(R){return R.validateSpec({key:R.key,value:R.value,valueSpec:t,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec})}}});return r==="identity"&&_&&E.push(new Pe(n.key,n.value,'missing required property "property"')),r==="identity"||n.value.stops||E.push(new Pe(n.key,n.value,'missing required property "stops"')),r==="exponential"&&n.valueSpec.expression&&!Pu(n.valueSpec)&&E.push(new Pe(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(w&&!Ko(n.valueSpec)?E.push(new Pe(n.key,n.value,"property functions not supported")):_&&!Eh(n.valueSpec)&&E.push(new Pe(n.key,n.value,"zoom functions not supported"))),r!=="categorical"&&!k||n.value.property!==void 0||E.push(new Pe(n.key,n.value,'"property" property is required')),E;function P(R){let j=[];const O=R.value,G=R.key;if(Mt(O)!=="array")return[new Pe(G,O,`array expected, ${Mt(O)} found`)];if(O.length!==2)return[new Pe(G,O,`array length 2 expected, length ${O.length} found`)];if(k){if(Mt(O[0])!=="object")return[new Pe(G,O,`object expected, ${Mt(O[0])} found`)];if(O[0].zoom===void 0)return[new Pe(G,O,"object stop key must have zoom")];if(O[0].value===void 0)return[new Pe(G,O,"object stop key must have value")];if(m&&m>ai(O[0].zoom))return[new Pe(G,O[0].zoom,"stop zoom values must appear in ascending order")];ai(O[0].zoom)!==m&&(m=ai(O[0].zoom),h=void 0,g={}),j=j.concat(xn({key:`${G}[0]`,value:O[0],valueSpec:{zoom:{}},validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{zoom:Du,value:A}}))}else j=j.concat(A({key:`${G}[0]`,value:O[0],valueSpec:{},validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec},O));return el(Kn(O[1]))?j.concat([new Pe(`${G}[1]`,O[1],"expressions are not allowed in function stops.")]):j.concat(R.validateSpec({key:`${G}[1]`,value:O[1],valueSpec:t,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec}))}function A(R,j){const O=Mt(R.value),G=ai(R.value),J=R.value!==null?R.value:j;if(a){if(O!==a)return[new Pe(R.key,J,`${O} stop domain type must match previous stop domain type ${a}`)]}else a=O;if(O!=="number"&&O!=="string"&&O!=="boolean")return[new Pe(R.key,J,"stop domain value must be a number, string, or boolean")];if(O!=="number"&&r!=="categorical"){let pe=`number expected, ${O} found`;return Ko(t)&&r===void 0&&(pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pe(R.key,J,pe)]}return r!=="categorical"||O!=="number"||isFinite(G)&&Math.floor(G)===G?r!=="categorical"&&O==="number"&&h!==void 0&&G<h?[new Pe(R.key,J,"stop domain values must appear in ascending order")]:(h=G,r==="categorical"&&G in g?[new Pe(R.key,J,"stop domain values must be unique")]:(g[G]=!0,[])):[new Pe(R.key,J,`integer expected, found ${G}`)]}}function is(n){const t=(n.expressionContext==="property"?Mu:Yo)(Kn(n.value),n.valueSpec);if(t.result==="error")return t.value.map(a=>new Pe(`${n.key}${a.key}`,n.value,a.message));const r=t.value.expression||t.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!r.outputDefined())return[new Pe(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Wo(r))return[new Pe(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!Wo(r))return[new Pe(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!na(r,["zoom","feature-state"]))return[new Pe(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!ia(r))return[new Pe(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Dr(n){const t=n.key,r=n.value,a=n.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(ai(r))===-1&&h.push(new Pe(t,r,`expected one of [${a.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(a.values).indexOf(ai(r))===-1&&h.push(new Pe(t,r,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function Lu(n){return tl(Kn(n.value))?is(pr({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ol(n)}function ol(n){const t=n.value,r=n.key;if(Mt(t)!=="array")return[new Pe(r,t,`array expected, ${Mt(t)} found`)];const a=n.styleSpec;let h,m=[];if(t.length<1)return[new Pe(r,t,"filter array must have at least 1 element")];switch(m=m.concat(Dr({key:`${r}[0]`,value:t[0],valueSpec:a.filter_operator,style:n.style,styleSpec:n.styleSpec})),ai(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ai(t[1])==="$type"&&m.push(new Pe(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new Pe(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Mt(t[1]),h!=="string"&&m.push(new Pe(`${r}[1]`,t[1],`string expected, ${h} found`)));for(let g=2;g<t.length;g++)h=Mt(t[g]),ai(t[1])==="$type"?m=m.concat(Dr({key:`${r}[${g}]`,value:t[g],valueSpec:a.geometry_type,style:n.style,styleSpec:n.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new Pe(`${r}[${g}]`,t[g],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)m=m.concat(ol({key:`${r}[${g}]`,value:t[g],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":h=Mt(t[1]),t.length!==2?m.push(new Pe(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new Pe(`${r}[1]`,t[1],`string expected, ${h} found`))}return m}function Ru(n,t){const r=n.key,a=n.validateSpec,h=n.style,m=n.styleSpec,g=n.value,_=n.objectKey,w=m[`${t}_${n.layerType}`];if(!w)return[];const k=_.match(/^(.*)-transition$/);if(t==="paint"&&k&&w[k[1]]&&w[k[1]].transition)return a({key:r,value:g,valueSpec:m.transition,style:h,styleSpec:m});const E=n.valueSpec||w[_];if(!E)return[new Pe(r,g,`unknown property "${_}"`)];let P;if(Mt(g)==="string"&&Ko(E)&&!E.tokens&&(P=/^{([^}]+)}$/.exec(g)))return[new Pe(r,g,`"${_}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(P[1])} }\`.`)];const A=[];return n.layerType==="symbol"&&(_==="text-field"&&h&&!h.glyphs&&A.push(new Pe(r,g,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&Ja(Kn(g))&&ai(g.type)==="identity"&&A.push(new Pe(r,g,'"text-font" does not support identity functions'))),A.concat(a({key:n.key,value:g,valueSpec:E,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:_}))}function sl(n){return Ru(n,"paint")}function Fu(n){return Ru(n,"layout")}function Bu(n){let t=[];const r=n.value,a=n.key,h=n.style,m=n.styleSpec;r.type||r.ref||t.push(new Pe(a,r,'either "type" or "ref" is required'));let g=ai(r.type);const _=ai(r.ref);if(r.id){const w=ai(r.id);for(let k=0;k<n.arrayIndex;k++){const E=h.layers[k];ai(E.id)===w&&t.push(new Pe(a,r.id,`duplicate layer id "${r.id}", previously used at line ${E.id.__line__}`))}}if("ref"in r){let w;["type","source","source-layer","filter","layout"].forEach(k=>{k in r&&t.push(new Pe(a,r[k],`"${k}" is prohibited for ref layers`))}),h.layers.forEach(k=>{ai(k.id)===_&&(w=k)}),w?w.ref?t.push(new Pe(a,r.ref,"ref cannot reference another ref layer")):g=ai(w.type):t.push(new Pe(a,r.ref,`ref layer "${_}" not found`))}else if(g!=="background")if(r.source){const w=h.sources&&h.sources[r.source],k=w&&ai(w.type);w?k==="vector"&&g==="raster"?t.push(new Pe(a,r.source,`layer "${r.id}" requires a raster source`)):k!=="raster-dem"&&g==="hillshade"?t.push(new Pe(a,r.source,`layer "${r.id}" requires a raster-dem source`)):k==="raster"&&g!=="raster"?t.push(new Pe(a,r.source,`layer "${r.id}" requires a vector source`)):k!=="vector"||r["source-layer"]?k==="raster-dem"&&g!=="hillshade"?t.push(new Pe(a,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!r.paint||!r.paint["line-gradient"]||k==="geojson"&&w.lineMetrics||t.push(new Pe(a,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Pe(a,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Pe(a,r.source,`source "${r.source}" not found`))}else t.push(new Pe(a,r,'missing required property "source"'));return t=t.concat(xn({key:a,value:r,valueSpec:m.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${a}.type`,value:r.type,valueSpec:m.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:r,objectKey:"type"}),filter:Lu,layout:w=>xn({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":k=>Fu(pr({layerType:g},k))}}),paint:w=>xn({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":k=>sl(pr({layerType:g},k))}})}})),t}function bo(n){const t=n.value,r=n.key,a=Mt(t);return a!=="string"?[new Pe(r,t,`string expected, ${a} found`)]:[]}const al={promoteId:function({key:n,value:t}){if(Mt(t)==="string")return bo({key:n,value:t});{const r=[];for(const a in t)r.push(...bo({key:`${n}.${a}`,value:t[a]}));return r}}};function la(n){const t=n.value,r=n.key,a=n.styleSpec,h=n.style,m=n.validateSpec;if(!t.type)return[new Pe(r,t,'"type" is required')];const g=ai(t.type);let _;switch(g){case"vector":case"raster":return _=xn({key:r,value:t,valueSpec:a[`source_${g.replace("-","_")}`],style:n.style,styleSpec:a,objectElementValidators:al,validateSpec:m}),_;case"raster-dem":return _=function(w){var k;const E=(k=w.sourceName)!==null&&k!==void 0?k:"",P=w.value,A=w.styleSpec,R=A.source_raster_dem,j=w.style;let O=[];const G=Mt(P);if(P===void 0)return O;if(G!=="object")return O.push(new Pe("source_raster_dem",P,`object expected, ${G} found`)),O;const J=ai(P.encoding)==="custom",pe=["redFactor","greenFactor","blueFactor","baseShift"],re=w.value.encoding?`"${w.value.encoding}"`:"Default";for(const he in P)!J&&pe.includes(he)?O.push(new Pe(he,P[he],`In "${E}": "${he}" is only valid when "encoding" is set to "custom". ${re} encoding found`)):R[he]?O=O.concat(w.validateSpec({key:he,value:P[he],valueSpec:R[he],validateSpec:w.validateSpec,style:j,styleSpec:A})):O.push(new Pe(he,P[he],`unknown property "${he}"`));return O}({sourceName:r,value:t,style:n.style,styleSpec:a,validateSpec:m}),_;case"geojson":if(_=xn({key:r,value:t,valueSpec:a.source_geojson,style:h,styleSpec:a,validateSpec:m,objectElementValidators:al}),t.cluster)for(const w in t.clusterProperties){const[k,E]=t.clusterProperties[w],P=typeof k=="string"?[k,["accumulated"],["get",w]]:k;_.push(...is({key:`${r}.${w}.map`,value:E,validateSpec:m,expressionContext:"cluster-map"})),_.push(...is({key:`${r}.${w}.reduce`,value:P,validateSpec:m,expressionContext:"cluster-reduce"}))}return _;case"video":return xn({key:r,value:t,valueSpec:a.source_video,style:h,validateSpec:m,styleSpec:a});case"image":return xn({key:r,value:t,valueSpec:a.source_image,style:h,validateSpec:m,styleSpec:a});case"canvas":return[new Pe(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Dr({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,validateSpec:m,styleSpec:a})}}function ju(n){const t=n.value,r=n.styleSpec,a=r.light,h=n.style;let m=[];const g=Mt(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new Pe("light",t,`object expected, ${g} found`)]),m;for(const _ in t){const w=_.match(/^(.*)-transition$/);m=m.concat(w&&a[w[1]]&&a[w[1]].transition?n.validateSpec({key:_,value:t[_],valueSpec:r.transition,validateSpec:n.validateSpec,style:h,styleSpec:r}):a[_]?n.validateSpec({key:_,value:t[_],valueSpec:a[_],validateSpec:n.validateSpec,style:h,styleSpec:r}):[new Pe(_,t[_],`unknown property "${_}"`)])}return m}function Ou(n){const t=n.value,r=n.styleSpec,a=r.sky,h=n.style,m=Mt(t);if(t===void 0)return[];if(m!=="object")return[new Pe("sky",t,`object expected, ${m} found`)];let g=[];for(const _ in t)g=g.concat(a[_]?n.validateSpec({key:_,value:t[_],valueSpec:a[_],style:h,styleSpec:r}):[new Pe(_,t[_],`unknown property "${_}"`)]);return g}function Nu(n){const t=n.value,r=n.styleSpec,a=r.terrain,h=n.style;let m=[];const g=Mt(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new Pe("terrain",t,`object expected, ${g} found`)]),m;for(const _ in t)m=m.concat(a[_]?n.validateSpec({key:_,value:t[_],valueSpec:a[_],validateSpec:n.validateSpec,style:h,styleSpec:r}):[new Pe(_,t[_],`unknown property "${_}"`)]);return m}function Vu(n){let t=[];const r=n.value,a=n.key;if(Array.isArray(r)){const h=[],m=[];for(const g in r)r[g].id&&h.includes(r[g].id)&&t.push(new Pe(a,r,`all the sprites' ids must be unique, but ${r[g].id} is duplicated`)),h.push(r[g].id),r[g].url&&m.includes(r[g].url)&&t.push(new Pe(a,r,`all the sprites' URLs must be unique, but ${r[g].url} is duplicated`)),m.push(r[g].url),t=t.concat(xn({key:`${a}[${g}]`,value:r[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return t}return bo({key:a,value:r})}const ll={"*":()=>[],array:aa,boolean:function(n){const t=n.value,r=n.key,a=Mt(t);return a!=="boolean"?[new Pe(r,t,`boolean expected, ${a} found`)]:[]},number:Du,color:function(n){const t=n.key,r=n.value,a=Mt(r);return a!=="string"?[new Pe(t,r,`color expected, ${a} found`)]:Ot.parse(String(r))?[]:[new Pe(t,r,`color expected, "${r}" found`)]},constants:Lh,enum:Dr,filter:Lu,function:rl,layer:Bu,object:xn,source:la,light:ju,sky:Ou,terrain:Nu,projection:function(n){const t=n.value,r=n.styleSpec,a=r.projection,h=n.style,m=Mt(t);if(t===void 0)return[];if(m!=="object")return[new Pe("projection",t,`object expected, ${m} found`)];let g=[];for(const _ in t)g=g.concat(a[_]?n.validateSpec({key:_,value:t[_],valueSpec:a[_],style:h,styleSpec:r}):[new Pe(_,t[_],`unknown property "${_}"`)]);return g},string:bo,formatted:function(n){return bo(n).length===0?[]:is(n)},resolvedImage:function(n){return bo(n).length===0?[]:is(n)},padding:function(n){const t=n.key,r=n.value;if(Mt(r)==="array"){if(r.length<1||r.length>4)return[new Pe(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const a={type:"number"};let h=[];for(let m=0;m<r.length;m++)h=h.concat(n.validateSpec({key:`${t}[${m}]`,value:r[m],validateSpec:n.validateSpec,valueSpec:a}));return h}return Du({key:t,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(n){const t=n.key,r=n.value,a=Mt(r),h=n.styleSpec;if(a!=="array"||r.length<1||r.length%2!=0)return[new Pe(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let g=0;g<r.length;g+=2)m=m.concat(Dr({key:`${t}[${g}]`,value:r[g],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(aa({key:`${t}[${g+1}]`,value:r[g+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:h}));return m},sprite:Vu};function ns(n){const t=n.value,r=n.valueSpec,a=n.styleSpec;return n.validateSpec=ns,r.expression&&Ja(ai(t))?rl(n):r.expression&&el(Kn(t))?is(n):r.type&&ll[r.type]?ll[r.type](n):xn(pr({},n,{valueSpec:r.type?a[r.type]:r}))}function Rh(n){const t=n.value,r=n.key,a=bo(n);return a.length||(t.indexOf("{fontstack}")===-1&&a.push(new Pe(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&a.push(new Pe(r,t,'"glyphs" url must include a "{range}" token'))),a}function An(n,t=ye){let r=[];return r=r.concat(ns({key:"",value:n,valueSpec:t.$root,styleSpec:t,style:n,validateSpec:ns,objectElementValidators:{glyphs:Rh,"*":()=>[]}})),n.constants&&(r=r.concat(Lh({key:"constants",value:n.constants,style:n,styleSpec:t,validateSpec:ns}))),Uu(r)}function _r(n){return function(t){return n({...t,validateSpec:ns})}}function Uu(n){return[].concat(n).sort((t,r)=>t.line-r.line)}function Jn(n){return function(...t){return Uu(n.apply(this,t))}}An.source=Jn(_r(la)),An.sprite=Jn(_r(Vu)),An.glyphs=Jn(_r(Rh)),An.light=Jn(_r(ju)),An.sky=Jn(_r(Ou)),An.terrain=Jn(_r(Nu)),An.layer=Jn(_r(Bu)),An.filter=Jn(_r(Lu)),An.paintProperty=Jn(_r(sl)),An.layoutProperty=Jn(_r(Fu));const So=An,Jp=So.light,Yp=So.sky,Fh=So.paintProperty,Bh=So.layoutProperty;function $u(n,t){let r=!1;if(t&&t.length)for(const a of t)n.fire(new qr(new Error(a.message))),r=!0;return r}class rs{constructor(t,r,a){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const g=new Int32Array(this.arrayBuffer);t=g[0],this.d=(r=g[1])+2*(a=g[2]);for(let w=0;w<this.d*this.d;w++){const k=g[3+w],E=g[3+w+1];h.push(k===E?null:g.subarray(k,E))}const _=g[3+h.length+1];this.keys=g.subarray(g[3+h.length],_),this.bboxes=g.subarray(_),this.insert=this._insertReadonly}else{this.d=r+2*a;for(let g=0;g<this.d*this.d;g++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=a,this.scale=r/t,this.uid=0;const m=a/r*t;this.min=-m,this.max=t+m}insert(t,r,a,h,m){this._forEachCell(r,a,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,a,h,m,g){this.cells[m].push(g)}query(t,r,a,h,m){const g=this.min,_=this.max;if(t<=g&&r<=g&&_<=a&&_<=h&&!m)return Array.prototype.slice.call(this.keys);{const w=[];return this._forEachCell(t,r,a,h,this._queryCell,w,{},m),w}}_queryCell(t,r,a,h,m,g,_,w){const k=this.cells[m];if(k!==null){const E=this.keys,P=this.bboxes;for(let A=0;A<k.length;A++){const R=k[A];if(_[R]===void 0){const j=4*R;(w?w(P[j+0],P[j+1],P[j+2],P[j+3]):t<=P[j+2]&&r<=P[j+3]&&a>=P[j+0]&&h>=P[j+1])?(_[R]=!0,g.push(E[R])):_[R]=!1}}}}_forEachCell(t,r,a,h,m,g,_,w){const k=this._convertToCellCoord(t),E=this._convertToCellCoord(r),P=this._convertToCellCoord(a),A=this._convertToCellCoord(h);for(let R=k;R<=P;R++)for(let j=E;j<=A;j++){const O=this.d*j+R;if((!w||w(this._convertFromCellCoord(R),this._convertFromCellCoord(j),this._convertFromCellCoord(R+1),this._convertFromCellCoord(j+1)))&&m.call(this,t,r,a,h,O,g,_,w))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let a=0;for(let g=0;g<this.cells.length;g++)a+=this.cells[g].length;const h=new Int32Array(r+a+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=r;for(let g=0;g<t.length;g++){const _=t[g];h[3+g]=m,h.set(_,m),m+=_.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,r){const a=t.toArrayBuffer();return r&&r.push(a),{buffer:a}}static deserialize(t){return new rs(t.buffer)}}const Dn={};function qe(n,t,r={}){if(Dn[n])throw new Error(`${n} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:n,writeable:!1}),Dn[n]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}qe("Object",Object),qe("TransferableGridIndex",rs),qe("Color",Ot),qe("Error",Error),qe("AJAXError",bi),qe("ResolvedImage",vn),qe("StylePropertyFunction",ts),qe("StyleExpression",Qa,{omit:["_evaluator"]}),qe("ZoomDependentExpression",es),qe("ZoomConstantExpression",Qo),qe("CompoundExpression",zn,{omit:["_evaluate"]});for(const n in Ho)Ho[n]._classRegistryKey||qe(`Expression_${n}`,Ho[n]);function ul(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Zu(n){return n.$name||n.constructor._classRegistryKey}function jh(n){return!function(t){if(t===null||typeof t!="object")return!1;const r=Zu(t);return!(!r||r==="Object")}(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||ul(n)||en(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function os(n,t){if(jh(n))return(ul(n)||en(n))&&t&&t.push(n),ArrayBuffer.isView(n)&&t&&t.push(n.buffer),n instanceof ImageData&&t&&t.push(n.data.buffer),n;if(Array.isArray(n)){const m=[];for(const g of n)m.push(os(g,t));return m}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const r=Zu(n);if(!r)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!Dn[r])throw new Error(`${r} is not registered.`);const{klass:a}=Dn[r],h=a.serialize?a.serialize(n,t):{};if(a.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in n){if(!n.hasOwnProperty(m)||Dn[r].omit.indexOf(m)>=0)continue;const g=n[m];h[m]=Dn[r].shallow.indexOf(m)>=0?g:os(g,t)}n instanceof Error&&(h.message=n.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(h.$name=r),h}function ss(n){if(jh(n))return n;if(Array.isArray(n))return n.map(ss);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const t=Zu(n)||"Object";if(!Dn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=Dn[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(n);const a=Object.create(r.prototype);for(const h of Object.keys(n)){if(h==="$name")continue;const m=n[h];a[h]=Dn[t].shallow.indexOf(h)>=0?m:ss(m)}return a}class qu{constructor(){this.first=!0}update(t,r){const a=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=a,!0))}}const Tt={"Latin-1 Supplement":n=>n>=128&&n<=255,"Hangul Jamo":n=>n>=4352&&n<=4607,Khmer:n=>n>=6016&&n<=6143,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Katakana:n=>n>=12448&&n<=12543,Kanbun:n=>n>=12688&&n<=12703,"CJK Strokes":n=>n>=12736&&n<=12783,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"Private Use Area":n=>n>=57344&&n<=63743,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function Gu(n){for(const t of n)if(Wu(t.charCodeAt(0)))return!0;return!1}function Qp(n){for(const t of n)if(!as(t.charCodeAt(0)))return!1;return!0}function Hu(n){const t=n.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(t.join("|"),"u")}const ef=Hu(["Arab","Dupl","Mong","Ougr","Syrc"]);function as(n){return!ef.test(String.fromCodePoint(n))}const Oh=Hu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Wu(n){return!(n!==746&&n!==747&&(n<4352||!(Tt["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||Tt["CJK Compatibility"](n)||Tt["CJK Strokes"](n)||!(!Tt["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||Tt["Enclosed CJK Letters and Months"](n)||Tt["Ideographic Description Characters"](n)||Tt.Kanbun(n)||Tt.Katakana(n)&&n!==12540||!(!Tt["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!Tt["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||Tt["Vertical Forms"](n)||Tt["Yijing Hexagram Symbols"](n)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(n))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(n))||Oh.test(String.fromCodePoint(n)))))}function Nh(n){return!(Wu(n)||function(t){return!!(Tt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Tt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Tt["Letterlike Symbols"](t)||Tt["Number Forms"](t)||Tt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Tt["Control Pictures"](t)&&t!==9251||Tt["Optical Character Recognition"](t)||Tt["Enclosed Alphanumerics"](t)||Tt["Geometric Shapes"](t)||Tt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Tt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Tt["CJK Symbols and Punctuation"](t)||Tt.Katakana(t)||Tt["Private Use Area"](t)||Tt["CJK Compatibility Forms"](t)||Tt["Small Form Variants"](t)||Tt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(n))}const tf=Hu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Xu(n){return tf.test(String.fromCodePoint(n))}function nf(n,t){return!(!t&&Xu(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||Tt.Khmer(n))}function rf(n){for(const t of n)if(Xu(t.charCodeAt(0)))return!0;return!1}const wn=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Ht{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new qu,this.transition={})}isSupportedScript(t){return function(r,a){for(const h of r)if(!nf(h.charCodeAt(0),a))return!1;return!0}(t,wn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),a=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*r}}}class ls{constructor(t,r){this.property=t,this.value=r,this.expression=function(a,h){if(Ja(a))return new ts(a,h);if(el(a)){const m=Mu(a,h);if(m.result==="error")throw new Error(m.value.map(g=>`${g.key}: ${g.message}`).join(", "));return m.value}{let m=a;return h.type==="color"&&typeof a=="string"?m=Ot.parse(a):h.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(a)&&(m=Mn.parse(a)):m=_n.parse(a),{kind:"constant",evaluate:()=>m}}}(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,a){return this.property.possiblyEvaluate(this,t,r,a)}}class cl{constructor(t){this.property=t,this.value=new ls(t,void 0)}transitioned(t,r){return new Vh(this.property,this.value,r,He({},t.transition,this.transition),t.now)}untransitioned(){return new Vh(this.property,this.value,null,{},0)}}class hl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return xt(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new cl(this._values[t].property)),this._values[t].value=new ls(this._values[t].property,r===null?void 0:xt(r))}getTransition(t){return xt(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new cl(this._values[t].property)),this._values[t].transition=xt(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(t[r]=a);const h=this.getTransition(r);h!==void 0&&(t[`${r}-transition`]=h)}return t}transitioned(t,r){const a=new ua(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(t,r._values[h]);return a}untransitioned(){const t=new ua(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class Vh{constructor(t,r,a,h,m){this.property=t,this.value=r,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(t,r,a){const h=t.now||0,m=this.value.possiblyEvaluate(t,r,a),g=this.prior;if(g){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return g.possiblyEvaluate(t,r,a);{const _=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,r,a),m,function(w){if(w<=0)return 0;if(w>=1)return 1;const k=w*w,E=k*w;return 4*(w<.5?E:3*(w-k)+E-.75)}(_))}}return m}}class ua{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,a){const h=new ha(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,r,a);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ca{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return xt(this._values[t].value)}setValue(t,r){this._values[t]=new ls(this._values[t].property,r===null?void 0:xt(r))}serialize(){const t={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(t[r]=a)}return t}possiblyEvaluate(t,r,a){const h=new ha(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,r,a);return h}}class vr{constructor(t,r,a){this.property=t,this.value=r,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,a,h){return this.property.evaluate(this.value,this.parameters,t,r,a,h)}}class ha{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Xe{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,a){const h=on[this.specification.type];return h?h(t,r,a):t}}class at{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,a,h){return new vr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},a,h)}:t.expression,r)}interpolate(t,r,a){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new vr(this,{kind:"constant",value:void 0},t.parameters);const h=on[this.specification.type];if(h){const m=h(t.value.value,r.value.value,a);return new vr(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,r,a,h,m,g){return t.kind==="constant"?t.value:t.evaluate(r,a,h,m,g)}}class dl extends at{possiblyEvaluate(t,r,a,h){if(t.value===void 0)return new vr(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const m=t.expression.evaluate(r,null,{},a,h),g=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,_=this._calculate(g,g,g,r);return new vr(this,{kind:"constant",value:_},r)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new vr(this,{kind:"constant",value:m},r)}return new vr(this,t.expression,r)}evaluate(t,r,a,h,m,g){if(t.kind==="source"){const _=t.evaluate(r,a,h,m,g);return this._calculate(_,_,_,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},a,h),t.evaluate({zoom:Math.floor(r.zoom)},a,h),t.evaluate({zoom:Math.floor(r.zoom)+1},a,h),r):t.value}_calculate(t,r,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:a,to:r}}interpolate(t){return t}}class pl{constructor(t){this.specification=t}possiblyEvaluate(t,r,a,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(r,null,{},a,h);return this._calculate(m,m,m,r)}return this._calculate(t.expression.evaluate(new Ht(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Ht(Math.floor(r.zoom),r)),t.expression.evaluate(new Ht(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:a,to:r}}interpolate(t){return t}}class Ku{constructor(t){this.specification=t}possiblyEvaluate(t,r,a,h){return!!t.expression.evaluate(r,null,{},a,h)}interpolate(){return!1}}class f{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const a=t[r];a.specification.overridable&&this.overridableProperties.push(r);const h=this.defaultPropertyValues[r]=new ls(a,void 0),m=this.defaultTransitionablePropertyValues[r]=new cl(a);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}}}qe("DataDrivenProperty",at),qe("DataConstantProperty",Xe),qe("CrossFadedDataDrivenProperty",dl),qe("CrossFadedProperty",pl),qe("ColorRampProperty",Ku);const e="-transition";class s extends Oo{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new ca(r.layout)),r.paint)){this._transitionablePaint=new hl(r.paint);for(const a in t.paint)this.setPaintProperty(a,t.paint[a],{validate:!1});for(const a in t.layout)this.setLayoutProperty(a,t.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ha(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,a={}){r!=null&&this._validate(Bh,`layers.${this.id}.layout.${t}`,t,r,a)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(e)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,a={}){if(r!=null&&this._validate(Fh,`layers.${this.id}.paint.${t}`,t,r,a))return!1;if(t.endsWith(e))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",g=h.value.isDataDriven(),_=h.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const w=this._transitionablePaint._values[t].value;return w.isDataDriven()||g||m||this._handleOverridablePaintPropertyUpdate(t,_,w)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,a){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),vt(t,(r,a)=>!(r===void 0||a==="layout"&&!Object.keys(r).length||a==="paint"&&!Object.keys(r).length))}_validate(t,r,a,h,m={}){return(!m||m.validate!==!1)&&$u(this,t.call(So,{key:r,layerType:this.type,objectKey:a,value:h,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof vr&&Ko(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const l={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class u{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class p{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function v(n,t=1){let r=0,a=0;return{members:n.map(h=>{const m=l[h.type].BYTES_PER_ELEMENT,g=r=b(r,Math.max(t,m)),_=h.components||1;return a=Math.max(a,m),r+=m*_,{name:h.name,type:h.type,components:_,offset:g}}),size:b(r,Math.max(a,t)),alignment:t}}function b(n,t){return Math.ceil(n/t)*t}class I extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const a=this.length;return this.resize(a+1),this.emplace(a,t,r)}emplace(t,r,a){const h=2*t;return this.int16[h+0]=r,this.int16[h+1]=a,t}}I.prototype.bytesPerElement=4,qe("StructArrayLayout2i4",I);class C extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,a)}emplace(t,r,a,h){const m=3*t;return this.int16[m+0]=r,this.int16[m+1]=a,this.int16[m+2]=h,t}}C.prototype.bytesPerElement=6,qe("StructArrayLayout3i6",C);class M extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,a,h)}emplace(t,r,a,h,m){const g=4*t;return this.int16[g+0]=r,this.int16[g+1]=a,this.int16[g+2]=h,this.int16[g+3]=m,t}}M.prototype.bytesPerElement=8,qe("StructArrayLayout4i8",M);class z extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,r,a,h,m,g)}emplace(t,r,a,h,m,g,_){const w=6*t;return this.int16[w+0]=r,this.int16[w+1]=a,this.int16[w+2]=h,this.int16[w+3]=m,this.int16[w+4]=g,this.int16[w+5]=_,t}}z.prototype.bytesPerElement=12,qe("StructArrayLayout2i4i12",z);class F extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,r,a,h,m,g)}emplace(t,r,a,h,m,g,_){const w=4*t,k=8*t;return this.int16[w+0]=r,this.int16[w+1]=a,this.uint8[k+4]=h,this.uint8[k+5]=m,this.uint8[k+6]=g,this.uint8[k+7]=_,t}}F.prototype.bytesPerElement=8,qe("StructArrayLayout2i4ub8",F);class N extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const a=this.length;return this.resize(a+1),this.emplace(a,t,r)}emplace(t,r,a){const h=2*t;return this.float32[h+0]=r,this.float32[h+1]=a,t}}N.prototype.bytesPerElement=8,qe("StructArrayLayout2f8",N);class $ extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g,_,w,k,E){const P=this.length;return this.resize(P+1),this.emplace(P,t,r,a,h,m,g,_,w,k,E)}emplace(t,r,a,h,m,g,_,w,k,E,P){const A=10*t;return this.uint16[A+0]=r,this.uint16[A+1]=a,this.uint16[A+2]=h,this.uint16[A+3]=m,this.uint16[A+4]=g,this.uint16[A+5]=_,this.uint16[A+6]=w,this.uint16[A+7]=k,this.uint16[A+8]=E,this.uint16[A+9]=P,t}}$.prototype.bytesPerElement=20,qe("StructArrayLayout10ui20",$);class W extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g,_,w,k,E,P,A){const R=this.length;return this.resize(R+1),this.emplace(R,t,r,a,h,m,g,_,w,k,E,P,A)}emplace(t,r,a,h,m,g,_,w,k,E,P,A,R){const j=12*t;return this.int16[j+0]=r,this.int16[j+1]=a,this.int16[j+2]=h,this.int16[j+3]=m,this.uint16[j+4]=g,this.uint16[j+5]=_,this.uint16[j+6]=w,this.uint16[j+7]=k,this.int16[j+8]=E,this.int16[j+9]=P,this.int16[j+10]=A,this.int16[j+11]=R,t}}W.prototype.bytesPerElement=24,qe("StructArrayLayout4i4ui4i24",W);class Y extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,a)}emplace(t,r,a,h){const m=3*t;return this.float32[m+0]=r,this.float32[m+1]=a,this.float32[m+2]=h,t}}Y.prototype.bytesPerElement=12,qe("StructArrayLayout3f12",Y);class Q extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}Q.prototype.bytesPerElement=4,qe("StructArrayLayout1ul4",Q);class ie extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g,_,w,k){const E=this.length;return this.resize(E+1),this.emplace(E,t,r,a,h,m,g,_,w,k)}emplace(t,r,a,h,m,g,_,w,k,E){const P=10*t,A=5*t;return this.int16[P+0]=r,this.int16[P+1]=a,this.int16[P+2]=h,this.int16[P+3]=m,this.int16[P+4]=g,this.int16[P+5]=_,this.uint32[A+3]=w,this.uint16[P+8]=k,this.uint16[P+9]=E,t}}ie.prototype.bytesPerElement=20,qe("StructArrayLayout6i1ul2ui20",ie);class q extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,r,a,h,m,g)}emplace(t,r,a,h,m,g,_){const w=6*t;return this.int16[w+0]=r,this.int16[w+1]=a,this.int16[w+2]=h,this.int16[w+3]=m,this.int16[w+4]=g,this.int16[w+5]=_,t}}q.prototype.bytesPerElement=12,qe("StructArrayLayout2i2i2i12",q);class se extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,a,h,m)}emplace(t,r,a,h,m,g){const _=4*t,w=8*t;return this.float32[_+0]=r,this.float32[_+1]=a,this.float32[_+2]=h,this.int16[w+6]=m,this.int16[w+7]=g,t}}se.prototype.bytesPerElement=16,qe("StructArrayLayout2f1f2i16",se);class ce extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,r,a,h,m,g)}emplace(t,r,a,h,m,g,_){const w=16*t,k=4*t,E=8*t;return this.uint8[w+0]=r,this.uint8[w+1]=a,this.float32[k+1]=h,this.float32[k+2]=m,this.int16[E+6]=g,this.int16[E+7]=_,t}}ce.prototype.bytesPerElement=16,qe("StructArrayLayout2ub2f2i16",ce);class fe extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,a)}emplace(t,r,a,h){const m=3*t;return this.uint16[m+0]=r,this.uint16[m+1]=a,this.uint16[m+2]=h,t}}fe.prototype.bytesPerElement=6,qe("StructArrayLayout3ui6",fe);class we extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g,_,w,k,E,P,A,R,j,O,G,J){const pe=this.length;return this.resize(pe+1),this.emplace(pe,t,r,a,h,m,g,_,w,k,E,P,A,R,j,O,G,J)}emplace(t,r,a,h,m,g,_,w,k,E,P,A,R,j,O,G,J,pe){const re=24*t,he=12*t,_e=48*t;return this.int16[re+0]=r,this.int16[re+1]=a,this.uint16[re+2]=h,this.uint16[re+3]=m,this.uint32[he+2]=g,this.uint32[he+3]=_,this.uint32[he+4]=w,this.uint16[re+10]=k,this.uint16[re+11]=E,this.uint16[re+12]=P,this.float32[he+7]=A,this.float32[he+8]=R,this.uint8[_e+36]=j,this.uint8[_e+37]=O,this.uint8[_e+38]=G,this.uint32[he+10]=J,this.int16[re+22]=pe,t}}we.prototype.bytesPerElement=48,qe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",we);class Ce extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,a,h,m,g,_,w,k,E,P,A,R,j,O,G,J,pe,re,he,_e,Te,Ve,st,Oe,Fe,Qe,Ge){const Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,t,r,a,h,m,g,_,w,k,E,P,A,R,j,O,G,J,pe,re,he,_e,Te,Ve,st,Oe,Fe,Qe,Ge)}emplace(t,r,a,h,m,g,_,w,k,E,P,A,R,j,O,G,J,pe,re,he,_e,Te,Ve,st,Oe,Fe,Qe,Ge,Ze){const xe=32*t,et=16*t;return this.int16[xe+0]=r,this.int16[xe+1]=a,this.int16[xe+2]=h,this.int16[xe+3]=m,this.int16[xe+4]=g,this.int16[xe+5]=_,this.int16[xe+6]=w,this.int16[xe+7]=k,this.uint16[xe+8]=E,this.uint16[xe+9]=P,this.uint16[xe+10]=A,this.uint16[xe+11]=R,this.uint16[xe+12]=j,this.uint16[xe+13]=O,this.uint16[xe+14]=G,this.uint16[xe+15]=J,this.uint16[xe+16]=pe,this.uint16[xe+17]=re,this.uint16[xe+18]=he,this.uint16[xe+19]=_e,this.uint16[xe+20]=Te,this.uint16[xe+21]=Ve,this.uint16[xe+22]=st,this.uint32[et+12]=Oe,this.float32[et+13]=Fe,this.float32[et+14]=Qe,this.uint16[xe+30]=Ge,this.uint16[xe+31]=Ze,t}}Ce.prototype.bytesPerElement=64,qe("StructArrayLayout8i15ui1ul2f2ui64",Ce);class Be extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}Be.prototype.bytesPerElement=4,qe("StructArrayLayout1f4",Be);class Ue extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,a)}emplace(t,r,a,h){const m=3*t;return this.uint16[6*t+0]=r,this.float32[m+1]=a,this.float32[m+2]=h,t}}Ue.prototype.bytesPerElement=12,qe("StructArrayLayout1ui2f12",Ue);class De extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,a)}emplace(t,r,a,h){const m=4*t;return this.uint32[2*t+0]=r,this.uint16[m+2]=a,this.uint16[m+3]=h,t}}De.prototype.bytesPerElement=8,qe("StructArrayLayout1ul2ui8",De);class Ae extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const a=this.length;return this.resize(a+1),this.emplace(a,t,r)}emplace(t,r,a){const h=2*t;return this.uint16[h+0]=r,this.uint16[h+1]=a,t}}Ae.prototype.bytesPerElement=4,qe("StructArrayLayout2ui4",Ae);class Ke extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}Ke.prototype.bytesPerElement=2,qe("StructArrayLayout1ui2",Ke);class ht extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,a,h)}emplace(t,r,a,h,m){const g=4*t;return this.float32[g+0]=r,this.float32[g+1]=a,this.float32[g+2]=h,this.float32[g+3]=m,t}}ht.prototype.bytesPerElement=16,qe("StructArrayLayout4f16",ht);class Re extends u{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new X(this.anchorPointX,this.anchorPointY)}}Re.prototype.size=20;class Ne extends ie{get(t){return new Re(this,t)}}qe("CollisionBoxArray",Ne);class ut extends u{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ut.prototype.size=48;class Wt extends we{get(t){return new ut(this,t)}}qe("PlacedSymbolArray",Wt);class gt extends u{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}gt.prototype.size=64;class St extends Ce{get(t){return new gt(this,t)}}qe("SymbolInstanceArray",St);class Xt extends Be{getoffsetX(t){return this.float32[1*t+0]}}qe("GlyphOffsetArray",Xt);class Fi extends C{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}qe("SymbolLineVertexArray",Fi);class Yn extends u{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Yn.prototype.size=12;class Kt extends Ue{get(t){return new Yn(this,t)}}qe("TextAnchorOffsetArray",Kt);class an extends u{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}an.prototype.size=8;class Hi extends De{get(t){return new an(this,t)}}qe("FeatureIndexArray",Hi);class Bi extends I{}class Wi extends I{}class xr extends I{}class us extends z{}class fl extends F{}class cs extends N{}class Ln extends ${}class ml extends W{}class Ju extends Y{}class Rn extends Q{}class Fn extends q{}class Jr extends ce{}class Qn extends fe{}class Mi extends Ae{}const ji=v([{name:"a_pos",components:2,type:"Int16"}],4),{members:bn}=ji;class It{constructor(t=[]){this.segments=t}prepareSegment(t,r,a,h){let m=this.segments[this.segments.length-1];return t>It.MAX_VERTEX_ARRAY_LENGTH&&oi(`Max vertices per segment is ${It.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!m||m.vertexLength+t>It.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:r.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,a,h){return new It([{vertexOffset:t,primitiveOffset:r,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}function To(n,t){return 256*(n=je(Math.floor(n),0,255))+je(Math.floor(t),0,255)}It.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,qe("SegmentVector",It);const hs=v([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ds={exports:{}},Uh={exports:{}};Uh.exports=function(n,t){var r,a,h,m,g,_,w,k;for(a=n.length-(r=3&n.length),h=t,g=3432918353,_=461845907,k=0;k<a;)w=255&n.charCodeAt(k)|(255&n.charCodeAt(++k))<<8|(255&n.charCodeAt(++k))<<16|(255&n.charCodeAt(++k))<<24,++k,h=27492+(65535&(m=5*(65535&(h=(h^=w=(65535&(w=(w=(65535&w)*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*_+(((w>>>16)*_&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(w=0,r){case 3:w^=(255&n.charCodeAt(k+2))<<16;case 2:w^=(255&n.charCodeAt(k+1))<<8;case 1:h^=w=(65535&(w=(w=(65535&(w^=255&n.charCodeAt(k)))*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*_+(((w>>>16)*_&65535)<<16)&4294967295}return h^=n.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var of=Uh.exports,$h={exports:{}};$h.exports=function(n,t){for(var r,a=n.length,h=t^a,m=0;a>=4;)r=1540483477*(65535&(r=255&n.charCodeAt(m)|(255&n.charCodeAt(++m))<<8|(255&n.charCodeAt(++m))<<16|(255&n.charCodeAt(++m))<<24))+((1540483477*(r>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:h^=(255&n.charCodeAt(m+2))<<16;case 2:h^=(255&n.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&n.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Yr=of,Zh=$h.exports;ds.exports=Yr,ds.exports.murmur3=Yr,ds.exports.murmur2=Zh;var gl=U(ds.exports);class da{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,a,h){this.ids.push(yl(t)),this.positions.push(r,a,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=yl(t);let a=0,h=this.ids.length-1;for(;a<h;){const g=a+h>>1;this.ids[g]>=r?h=g:a=g+1}const m=[];for(;this.ids[a]===r;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(t,r){const a=new Float64Array(t.ids),h=new Uint32Array(t.positions);return _l(a,h,0,a.length-1),r&&r.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(t){const r=new da;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function yl(n){const t=+n;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:gl(String(n))}function _l(n,t,r,a){for(;r<a;){const h=n[r+a>>1];let m=r-1,g=a+1;for(;;){do m++;while(n[m]<h);do g--;while(n[g]>h);if(m>=g)break;ps(n,m,g),ps(t,3*m,3*g),ps(t,3*m+1,3*g+1),ps(t,3*m+2,3*g+2)}g-r<a-g?(_l(n,t,r,g),r=g+1):(_l(n,t,g+1,a),a=g)}}function ps(n,t,r){const a=n[t];n[t]=n[r],n[r]=a}qe("FeaturePositionMap",da);class pa{constructor(t,r){this.gl=t.gl,this.location=r}}class qh extends pa{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class fy extends pa{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class my extends pa{constructor(t,r){super(t,r),this.current=Ot.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const V1=new Float32Array(16);function sf(n){return[To(255*n.r,255*n.g),To(255*n.b,255*n.a)]}class Yu{constructor(t,r,a){this.value=t,this.uniformNames=r.map(h=>`u_${h}`),this.type=a}setUniform(t,r,a){t.set(a.constantOr(this.value))}getBinding(t,r,a){return this.type==="color"?new my(t,r):new qh(t,r)}}class vl{constructor(t,r){this.uniformNames=r.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,a,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,r,a){return a.substr(0,9)==="u_pattern"?new fy(t,r):new qh(t,r)}}class Io{constructor(t,r,a,h){this.expression=t,this.type=a,this.maxValue=0,this.paintVertexAttributes=r.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,r,a,h,m){const g=this.paintVertexArray.length,_=this.expression.evaluate(new Ht(0),r,{},h,[],m);this.paintVertexArray.resize(t),this._setPaintValue(g,t,_)}updatePaintArray(t,r,a,h){const m=this.expression.evaluate({zoom:0},a,h);this._setPaintValue(t,r,m)}_setPaintValue(t,r,a){if(this.type==="color"){const h=sf(a);for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Lr{constructor(t,r,a,h,m,g){this.expression=t,this.uniformNames=r.map(_=>`u_${_}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(_=>({name:`a_${_}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,r,a,h,m){const g=this.expression.evaluate(new Ht(this.zoom),r,{},h,[],m),_=this.expression.evaluate(new Ht(this.zoom+1),r,{},h,[],m),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,g,_)}updatePaintArray(t,r,a,h){const m=this.expression.evaluate({zoom:this.zoom},a,h),g=this.expression.evaluate({zoom:this.zoom+1},a,h);this._setPaintValue(t,r,m,g)}_setPaintValue(t,r,a,h){if(this.type==="color"){const m=sf(a),g=sf(h);for(let _=t;_<r;_++)this.paintVertexArray.emplace(_,m[0],m[1],g[0],g[1])}else{for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const a=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,h=je(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,r,a){return new qh(t,r)}}class fs{constructor(t,r,a,h,m,g){this.expression=t,this.type=r,this.useIntegerZoom=a,this.zoom=h,this.layerId=g,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,r,a){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,r.patterns&&r.patterns[this.layerId],a)}updatePaintArray(t,r,a,h,m){this._setPaintValues(t,r,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(t,r,a,h){if(!h||!a)return;const{min:m,mid:g,max:_}=a,w=h[m],k=h[g],E=h[_];if(w&&k&&E)for(let P=t;P<r;P++)this.zoomInPaintVertexArray.emplace(P,k.tl[0],k.tl[1],k.br[0],k.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],k.pixelRatio,w.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,k.tl[0],k.tl[1],k.br[0],k.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],k.pixelRatio,E.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,hs.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,hs.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class gy{constructor(t,r,a){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!a(m))continue;const g=t.paint.get(m);if(!(g instanceof vr&&Ko(g.property.specification)))continue;const _=U1(m,t.type),w=g.value,k=g.property.specification.type,E=g.property.useIntegerZoom,P=g.property.specification["property-type"],A=P==="cross-faded"||P==="cross-faded-data-driven";if(w.kind==="constant")this.binders[m]=A?new vl(w.value,_):new Yu(w.value,_,k),h.push(`/u_${m}`);else if(w.kind==="source"||A){const R=yy(m,k,"source");this.binders[m]=A?new fs(w,k,E,r,R,t.id):new Io(w,_,k,R),h.push(`/a_${m}`)}else{const R=yy(m,k,"composite");this.binders[m]=new Lr(w,_,k,E,r,R),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof Io||r instanceof Lr?r.maxValue:0}populatePaintArrays(t,r,a,h,m){for(const g in this.binders){const _=this.binders[g];(_ instanceof Io||_ instanceof Lr||_ instanceof fs)&&_.populatePaintArray(t,r,a,h,m)}}setConstantPatternPositions(t,r){for(const a in this.binders){const h=this.binders[a];h instanceof vl&&h.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,a,h,m){let g=!1;for(const _ in t){const w=r.getPositions(_);for(const k of w){const E=a.feature(k.index);for(const P in this.binders){const A=this.binders[P];if((A instanceof Io||A instanceof Lr||A instanceof fs)&&A.expression.isStateDependent===!0){const R=h.paint.get(P);A.expression=R.value,A.updatePaintArray(k.start,k.end,E,t[_],m),g=!0}}}}return g}defines(){const t=[];for(const r in this.binders){const a=this.binders[r];(a instanceof Yu||a instanceof vl)&&t.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof Io||a instanceof Lr)for(let h=0;h<a.paintVertexAttributes.length;h++)t.push(a.paintVertexAttributes[h].name);else if(a instanceof fs)for(let h=0;h<hs.members.length;h++)t.push(hs.members[h].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof Yu||a instanceof vl||a instanceof Lr)for(const h of a.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Yu||m instanceof vl||m instanceof Lr){for(const g of m.uniformNames)if(r[g]){const _=m.getBinding(t,r[g],g);a.push({name:g,property:h,binding:_})}}}return a}setUniforms(t,r,a,h){for(const{name:m,property:g,binding:_}of r)this.binders[g].setUniform(_,h,a.get(g),m)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const a=this.binders[r];if(t&&a instanceof fs){const h=t.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof Io||a instanceof Lr)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(t){for(const r in this.binders){const a=this.binders[r];(a instanceof Io||a instanceof Lr||a instanceof fs)&&a.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof Io||r instanceof Lr||r instanceof fs)&&r.destroy()}}}class fa{constructor(t,r,a=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new gy(h,r,a);this.needsUpload=!1,this._featureMap=new da,this._bufferOffset=0}populatePaintArrays(t,r,a,h,m,g){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(t,r,h,m,g);r.id!==void 0&&this._featureMap.add(r.id,a,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,a,h){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,r,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function U1(n,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${t}-`,"").replace(/-/g,"_")]}function yy(n,t,r){const a={color:{source:N,composite:ht},number:{source:Be,composite:N}},h=function(m){return{"line-pattern":{source:Ln,composite:Ln},"fill-pattern":{source:Ln,composite:Ln},"fill-extrusion-pattern":{source:Ln,composite:Ln}}[m]}(n);return h&&h[r]||a[t][r]}qe("ConstantBinder",Yu),qe("CrossFadedConstantBinder",vl),qe("SourceExpressionBinder",Io),qe("CrossFadedCompositeBinder",fs),qe("CompositeExpressionBinder",Lr),qe("ProgramConfiguration",gy,{omit:["_buffers"]}),qe("ProgramConfigurationSet",fa);const yi=8192,af=Math.pow(2,14)-1,_y=-af-1;function ma(n){const t=yi/n.extent,r=n.loadGeometry();for(let a=0;a<r.length;a++){const h=r[a];for(let m=0;m<h.length;m++){const g=h[m],_=Math.round(g.x*t),w=Math.round(g.y*t);g.x=je(_,_y,af),g.y=je(w,_y,af),(_<g.x||_>g.x+1||w<g.y||w>g.y+1)&&oi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function ga(n,t){return{type:n.type,id:n.id,properties:n.properties,geometry:t?ma(n):[]}}function Gh(n,t,r,a,h){n.emplaceBack(2*t+(a+1)/2,2*r+(h+1)/2)}class lf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Wi,this.indexArray=new Qn,this.segments=new It,this.programConfigurations=new fa(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,a){const h=this.layers[0],m=[];let g=null,_=!1;h.type==="circle"&&(g=h.layout.get("circle-sort-key"),_=!g.isConstant());for(const{feature:w,id:k,index:E,sourceLayerIndex:P}of t){const A=this.layers[0]._featureFilter.needGeometry,R=ga(w,A);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),R,a))continue;const j=_?g.evaluate(R,{},a):void 0,O={id:k,properties:w.properties,type:w.type,sourceLayerIndex:P,index:E,geometry:A?R.geometry:ma(w),patterns:{},sortKey:j};m.push(O)}_&&m.sort((w,k)=>w.sortKey-k.sortKey);for(const w of m){const{geometry:k,index:E,sourceLayerIndex:P}=w,A=t[E].feature;this.addFeature(w,k,E,a),r.featureIndex.insert(A,k,E,P,this.index)}}update(t,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,a,h){for(const m of r)for(const g of m){const _=g.x,w=g.y;if(_<0||_>=yi||w<0||w>=yi)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),E=k.vertexLength;Gh(this.layoutVertexArray,_,w,-1,-1),Gh(this.layoutVertexArray,_,w,1,-1),Gh(this.layoutVertexArray,_,w,1,1),Gh(this.layoutVertexArray,_,w,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,{},h)}}function vy(n,t){for(let r=0;r<n.length;r++)if(xl(t,n[r]))return!0;for(let r=0;r<t.length;r++)if(xl(n,t[r]))return!0;return!!uf(n,t)}function $1(n,t,r){return!!xl(n,t)||!!cf(t,n,r)}function xy(n,t){if(n.length===1)return by(t,n[0]);for(let r=0;r<t.length;r++){const a=t[r];for(let h=0;h<a.length;h++)if(xl(n,a[h]))return!0}for(let r=0;r<n.length;r++)if(by(t,n[r]))return!0;for(let r=0;r<t.length;r++)if(uf(n,t[r]))return!0;return!1}function Z1(n,t,r){if(n.length>1){if(uf(n,t))return!0;for(let a=0;a<t.length;a++)if(cf(t[a],n,r))return!0}for(let a=0;a<n.length;a++)if(cf(n[a],t,r))return!0;return!1}function uf(n,t){if(n.length===0||t.length===0)return!1;for(let r=0;r<n.length-1;r++){const a=n[r],h=n[r+1];for(let m=0;m<t.length-1;m++)if(q1(a,h,t[m],t[m+1]))return!0}return!1}function q1(n,t,r,a){return wi(n,r,a)!==wi(t,r,a)&&wi(n,t,r)!==wi(n,t,a)}function cf(n,t,r){const a=r*r;if(t.length===1)return n.distSqr(t[0])<a;for(let h=1;h<t.length;h++)if(wy(n,t[h-1],t[h])<a)return!0;return!1}function wy(n,t,r){const a=t.distSqr(r);if(a===0)return n.distSqr(t);const h=((n.x-t.x)*(r.x-t.x)+(n.y-t.y)*(r.y-t.y))/a;return n.distSqr(h<0?t:h>1?r:r.sub(t)._mult(h)._add(t))}function by(n,t){let r,a,h,m=!1;for(let g=0;g<n.length;g++){r=n[g];for(let _=0,w=r.length-1;_<r.length;w=_++)a=r[_],h=r[w],a.y>t.y!=h.y>t.y&&t.x<(h.x-a.x)*(t.y-a.y)/(h.y-a.y)+a.x&&(m=!m)}return m}function xl(n,t){let r=!1;for(let a=0,h=n.length-1;a<n.length;h=a++){const m=n[a],g=n[h];m.y>t.y!=g.y>t.y&&t.x<(g.x-m.x)*(t.y-m.y)/(g.y-m.y)+m.x&&(r=!r)}return r}function G1(n,t,r){const a=r[0],h=r[2];if(n.x<a.x&&t.x<a.x||n.x>h.x&&t.x>h.x||n.y<a.y&&t.y<a.y||n.y>h.y&&t.y>h.y)return!1;const m=wi(n,t,r[0]);return m!==wi(n,t,r[1])||m!==wi(n,t,r[2])||m!==wi(n,t,r[3])}function Qu(n,t,r){const a=t.paint.get(n).value;return a.kind==="constant"?a.value:r.programConfigurations.get(t.id).getMaxValue(n)}function Hh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Wh(n,t,r,a,h){if(!t[0]&&!t[1])return n;const m=X.convert(t)._mult(h);r==="viewport"&&m._rotate(-a);const g=[];for(let _=0;_<n.length;_++)g.push(n[_].sub(m));return g}let Sy,Ty;qe("CircleBucket",lf,{omit:["layers"]});var H1={get paint(){return Ty=Ty||new f({"circle-radius":new at(ye.paint_circle["circle-radius"]),"circle-color":new at(ye.paint_circle["circle-color"]),"circle-blur":new at(ye.paint_circle["circle-blur"]),"circle-opacity":new at(ye.paint_circle["circle-opacity"]),"circle-translate":new Xe(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Xe(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xe(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xe(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new at(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new at(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new at(ye.paint_circle["circle-stroke-opacity"])})},get layout(){return Sy=Sy||new f({"circle-sort-key":new at(ye.layout_circle["circle-sort-key"])})}},ln=1e-6,wl=typeof Float32Array<"u"?Float32Array:Array;function hf(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Iy(n,t,r){var a=t[0],h=t[1],m=t[2],g=t[3],_=t[4],w=t[5],k=t[6],E=t[7],P=t[8],A=t[9],R=t[10],j=t[11],O=t[12],G=t[13],J=t[14],pe=t[15],re=r[0],he=r[1],_e=r[2],Te=r[3];return n[0]=re*a+he*_+_e*P+Te*O,n[1]=re*h+he*w+_e*A+Te*G,n[2]=re*m+he*k+_e*R+Te*J,n[3]=re*g+he*E+_e*j+Te*pe,n[4]=(re=r[4])*a+(he=r[5])*_+(_e=r[6])*P+(Te=r[7])*O,n[5]=re*h+he*w+_e*A+Te*G,n[6]=re*m+he*k+_e*R+Te*J,n[7]=re*g+he*E+_e*j+Te*pe,n[8]=(re=r[8])*a+(he=r[9])*_+(_e=r[10])*P+(Te=r[11])*O,n[9]=re*h+he*w+_e*A+Te*G,n[10]=re*m+he*k+_e*R+Te*J,n[11]=re*g+he*E+_e*j+Te*pe,n[12]=(re=r[12])*a+(he=r[13])*_+(_e=r[14])*P+(Te=r[15])*O,n[13]=re*h+he*w+_e*A+Te*G,n[14]=re*m+he*k+_e*R+Te*J,n[15]=re*g+he*E+_e*j+Te*pe,n}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});var ec,W1=Iy;function Xh(n,t,r){var a=t[0],h=t[1],m=t[2],g=t[3];return n[0]=r[0]*a+r[4]*h+r[8]*m+r[12]*g,n[1]=r[1]*a+r[5]*h+r[9]*m+r[13]*g,n[2]=r[2]*a+r[6]*h+r[10]*m+r[14]*g,n[3]=r[3]*a+r[7]*h+r[11]*m+r[15]*g,n}ec=new wl(4),wl!=Float32Array&&(ec[0]=0,ec[1]=0,ec[2]=0,ec[3]=0);class X1 extends s{constructor(t){super(t,H1)}createBucket(t){return new lf(t)}queryRadius(t){const r=t;return Qu("circle-radius",this,r)+Qu("circle-stroke-width",this,r)+Hh(this.paint.get("circle-translate"))}queryIntersectsFeature(t,r,a,h,m,g,_,w){const k=Wh(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,_),E=this.paint.get("circle-radius").evaluate(r,a)+this.paint.get("circle-stroke-width").evaluate(r,a),P=this.paint.get("circle-pitch-alignment")==="map",A=P?k:function(j,O){return j.map(G=>ky(G,O))}(k,w),R=P?E*_:E;for(const j of h)for(const O of j){const G=P?O:ky(O,w);let J=R;const pe=Xh([],[O.x,O.y,0,1],w);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?J*=pe[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(J*=g.cameraToCenterDistance/pe[3]),$1(A,G,J))return!0}return!1}}function ky(n,t){const r=Xh([],[n.x,n.y,0,1],t);return new X(r[0]/r[3],r[1]/r[3])}class Ey extends lf{}let Cy;qe("HeatmapBucket",Ey,{omit:["layers"]});var K1={get paint(){return Cy=Cy||new f({"heatmap-radius":new at(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new at(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xe(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ku(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xe(ye.paint_heatmap["heatmap-opacity"])})}};function df(n,{width:t,height:r},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*r*a)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*r*a}`)}else h=new Uint8Array(t*r*a);return n.width=t,n.height=r,n.data=h,n}function Py(n,{width:t,height:r},a){if(t===n.width&&r===n.height)return;const h=df({},{width:t,height:r},a);pf(n,h,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,t),height:Math.min(n.height,r)},a),n.width=t,n.height=r,n.data=h.data}function pf(n,t,r,a,h,m){if(h.width===0||h.height===0)return t;if(h.width>n.width||h.height>n.height||r.x>n.width-h.width||r.y>n.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||a.x>t.width-h.width||a.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const g=n.data,_=t.data;if(g===_)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<h.height;w++){const k=((r.y+w)*n.width+r.x)*m,E=((a.y+w)*t.width+a.x)*m;for(let P=0;P<h.width*m;P++)_[E+P]=g[k+P]}return t}class tc{constructor(t,r){df(this,t,1,r)}resize(t){Py(this,t,1)}clone(){return new tc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,a,h,m){pf(t,r,a,h,m,1)}}class er{constructor(t,r){df(this,t,4,r)}resize(t){Py(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new er({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,a,h,m){pf(t,r,a,h,m,4)}}function My(n){const t={},r=n.resolution||256,a=n.clips?n.clips.length:1,h=n.image||new er({width:r,height:a});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const m=(g,_,w)=>{t[n.evaluationKey]=w;const k=n.expression.evaluate(t);h.data[g+_+0]=Math.floor(255*k.r/k.a),h.data[g+_+1]=Math.floor(255*k.g/k.a),h.data[g+_+2]=Math.floor(255*k.b/k.a),h.data[g+_+3]=Math.floor(255*k.a)};if(n.clips)for(let g=0,_=0;g<a;++g,_+=4*r)for(let w=0,k=0;w<r;w++,k+=4){const E=w/(r-1),{start:P,end:A}=n.clips[g];m(_,k,P*(1-E)+A*E)}else for(let g=0,_=0;g<r;g++,_+=4)m(0,_,g/(r-1));return h}qe("AlphaImage",tc),qe("RGBAImage",er);const ff="big-fb";class J1 extends s{createBucket(t){return new Ey(t)}constructor(t){super(t,K1),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=My({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ff)&&this.heatmapFbos.delete(ff)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let zy;var Y1={get paint(){return zy=zy||new f({"hillshade-illumination-direction":new Xe(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xe(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xe(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xe(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xe(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xe(ye.paint_hillshade["hillshade-accent-color"])})}};class Q1 extends s{constructor(t){super(t,Y1)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const ew=v([{name:"a_pos",components:2,type:"Int16"}],4),{members:tw}=ew;function Ay(n,t,r=2){const a=t&&t.length,h=a?t[0]*r:n.length;let m=Dy(n,0,h,r,!0);const g=[];if(!m||m.next===m.prev)return g;let _,w,k;if(a&&(m=function(E,P,A,R){const j=[];for(let O=0,G=P.length;O<G;O++){const J=Dy(E,P[O]*R,O<G-1?P[O+1]*R:E.length,R,!1);J===J.next&&(J.steiner=!0),j.push(uw(J))}j.sort(sw);for(let O=0;O<j.length;O++)A=aw(j[O],A);return A}(n,t,m,r)),n.length>80*r){_=1/0,w=1/0;let E=-1/0,P=-1/0;for(let A=r;A<h;A+=r){const R=n[A],j=n[A+1];R<_&&(_=R),j<w&&(w=j),R>E&&(E=R),j>P&&(P=j)}k=Math.max(E-_,P-w),k=k!==0?32767/k:0}return ic(m,g,r,_,w,k,0),g}function Dy(n,t,r,a,h){let m;if(h===function(g,_,w,k){let E=0;for(let P=_,A=w-k;P<w;P+=k)E+=(g[A]-g[P])*(g[P+1]+g[A+1]),A=P;return E}(n,t,r,a)>0)for(let g=t;g<r;g+=a)m=Fy(g/a|0,n[g],n[g+1],m);else for(let g=r-a;g>=t;g-=a)m=Fy(g/a|0,n[g],n[g+1],m);return m&&Kh(m,m.next)&&(rc(m),m=m.next),m}function ya(n,t){if(!n)return n;t||(t=n);let r,a=n;do if(r=!1,a.steiner||!Kh(a,a.next)&&hi(a.prev,a,a.next)!==0)a=a.next;else{if(rc(a),a=t=a.prev,a===a.next)break;r=!0}while(r||a!==t);return t}function ic(n,t,r,a,h,m,g){if(!n)return;!g&&m&&function(w,k,E,P){let A=w;do A.z===0&&(A.z=mf(A.x,A.y,k,E,P)),A.prevZ=A.prev,A.nextZ=A.next,A=A.next;while(A!==w);A.prevZ.nextZ=null,A.prevZ=null,function(R){let j,O=1;do{let G,J=R;R=null;let pe=null;for(j=0;J;){j++;let re=J,he=0;for(let Te=0;Te<O&&(he++,re=re.nextZ,re);Te++);let _e=O;for(;he>0||_e>0&&re;)he!==0&&(_e===0||!re||J.z<=re.z)?(G=J,J=J.nextZ,he--):(G=re,re=re.nextZ,_e--),pe?pe.nextZ=G:R=G,G.prevZ=pe,pe=G;J=re}pe.nextZ=null,O*=2}while(j>1)}(A)}(n,a,h,m);let _=n;for(;n.prev!==n.next;){const w=n.prev,k=n.next;if(m?nw(n,a,h,m):iw(n))t.push(w.i,n.i,k.i),rc(n),n=k.next,_=k.next;else if((n=k)===_){g?g===1?ic(n=rw(ya(n),t),t,r,a,h,m,2):g===2&&ow(n,t,r,a,h,m):ic(ya(n),t,r,a,h,m,1);break}}}function iw(n){const t=n.prev,r=n,a=n.next;if(hi(t,r,a)>=0)return!1;const h=t.x,m=r.x,g=a.x,_=t.y,w=r.y,k=a.y,E=h<m?h<g?h:g:m<g?m:g,P=_<w?_<k?_:k:w<k?w:k,A=h>m?h>g?h:g:m>g?m:g,R=_>w?_>k?_:k:w>k?w:k;let j=a.next;for(;j!==t;){if(j.x>=E&&j.x<=A&&j.y>=P&&j.y<=R&&bl(h,_,m,w,g,k,j.x,j.y)&&hi(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function nw(n,t,r,a){const h=n.prev,m=n,g=n.next;if(hi(h,m,g)>=0)return!1;const _=h.x,w=m.x,k=g.x,E=h.y,P=m.y,A=g.y,R=_<w?_<k?_:k:w<k?w:k,j=E<P?E<A?E:A:P<A?P:A,O=_>w?_>k?_:k:w>k?w:k,G=E>P?E>A?E:A:P>A?P:A,J=mf(R,j,t,r,a),pe=mf(O,G,t,r,a);let re=n.prevZ,he=n.nextZ;for(;re&&re.z>=J&&he&&he.z<=pe;){if(re.x>=R&&re.x<=O&&re.y>=j&&re.y<=G&&re!==h&&re!==g&&bl(_,E,w,P,k,A,re.x,re.y)&&hi(re.prev,re,re.next)>=0||(re=re.prevZ,he.x>=R&&he.x<=O&&he.y>=j&&he.y<=G&&he!==h&&he!==g&&bl(_,E,w,P,k,A,he.x,he.y)&&hi(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;re&&re.z>=J;){if(re.x>=R&&re.x<=O&&re.y>=j&&re.y<=G&&re!==h&&re!==g&&bl(_,E,w,P,k,A,re.x,re.y)&&hi(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;he&&he.z<=pe;){if(he.x>=R&&he.x<=O&&he.y>=j&&he.y<=G&&he!==h&&he!==g&&bl(_,E,w,P,k,A,he.x,he.y)&&hi(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function rw(n,t){let r=n;do{const a=r.prev,h=r.next.next;!Kh(a,h)&&Ly(a,r,r.next,h)&&nc(a,h)&&nc(h,a)&&(t.push(a.i,r.i,h.i),rc(r),rc(r.next),r=n=h),r=r.next}while(r!==n);return ya(r)}function ow(n,t,r,a,h,m){let g=n;do{let _=g.next.next;for(;_!==g.prev;){if(g.i!==_.i&&cw(g,_)){let w=Ry(g,_);return g=ya(g,g.next),w=ya(w,w.next),ic(g,t,r,a,h,m,0),void ic(w,t,r,a,h,m,0)}_=_.next}g=g.next}while(g!==n)}function sw(n,t){return n.x-t.x}function aw(n,t){const r=function(h,m){let g=m;const _=h.x,w=h.y;let k,E=-1/0;do{if(w<=g.y&&w>=g.next.y&&g.next.y!==g.y){const O=g.x+(w-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(O<=_&&O>E&&(E=O,k=g.x<g.next.x?g:g.next,O===_))return k}g=g.next}while(g!==m);if(!k)return null;const P=k,A=k.x,R=k.y;let j=1/0;g=k;do{if(_>=g.x&&g.x>=A&&_!==g.x&&bl(w<R?_:E,w,A,R,w<R?E:_,w,g.x,g.y)){const O=Math.abs(w-g.y)/(_-g.x);nc(g,h)&&(O<j||O===j&&(g.x>k.x||g.x===k.x&&lw(k,g)))&&(k=g,j=O)}g=g.next}while(g!==P);return k}(n,t);if(!r)return t;const a=Ry(r,n);return ya(a,a.next),ya(r,r.next)}function lw(n,t){return hi(n.prev,n,t.prev)<0&&hi(t.next,n,n.next)<0}function mf(n,t,r,a,h){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*h|0)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-a)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function uw(n){let t=n,r=n;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==n);return r}function bl(n,t,r,a,h,m,g,_){return(h-g)*(t-_)>=(n-g)*(m-_)&&(n-g)*(a-_)>=(r-g)*(t-_)&&(r-g)*(m-_)>=(h-g)*(a-_)}function cw(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!function(r,a){let h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==a.i&&h.next.i!==a.i&&Ly(h,h.next,r,a))return!0;h=h.next}while(h!==r);return!1}(n,t)&&(nc(n,t)&&nc(t,n)&&function(r,a){let h=r,m=!1;const g=(r.x+a.x)/2,_=(r.y+a.y)/2;do h.y>_!=h.next.y>_&&h.next.y!==h.y&&g<(h.next.x-h.x)*(_-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==r);return m}(n,t)&&(hi(n.prev,n,t.prev)||hi(n,t.prev,t))||Kh(n,t)&&hi(n.prev,n,n.next)>0&&hi(t.prev,t,t.next)>0)}function hi(n,t,r){return(t.y-n.y)*(r.x-t.x)-(t.x-n.x)*(r.y-t.y)}function Kh(n,t){return n.x===t.x&&n.y===t.y}function Ly(n,t,r,a){const h=Yh(hi(n,t,r)),m=Yh(hi(n,t,a)),g=Yh(hi(r,a,n)),_=Yh(hi(r,a,t));return h!==m&&g!==_||!(h!==0||!Jh(n,r,t))||!(m!==0||!Jh(n,a,t))||!(g!==0||!Jh(r,n,a))||!(_!==0||!Jh(r,t,a))}function Jh(n,t,r){return t.x<=Math.max(n.x,r.x)&&t.x>=Math.min(n.x,r.x)&&t.y<=Math.max(n.y,r.y)&&t.y>=Math.min(n.y,r.y)}function Yh(n){return n>0?1:n<0?-1:0}function nc(n,t){return hi(n.prev,n,n.next)<0?hi(n,t,n.next)>=0&&hi(n,n.prev,t)>=0:hi(n,t,n.prev)<0||hi(n,n.next,t)<0}function Ry(n,t){const r=gf(n.i,n.x,n.y),a=gf(t.i,t.x,t.y),h=n.next,m=t.prev;return n.next=t,t.prev=n,r.next=h,h.prev=r,a.next=r,r.prev=a,m.next=a,a.prev=m,a}function Fy(n,t,r,a){const h=gf(n,t,r);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function rc(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function gf(n,t,r){return{i:n,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function yf(n,t,r){const a=r.patternDependencies;let h=!1;for(const m of t){const g=m.paint.get(`${n}-pattern`);g.isConstant()||(h=!0);const _=g.constantOr(null);_&&(h=!0,a[_.to]=!0,a[_.from]=!0)}return h}function _f(n,t,r,a,h){const m=h.patternDependencies;for(const g of t){const _=g.paint.get(`${n}-pattern`).value;if(_.kind!=="constant"){let w=_.evaluate({zoom:a-1},r,{},h.availableImages),k=_.evaluate({zoom:a},r,{},h.availableImages),E=_.evaluate({zoom:a+1},r,{},h.availableImages);w=w&&w.name?w.name:w,k=k&&k.name?k.name:k,E=E&&E.name?E.name:E,m[w]=!0,m[k]=!0,m[E]=!0,r.patterns[g.id]={min:w,mid:k,max:E}}}return r}class vf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new xr,this.indexArray=new Qn,this.indexArray2=new Mi,this.programConfigurations=new fa(t.layers,t.zoom),this.segments=new It,this.segments2=new It,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,a){this.hasPattern=yf("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),g=[];for(const{feature:_,id:w,index:k,sourceLayerIndex:E}of t){const P=this.layers[0]._featureFilter.needGeometry,A=ga(_,P);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),A,a))continue;const R=m?h.evaluate(A,{},a,r.availableImages):void 0,j={id:w,properties:_.properties,type:_.type,sourceLayerIndex:E,index:k,geometry:P?A.geometry:ma(_),patterns:{},sortKey:R};g.push(j)}m&&g.sort((_,w)=>_.sortKey-w.sortKey);for(const _ of g){const{geometry:w,index:k,sourceLayerIndex:E}=_;if(this.hasPattern){const P=_f("fill",this.layers,_,this.zoom,r);this.patternFeatures.push(P)}else this.addFeature(_,w,k,a,{});r.featureIndex.insert(t[k].feature,w,k,E,this.index)}}update(t,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,a)}addFeatures(t,r,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tw),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,a,h,m){for(const g of Ga(r,500)){let _=0;for(const R of g)_+=R.length;const w=this.segments.prepareSegment(_,this.layoutVertexArray,this.indexArray),k=w.vertexLength,E=[],P=[];for(const R of g){if(R.length===0)continue;R!==g[0]&&P.push(E.length/2);const j=this.segments2.prepareSegment(R.length,this.layoutVertexArray,this.indexArray2),O=j.vertexLength;this.layoutVertexArray.emplaceBack(R[0].x,R[0].y),this.indexArray2.emplaceBack(O+R.length-1,O),E.push(R[0].x),E.push(R[0].y);for(let G=1;G<R.length;G++)this.layoutVertexArray.emplaceBack(R[G].x,R[G].y),this.indexArray2.emplaceBack(O+G-1,O+G),E.push(R[G].x),E.push(R[G].y);j.vertexLength+=R.length,j.primitiveLength+=R.length}const A=Ay(E,P);for(let R=0;R<A.length;R+=3)this.indexArray.emplaceBack(k+A[R],k+A[R+1],k+A[R+2]);w.vertexLength+=_,w.primitiveLength+=A.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}}let By,jy;qe("FillBucket",vf,{omit:["layers","patternFeatures"]});var hw={get paint(){return jy=jy||new f({"fill-antialias":new Xe(ye.paint_fill["fill-antialias"]),"fill-opacity":new at(ye.paint_fill["fill-opacity"]),"fill-color":new at(ye.paint_fill["fill-color"]),"fill-outline-color":new at(ye.paint_fill["fill-outline-color"]),"fill-translate":new Xe(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Xe(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new dl(ye.paint_fill["fill-pattern"])})},get layout(){return By=By||new f({"fill-sort-key":new at(ye.layout_fill["fill-sort-key"])})}};class dw extends s{constructor(t){super(t,hw)}recalculate(t,r){super.recalculate(t,r);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new vf(t)}queryRadius(){return Hh(this.paint.get("fill-translate"))}queryIntersectsFeature(t,r,a,h,m,g,_){return xy(Wh(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,_),h)}isTileClipped(){return!0}}const pw=v([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),fw=v([{name:"a_centroid",components:2,type:"Int16"}],4),{members:mw}=pw;var ms={},gw=ee,Oy=Sl;function Sl(n,t,r,a,h){this.properties={},this.extent=r,this.type=0,this._pbf=n,this._geometry=-1,this._keys=a,this._values=h,n.readFields(yw,this,t)}function yw(n,t,r){n==1?t.id=r.readVarint():n==2?function(a,h){for(var m=a.readVarint()+a.pos;a.pos<m;){var g=h._keys[a.readVarint()],_=h._values[a.readVarint()];h.properties[g]=_}}(r,t):n==3?t.type=r.readVarint():n==4&&(t._geometry=r.pos)}function _w(n){for(var t,r,a=0,h=0,m=n.length,g=m-1;h<m;g=h++)a+=((r=n[g]).x-(t=n[h]).x)*(t.y+r.y);return a}Sl.types=["Unknown","Point","LineString","Polygon"],Sl.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var t,r=n.readVarint()+n.pos,a=1,h=0,m=0,g=0,_=[];n.pos<r;){if(h<=0){var w=n.readVarint();a=7&w,h=w>>3}if(h--,a===1||a===2)m+=n.readSVarint(),g+=n.readSVarint(),a===1&&(t&&_.push(t),t=[]),t.push(new gw(m,g));else{if(a!==7)throw new Error("unknown command "+a);t&&t.push(t[0].clone())}}return t&&_.push(t),_},Sl.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var t=n.readVarint()+n.pos,r=1,a=0,h=0,m=0,g=1/0,_=-1/0,w=1/0,k=-1/0;n.pos<t;){if(a<=0){var E=n.readVarint();r=7&E,a=E>>3}if(a--,r===1||r===2)(h+=n.readSVarint())<g&&(g=h),h>_&&(_=h),(m+=n.readSVarint())<w&&(w=m),m>k&&(k=m);else if(r!==7)throw new Error("unknown command "+r)}return[g,w,_,k]},Sl.prototype.toGeoJSON=function(n,t,r){var a,h,m=this.extent*Math.pow(2,r),g=this.extent*n,_=this.extent*t,w=this.loadGeometry(),k=Sl.types[this.type];function E(R){for(var j=0;j<R.length;j++){var O=R[j];R[j]=[360*(O.x+g)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(O.y+_)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(a=0;a<w.length;a++)P[a]=w[a][0];E(w=P);break;case 2:for(a=0;a<w.length;a++)E(w[a]);break;case 3:for(w=function(R){var j=R.length;if(j<=1)return[R];for(var O,G,J=[],pe=0;pe<j;pe++){var re=_w(R[pe]);re!==0&&(G===void 0&&(G=re<0),G===re<0?(O&&J.push(O),O=[R[pe]]):O.push(R[pe]))}return O&&J.push(O),J}(w),a=0;a<w.length;a++)for(h=0;h<w[a].length;h++)E(w[a][h])}w.length===1?w=w[0]:k="Multi"+k;var A={type:"Feature",geometry:{type:k,coordinates:w},properties:this.properties};return"id"in this&&(A.id=this.id),A};var vw=Oy,Ny=Vy;function Vy(n,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(xw,this,t),this.length=this._features.length}function xw(n,t,r){n===15?t.version=r.readVarint():n===1?t.name=r.readString():n===5?t.extent=r.readVarint():n===2?t._features.push(r.pos):n===3?t._keys.push(r.readString()):n===4&&t._values.push(function(a){for(var h=null,m=a.readVarint()+a.pos;a.pos<m;){var g=a.readVarint()>>3;h=g===1?a.readString():g===2?a.readFloat():g===3?a.readDouble():g===4?a.readVarint64():g===5?a.readVarint():g===6?a.readSVarint():g===7?a.readBoolean():null}return h}(r))}Vy.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var t=this._pbf.readVarint()+this._pbf.pos;return new vw(this._pbf,t,this.extent,this._keys,this._values)};var ww=Ny;function bw(n,t,r){if(n===3){var a=new ww(r,r.readVarint()+r.pos);a.length&&(t[a.name]=a)}}ms.VectorTile=function(n,t){this.layers=n.readFields(bw,{},t)},ms.VectorTileFeature=Oy,ms.VectorTileLayer=Ny;const Sw=ms.VectorTileFeature.types,xf=Math.pow(2,13);function oc(n,t,r,a,h,m,g,_){n.emplaceBack(t,r,2*Math.floor(a*xf)+g,h*xf*2,m*xf*2,Math.round(_))}class wf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new us,this.centroidVertexArray=new Bi,this.indexArray=new Qn,this.programConfigurations=new fa(t.layers,t.zoom),this.segments=new It,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,a){this.features=[],this.hasPattern=yf("fill-extrusion",this.layers,r);for(const{feature:h,id:m,index:g,sourceLayerIndex:_}of t){const w=this.layers[0]._featureFilter.needGeometry,k=ga(h,w);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),k,a))continue;const E={id:m,sourceLayerIndex:_,index:g,geometry:w?k.geometry:ma(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(_f("fill-extrusion",this.layers,E,this.zoom,r)):this.addFeature(E,E.geometry,g,a,{}),r.featureIndex.insert(h,E.geometry,g,_,this.index,!0)}}addFeatures(t,r,a){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,r,a)}}update(t,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mw),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,fw.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,a,h,m){for(const g of Ga(r,500)){const _={x:0,y:0,vertexCount:0};let w=0;for(const j of g)w+=j.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const j of g){if(j.length===0||Iw(j))continue;let O=0;for(let G=0;G<j.length;G++){const J=j[G];if(G>=1){const pe=j[G-1];if(!Tw(J,pe)){k.vertexLength+4>It.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const re=J.sub(pe)._perp()._unit(),he=pe.dist(J);O+he>32768&&(O=0),oc(this.layoutVertexArray,J.x,J.y,re.x,re.y,0,0,O),oc(this.layoutVertexArray,J.x,J.y,re.x,re.y,0,1,O),_.x+=2*J.x,_.y+=2*J.y,_.vertexCount+=2,O+=he,oc(this.layoutVertexArray,pe.x,pe.y,re.x,re.y,0,0,O),oc(this.layoutVertexArray,pe.x,pe.y,re.x,re.y,0,1,O),_.x+=2*pe.x,_.y+=2*pe.y,_.vertexCount+=2;const _e=k.vertexLength;this.indexArray.emplaceBack(_e,_e+2,_e+1),this.indexArray.emplaceBack(_e+1,_e+2,_e+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+w>It.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray)),Sw[t.type]!=="Polygon")continue;const E=[],P=[],A=k.vertexLength;for(const j of g)if(j.length!==0){j!==g[0]&&P.push(E.length/2);for(let O=0;O<j.length;O++){const G=j[O];oc(this.layoutVertexArray,G.x,G.y,0,0,1,1,0),_.x+=G.x,_.y+=G.y,_.vertexCount+=1,E.push(G.x),E.push(G.y)}}const R=Ay(E,P);for(let j=0;j<R.length;j+=3)this.indexArray.emplaceBack(A+R[j],A+R[j+2],A+R[j+1]);k.primitiveLength+=R.length/3,k.vertexLength+=w;for(let j=0;j<_.vertexCount;j++){const O=Math.floor(_.x/_.vertexCount),G=Math.floor(_.y/_.vertexCount);this.centroidVertexArray.emplaceBack(O,G)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}}function Tw(n,t){return n.x===t.x&&(n.x<0||n.x>yi)||n.y===t.y&&(n.y<0||n.y>yi)}function Iw(n){return n.every(t=>t.x<0)||n.every(t=>t.x>yi)||n.every(t=>t.y<0)||n.every(t=>t.y>yi)}let Uy;qe("FillExtrusionBucket",wf,{omit:["layers","features"]});var kw={get paint(){return Uy=Uy||new f({"fill-extrusion-opacity":new Xe(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new at(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xe(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xe(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new dl(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new at(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new at(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xe(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Ew extends s{constructor(t){super(t,kw)}createBucket(t){return new wf(t)}queryRadius(){return Hh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,r,a,h,m,g,_,w){const k=Wh(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,_),E=this.paint.get("fill-extrusion-height").evaluate(r,a),P=this.paint.get("fill-extrusion-base").evaluate(r,a),A=function(j,O,G,J){const pe=[];for(const re of j){const he=[re.x,re.y,0,1];Xh(he,he,O),pe.push(new X(he[0]/he[3],he[1]/he[3]))}return pe}(k,w),R=function(j,O,G,J){const pe=[],re=[],he=J[8]*O,_e=J[9]*O,Te=J[10]*O,Ve=J[11]*O,st=J[8]*G,Oe=J[9]*G,Fe=J[10]*G,Qe=J[11]*G;for(const Ge of j){const Ze=[],xe=[];for(const et of Ge){const Ye=et.x,ct=et.y,$t=J[0]*Ye+J[4]*ct+J[12],Ut=J[1]*Ye+J[5]*ct+J[13],Ti=J[2]*Ye+J[6]*ct+J[14],wr=J[3]*Ye+J[7]*ct+J[15],Ni=Ti+Te,Ii=wr+Ve,un=$t+st,cn=Ut+Oe,hn=Ti+Fe,li=wr+Qe,ki=new X(($t+he)/Ii,(Ut+_e)/Ii);ki.z=Ni/Ii,Ze.push(ki);const Xi=new X(un/li,cn/li);Xi.z=hn/li,xe.push(Xi)}pe.push(Ze),re.push(xe)}return[pe,re]}(h,P,E,w);return function(j,O,G){let J=1/0;xy(G,O)&&(J=$y(G,O[0]));for(let pe=0;pe<O.length;pe++){const re=O[pe],he=j[pe];for(let _e=0;_e<re.length-1;_e++){const Te=re[_e],Ve=[Te,re[_e+1],he[_e+1],he[_e],Te];vy(G,Ve)&&(J=Math.min(J,$y(G,Ve)))}}return J!==1/0&&J}(R[0],R[1],A)}}function sc(n,t){return n.x*t.x+n.y*t.y}function $y(n,t){if(n.length===1){let r=0;const a=t[r++];let h;for(;!h||a.equals(h);)if(h=t[r++],!h)return 1/0;for(;r<t.length;r++){const m=t[r],g=n[0],_=h.sub(a),w=m.sub(a),k=g.sub(a),E=sc(_,_),P=sc(_,w),A=sc(w,w),R=sc(k,_),j=sc(k,w),O=E*A-P*P,G=(A*R-P*j)/O,J=(E*j-P*R)/O,pe=a.z*(1-G-J)+h.z*G+m.z*J;if(isFinite(pe))return pe}return 1/0}{let r=1/0;for(const a of t)r=Math.min(r,a.z);return r}}const Cw=v([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Pw}=Cw,Mw=v([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:zw}=Mw,Aw=ms.VectorTileFeature.types,Dw=Math.cos(Math.PI/180*37.5),Zy=Math.pow(2,14)/.5;class bf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new fl,this.layoutVertexArray2=new cs,this.indexArray=new Qn,this.programConfigurations=new fa(t.layers,t.zoom),this.segments=new It,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,a){this.hasPattern=yf("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),g=[];for(const{feature:_,id:w,index:k,sourceLayerIndex:E}of t){const P=this.layers[0]._featureFilter.needGeometry,A=ga(_,P);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),A,a))continue;const R=m?h.evaluate(A,{},a):void 0,j={id:w,properties:_.properties,type:_.type,sourceLayerIndex:E,index:k,geometry:P?A.geometry:ma(_),patterns:{},sortKey:R};g.push(j)}m&&g.sort((_,w)=>_.sortKey-w.sortKey);for(const _ of g){const{geometry:w,index:k,sourceLayerIndex:E}=_;if(this.hasPattern){const P=_f("line",this.layers,_,this.zoom,r);this.patternFeatures.push(P)}else this.addFeature(_,w,k,a,{});r.featureIndex.insert(t[k].feature,w,k,E,this.index)}}update(t,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,a)}addFeatures(t,r,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,zw)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pw),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,a,h,m){const g=this.layers[0].layout,_=g.get("line-join").evaluate(t,{}),w=g.get("line-cap"),k=g.get("line-miter-limit"),E=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const P of r)this.addLine(P,t,_,w,k,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}addLine(t,r,a,h,m,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let J=0;J<t.length-1;J++)this.totalDistance+=t[J].dist(t[J+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const _=Aw[r.type]==="Polygon";let w=t.length;for(;w>=2&&t[w-1].equals(t[w-2]);)w--;let k=0;for(;k<w-1&&t[k].equals(t[k+1]);)k++;if(w<(_?3:2))return;a==="bevel"&&(m=1.05);const E=this.overscaling<=16?15*yi/(512*this.overscaling):0,P=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let A,R,j,O,G;this.e1=this.e2=-1,_&&(A=t[w-2],G=t[k].sub(A)._unit()._perp());for(let J=k;J<w;J++){if(j=J===w-1?_?t[k+1]:void 0:t[J+1],j&&t[J].equals(j))continue;G&&(O=G),A&&(R=A),A=t[J],G=j?j.sub(A)._unit()._perp():O,O=O||G;let pe=O.add(G);pe.x===0&&pe.y===0||pe._unit();const re=O.x*G.x+O.y*G.y,he=pe.x*G.x+pe.y*G.y,_e=he!==0?1/he:1/0,Te=2*Math.sqrt(2-2*he),Ve=he<Dw&&R&&j,st=O.x*G.y-O.y*G.x>0;if(Ve&&J>k){const Qe=A.dist(R);if(Qe>2*E){const Ge=A.sub(A.sub(R)._mult(E/Qe)._round());this.updateDistance(R,Ge),this.addCurrentVertex(Ge,O,0,0,P),R=Ge}}const Oe=R&&j;let Fe=Oe?a:_?"butt":h;if(Oe&&Fe==="round"&&(_e<g?Fe="miter":_e<=2&&(Fe="fakeround")),Fe==="miter"&&_e>m&&(Fe="bevel"),Fe==="bevel"&&(_e>2&&(Fe="flipbevel"),_e<m&&(Fe="miter")),R&&this.updateDistance(R,A),Fe==="miter")pe._mult(_e),this.addCurrentVertex(A,pe,0,0,P);else if(Fe==="flipbevel"){if(_e>100)pe=G.mult(-1);else{const Qe=_e*O.add(G).mag()/O.sub(G).mag();pe._perp()._mult(Qe*(st?-1:1))}this.addCurrentVertex(A,pe,0,0,P),this.addCurrentVertex(A,pe.mult(-1),0,0,P)}else if(Fe==="bevel"||Fe==="fakeround"){const Qe=-Math.sqrt(_e*_e-1),Ge=st?Qe:0,Ze=st?0:Qe;if(R&&this.addCurrentVertex(A,O,Ge,Ze,P),Fe==="fakeround"){const xe=Math.round(180*Te/Math.PI/20);for(let et=1;et<xe;et++){let Ye=et/xe;if(Ye!==.5){const $t=Ye-.5;Ye+=Ye*$t*(Ye-1)*((1.0904+re*(re*(3.55645-1.43519*re)-3.2452))*$t*$t+(.848013+re*(.215638*re-1.06021)))}const ct=G.sub(O)._mult(Ye)._add(O)._unit()._mult(st?-1:1);this.addHalfVertex(A,ct.x,ct.y,!1,st,0,P)}}j&&this.addCurrentVertex(A,G,-Ge,-Ze,P)}else if(Fe==="butt")this.addCurrentVertex(A,pe,0,0,P);else if(Fe==="square"){const Qe=R?1:-1;this.addCurrentVertex(A,pe,Qe,Qe,P)}else Fe==="round"&&(R&&(this.addCurrentVertex(A,O,0,0,P),this.addCurrentVertex(A,O,1,1,P,!0)),j&&(this.addCurrentVertex(A,G,-1,-1,P,!0),this.addCurrentVertex(A,G,0,0,P)));if(Ve&&J<w-1){const Qe=A.dist(j);if(Qe>2*E){const Ge=A.add(j.sub(A)._mult(E/Qe)._round());this.updateDistance(A,Ge),this.addCurrentVertex(Ge,G,0,0,P),A=Ge}}}}addCurrentVertex(t,r,a,h,m,g=!1){const _=r.y*h-r.x,w=-r.y-r.x*h;this.addHalfVertex(t,r.x+r.y*a,r.y-r.x*a,g,!1,a,m),this.addHalfVertex(t,_,w,g,!0,-h,m),this.distance>Zy/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,a,h,m,g))}addHalfVertex({x:t,y:r},a,h,m,g,_,w){const k=.5*(this.lineClips?this.scaledDistance*(Zy-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(r<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(_===0?0:_<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const E=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),w.primitiveLength++),g?this.e2=E:this.e1=E}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let qy,Gy;qe("LineBucket",bf,{omit:["layers","patternFeatures"]});var Hy={get paint(){return Gy=Gy||new f({"line-opacity":new at(ye.paint_line["line-opacity"]),"line-color":new at(ye.paint_line["line-color"]),"line-translate":new Xe(ye.paint_line["line-translate"]),"line-translate-anchor":new Xe(ye.paint_line["line-translate-anchor"]),"line-width":new at(ye.paint_line["line-width"]),"line-gap-width":new at(ye.paint_line["line-gap-width"]),"line-offset":new at(ye.paint_line["line-offset"]),"line-blur":new at(ye.paint_line["line-blur"]),"line-dasharray":new pl(ye.paint_line["line-dasharray"]),"line-pattern":new dl(ye.paint_line["line-pattern"]),"line-gradient":new Ku(ye.paint_line["line-gradient"])})},get layout(){return qy=qy||new f({"line-cap":new Xe(ye.layout_line["line-cap"]),"line-join":new at(ye.layout_line["line-join"]),"line-miter-limit":new Xe(ye.layout_line["line-miter-limit"]),"line-round-limit":new Xe(ye.layout_line["line-round-limit"]),"line-sort-key":new at(ye.layout_line["line-sort-key"])})}};class Lw extends at{possiblyEvaluate(t,r){return r=new Ht(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,a,h){return r=He({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,a,h)}}let Qh;class Rw extends s{constructor(t){super(t,Hy),this.gradientVersion=0,Qh||(Qh=new Lw(Hy.paint.properties["line-width"].specification),Qh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof Zo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=Qh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new bf(t)}queryRadius(t){const r=t,a=Wy(Qu("line-width",this,r),Qu("line-gap-width",this,r)),h=Qu("line-offset",this,r);return a/2+Math.abs(h)+Hh(this.paint.get("line-translate"))}queryIntersectsFeature(t,r,a,h,m,g,_){const w=Wh(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,_),k=_/2*Wy(this.paint.get("line-width").evaluate(r,a),this.paint.get("line-gap-width").evaluate(r,a)),E=this.paint.get("line-offset").evaluate(r,a);return E&&(h=function(P,A){const R=[];for(let j=0;j<P.length;j++){const O=P[j],G=[];for(let J=0;J<O.length;J++){const pe=O[J-1],re=O[J],he=O[J+1],_e=J===0?new X(0,0):re.sub(pe)._unit()._perp(),Te=J===O.length-1?new X(0,0):he.sub(re)._unit()._perp(),Ve=_e._add(Te)._unit(),st=Ve.x*Te.x+Ve.y*Te.y;st!==0&&Ve._mult(1/st),G.push(Ve._mult(A)._add(re))}R.push(G)}return R}(h,E*_)),function(P,A,R){for(let j=0;j<A.length;j++){const O=A[j];if(P.length>=3){for(let G=0;G<O.length;G++)if(xl(P,O[G]))return!0}if(Z1(P,O,R))return!0}return!1}(w,h,k)}isTileClipped(){return!0}}function Wy(n,t){return t>0?t+2*n:n}const Fw=v([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bw=v([{name:"a_projected_pos",components:3,type:"Float32"}],4);v([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const jw=v([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);v([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Xy=v([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ow=v([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Nw(n,t,r){return n.sections.forEach(a=>{a.text=function(h,m,g){const _=m.layout.get("text-transform").evaluate(g,{});return _==="uppercase"?h=h.toLocaleUpperCase():_==="lowercase"&&(h=h.toLocaleLowerCase()),wn.applyArabicShaping&&(h=wn.applyArabicShaping(h)),h}(a.text,t,r)}),n}v([{name:"triangle",components:3,type:"Uint16"}]),v([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),v([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),v([{type:"Float32",name:"offsetX"}]),v([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),v([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const ac={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var vi=24,Ky=Vt,Jy=function(n,t,r,a,h){var m,g,_=8*h-a-1,w=(1<<_)-1,k=w>>1,E=-7,P=h-1,A=-1,R=n[t+P];for(P+=A,m=R&(1<<-E)-1,R>>=-E,E+=_;E>0;m=256*m+n[t+P],P+=A,E-=8);for(g=m&(1<<-E)-1,m>>=-E,E+=a;E>0;g=256*g+n[t+P],P+=A,E-=8);if(m===0)m=1-k;else{if(m===w)return g?NaN:1/0*(R?-1:1);g+=Math.pow(2,a),m-=k}return(R?-1:1)*g*Math.pow(2,m-a)},Yy=function(n,t,r,a,h,m){var g,_,w,k=8*m-h-1,E=(1<<k)-1,P=E>>1,A=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=0,j=1,O=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(_=isNaN(t)?1:0,g=E):(g=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-g))<1&&(g--,w*=2),(t+=g+P>=1?A/w:A*Math.pow(2,1-P))*w>=2&&(g++,w/=2),g+P>=E?(_=0,g=E):g+P>=1?(_=(t*w-1)*Math.pow(2,h),g+=P):(_=t*Math.pow(2,P-1)*Math.pow(2,h),g=0));h>=8;n[r+R]=255&_,R+=j,_/=256,h-=8);for(g=g<<h|_,k+=h;k>0;n[r+R]=255&g,R+=j,g/=256,k-=8);n[r+R-j]|=128*O};function Vt(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}Vt.Varint=0,Vt.Fixed64=1,Vt.Bytes=2,Vt.Fixed32=5;var Sf=4294967296,Qy=1/Sf,e_=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function ko(n){return n.type===Vt.Bytes?n.readVarint()+n.pos:n.pos+1}function Tl(n,t,r){return r?4294967296*t+(n>>>0):4294967296*(t>>>0)+(n>>>0)}function t_(n,t,r){var a=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(a);for(var h=r.pos-1;h>=n;h--)r.buf[h+a]=r.buf[h]}function Vw(n,t){for(var r=0;r<n.length;r++)t.writeVarint(n[r])}function Uw(n,t){for(var r=0;r<n.length;r++)t.writeSVarint(n[r])}function $w(n,t){for(var r=0;r<n.length;r++)t.writeFloat(n[r])}function Zw(n,t){for(var r=0;r<n.length;r++)t.writeDouble(n[r])}function qw(n,t){for(var r=0;r<n.length;r++)t.writeBoolean(n[r])}function Gw(n,t){for(var r=0;r<n.length;r++)t.writeFixed32(n[r])}function Hw(n,t){for(var r=0;r<n.length;r++)t.writeSFixed32(n[r])}function Ww(n,t){for(var r=0;r<n.length;r++)t.writeFixed64(n[r])}function Xw(n,t){for(var r=0;r<n.length;r++)t.writeSFixed64(n[r])}function ed(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+16777216*n[t+3]}function Il(n,t,r){n[r]=t,n[r+1]=t>>>8,n[r+2]=t>>>16,n[r+3]=t>>>24}function i_(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+(n[t+3]<<24)}Vt.prototype={destroy:function(){this.buf=null},readFields:function(n,t,r){for(r=r||this.length;this.pos<r;){var a=this.readVarint(),h=a>>3,m=this.pos;this.type=7&a,n(h,t,this),this.pos===m&&this.skip(a)}return t},readMessage:function(n,t){return this.readFields(n,t,this.readVarint()+this.pos)},readFixed32:function(){var n=ed(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=i_(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=ed(this.buf,this.pos)+ed(this.buf,this.pos+4)*Sf;return this.pos+=8,n},readSFixed64:function(){var n=ed(this.buf,this.pos)+i_(this.buf,this.pos+4)*Sf;return this.pos+=8,n},readFloat:function(){var n=Jy(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=Jy(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var t,r,a=this.buf;return t=127&(r=a[this.pos++]),r<128?t:(t|=(127&(r=a[this.pos++]))<<7,r<128?t:(t|=(127&(r=a[this.pos++]))<<14,r<128?t:(t|=(127&(r=a[this.pos++]))<<21,r<128?t:function(h,m,g){var _,w,k=g.buf;if(_=(112&(w=k[g.pos++]))>>4,w<128||(_|=(127&(w=k[g.pos++]))<<3,w<128)||(_|=(127&(w=k[g.pos++]))<<10,w<128)||(_|=(127&(w=k[g.pos++]))<<17,w<128)||(_|=(127&(w=k[g.pos++]))<<24,w<128)||(_|=(1&(w=k[g.pos++]))<<31,w<128))return Tl(h,_,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=a[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,t=this.pos;return this.pos=n,n-t>=12&&e_?function(r,a,h){return e_.decode(r.subarray(a,h))}(this.buf,t,n):function(r,a,h){for(var m="",g=a;g<h;){var _,w,k,E=r[g],P=null,A=E>239?4:E>223?3:E>191?2:1;if(g+A>h)break;A===1?E<128&&(P=E):A===2?(192&(_=r[g+1]))==128&&(P=(31&E)<<6|63&_)<=127&&(P=null):A===3?(w=r[g+2],(192&(_=r[g+1]))==128&&(192&w)==128&&((P=(15&E)<<12|(63&_)<<6|63&w)<=2047||P>=55296&&P<=57343)&&(P=null)):A===4&&(w=r[g+2],k=r[g+3],(192&(_=r[g+1]))==128&&(192&w)==128&&(192&k)==128&&((P=(15&E)<<18|(63&_)<<12|(63&w)<<6|63&k)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,A=1):P>65535&&(P-=65536,m+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),m+=String.fromCharCode(P),g+=A}return m}(this.buf,t,n)},readBytes:function(){var n=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,n);return this.pos=n,t},readPackedVarint:function(n,t){if(this.type!==Vt.Bytes)return n.push(this.readVarint(t));var r=ko(this);for(n=n||[];this.pos<r;)n.push(this.readVarint(t));return n},readPackedSVarint:function(n){if(this.type!==Vt.Bytes)return n.push(this.readSVarint());var t=ko(this);for(n=n||[];this.pos<t;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==Vt.Bytes)return n.push(this.readBoolean());var t=ko(this);for(n=n||[];this.pos<t;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==Vt.Bytes)return n.push(this.readFloat());var t=ko(this);for(n=n||[];this.pos<t;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==Vt.Bytes)return n.push(this.readDouble());var t=ko(this);for(n=n||[];this.pos<t;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==Vt.Bytes)return n.push(this.readFixed32());var t=ko(this);for(n=n||[];this.pos<t;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==Vt.Bytes)return n.push(this.readSFixed32());var t=ko(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==Vt.Bytes)return n.push(this.readFixed64());var t=ko(this);for(n=n||[];this.pos<t;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==Vt.Bytes)return n.push(this.readSFixed64());var t=ko(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed64());return n},skip:function(n){var t=7&n;if(t===Vt.Varint)for(;this.buf[this.pos++]>127;);else if(t===Vt.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Vt.Fixed32)this.pos+=4;else{if(t!==Vt.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(n,t){this.writeVarint(n<<3|t)},realloc:function(n){for(var t=this.length||16;t<this.pos+n;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Il(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Il(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Il(this.buf,-1&n,this.pos),Il(this.buf,Math.floor(n*Qy),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Il(this.buf,-1&n,this.pos),Il(this.buf,Math.floor(n*Qy),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(t,r){var a,h;if(t>=0?(a=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(a=~(-t%4294967296))?a=a+1|0:(a=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(m,g,_){_.buf[_.pos++]=127&m|128,m>>>=7,_.buf[_.pos++]=127&m|128,m>>>=7,_.buf[_.pos++]=127&m|128,m>>>=7,_.buf[_.pos++]=127&m|128,_.buf[_.pos]=127&(m>>>=7)}(a,0,r),function(m,g){var _=(7&m)<<4;g.buf[g.pos++]|=_|((m>>>=3)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m)))))}(h,r)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var t=this.pos;this.pos=function(a,h,m){for(var g,_,w=0;w<h.length;w++){if((g=h.charCodeAt(w))>55295&&g<57344){if(!_){g>56319||w+1===h.length?(a[m++]=239,a[m++]=191,a[m++]=189):_=g;continue}if(g<56320){a[m++]=239,a[m++]=191,a[m++]=189,_=g;continue}g=_-55296<<10|g-56320|65536,_=null}else _&&(a[m++]=239,a[m++]=191,a[m++]=189,_=null);g<128?a[m++]=g:(g<2048?a[m++]=g>>6|192:(g<65536?a[m++]=g>>12|224:(a[m++]=g>>18|240,a[m++]=g>>12&63|128),a[m++]=g>>6&63|128),a[m++]=63&g|128)}return m}(this.buf,n,this.pos);var r=this.pos-t;r>=128&&t_(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(n){this.realloc(4),Yy(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),Yy(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var t=n.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=n[r]},writeRawMessage:function(n,t){this.pos++;var r=this.pos;n(t,this);var a=this.pos-r;a>=128&&t_(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeMessage:function(n,t,r){this.writeTag(n,Vt.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(n,t){t.length&&this.writeMessage(n,Vw,t)},writePackedSVarint:function(n,t){t.length&&this.writeMessage(n,Uw,t)},writePackedBoolean:function(n,t){t.length&&this.writeMessage(n,qw,t)},writePackedFloat:function(n,t){t.length&&this.writeMessage(n,$w,t)},writePackedDouble:function(n,t){t.length&&this.writeMessage(n,Zw,t)},writePackedFixed32:function(n,t){t.length&&this.writeMessage(n,Gw,t)},writePackedSFixed32:function(n,t){t.length&&this.writeMessage(n,Hw,t)},writePackedFixed64:function(n,t){t.length&&this.writeMessage(n,Ww,t)},writePackedSFixed64:function(n,t){t.length&&this.writeMessage(n,Xw,t)},writeBytesField:function(n,t){this.writeTag(n,Vt.Bytes),this.writeBytes(t)},writeFixed32Field:function(n,t){this.writeTag(n,Vt.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(n,t){this.writeTag(n,Vt.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(n,t){this.writeTag(n,Vt.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(n,t){this.writeTag(n,Vt.Fixed64),this.writeSFixed64(t)},writeVarintField:function(n,t){this.writeTag(n,Vt.Varint),this.writeVarint(t)},writeSVarintField:function(n,t){this.writeTag(n,Vt.Varint),this.writeSVarint(t)},writeStringField:function(n,t){this.writeTag(n,Vt.Bytes),this.writeString(t)},writeFloatField:function(n,t){this.writeTag(n,Vt.Fixed32),this.writeFloat(t)},writeDoubleField:function(n,t){this.writeTag(n,Vt.Fixed64),this.writeDouble(t)},writeBooleanField:function(n,t){this.writeVarintField(n,!!t)}};var Tf=U(Ky);const If=3;function Kw(n,t,r){n===1&&r.readMessage(Jw,t)}function Jw(n,t,r){if(n===3){const{id:a,bitmap:h,width:m,height:g,left:_,top:w,advance:k}=r.readMessage(Yw,{});t.push({id:a,bitmap:new tc({width:m+2*If,height:g+2*If},h),metrics:{width:m,height:g,left:_,top:w,advance:k}})}}function Yw(n,t,r){n===1?t.id=r.readVarint():n===2?t.bitmap=r.readBytes():n===3?t.width=r.readVarint():n===4?t.height=r.readVarint():n===5?t.left=r.readSVarint():n===6?t.top=r.readSVarint():n===7&&(t.advance=r.readVarint())}const n_=If;function r_(n){let t=0,r=0;for(const g of n)t+=g.w*g.h,r=Math.max(r,g.w);n.sort((g,_)=>_.h-g.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let h=0,m=0;for(const g of n)for(let _=a.length-1;_>=0;_--){const w=a[_];if(!(g.w>w.w||g.h>w.h)){if(g.x=w.x,g.y=w.y,m=Math.max(m,g.y+g.h),h=Math.max(h,g.x+g.w),g.w===w.w&&g.h===w.h){const k=a.pop();_<a.length&&(a[_]=k)}else g.h===w.h?(w.x+=g.w,w.w-=g.w):g.w===w.w?(w.y+=g.h,w.h-=g.h):(a.push({x:w.x+g.w,y:w.y,w:w.w-g.w,h:g.h}),w.y+=g.h,w.h-=g.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}const Sn=1;class kf{constructor(t,{pixelRatio:r,version:a,stretchX:h,stretchY:m,content:g,textFitWidth:_,textFitHeight:w}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=h,this.stretchY=m,this.content=g,this.version=a,this.textFitWidth=_,this.textFitHeight=w}get tl(){return[this.paddedRect.x+Sn,this.paddedRect.y+Sn]}get br(){return[this.paddedRect.x+this.paddedRect.w-Sn,this.paddedRect.y+this.paddedRect.h-Sn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Sn)/this.pixelRatio,(this.paddedRect.h-2*Sn)/this.pixelRatio]}}class o_{constructor(t,r){const a={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,a,m),this.addImages(r,h,m);const{w:g,h:_}=r_(m),w=new er({width:g||1,height:_||1});for(const k in t){const E=t[k],P=a[k].paddedRect;er.copy(E.data,w,{x:0,y:0},{x:P.x+Sn,y:P.y+Sn},E.data)}for(const k in r){const E=r[k],P=h[k].paddedRect,A=P.x+Sn,R=P.y+Sn,j=E.data.width,O=E.data.height;er.copy(E.data,w,{x:0,y:0},{x:A,y:R},E.data),er.copy(E.data,w,{x:0,y:O-1},{x:A,y:R-1},{width:j,height:1}),er.copy(E.data,w,{x:0,y:0},{x:A,y:R+O},{width:j,height:1}),er.copy(E.data,w,{x:j-1,y:0},{x:A-1,y:R},{width:1,height:O}),er.copy(E.data,w,{x:0,y:0},{x:A+j,y:R},{width:1,height:O})}this.image=w,this.iconPositions=a,this.patternPositions=h}addImages(t,r,a){for(const h in t){const m=t[h],g={x:0,y:0,w:m.data.width+2*Sn,h:m.data.height+2*Sn};a.push(g),r[h]=new kf(g,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in t.updatedImages)this.patchUpdatedImage(this.iconPositions[a],t.getImage(a),r),this.patchUpdatedImage(this.patternPositions[a],t.getImage(a),r)}patchUpdatedImage(t,r,a){if(!t||!r||t.version===r.version)return;t.version=r.version;const[h,m]=t.tl;a.update(r.data,void 0,{x:h,y:m})}}var gs;qe("ImagePosition",kf),qe("ImageAtlas",o_),S.ah=void 0,(gs=S.ah||(S.ah={}))[gs.none=0]="none",gs[gs.horizontal=1]="horizontal",gs[gs.vertical=2]="vertical",gs[gs.horizontalOnly=3]="horizontalOnly";const lc=-17;class uc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const a=new uc;return a.scale=t||1,a.fontStack=r,a}static forImage(t){const r=new uc;return r.imageName=t,r}}class kl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const a=new kl;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?a.addImageSection(m):a.addTextSection(m,r)}return a}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let r="";for(let a=0;a<t.length;a++){const h=t.charCodeAt(a+1)||null,m=t.charCodeAt(a-1)||null;r+=h&&Nh(h)&&!ac[t[a+1]]||m&&Nh(m)&&!ac[t[a-1]]||!ac[t[a]]?t[a]:ac[t[a]]}return r}(this.text)}trim(){let t=0;for(let a=0;a<this.text.length&&id[this.text.charCodeAt(a)];a++)t++;let r=this.text.length;for(let a=this.text.length-1;a>=0&&a>=t&&id[this.text.charCodeAt(a)];a--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const a=new kl;return a.text=this.text.substring(t,r),a.sectionIndex=this.sectionIndex.slice(t,r),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(uc.forText(t.scale,t.fontStack||r));const a=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(a)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void oi("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(uc.forImage(r)),this.sectionIndex.push(this.sections.length-1)):oi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function td(n,t,r,a,h,m,g,_,w,k,E,P,A,R,j){const O=kl.fromFeature(n,h);let G;P===S.ah.vertical&&O.verticalizePunctuation();const{processBidirectionalText:J,processStyledBidirectionalText:pe}=wn;if(J&&O.sections.length===1){G=[];const _e=J(O.toString(),Ef(O,k,m,t,a,R));for(const Te of _e){const Ve=new kl;Ve.text=Te,Ve.sections=O.sections;for(let st=0;st<Te.length;st++)Ve.sectionIndex.push(0);G.push(Ve)}}else if(pe){G=[];const _e=pe(O.text,O.sectionIndex,Ef(O,k,m,t,a,R));for(const Te of _e){const Ve=new kl;Ve.text=Te[0],Ve.sectionIndex=Te[1],Ve.sections=O.sections,G.push(Ve)}}else G=function(_e,Te){const Ve=[],st=_e.text;let Oe=0;for(const Fe of Te)Ve.push(_e.substring(Oe,Fe)),Oe=Fe;return Oe<st.length&&Ve.push(_e.substring(Oe,st.length)),Ve}(O,Ef(O,k,m,t,a,R));const re=[],he={positionedLines:re,text:O.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:P,iconsInText:!1,verticalizable:!1};return function(_e,Te,Ve,st,Oe,Fe,Qe,Ge,Ze,xe,et,Ye){let ct=0,$t=lc,Ut=0,Ti=0;const wr=Ge==="right"?1:Ge==="left"?0:.5;let Ni=0;for(const li of Oe){li.trim();const ki=li.getMaxScale(),Xi=(ki-1)*vi,Vi={positionedGlyphs:[],lineOffset:0};_e.positionedLines[Ni]=Vi;const dn=Vi.positionedGlyphs;let Ui=0;if(!li.length()){$t+=Fe,++Ni;continue}for(let Tn=0;Tn<li.length();Tn++){const zt=li.getSection(Tn),qt=li.getSectionIndex(Tn),Jt=li.getCharCode(Tn);let Bn=0,ii=null,Ml=null,eo=null,to=vi;const br=!(Ze===S.ah.horizontal||!et&&!Wu(Jt)||et&&(id[Jt]||(Ii=Jt,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Ii)))));if(zt.imageName){const nr=st[zt.imageName];if(!nr)continue;eo=zt.imageName,_e.iconsInText=_e.iconsInText||!0,Ml=nr.paddedRect;const zi=nr.displaySize;zt.scale=zt.scale*vi/Ye,ii={width:zi[0],height:zi[1],left:Sn,top:-n_,advance:br?zi[1]:zi[0]},Bn=Xi+(vi-zi[1]*zt.scale),to=ii.advance;const Eo=br?zi[0]*zt.scale-vi*ki:zi[1]*zt.scale-vi*ki;Eo>0&&Eo>Ui&&(Ui=Eo)}else{const nr=Ve[zt.fontStack],zi=nr&&nr[Jt];if(zi&&zi.rect)Ml=zi.rect,ii=zi.metrics;else{const Eo=Te[zt.fontStack],mc=Eo&&Eo[Jt];if(!mc)continue;ii=mc.metrics}Bn=(ki-zt.scale)*vi}br?(_e.verticalizable=!0,dn.push({glyph:Jt,imageName:eo,x:ct,y:$t+Bn,vertical:br,scale:zt.scale,fontStack:zt.fontStack,sectionIndex:qt,metrics:ii,rect:Ml}),ct+=to*zt.scale+xe):(dn.push({glyph:Jt,imageName:eo,x:ct,y:$t+Bn,vertical:br,scale:zt.scale,fontStack:zt.fontStack,sectionIndex:qt,metrics:ii,rect:Ml}),ct+=ii.advance*zt.scale+xe)}dn.length!==0&&(Ut=Math.max(ct-xe,Ut),ib(dn,0,dn.length-1,wr,Ui)),ct=0;const ir=Fe*ki+Ui;Vi.lineOffset=Math.max(Ui,Xi),$t+=ir,Ti=Math.max(ir,Ti),++Ni}var Ii;const un=$t-lc,{horizontalAlign:cn,verticalAlign:hn}=Cf(Qe);(function(li,ki,Xi,Vi,dn,Ui,ir,Tn,zt){const qt=(ki-Xi)*dn;let Jt=0;Jt=Ui!==ir?-Tn*Vi-lc:(-Vi*zt+.5)*ir;for(const Bn of li)for(const ii of Bn.positionedGlyphs)ii.x+=qt,ii.y+=Jt})(_e.positionedLines,wr,cn,hn,Ut,Ti,Fe,un,Oe.length),_e.top+=-hn*un,_e.bottom=_e.top+un,_e.left+=-cn*Ut,_e.right=_e.left+Ut}(he,t,r,a,G,g,_,w,P,k,A,j),!function(_e){for(const Te of _e)if(Te.positionedGlyphs.length!==0)return!1;return!0}(re)&&he}const id={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Qw={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},eb={40:!0};function s_(n,t,r,a,h,m){if(t.imageName){const g=a[t.imageName];return g?g.displaySize[0]*t.scale*vi/m+h:0}{const g=r[t.fontStack],_=g&&g[n];return _?_.metrics.advance*t.scale+h:0}}function a_(n,t,r,a){const h=Math.pow(n-t,2);return a?n<t?h/2:2*h:h+Math.abs(r)*r}function tb(n,t,r){let a=0;return n===10&&(a-=1e4),r&&(a+=150),n!==40&&n!==65288||(a+=50),t!==41&&t!==65289||(a+=50),a}function l_(n,t,r,a,h,m){let g=null,_=a_(t,r,h,m);for(const w of a){const k=a_(t-w.x,r,h,m)+w.badness;k<=_&&(g=w,_=k)}return{index:n,x:t,priorBreak:g,badness:_}}function u_(n){return n?u_(n.priorBreak).concat(n.index):[]}function Ef(n,t,r,a,h,m){if(!n)return[];const g=[],_=function(P,A,R,j,O,G){let J=0;for(let pe=0;pe<P.length();pe++){const re=P.getSection(pe);J+=s_(P.getCharCode(pe),re,j,O,A,G)}return J/Math.max(1,Math.ceil(J/R))}(n,t,r,a,h,m),w=n.text.indexOf("")>=0;let k=0;for(let P=0;P<n.length();P++){const A=n.getSection(P),R=n.getCharCode(P);if(id[R]||(k+=s_(R,A,a,h,t,m)),P<n.length()-1){const j=!((E=R)<11904)&&(!!Tt["CJK Compatibility Forms"](E)||!!Tt["CJK Compatibility"](E)||!!Tt["CJK Strokes"](E)||!!Tt["CJK Symbols and Punctuation"](E)||!!Tt["Enclosed CJK Letters and Months"](E)||!!Tt["Halfwidth and Fullwidth Forms"](E)||!!Tt["Ideographic Description Characters"](E)||!!Tt["Vertical Forms"](E)||Oh.test(String.fromCodePoint(E)));(Qw[R]||j||A.imageName||P!==n.length()-2&&eb[n.getCharCode(P+1)])&&g.push(l_(P+1,k,_,g,tb(R,n.getCharCode(P+1),j&&w),!1))}}var E;return u_(l_(n.length(),k,_,g,0,!0))}function Cf(n){let t=.5,r=.5;switch(n){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function ib(n,t,r,a,h){if(!a&&!h)return;const m=n[r],g=(n[r].x+m.metrics.advance*m.scale)*a;for(let _=t;_<=r;_++)n[_].x-=g,n[_].y+=h}function nb(n,t,r){const{horizontalAlign:a,verticalAlign:h}=Cf(r),m=t[0]-n.displaySize[0]*a,g=t[1]-n.displaySize[1]*h;return{image:n,top:g,bottom:g+n.displaySize[1],left:m,right:m+n.displaySize[0]}}function c_(n){var t,r;let a=n.left,h=n.top,m=n.right-a,g=n.bottom-h;const _=(t=n.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",w=(r=n.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",k=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(w==="proportional"){if(_==="stretchOnly"&&m/g<k||_==="proportional"){const E=Math.ceil(g*k);a*=E/m,m=E}}else if(_==="proportional"&&w==="stretchOnly"&&k!==0&&m/g>k){const E=Math.ceil(m/k);h*=E/g,g=E}return{x1:a,y1:h,x2:a+m,y2:h+g}}function h_(n,t,r,a,h,m){const g=n.image;let _;if(g.content){const G=g.content,J=g.pixelRatio||1;_=[G[0]/J,G[1]/J,g.displaySize[0]-G[2]/J,g.displaySize[1]-G[3]/J]}const w=t.left*m,k=t.right*m;let E,P,A,R;r==="width"||r==="both"?(R=h[0]+w-a[3],P=h[0]+k+a[1]):(R=h[0]+(w+k-g.displaySize[0])/2,P=R+g.displaySize[0]);const j=t.top*m,O=t.bottom*m;return r==="height"||r==="both"?(E=h[1]+j-a[0],A=h[1]+O+a[2]):(E=h[1]+(j+O-g.displaySize[1])/2,A=E+g.displaySize[1]),{image:g,top:E,right:P,bottom:A,left:R,collisionPadding:_}}const cc=255,Qr=128,ys=cc*Qr;function d_(n,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Ht(n+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=r;let m=0;for(;m<a.length&&a[m]<=n;)m++;m=Math.max(0,m-1);let g=m;for(;g<a.length&&a[g]<n+1;)g++;g=Math.min(a.length-1,g);const _=a[m],w=a[g];return r.kind==="composite"?{kind:"composite",minZoom:_,maxZoom:w,interpolationType:h}:{kind:"camera",minZoom:_,maxZoom:w,minSize:r.evaluate(new Ht(_)),maxSize:r.evaluate(new Ht(w)),interpolationType:h}}}function Pf(n,t,r){let a="never";const h=n.get(t);return h?a=h:n.get(r)&&(a="always"),a}const rb=ms.VectorTileFeature.types,ob=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nd(n,t,r,a,h,m,g,_,w,k,E,P,A){const R=_?Math.min(ys,Math.round(_[0])):0,j=_?Math.min(ys,Math.round(_[1])):0;n.emplaceBack(t,r,Math.round(32*a),Math.round(32*h),m,g,(R<<1)+(w?1:0),j,16*k,16*E,256*P,256*A)}function Mf(n,t,r){n.emplaceBack(t.x,t.y,r),n.emplaceBack(t.x,t.y,r),n.emplaceBack(t.x,t.y,r),n.emplaceBack(t.x,t.y,r)}function sb(n){for(const t of n.sections)if(rf(t.text))return!0;return!1}class zf{constructor(t){this.layoutVertexArray=new ml,this.indexArray=new Qn,this.programConfigurations=t,this.segments=new It,this.dynamicLayoutVertexArray=new Ju,this.opacityVertexArray=new Rn,this.hasVisibleVertices=!1,this.placedSymbolArray=new Wt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Fw.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Bw.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,ob,!0),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}qe("SymbolBuffers",zf);class Af{constructor(t,r,a){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new a,this.segments=new It,this.collisionVertexArray=new Jr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,jw.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}qe("CollisionBuffers",Af);class El{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(g=>g.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=hf([]),this.placementViewportMatrix=hf([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=d_(this.zoom,r["text-size"]),this.iconSizeData=d_(this.zoom,r["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=Pf(a,"text-overlap","text-allow-overlap")!=="never"||Pf(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(g=>S.ah[g])),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=t.sourceID}createArrays(){this.text=new zf(new fa(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new zf(new fa(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Xt,this.lineVertexArray=new Fi,this.symbolInstances=new St,this.textAnchorOffsets=new Kt}calculateGlyphDependencies(t,r,a,h,m){for(let g=0;g<t.length;g++)if(r[t.charCodeAt(g)]=!0,(a||h)&&m){const _=ac[t.charAt(g)];_&&(r[_.charCodeAt(0)]=!0)}}populate(t,r,a){const h=this.layers[0],m=h.layout,g=m.get("text-font"),_=m.get("text-field"),w=m.get("icon-image"),k=(_.value.kind!=="constant"||_.value.value instanceof yn&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),E=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,P=m.get("symbol-sort-key");if(this.features=[],!k&&!E)return;const A=r.iconDependencies,R=r.glyphDependencies,j=r.availableImages,O=new Ht(this.zoom);for(const{feature:G,id:J,index:pe,sourceLayerIndex:re}of t){const he=h._featureFilter.needGeometry,_e=ga(G,he);if(!h._featureFilter.filter(O,_e,a))continue;let Te,Ve;if(he||(_e.geometry=ma(G)),k){const Oe=h.getValueAndResolveTokens("text-field",_e,a,j),Fe=yn.factory(Oe),Qe=this.hasRTLText=this.hasRTLText||sb(Fe);(!Qe||wn.getRTLTextPluginStatus()==="unavailable"||Qe&&wn.isParsed())&&(Te=Nw(Fe,h,_e))}if(E){const Oe=h.getValueAndResolveTokens("icon-image",_e,a,j);Ve=Oe instanceof vn?Oe:vn.fromString(Oe)}if(!Te&&!Ve)continue;const st=this.sortFeaturesByKey?P.evaluate(_e,{},a):void 0;if(this.features.push({id:J,text:Te,icon:Ve,index:pe,sourceLayerIndex:re,geometry:_e.geometry,properties:G.properties,type:rb[G.type],sortKey:st}),Ve&&(A[Ve.name]=!0),Te){const Oe=g.evaluate(_e,{},a).join(","),Fe=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(S.ah.vertical)>=0;for(const Qe of Te.sections)if(Qe.image)A[Qe.image.name]=!0;else{const Ge=Gu(Te.toString()),Ze=Qe.fontStack||Oe,xe=R[Ze]=R[Ze]||{};this.calculateGlyphDependencies(Qe.text,xe,Fe,this.allowVerticalPlacement,Ge)}}}m.get("symbol-placement")==="line"&&(this.features=function(G){const J={},pe={},re=[];let he=0;function _e(Oe){re.push(G[Oe]),he++}function Te(Oe,Fe,Qe){const Ge=pe[Oe];return delete pe[Oe],pe[Fe]=Ge,re[Ge].geometry[0].pop(),re[Ge].geometry[0]=re[Ge].geometry[0].concat(Qe[0]),Ge}function Ve(Oe,Fe,Qe){const Ge=J[Fe];return delete J[Fe],J[Oe]=Ge,re[Ge].geometry[0].shift(),re[Ge].geometry[0]=Qe[0].concat(re[Ge].geometry[0]),Ge}function st(Oe,Fe,Qe){const Ge=Qe?Fe[0][Fe[0].length-1]:Fe[0][0];return`${Oe}:${Ge.x}:${Ge.y}`}for(let Oe=0;Oe<G.length;Oe++){const Fe=G[Oe],Qe=Fe.geometry,Ge=Fe.text?Fe.text.toString():null;if(!Ge){_e(Oe);continue}const Ze=st(Ge,Qe),xe=st(Ge,Qe,!0);if(Ze in pe&&xe in J&&pe[Ze]!==J[xe]){const et=Ve(Ze,xe,Qe),Ye=Te(Ze,xe,re[et].geometry);delete J[Ze],delete pe[xe],pe[st(Ge,re[Ye].geometry,!0)]=Ye,re[et].geometry=null}else Ze in pe?Te(Ze,xe,Qe):xe in J?Ve(Ze,xe,Qe):(_e(Oe),J[Ze]=he-1,pe[xe]=he-1)}return re.filter(Oe=>Oe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((G,J)=>G.sortKey-J.sortKey)}update(t,r,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,a),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const a=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(r[t.segment+1]),m=t.dist(r[t.segment]);const g={};for(let _=t.segment+1;_<r.length;_++)g[_]={x:r[_].x,y:r[_].y,tileUnitDistanceFromAnchor:h},_<r.length-1&&(h+=r[_+1].dist(r[_]));for(let _=t.segment||0;_>=0;_--)g[_]={x:r[_].x,y:r[_].y,tileUnitDistanceFromAnchor:m},_>0&&(m+=r[_-1].dist(r[_]));for(let _=0;_<r.length;_++){const w=g[_];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(t,r,a,h,m,g,_,w,k,E,P,A){const R=t.indexArray,j=t.layoutVertexArray,O=t.segments.prepareSegment(4*r.length,j,R,this.canOverlap?g.sortKey:void 0),G=this.glyphOffsetArray.length,J=O.vertexLength,pe=this.allowVerticalPlacement&&_===S.ah.vertical?Math.PI/2:0,re=g.text&&g.text.sections;for(let he=0;he<r.length;he++){const{tl:_e,tr:Te,bl:Ve,br:st,tex:Oe,pixelOffsetTL:Fe,pixelOffsetBR:Qe,minFontScaleX:Ge,minFontScaleY:Ze,glyphOffset:xe,isSDF:et,sectionIndex:Ye}=r[he],ct=O.vertexLength,$t=xe[1];nd(j,w.x,w.y,_e.x,$t+_e.y,Oe.x,Oe.y,a,et,Fe.x,Fe.y,Ge,Ze),nd(j,w.x,w.y,Te.x,$t+Te.y,Oe.x+Oe.w,Oe.y,a,et,Qe.x,Fe.y,Ge,Ze),nd(j,w.x,w.y,Ve.x,$t+Ve.y,Oe.x,Oe.y+Oe.h,a,et,Fe.x,Qe.y,Ge,Ze),nd(j,w.x,w.y,st.x,$t+st.y,Oe.x+Oe.w,Oe.y+Oe.h,a,et,Qe.x,Qe.y,Ge,Ze),Mf(t.dynamicLayoutVertexArray,w,pe),R.emplaceBack(ct,ct+1,ct+2),R.emplaceBack(ct+1,ct+2,ct+3),O.vertexLength+=4,O.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(xe[0]),he!==r.length-1&&Ye===r[he+1].sectionIndex||t.programConfigurations.populatePaintArrays(j.length,g,g.index,{},A,re&&re[Ye])}t.placedSymbolArray.emplaceBack(w.x,w.y,G,this.glyphOffsetArray.length-G,J,k,E,w.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],_,0,!1,0,P)}_addCollisionDebugVertex(t,r,a,h,m,g){return r.emplaceBack(0,0),t.emplaceBack(a.x,a.y,h,m,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(t,r,a,h,m,g,_){const w=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),k=w.vertexLength,E=m.layoutVertexArray,P=m.collisionVertexArray,A=_.anchorX,R=_.anchorY;this._addCollisionDebugVertex(E,P,g,A,R,new X(t,r)),this._addCollisionDebugVertex(E,P,g,A,R,new X(a,r)),this._addCollisionDebugVertex(E,P,g,A,R,new X(a,h)),this._addCollisionDebugVertex(E,P,g,A,R,new X(t,h)),w.vertexLength+=4;const j=m.indexArray;j.emplaceBack(k,k+1),j.emplaceBack(k+1,k+2),j.emplaceBack(k+2,k+3),j.emplaceBack(k+3,k),w.primitiveLength+=4}addDebugCollisionBoxes(t,r,a,h){for(let m=t;m<r;m++){const g=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,h?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Af(Fn,Xy.members,Mi),this.iconCollisionBox=new Af(Fn,Xy.members,Mi);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,a,h,m,g,_,w,k){const E={};for(let P=r;P<a;P++){const A=t.get(P);E.textBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,anchorPointX:A.anchorPointX,anchorPointY:A.anchorPointY},E.textFeatureIndex=A.featureIndex;break}for(let P=h;P<m;P++){const A=t.get(P);E.verticalTextBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,anchorPointX:A.anchorPointX,anchorPointY:A.anchorPointY},E.verticalTextFeatureIndex=A.featureIndex;break}for(let P=g;P<_;P++){const A=t.get(P);E.iconBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,anchorPointX:A.anchorPointX,anchorPointY:A.anchorPointY},E.iconFeatureIndex=A.featureIndex;break}for(let P=w;P<k;P++){const A=t.get(P);E.verticalIconBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,anchorPointX:A.anchorPointX,anchorPointY:A.anchorPointY},E.verticalIconFeatureIndex=A.featureIndex;break}return E}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const a=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const a=t.placedSymbolArray.get(r),h=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+1,m+2),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),a=Math.cos(t),h=[],m=[],g=[];for(let _=0;_<this.symbolInstances.length;++_){g.push(_);const w=this.symbolInstances.get(_);h.push(0|Math.round(r*w.anchorX+a*w.anchorY)),m.push(w.featureIndex)}return g.sort((_,w)=>h[_]-h[w]||m[w]-m[_]),g}addToSortKeyRanges(t,r){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===r?a.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const a=this.symbolInstances.get(r);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((h,m,g)=>{h>=0&&g.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let p_,f_;qe("SymbolBucket",El,{omit:["layers","collisionBoxArray","features","compareText"]}),El.MAX_GLYPHS=65535,El.addDynamicAttributes=Mf;var Df={get paint(){return f_=f_||new f({"icon-opacity":new at(ye.paint_symbol["icon-opacity"]),"icon-color":new at(ye.paint_symbol["icon-color"]),"icon-halo-color":new at(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new at(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new at(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Xe(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xe(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new at(ye.paint_symbol["text-opacity"]),"text-color":new at(ye.paint_symbol["text-color"],{runtimeType:rn,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new at(ye.paint_symbol["text-halo-color"]),"text-halo-width":new at(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new at(ye.paint_symbol["text-halo-blur"]),"text-translate":new Xe(ye.paint_symbol["text-translate"]),"text-translate-anchor":new Xe(ye.paint_symbol["text-translate-anchor"])})},get layout(){return p_=p_||new f({"symbol-placement":new Xe(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Xe(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xe(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new at(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xe(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xe(ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Xe(ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Xe(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xe(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xe(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new at(ye.layout_symbol["icon-size"]),"icon-text-fit":new Xe(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xe(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new at(ye.layout_symbol["icon-image"]),"icon-rotate":new at(ye.layout_symbol["icon-rotate"]),"icon-padding":new at(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Xe(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new at(ye.layout_symbol["icon-offset"]),"icon-anchor":new at(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xe(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xe(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xe(ye.layout_symbol["text-rotation-alignment"]),"text-field":new at(ye.layout_symbol["text-field"]),"text-font":new at(ye.layout_symbol["text-font"]),"text-size":new at(ye.layout_symbol["text-size"]),"text-max-width":new at(ye.layout_symbol["text-max-width"]),"text-line-height":new Xe(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new at(ye.layout_symbol["text-letter-spacing"]),"text-justify":new at(ye.layout_symbol["text-justify"]),"text-radial-offset":new at(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xe(ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new at(ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new at(ye.layout_symbol["text-anchor"]),"text-max-angle":new Xe(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Xe(ye.layout_symbol["text-writing-mode"]),"text-rotate":new at(ye.layout_symbol["text-rotate"]),"text-padding":new Xe(ye.layout_symbol["text-padding"]),"text-keep-upright":new Xe(ye.layout_symbol["text-keep-upright"]),"text-transform":new at(ye.layout_symbol["text-transform"]),"text-offset":new at(ye.layout_symbol["text-offset"]),"text-allow-overlap":new Xe(ye.layout_symbol["text-allow-overlap"]),"text-overlap":new Xe(ye.layout_symbol["text-overlap"]),"text-ignore-placement":new Xe(ye.layout_symbol["text-ignore-placement"]),"text-optional":new Xe(ye.layout_symbol["text-optional"])})}};class m_{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Hr,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}qe("FormatSectionOverride",m_,{omit:["defaultValue"]});class rd extends s{constructor(t){super(t,Df)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const m of a)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,a,h){const m=this.layout.get(t).evaluate(r,{},a,h),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||el(g.value)||!m?m:function(_,w){return w.replace(/{([^{}]+)}/g,(k,E)=>_&&E in _?String(_[E]):"")}(r.properties,m)}createBucket(t){return new El(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Df.paint.overridableProperties){if(!rd.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),a=new m_(r),h=new Qa(a,r.property.specification);let m=null;m=r.value.kind==="constant"||r.value.kind==="source"?new Qo("source",h):new es("composite",h,r.value.zoomStops),this.paint._values[t]=new vr(r.property,m,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,a){return!(!this.layout||r.isDataDriven()||a.isDataDriven())&&rd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const a=t.get("text-field"),h=Df.paint.properties[r];let m=!1;const g=_=>{for(const w of _)if(h.overrides&&h.overrides.hasOverride(w))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof yn)g(a.value.value.sections);else if(a.value.kind==="source"){const _=k=>{m||(k instanceof Hn&&gi(k.value)===zr?g(k.value.sections):k instanceof Za?g(k.sections):k.eachChild(_))},w=a.value;w._styleExpression&&_(w._styleExpression.expression)}return m}}let g_;var ab={get paint(){return g_=g_||new f({"background-color":new Xe(ye.paint_background["background-color"]),"background-pattern":new pl(ye.paint_background["background-pattern"]),"background-opacity":new Xe(ye.paint_background["background-opacity"])})}};class lb extends s{constructor(t){super(t,ab)}}let y_;var ub={get paint(){return y_=y_||new f({"raster-opacity":new Xe(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xe(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xe(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xe(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Xe(ye.paint_raster["raster-saturation"]),"raster-contrast":new Xe(ye.paint_raster["raster-contrast"]),"raster-resampling":new Xe(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Xe(ye.paint_raster["raster-fade-duration"])})}};class cb extends s{constructor(t){super(t,ub)}}class hb extends s{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class db{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Lf=63710088e-1;class _s{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new _s(Je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,a=this.lat*r,h=t.lat*r,m=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((t.lng-this.lng)*r);return Lf*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof _s)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new _s(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new _s(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const __=2*Math.PI*Lf;function v_(n){return __*Math.cos(n*Math.PI/180)}function x_(n){return(180+n)/360}function w_(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function b_(n,t){return n/v_(t)}function Rf(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}class hc{constructor(t,r,a=0){this.x=+t,this.y=+r,this.z=+a}static fromLngLat(t,r=0){const a=_s.convert(t);return new hc(x_(a.lng),w_(a.lat),b_(r,a.lat))}toLngLat(){return new _s(360*this.x-180,Rf(this.y))}toAltitude(){return this.z*v_(Rf(this.y))}meterInMercatorCoordinateUnits(){return 1/__*(t=Rf(this.y),1/Math.cos(t*Math.PI/180));var t}}function S_(n,t,r){var a=2*Math.PI*6378137/256/Math.pow(2,r);return[n*a-2*Math.PI*6378137/2,t*a-2*Math.PI*6378137/2]}class Ff{constructor(t,r,a){if(!function(h,m,g){return!(h<0||h>25||g<0||g>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))}(t,r,a))throw new Error(`x=${r}, y=${a}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=a,this.key=dc(0,t,t,r,a)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,a){const h=(g=this.y,_=this.z,w=S_(256*(m=this.x),256*(g=Math.pow(2,_)-g-1),_),k=S_(256*(m+1),256*(g+1),_),w[0]+","+w[1]+","+k[0]+","+k[1]);var m,g,_,w,k;const E=function(P,A,R){let j,O="";for(let G=P;G>0;G--)j=1<<G-1,O+=(A&j?1:0)+(R&j?2:0);return O}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,E).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new X((t.x*r-this.x)*yi,(t.y*r-this.y)*yi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class T_{constructor(t,r){this.wrap=t,this.canonical=r,this.key=dc(t,r.z,r.z,r.x,r.y)}}class tr{constructor(t,r,a,h,m){if(t<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${a}`);this.overscaledZ=t,this.wrap=r,this.canonical=new Ff(a,+h,+m),this.key=dc(r,t,a,h,m)}clone(){return new tr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new tr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new tr(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?dc(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):dc(this.wrap*+r,t,t,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new tr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new tr(r,this.wrap,r,a,h),new tr(r,this.wrap,r,a+1,h),new tr(r,this.wrap,r,a,h+1),new tr(r,this.wrap,r,a+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new tr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new tr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new T_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new hc(t.x-this.wrap,t.y))}}function dc(n,t,r,a,h){(n*=2)<0&&(n=-1*n-1);const m=1<<r;return(m*m*n+m*h+a).toString(36)+r.toString(36)+t.toString(36)}qe("CanonicalTileID",Ff),qe("OverscaledTileID",tr,{omit:["posMatrix"]});class I_{constructor(t,r,a,h=1,m=1,g=1,_=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void oi(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const w=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=g,this.baseShift=_;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<w;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(w,k)]=this.data[this._idx(w-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,w)]=this.data[this._idx(k,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<w;k++)for(let E=0;E<w;E++){const P=this.get(k,E);P>this.max&&(this.max=P),P<this.min&&(this.min=P)}}get(t,r){const a=new Uint8Array(this.data.buffer),h=4*this._idx(t,r);return this.unpack(a[h],a[h+1],a[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,a){return t*this.redFactor+r*this.greenFactor+a*this.blueFactor-this.baseShift}getPixels(){return new er({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,a){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,m=r*this.dim+this.dim,g=a*this.dim,_=a*this.dim+this.dim;switch(r){case-1:h=m-1;break;case 1:m=h+1}switch(a){case-1:g=_-1;break;case 1:_=g+1}const w=-r*this.dim,k=-a*this.dim;for(let E=g;E<_;E++)for(let P=h;P<m;P++)this.data[this._idx(P,E)]=t.data[this._idx(P+w,E+k)]}}qe("DEMData",I_);class k_{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const a=t[r];this._stringToNumber[a]=r,this._numberToString[r]=a}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class E_{constructor(t,r,a,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=a,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class C_{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new rs(yi,16,0),this.grid3D=new rs(yi,16,0),this.featureIndexArray=new Hi,this.promoteId=r}insert(t,r,a,h,m,g){const _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,m);const w=g?this.grid3D:this.grid;for(let k=0;k<r.length;k++){const E=r[k],P=[1/0,1/0,-1/0,-1/0];for(let A=0;A<E.length;A++){const R=E[A];P[0]=Math.min(P[0],R.x),P[1]=Math.min(P[1],R.y),P[2]=Math.max(P[2],R.x),P[3]=Math.max(P[3],R.y)}P[0]<yi&&P[1]<yi&&P[2]>=0&&P[3]>=0&&w.insert(_,P[0],P[1],P[2],P[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ms.VectorTile(new Tf(this.rawTileData)).layers,this.sourceLayerCoder=new k_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,a,h){this.loadVTLayers();const m=t.params||{},g=yi/t.tileSize/t.scale,_=zu(m.filter),w=t.queryGeometry,k=t.queryPadding*g,E=M_(w),P=this.grid.query(E.minX-k,E.minY-k,E.maxX+k,E.maxY+k),A=M_(t.cameraQueryGeometry),R=this.grid3D.query(A.minX-k,A.minY-k,A.maxX+k,A.maxY+k,(G,J,pe,re)=>function(he,_e,Te,Ve,st){for(const Fe of he)if(_e<=Fe.x&&Te<=Fe.y&&Ve>=Fe.x&&st>=Fe.y)return!0;const Oe=[new X(_e,Te),new X(_e,st),new X(Ve,st),new X(Ve,Te)];if(he.length>2){for(const Fe of Oe)if(xl(he,Fe))return!0}for(let Fe=0;Fe<he.length-1;Fe++)if(G1(he[Fe],he[Fe+1],Oe))return!0;return!1}(t.cameraQueryGeometry,G-k,J-k,pe+k,re+k));for(const G of R)P.push(G);P.sort(pb);const j={};let O;for(let G=0;G<P.length;G++){const J=P[G];if(J===O)continue;O=J;const pe=this.featureIndexArray.get(J);let re=null;this.loadMatchingFeature(j,pe.bucketIndex,pe.sourceLayerIndex,pe.featureIndex,_,m.layers,m.availableImages,r,a,h,(he,_e,Te)=>(re||(re=ma(he)),_e.queryIntersectsFeature(w,he,Te,re,this.z,t.transform,g,t.pixelPosMatrix)))}return j}loadMatchingFeature(t,r,a,h,m,g,_,w,k,E,P){const A=this.bucketLayerIDs[r];if(g&&!function(G,J){for(let pe=0;pe<G.length;pe++)if(J.indexOf(G[pe])>=0)return!0;return!1}(g,A))return;const R=this.sourceLayerCoder.decode(a),j=this.vtLayers[R].feature(h);if(m.needGeometry){const G=ga(j,!0);if(!m.filter(new Ht(this.tileID.overscaledZ),G,this.tileID.canonical))return}else if(!m.filter(new Ht(this.tileID.overscaledZ),j))return;const O=this.getId(j,R);for(let G=0;G<A.length;G++){const J=A[G];if(g&&g.indexOf(J)<0)continue;const pe=w[J];if(!pe)continue;let re={};O&&E&&(re=E.getState(pe.sourceLayer||"_geojsonTileLayer",O));const he=He({},k[J]);he.paint=P_(he.paint,pe.paint,j,re,_),he.layout=P_(he.layout,pe.layout,j,re,_);const _e=!P||P(j,pe,re);if(!_e)continue;const Te=new E_(j,this.z,this.x,this.y,O);Te.layer=he;let Ve=t[J];Ve===void 0&&(Ve=t[J]=[]),Ve.push({featureIndex:h,feature:Te,intersectionZ:_e})}}lookupSymbolFeatures(t,r,a,h,m,g,_,w){const k={};this.loadVTLayers();const E=zu(m);for(const P of t)this.loadMatchingFeature(k,a,h,P,E,g,_,w,r);return k}hasLayer(t){for(const r of this.bucketLayerIDs)for(const a of r)if(t===a)return!0;return!1}getId(t,r){let a=t.id;return this.promoteId&&(a=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof a=="boolean"&&(a=Number(a))),a}}function P_(n,t,r,a,h){return Lt(n,(m,g)=>{const _=t instanceof ha?t.get(g):null;return _&&_.evaluate?_.evaluate(r,a,h):_})}function M_(n){let t=1/0,r=1/0,a=-1/0,h=-1/0;for(const m of n)t=Math.min(t,m.x),r=Math.min(r,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return{minX:t,minY:r,maxX:a,maxY:h}}function pb(n,t){return t-n}function z_(n,t,r,a,h){const m=[];for(let g=0;g<n.length;g++){const _=n[g];let w;for(let k=0;k<_.length-1;k++){let E=_[k],P=_[k+1];E.x<t&&P.x<t||(E.x<t?E=new X(t,E.y+(t-E.x)/(P.x-E.x)*(P.y-E.y))._round():P.x<t&&(P=new X(t,E.y+(t-E.x)/(P.x-E.x)*(P.y-E.y))._round()),E.y<r&&P.y<r||(E.y<r?E=new X(E.x+(r-E.y)/(P.y-E.y)*(P.x-E.x),r)._round():P.y<r&&(P=new X(E.x+(r-E.y)/(P.y-E.y)*(P.x-E.x),r)._round()),E.x>=a&&P.x>=a||(E.x>=a?E=new X(a,E.y+(a-E.x)/(P.x-E.x)*(P.y-E.y))._round():P.x>=a&&(P=new X(a,E.y+(a-E.x)/(P.x-E.x)*(P.y-E.y))._round()),E.y>=h&&P.y>=h||(E.y>=h?E=new X(E.x+(h-E.y)/(P.y-E.y)*(P.x-E.x),h)._round():P.y>=h&&(P=new X(E.x+(h-E.y)/(P.y-E.y)*(P.x-E.x),h)._round()),w&&E.equals(w[w.length-1])||(w=[E],m.push(w)),w.push(P)))))}}return m}qe("FeatureIndex",C_,{omit:["rawTileData","sourceLayerCoder"]});class vs extends X{constructor(t,r,a,h){super(t,r),this.angle=a,h!==void 0&&(this.segment=h)}clone(){return new vs(this.x,this.y,this.angle,this.segment)}}function A_(n,t,r,a,h){if(t.segment===void 0||r===0)return!0;let m=t,g=t.segment+1,_=0;for(;_>-r/2;){if(g--,g<0)return!1;_-=n[g].dist(m),m=n[g]}_+=n[g].dist(n[g+1]),g++;const w=[];let k=0;for(;_<r/2;){const E=n[g],P=n[g+1];if(!P)return!1;let A=n[g-1].angleTo(E)-E.angleTo(P);for(A=Math.abs((A+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:_,angleDelta:A}),k+=A;_-w[0].distance>a;)k-=w.shift().angleDelta;if(k>h)return!1;g++,_+=E.dist(P)}return!0}function D_(n){let t=0;for(let r=0;r<n.length-1;r++)t+=n[r].dist(n[r+1]);return t}function L_(n,t,r){return n?.6*t*r:0}function R_(n,t){return Math.max(n?n.right-n.left:0,t?t.right-t.left:0)}function fb(n,t,r,a,h,m){const g=L_(r,h,m),_=R_(r,a)*m;let w=0;const k=D_(n)/2;for(let E=0;E<n.length-1;E++){const P=n[E],A=n[E+1],R=P.dist(A);if(w+R>k){const j=(k-w)/R,O=on.number(P.x,A.x,j),G=on.number(P.y,A.y,j),J=new vs(O,G,A.angleTo(P),E);return J._round(),!g||A_(n,J,_,g,t)?J:void 0}w+=R}}function mb(n,t,r,a,h,m,g,_,w){const k=L_(a,m,g),E=R_(a,h),P=E*g,A=n[0].x===0||n[0].x===w||n[0].y===0||n[0].y===w;return t-P<t/4&&(t=P+t/4),F_(n,A?t/2*_%t:(E/2+2*m)*g*_%t,t,k,r,P,A,!1,w)}function F_(n,t,r,a,h,m,g,_,w){const k=m/2,E=D_(n);let P=0,A=t-r,R=[];for(let j=0;j<n.length-1;j++){const O=n[j],G=n[j+1],J=O.dist(G),pe=G.angleTo(O);for(;A+r<P+J;){A+=r;const re=(A-P)/J,he=on.number(O.x,G.x,re),_e=on.number(O.y,G.y,re);if(he>=0&&he<w&&_e>=0&&_e<w&&A-k>=0&&A+k<=E){const Te=new vs(he,_e,pe,j);Te._round(),a&&!A_(n,Te,m,a,h)||R.push(Te)}}P+=J}return _||R.length||g||(R=F_(n,P/2,r,a,h,m,g,!0,w)),R}qe("Anchor",vs);const Cl=Sn;function B_(n,t,r,a){const h=[],m=n.image,g=m.pixelRatio,_=m.paddedRect.w-2*Cl,w=m.paddedRect.h-2*Cl;let k={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const E=m.stretchX||[[0,_]],P=m.stretchY||[[0,w]],A=(xe,et)=>xe+et[1]-et[0],R=E.reduce(A,0),j=P.reduce(A,0),O=_-R,G=w-j;let J=0,pe=R,re=0,he=j,_e=0,Te=O,Ve=0,st=G;if(m.content&&a){const xe=m.content,et=xe[2]-xe[0],Ye=xe[3]-xe[1];(m.textFitWidth||m.textFitHeight)&&(k=c_(n)),J=od(E,0,xe[0]),re=od(P,0,xe[1]),pe=od(E,xe[0],xe[2]),he=od(P,xe[1],xe[3]),_e=xe[0]-J,Ve=xe[1]-re,Te=et-pe,st=Ye-he}const Oe=k.x1,Fe=k.y1,Qe=k.x2-Oe,Ge=k.y2-Fe,Ze=(xe,et,Ye,ct)=>{const $t=sd(xe.stretch-J,pe,Qe,Oe),Ut=ad(xe.fixed-_e,Te,xe.stretch,R),Ti=sd(et.stretch-re,he,Ge,Fe),wr=ad(et.fixed-Ve,st,et.stretch,j),Ni=sd(Ye.stretch-J,pe,Qe,Oe),Ii=ad(Ye.fixed-_e,Te,Ye.stretch,R),un=sd(ct.stretch-re,he,Ge,Fe),cn=ad(ct.fixed-Ve,st,ct.stretch,j),hn=new X($t,Ti),li=new X(Ni,Ti),ki=new X(Ni,un),Xi=new X($t,un),Vi=new X(Ut/g,wr/g),dn=new X(Ii/g,cn/g),Ui=t*Math.PI/180;if(Ui){const zt=Math.sin(Ui),qt=Math.cos(Ui),Jt=[qt,-zt,zt,qt];hn._matMult(Jt),li._matMult(Jt),Xi._matMult(Jt),ki._matMult(Jt)}const ir=xe.stretch+xe.fixed,Tn=et.stretch+et.fixed;return{tl:hn,tr:li,bl:Xi,br:ki,tex:{x:m.paddedRect.x+Cl+ir,y:m.paddedRect.y+Cl+Tn,w:Ye.stretch+Ye.fixed-ir,h:ct.stretch+ct.fixed-Tn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Vi,pixelOffsetBR:dn,minFontScaleX:Te/g/Qe,minFontScaleY:st/g/Ge,isSDF:r}};if(a&&(m.stretchX||m.stretchY)){const xe=j_(E,O,R),et=j_(P,G,j);for(let Ye=0;Ye<xe.length-1;Ye++){const ct=xe[Ye],$t=xe[Ye+1];for(let Ut=0;Ut<et.length-1;Ut++)h.push(Ze(ct,et[Ut],$t,et[Ut+1]))}}else h.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:_+1},{fixed:0,stretch:w+1}));return h}function od(n,t,r){let a=0;for(const h of n)a+=Math.max(t,Math.min(r,h[1]))-Math.max(t,Math.min(r,h[0]));return a}function j_(n,t,r){const a=[{fixed:-Cl,stretch:0}];for(const[h,m]of n){const g=a[a.length-1];a.push({fixed:h-g.stretch,stretch:g.stretch}),a.push({fixed:h-g.stretch,stretch:g.stretch+(m-h)})}return a.push({fixed:t+Cl,stretch:r}),a}function sd(n,t,r,a){return n/t*r+a}function ad(n,t,r,a){return n-t*r/a}class ld{constructor(t,r,a,h,m,g,_,w,k,E){var P;if(this.boxStartIndex=t.length,k){let A=g.top,R=g.bottom;const j=g.collisionPadding;j&&(A-=j[1],R+=j[3]);let O=R-A;O>0&&(O=Math.max(10,O),this.circleDiameter=O)}else{const A=!((P=g.image)===null||P===void 0)&&P.content&&(g.image.textFitWidth||g.image.textFitHeight)?c_(g):{x1:g.left,y1:g.top,x2:g.right,y2:g.bottom};A.y1=A.y1*_-w[0],A.y2=A.y2*_+w[2],A.x1=A.x1*_-w[3],A.x2=A.x2*_+w[1];const R=g.collisionPadding;if(R&&(A.x1-=R[0]*_,A.y1-=R[1]*_,A.x2+=R[2]*_,A.y2+=R[3]*_),E){const j=new X(A.x1,A.y1),O=new X(A.x2,A.y1),G=new X(A.x1,A.y2),J=new X(A.x2,A.y2),pe=E*Math.PI/180;j._rotate(pe),O._rotate(pe),G._rotate(pe),J._rotate(pe),A.x1=Math.min(j.x,O.x,G.x,J.x),A.x2=Math.max(j.x,O.x,G.x,J.x),A.y1=Math.min(j.y,O.y,G.y,J.y),A.y2=Math.max(j.y,O.y,G.y,J.y)}t.emplaceBack(r.x,r.y,A.x1,A.y1,A.x2,A.y2,a,h,m)}this.boxEndIndex=t.length}}class gb{constructor(t=[],r=(a,h)=>a<h?-1:a>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:a}=this,h=r[t];for(;t>0;){const m=t-1>>1,g=r[m];if(a(h,g)>=0)break;r[t]=g,t=m}r[t]=h}_down(t){const{data:r,compare:a}=this,h=this.length>>1,m=r[t];for(;t<h;){let g=1+(t<<1);const _=g+1;if(_<this.length&&a(r[_],r[g])<0&&(g=_),a(r[g],m)>=0)break;r[t]=r[g],t=g}r[t]=m}}function yb(n,t=1,r=!1){let a=1/0,h=1/0,m=-1/0,g=-1/0;const _=n[0];for(let R=0;R<_.length;R++){const j=_[R];(!R||j.x<a)&&(a=j.x),(!R||j.y<h)&&(h=j.y),(!R||j.x>m)&&(m=j.x),(!R||j.y>g)&&(g=j.y)}const w=Math.min(m-a,g-h);let k=w/2;const E=new gb([],_b);if(w===0)return new X(a,h);for(let R=a;R<m;R+=w)for(let j=h;j<g;j+=w)E.push(new Pl(R+k,j+k,k,n));let P=function(R){let j=0,O=0,G=0;const J=R[0];for(let pe=0,re=J.length,he=re-1;pe<re;he=pe++){const _e=J[pe],Te=J[he],Ve=_e.x*Te.y-Te.x*_e.y;O+=(_e.x+Te.x)*Ve,G+=(_e.y+Te.y)*Ve,j+=3*Ve}return new Pl(O/j,G/j,0,R)}(n),A=E.length;for(;E.length;){const R=E.pop();(R.d>P.d||!P.d)&&(P=R,r&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,A)),R.max-P.d<=t||(k=R.h/2,E.push(new Pl(R.p.x-k,R.p.y-k,k,n)),E.push(new Pl(R.p.x+k,R.p.y-k,k,n)),E.push(new Pl(R.p.x-k,R.p.y+k,k,n)),E.push(new Pl(R.p.x+k,R.p.y+k,k,n)),A+=4)}return r&&(console.log(`num probes: ${A}`),console.log(`best distance: ${P.d}`)),P.p}function _b(n,t){return t.max-n.max}function Pl(n,t,r,a){this.p=new X(n,t),this.h=r,this.d=function(h,m){let g=!1,_=1/0;for(let w=0;w<m.length;w++){const k=m[w];for(let E=0,P=k.length,A=P-1;E<P;A=E++){const R=k[E],j=k[A];R.y>h.y!=j.y>h.y&&h.x<(j.x-R.x)*(h.y-R.y)/(j.y-R.y)+R.x&&(g=!g),_=Math.min(_,wy(h,R,j))}}return(g?1:-1)*Math.sqrt(_)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var Oi;S.aq=void 0,(Oi=S.aq||(S.aq={}))[Oi.center=1]="center",Oi[Oi.left=2]="left",Oi[Oi.right=3]="right",Oi[Oi.top=4]="top",Oi[Oi.bottom=5]="bottom",Oi[Oi["top-left"]=6]="top-left",Oi[Oi["top-right"]=7]="top-right",Oi[Oi["bottom-left"]=8]="bottom-left",Oi[Oi["bottom-right"]=9]="bottom-right";const xs=7,Bf=Number.POSITIVE_INFINITY;function O_(n,t){return t[1]!==Bf?function(r,a,h){let m=0,g=0;switch(a=Math.abs(a),h=Math.abs(h),r){case"top-right":case"top-left":case"top":g=h-xs;break;case"bottom-right":case"bottom-left":case"bottom":g=-h+xs}switch(r){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,g]}(n,t[0],t[1]):function(r,a){let h=0,m=0;a<0&&(a=0);const g=a/Math.SQRT2;switch(r){case"top-right":case"top-left":m=g-xs;break;case"bottom-right":case"bottom-left":m=-g+xs;break;case"bottom":m=-a+xs;break;case"top":m=a-xs}switch(r){case"top-right":case"bottom-right":h=-g;break;case"top-left":case"bottom-left":h=g;break;case"left":h=a;break;case"right":h=-a}return[h,m]}(n,t[0])}function N_(n,t,r){var a;const h=n.layout,m=(a=h.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(t,{},r);if(m){const _=m.values,w=[];for(let k=0;k<_.length;k+=2){const E=w[k]=_[k],P=_[k+1].map(A=>A*vi);E.startsWith("top")?P[1]-=xs:E.startsWith("bottom")&&(P[1]+=xs),w[k+1]=P}return new Mn(w)}const g=h.get("text-variable-anchor");if(g){let _;_=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},r)*vi,Bf]:h.get("text-offset").evaluate(t,{},r).map(k=>k*vi);const w=[];for(const k of g)w.push(k,O_(k,_));return new Mn(w)}return null}function jf(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vb(n,t,r,a,h,m,g,_,w,k,E){let P=m.textMaxSize.evaluate(t,{});P===void 0&&(P=g);const A=n.layers[0].layout,R=A.get("icon-offset").evaluate(t,{},E),j=U_(r.horizontal),O=g/24,G=n.tilePixelRatio*O,J=n.tilePixelRatio*P/24,pe=n.tilePixelRatio*_,re=n.tilePixelRatio*A.get("symbol-spacing"),he=A.get("text-padding")*n.tilePixelRatio,_e=function(xe,et,Ye,ct=1){const $t=xe.get("icon-padding").evaluate(et,{},Ye),Ut=$t&&$t.values;return[Ut[0]*ct,Ut[1]*ct,Ut[2]*ct,Ut[3]*ct]}(A,t,E,n.tilePixelRatio),Te=A.get("text-max-angle")/180*Math.PI,Ve=A.get("text-rotation-alignment")!=="viewport"&&A.get("symbol-placement")!=="point",st=A.get("icon-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",Oe=A.get("symbol-placement"),Fe=re/2,Qe=A.get("icon-text-fit");let Ge;a&&Qe!=="none"&&(n.allowVerticalPlacement&&r.vertical&&(Ge=h_(a,r.vertical,Qe,A.get("icon-text-fit-padding"),R,O)),j&&(a=h_(a,j,Qe,A.get("icon-text-fit-padding"),R,O)));const Ze=(xe,et)=>{et.x<0||et.x>=yi||et.y<0||et.y>=yi||function(Ye,ct,$t,Ut,Ti,wr,Ni,Ii,un,cn,hn,li,ki,Xi,Vi,dn,Ui,ir,Tn,zt,qt,Jt,Bn,ii,Ml){const eo=Ye.addToLineVertexArray(ct,$t);let to,br,nr,zi,Eo=0,mc=0,G_=0,H_=0,Gf=-1,Hf=-1;const Co={};let W_=gl("");if(Ye.allowVerticalPlacement&&Ut.vertical){const Ki=Ii.layout.get("text-rotate").evaluate(qt,{},ii)+90;nr=new ld(un,ct,cn,hn,li,Ut.vertical,ki,Xi,Vi,Ki),Ni&&(zi=new ld(un,ct,cn,hn,li,Ni,Ui,ir,Vi,Ki))}if(Ti){const Ki=Ii.layout.get("icon-rotate").evaluate(qt,{}),rr=Ii.layout.get("icon-text-fit")!=="none",_a=B_(Ti,Ki,Bn,rr),Fr=Ni?B_(Ni,Ki,Bn,rr):void 0;br=new ld(un,ct,cn,hn,li,Ti,Ui,ir,!1,Ki),Eo=4*_a.length;const va=Ye.iconSizeData;let io=null;va.kind==="source"?(io=[Qr*Ii.layout.get("icon-size").evaluate(qt,{})],io[0]>ys&&oi(`${Ye.layerIds[0]}: Value for "icon-size" is >= ${cc}. Reduce your "icon-size".`)):va.kind==="composite"&&(io=[Qr*Jt.compositeIconSizes[0].evaluate(qt,{},ii),Qr*Jt.compositeIconSizes[1].evaluate(qt,{},ii)],(io[0]>ys||io[1]>ys)&&oi(`${Ye.layerIds[0]}: Value for "icon-size" is >= ${cc}. Reduce your "icon-size".`)),Ye.addSymbols(Ye.icon,_a,io,zt,Tn,qt,S.ah.none,ct,eo.lineStartIndex,eo.lineLength,-1,ii),Gf=Ye.icon.placedSymbolArray.length-1,Fr&&(mc=4*Fr.length,Ye.addSymbols(Ye.icon,Fr,io,zt,Tn,qt,S.ah.vertical,ct,eo.lineStartIndex,eo.lineLength,-1,ii),Hf=Ye.icon.placedSymbolArray.length-1)}const X_=Object.keys(Ut.horizontal);for(const Ki of X_){const rr=Ut.horizontal[Ki];if(!to){W_=gl(rr.text);const Fr=Ii.layout.get("text-rotate").evaluate(qt,{},ii);to=new ld(un,ct,cn,hn,li,rr,ki,Xi,Vi,Fr)}const _a=rr.positionedLines.length===1;if(G_+=V_(Ye,ct,rr,wr,Ii,Vi,qt,dn,eo,Ut.vertical?S.ah.horizontal:S.ah.horizontalOnly,_a?X_:[Ki],Co,Gf,Jt,ii),_a)break}Ut.vertical&&(H_+=V_(Ye,ct,Ut.vertical,wr,Ii,Vi,qt,dn,eo,S.ah.vertical,["vertical"],Co,Hf,Jt,ii));const bb=to?to.boxStartIndex:Ye.collisionBoxArray.length,Sb=to?to.boxEndIndex:Ye.collisionBoxArray.length,Tb=nr?nr.boxStartIndex:Ye.collisionBoxArray.length,Ib=nr?nr.boxEndIndex:Ye.collisionBoxArray.length,kb=br?br.boxStartIndex:Ye.collisionBoxArray.length,Eb=br?br.boxEndIndex:Ye.collisionBoxArray.length,Cb=zi?zi.boxStartIndex:Ye.collisionBoxArray.length,Pb=zi?zi.boxEndIndex:Ye.collisionBoxArray.length;let Rr=-1;const cd=(Ki,rr)=>Ki&&Ki.circleDiameter?Math.max(Ki.circleDiameter,rr):rr;Rr=cd(to,Rr),Rr=cd(nr,Rr),Rr=cd(br,Rr),Rr=cd(zi,Rr);const K_=Rr>-1?1:0;K_&&(Rr*=Ml/vi),Ye.glyphOffsetArray.length>=El.MAX_GLYPHS&&oi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),qt.sortKey!==void 0&&Ye.addToSortKeyRanges(Ye.symbolInstances.length,qt.sortKey);const Mb=N_(Ii,qt,ii),[zb,Ab]=function(Ki,rr){const _a=Ki.length,Fr=rr==null?void 0:rr.values;if((Fr==null?void 0:Fr.length)>0)for(let va=0;va<Fr.length;va+=2){const io=Fr[va+1];Ki.emplaceBack(S.aq[Fr[va]],io[0],io[1])}return[_a,Ki.length]}(Ye.textAnchorOffsets,Mb);Ye.symbolInstances.emplaceBack(ct.x,ct.y,Co.right>=0?Co.right:-1,Co.center>=0?Co.center:-1,Co.left>=0?Co.left:-1,Co.vertical||-1,Gf,Hf,W_,bb,Sb,Tb,Ib,kb,Eb,Cb,Pb,cn,G_,H_,Eo,mc,K_,0,ki,Rr,zb,Ab)}(n,et,xe,r,a,h,Ge,n.layers[0],n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,G,[he,he,he,he],Ve,w,pe,_e,st,R,t,m,k,E,g)};if(Oe==="line")for(const xe of z_(t.geometry,0,0,yi,yi)){const et=mb(xe,re,Te,r.vertical||j,a,24,J,n.overscaling,yi);for(const Ye of et)j&&xb(n,j.text,Fe,Ye)||Ze(xe,Ye)}else if(Oe==="line-center"){for(const xe of t.geometry)if(xe.length>1){const et=fb(xe,Te,r.vertical||j,a,24,J);et&&Ze(xe,et)}}else if(t.type==="Polygon")for(const xe of Ga(t.geometry,0)){const et=yb(xe,16);Ze(xe[0],new vs(et.x,et.y,0))}else if(t.type==="LineString")for(const xe of t.geometry)Ze(xe,new vs(xe[0].x,xe[0].y,0));else if(t.type==="Point")for(const xe of t.geometry)for(const et of xe)Ze([et],new vs(et.x,et.y,0))}function V_(n,t,r,a,h,m,g,_,w,k,E,P,A,R,j){const O=function(pe,re,he,_e,Te,Ve,st,Oe){const Fe=_e.layout.get("text-rotate").evaluate(Ve,{})*Math.PI/180,Qe=[];for(const Ge of re.positionedLines)for(const Ze of Ge.positionedGlyphs){if(!Ze.rect)continue;const xe=Ze.rect||{};let et=n_+1,Ye=!0,ct=1,$t=0;const Ut=(Te||Oe)&&Ze.vertical,Ti=Ze.metrics.advance*Ze.scale/2;if(Oe&&re.verticalizable&&($t=Ge.lineOffset/2-(Ze.imageName?-(vi-Ze.metrics.width*Ze.scale)/2:(Ze.scale-1)*vi)),Ze.imageName){const zt=st[Ze.imageName];Ye=zt.sdf,ct=zt.pixelRatio,et=Sn/ct}const wr=Te?[Ze.x+Ti,Ze.y]:[0,0];let Ni=Te?[0,0]:[Ze.x+Ti+he[0],Ze.y+he[1]-$t],Ii=[0,0];Ut&&(Ii=Ni,Ni=[0,0]);const un=Ze.metrics.isDoubleResolution?2:1,cn=(Ze.metrics.left-et)*Ze.scale-Ti+Ni[0],hn=(-Ze.metrics.top-et)*Ze.scale+Ni[1],li=cn+xe.w/un*Ze.scale/ct,ki=hn+xe.h/un*Ze.scale/ct,Xi=new X(cn,hn),Vi=new X(li,hn),dn=new X(cn,ki),Ui=new X(li,ki);if(Ut){const zt=new X(-Ti,Ti-lc),qt=-Math.PI/2,Jt=vi/2-Ti,Bn=new X(5-lc-Jt,-(Ze.imageName?Jt:0)),ii=new X(...Ii);Xi._rotateAround(qt,zt)._add(Bn)._add(ii),Vi._rotateAround(qt,zt)._add(Bn)._add(ii),dn._rotateAround(qt,zt)._add(Bn)._add(ii),Ui._rotateAround(qt,zt)._add(Bn)._add(ii)}if(Fe){const zt=Math.sin(Fe),qt=Math.cos(Fe),Jt=[qt,-zt,zt,qt];Xi._matMult(Jt),Vi._matMult(Jt),dn._matMult(Jt),Ui._matMult(Jt)}const ir=new X(0,0),Tn=new X(0,0);Qe.push({tl:Xi,tr:Vi,bl:dn,br:Ui,tex:xe,writingMode:re.writingMode,glyphOffset:wr,sectionIndex:Ze.sectionIndex,isSDF:Ye,pixelOffsetTL:ir,pixelOffsetBR:Tn,minFontScaleX:0,minFontScaleY:0})}return Qe}(0,r,_,h,m,g,a,n.allowVerticalPlacement),G=n.textSizeData;let J=null;G.kind==="source"?(J=[Qr*h.layout.get("text-size").evaluate(g,{})],J[0]>ys&&oi(`${n.layerIds[0]}: Value for "text-size" is >= ${cc}. Reduce your "text-size".`)):G.kind==="composite"&&(J=[Qr*R.compositeTextSizes[0].evaluate(g,{},j),Qr*R.compositeTextSizes[1].evaluate(g,{},j)],(J[0]>ys||J[1]>ys)&&oi(`${n.layerIds[0]}: Value for "text-size" is >= ${cc}. Reduce your "text-size".`)),n.addSymbols(n.text,O,J,_,m,g,k,t,w.lineStartIndex,w.lineLength,A,j);for(const pe of E)P[pe]=n.text.placedSymbolArray.length-1;return 4*O.length}function U_(n){for(const t in n)return n[t];return null}function xb(n,t,r,a){const h=n.compareText;if(t in h){const m=h[t];for(let g=m.length-1;g>=0;g--)if(a.dist(m[g])<r)return!0}else h[t]=[];return h[t].push(a),!1}const $_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Of{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,a]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=$_[15&a];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[_]=new Uint32Array(t,4,1);return new Of(_,g,m,t)}constructor(t,r=64,a=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=a,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=$_.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,_=t*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-_%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+_+w,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+_+w),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+_+w,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=t,this.coords[this._pos++]=r,a}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Nf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:_}=this,w=[0,m.length-1,0],k=[];for(;w.length;){const E=w.pop()||0,P=w.pop()||0,A=w.pop()||0;if(P-A<=_){for(let G=A;G<=P;G++){const J=g[2*G],pe=g[2*G+1];J>=t&&J<=a&&pe>=r&&pe<=h&&k.push(m[G])}continue}const R=A+P>>1,j=g[2*R],O=g[2*R+1];j>=t&&j<=a&&O>=r&&O<=h&&k.push(m[R]),(E===0?t<=j:r<=O)&&(w.push(A),w.push(R-1),w.push(1-E)),(E===0?a>=j:h>=O)&&(w.push(R+1),w.push(P),w.push(1-E))}return k}within(t,r,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:g}=this,_=[0,h.length-1,0],w=[],k=a*a;for(;_.length;){const E=_.pop()||0,P=_.pop()||0,A=_.pop()||0;if(P-A<=g){for(let G=A;G<=P;G++)q_(m[2*G],m[2*G+1],t,r)<=k&&w.push(h[G]);continue}const R=A+P>>1,j=m[2*R],O=m[2*R+1];q_(j,O,t,r)<=k&&w.push(h[R]),(E===0?t-a<=j:r-a<=O)&&(_.push(A),_.push(R-1),_.push(1-E)),(E===0?t+a>=j:r+a>=O)&&(_.push(R+1),_.push(P),_.push(1-E))}return w}}function Nf(n,t,r,a,h,m){if(h-a<=r)return;const g=a+h>>1;Z_(n,t,g,a,h,m),Nf(n,t,r,a,g-1,1-m),Nf(n,t,r,g+1,h,1-m)}function Z_(n,t,r,a,h,m){for(;h>a;){if(h-a>600){const k=h-a+1,E=r-a+1,P=Math.log(k),A=.5*Math.exp(2*P/3),R=.5*Math.sqrt(P*A*(k-A)/k)*(E-k/2<0?-1:1);Z_(n,t,r,Math.max(a,Math.floor(r-E*A/k+R)),Math.min(h,Math.floor(r+(k-E)*A/k+R)),m)}const g=t[2*r+m];let _=a,w=h;for(pc(n,t,a,r),t[2*h+m]>g&&pc(n,t,a,h);_<w;){for(pc(n,t,_,w),_++,w--;t[2*_+m]<g;)_++;for(;t[2*w+m]>g;)w--}t[2*a+m]===g?pc(n,t,a,w):(w++,pc(n,t,w,h)),w<=r&&(a=w+1),r<=w&&(h=w-1)}}function pc(n,t,r,a){Vf(n,r,a),Vf(t,2*r,2*a),Vf(t,2*r+1,2*a+1)}function Vf(n,t,r){const a=n[t];n[t]=n[r],n[r]=a}function q_(n,t,r,a){const h=n-r,m=t-a;return h*h+m*m}var Uf;S.bg=void 0,(Uf=S.bg||(S.bg={})).create="create",Uf.load="load",Uf.fullLoad="fullLoad";let ud=null,fc=[];const $f=1e3/60,Zf="loadTime",qf="fullLoadTime",wb={mark(n){performance.mark(n)},frame(n){const t=n;ud!=null&&fc.push(t-ud),ud=t},clearMetrics(){ud=null,fc=[],performance.clearMeasures(Zf),performance.clearMeasures(qf);for(const n in S.bg)performance.clearMarks(S.bg[n])},getPerformanceMetrics(){performance.measure(Zf,S.bg.create,S.bg.load),performance.measure(qf,S.bg.create,S.bg.fullLoad);const n=performance.getEntriesByName(Zf)[0].duration,t=performance.getEntriesByName(qf)[0].duration,r=fc.length,a=1/(fc.reduce((m,g)=>m+g,0)/r/1e3),h=fc.filter(m=>m>$f).reduce((m,g)=>m+(g-$f)/$f,0);return{loadTime:n,fullLoadTime:t,fps:a,percentDroppedFrames:h/(r+h)*100,totalFrames:r}}};S.$=class extends M{},S.A=wl,S.B=Yp,S.C=function(n){if(dr==null){const t=n.navigator?n.navigator.userAgent:null;dr=!!n.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return dr},S.D=Xe,S.E=Oo,S.F=class{constructor(n,t){this.target=n,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new db(()=>this.process()),this.subscription=function(r,a,h,m){return r.addEventListener(a,h,!1),{unsubscribe:()=>{r.removeEventListener(a,h,!1)}}}(this.target,"message",r=>this.receive(r)),this.globalScope=$n(self)?n:window}registerMessageHandler(n,t){this.messageHandlers[n]=t}sendAsync(n,t){return new Promise((r,a)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[h]={resolve:r,reject:a},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[h];const _={id:h,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(_)},{once:!0});const m=[],g=Object.assign(Object.assign({},n),{id:h,sourceMapId:this.mapId,origin:location.origin,data:os(n.data,m)});this.target.postMessage(g,{transfer:m})})}receive(n){const t=n.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];const a=this.abortControllers[r];return delete this.abortControllers[r],void(a&&a.abort())}if($n(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),t=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(n,t)}processTask(n,t){return d(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[n];return delete this.resolveRejects[n],h?void(t.error?h.reject(ss(t.error)):h.resolve(ss(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=ss(t.data),a=new AbortController;this.abortControllers[n]=a;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,r,a);this.completeTask(n,null,h)}catch(h){this.completeTask(n,h)}})}completeTask(n,t,r){const a=[];delete this.abortControllers[n];const h={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?os(t):null,data:os(r,a)};this.target.postMessage(h,{transfer:a})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},S.G=nn,S.H=function(){var n=new wl(16);return wl!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},S.I=kf,S.J=function(n,t,r){var a,h,m,g,_,w,k,E,P,A,R,j,O=r[0],G=r[1],J=r[2];return t===n?(n[12]=t[0]*O+t[4]*G+t[8]*J+t[12],n[13]=t[1]*O+t[5]*G+t[9]*J+t[13],n[14]=t[2]*O+t[6]*G+t[10]*J+t[14],n[15]=t[3]*O+t[7]*G+t[11]*J+t[15]):(h=t[1],m=t[2],g=t[3],_=t[4],w=t[5],k=t[6],E=t[7],P=t[8],A=t[9],R=t[10],j=t[11],n[0]=a=t[0],n[1]=h,n[2]=m,n[3]=g,n[4]=_,n[5]=w,n[6]=k,n[7]=E,n[8]=P,n[9]=A,n[10]=R,n[11]=j,n[12]=a*O+_*G+P*J+t[12],n[13]=h*O+w*G+A*J+t[13],n[14]=m*O+k*G+R*J+t[14],n[15]=g*O+E*G+j*J+t[15]),n},S.K=function(n,t,r){var a=r[0],h=r[1],m=r[2];return n[0]=t[0]*a,n[1]=t[1]*a,n[2]=t[2]*a,n[3]=t[3]*a,n[4]=t[4]*h,n[5]=t[5]*h,n[6]=t[6]*h,n[7]=t[7]*h,n[8]=t[8]*m,n[9]=t[9]*m,n[10]=t[10]*m,n[11]=t[11]*m,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},S.L=Iy,S.M=function(n,t){const r={};for(let a=0;a<t.length;a++){const h=t[a];h in n&&(r[h]=n[h])}return r},S.N=_s,S.O=x_,S.P=X,S.Q=w_,S.R=er,S.S=tr,S.T=hl,S.U=le,S.V=ne,S.W=dt,S.X=yi,S.Y=v,S.Z=hc,S._=d,S.a=Li,S.a$=function(n,t){var r=n[0],a=n[1],h=n[2],m=n[3],g=n[4],_=n[5],w=n[6],k=n[7],E=n[8],P=n[9],A=n[10],R=n[11],j=n[12],O=n[13],G=n[14],J=n[15],pe=t[0],re=t[1],he=t[2],_e=t[3],Te=t[4],Ve=t[5],st=t[6],Oe=t[7],Fe=t[8],Qe=t[9],Ge=t[10],Ze=t[11],xe=t[12],et=t[13],Ye=t[14],ct=t[15];return Math.abs(r-pe)<=ln*Math.max(1,Math.abs(r),Math.abs(pe))&&Math.abs(a-re)<=ln*Math.max(1,Math.abs(a),Math.abs(re))&&Math.abs(h-he)<=ln*Math.max(1,Math.abs(h),Math.abs(he))&&Math.abs(m-_e)<=ln*Math.max(1,Math.abs(m),Math.abs(_e))&&Math.abs(g-Te)<=ln*Math.max(1,Math.abs(g),Math.abs(Te))&&Math.abs(_-Ve)<=ln*Math.max(1,Math.abs(_),Math.abs(Ve))&&Math.abs(w-st)<=ln*Math.max(1,Math.abs(w),Math.abs(st))&&Math.abs(k-Oe)<=ln*Math.max(1,Math.abs(k),Math.abs(Oe))&&Math.abs(E-Fe)<=ln*Math.max(1,Math.abs(E),Math.abs(Fe))&&Math.abs(P-Qe)<=ln*Math.max(1,Math.abs(P),Math.abs(Qe))&&Math.abs(A-Ge)<=ln*Math.max(1,Math.abs(A),Math.abs(Ge))&&Math.abs(R-Ze)<=ln*Math.max(1,Math.abs(R),Math.abs(Ze))&&Math.abs(j-xe)<=ln*Math.max(1,Math.abs(j),Math.abs(xe))&&Math.abs(O-et)<=ln*Math.max(1,Math.abs(O),Math.abs(et))&&Math.abs(G-Ye)<=ln*Math.max(1,Math.abs(G),Math.abs(Ye))&&Math.abs(J-ct)<=ln*Math.max(1,Math.abs(J),Math.abs(ct))},S.a0=It,S.a1=Ff,S.a2=Pe,S.a3=n=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{t.onloadstart=()=>{r(t)};for(const a of n){const h=window.document.createElement("source");uo(a)||(t.crossOrigin="Anonymous"),h.src=a,t.appendChild(h)}})},S.a4=function(){return ot++},S.a5=Ne,S.a6=El,S.a7=zu,S.a8=ga,S.a9=E_,S.aA=function(n){if(n.type==="custom")return new hb(n);switch(n.type){case"background":return new lb(n);case"circle":return new X1(n);case"fill":return new dw(n);case"fill-extrusion":return new Ew(n);case"heatmap":return new J1(n);case"hillshade":return new Q1(n);case"line":return new Rw(n);case"raster":return new cb(n);case"symbol":return new rd(n)}},S.aB=xt,S.aC=function(n,t){if(!n)return[{command:"setStyle",args:[t]}];let r=[];try{if(!At(n.version,t.version))return[{command:"setStyle",args:[t]}];At(n.center,t.center)||r.push({command:"setCenter",args:[t.center]}),At(n.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),At(n.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),At(n.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),At(n.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),At(n.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),At(n.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),At(n.light,t.light)||r.push({command:"setLight",args:[t.light]}),At(n.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),At(n.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),At(n.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const a={},h=[];(function(g,_,w,k){let E;for(E in _=_||{},g=g||{})Object.prototype.hasOwnProperty.call(g,E)&&(Object.prototype.hasOwnProperty.call(_,E)||Gr(E,w,k));for(E in _)Object.prototype.hasOwnProperty.call(_,E)&&(Object.prototype.hasOwnProperty.call(g,E)?At(g[E],_[E])||(g[E].type==="geojson"&&_[E].type==="geojson"&&No(g,_,E)?ei(w,{command:"setGeoJSONSourceData",args:[E,_[E].data]}):Mr(E,_,w,k)):qs(E,_,w))})(n.sources,t.sources,h,a);const m=[];n.layers&&n.layers.forEach(g=>{"source"in g&&a[g.source]?r.push({command:"removeLayer",args:[g.id]}):m.push(g)}),r=r.concat(h),function(g,_,w){_=_||[];const k=(g=g||[]).map(Gs),E=_.map(Gs),P=g.reduce(Hs,{}),A=_.reduce(Hs,{}),R=k.slice(),j=Object.create(null);let O,G,J,pe,re;for(let he=0,_e=0;he<k.length;he++)O=k[he],Object.prototype.hasOwnProperty.call(A,O)?_e++:(ei(w,{command:"removeLayer",args:[O]}),R.splice(R.indexOf(O,_e),1));for(let he=0,_e=0;he<E.length;he++)O=E[E.length-1-he],R[R.length-1-he]!==O&&(Object.prototype.hasOwnProperty.call(P,O)?(ei(w,{command:"removeLayer",args:[O]}),R.splice(R.lastIndexOf(O,R.length-_e),1)):_e++,pe=R[R.length-he],ei(w,{command:"addLayer",args:[A[O],pe]}),R.splice(R.length-he,0,O),j[O]=!0);for(let he=0;he<E.length;he++)if(O=E[he],G=P[O],J=A[O],!j[O]&&!At(G,J))if(At(G.source,J.source)&&At(G["source-layer"],J["source-layer"])&&At(G.type,J.type)){for(re in Pn(G.layout,J.layout,w,O,null,"setLayoutProperty"),Pn(G.paint,J.paint,w,O,null,"setPaintProperty"),At(G.filter,J.filter)||ei(w,{command:"setFilter",args:[O,J.filter]}),At(G.minzoom,J.minzoom)&&At(G.maxzoom,J.maxzoom)||ei(w,{command:"setLayerZoomRange",args:[O,J.minzoom,J.maxzoom]}),G)Object.prototype.hasOwnProperty.call(G,re)&&re!=="layout"&&re!=="paint"&&re!=="filter"&&re!=="metadata"&&re!=="minzoom"&&re!=="maxzoom"&&(re.indexOf("paint.")===0?Pn(G[re],J[re],w,O,re.slice(6),"setPaintProperty"):At(G[re],J[re])||ei(w,{command:"setLayerProperty",args:[O,re,J[re]]}));for(re in J)Object.prototype.hasOwnProperty.call(J,re)&&!Object.prototype.hasOwnProperty.call(G,re)&&re!=="layout"&&re!=="paint"&&re!=="filter"&&re!=="metadata"&&re!=="minzoom"&&re!=="maxzoom"&&(re.indexOf("paint.")===0?Pn(G[re],J[re],w,O,re.slice(6),"setPaintProperty"):At(G[re],J[re])||ei(w,{command:"setLayerProperty",args:[O,re,J[re]]}))}else ei(w,{command:"removeLayer",args:[O]}),pe=R[R.lastIndexOf(O)+1],ei(w,{command:"addLayer",args:[J,pe]})}(m,t.layers,r)}catch(a){console.warn("Unable to compute style diff:",a),r=[{command:"setStyle",args:[t]}]}return r},S.aD=function(n){const t=[],r=n.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),n.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},S.aE=function n(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(!n(t[a],r[a]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(!n(t[a],r[a]))return!1;return!0}return t===r},S.aF=Lt,S.aG=vt,S.aH=class extends pa{constructor(n,t){super(n,t),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},S.aI=qh,S.aJ=class extends pa{constructor(n,t){super(n,t),this.current=V1}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let t=1;t<16;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},S.aK=fy,S.aL=my,S.aM=Ot,S.aN=class extends pa{constructor(n,t){super(n,t),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},S.aO=class extends pa{constructor(n,t){super(n,t),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},S.aP=function(n,t,r,a,h,m,g){var _=1/(t-r),w=1/(a-h),k=1/(m-g);return n[0]=-2*_,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*w,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*k,n[11]=0,n[12]=(t+r)*_,n[13]=(h+a)*w,n[14]=(g+m)*k,n[15]=1,n},S.aQ=W1,S.aR=class extends se{},S.aS=Ow,S.aT=class extends fe{},S.aU=ff,S.aV=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},S.aW=My,S.aX=Bi,S.aY=Qn,S.aZ=class extends Ke{},S.a_=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]},S.aa=function(n){const t={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,a,h,m)=>{const g=h||m;return t[a]=!g||g.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},S.ab=function(n,t){const r=[];for(const a in n)a in t||r.push(a);return r},S.ac=je,S.ad=function(n,t,r){var a=Math.sin(r),h=Math.cos(r),m=t[0],g=t[1],_=t[2],w=t[3],k=t[4],E=t[5],P=t[6],A=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=m*h+k*a,n[1]=g*h+E*a,n[2]=_*h+P*a,n[3]=w*h+A*a,n[4]=k*h-m*a,n[5]=E*h-g*a,n[6]=P*h-_*a,n[7]=A*h-w*a,n},S.ae=function(n){var t=new wl(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},S.af=Xh,S.ag=function(n,t){let r=0,a=0;if(n.kind==="constant")a=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:g}=n,_=h?je(sn.interpolationFactor(h,t,m,g),0,1):0;n.kind==="camera"?a=on.number(n.minSize,n.maxSize,_):r=_}return{uSizeT:r,uSize:a}},S.ai=function(n,{uSize:t,uSizeT:r},{lowerSize:a,upperSize:h}){return n.kind==="source"?a/Qr:n.kind==="composite"?on.number(a/Qr,h/Qr,r):t},S.aj=Mf,S.ak=function(n,t,r,a){const h=t.y-n.y,m=t.x-n.x,g=a.y-r.y,_=a.x-r.x,w=g*m-_*h;if(w===0)return null;const k=(_*(n.y-r.y)-g*(n.x-r.x))/w;return new X(n.x+k*m,n.y+k*h)},S.al=z_,S.am=vy,S.an=hf,S.ao=function(n){let t=1/0,r=1/0,a=-1/0,h=-1/0;for(const m of n)t=Math.min(t,m.x),r=Math.min(r,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return[t,r,a,h]},S.ap=vi,S.ar=Pf,S.as=function(n,t){var r=t[0],a=t[1],h=t[2],m=t[3],g=t[4],_=t[5],w=t[6],k=t[7],E=t[8],P=t[9],A=t[10],R=t[11],j=t[12],O=t[13],G=t[14],J=t[15],pe=r*_-a*g,re=r*w-h*g,he=r*k-m*g,_e=a*w-h*_,Te=a*k-m*_,Ve=h*k-m*w,st=E*O-P*j,Oe=E*G-A*j,Fe=E*J-R*j,Qe=P*G-A*O,Ge=P*J-R*O,Ze=A*J-R*G,xe=pe*Ze-re*Ge+he*Qe+_e*Fe-Te*Oe+Ve*st;return xe?(n[0]=(_*Ze-w*Ge+k*Qe)*(xe=1/xe),n[1]=(h*Ge-a*Ze-m*Qe)*xe,n[2]=(O*Ve-G*Te+J*_e)*xe,n[3]=(A*Te-P*Ve-R*_e)*xe,n[4]=(w*Fe-g*Ze-k*Oe)*xe,n[5]=(r*Ze-h*Fe+m*Oe)*xe,n[6]=(G*he-j*Ve-J*re)*xe,n[7]=(E*Ve-A*he+R*re)*xe,n[8]=(g*Ge-_*Fe+k*st)*xe,n[9]=(a*Fe-r*Ge-m*st)*xe,n[10]=(j*Te-O*he+J*pe)*xe,n[11]=(P*he-E*Te-R*pe)*xe,n[12]=(_*Oe-g*Qe-w*st)*xe,n[13]=(r*Qe-a*Oe+h*st)*xe,n[14]=(O*re-j*_e-G*pe)*xe,n[15]=(E*_e-P*re+A*pe)*xe,n):null},S.at=jf,S.au=Cf,S.av=Of,S.aw=function(){const n={},t=ye.$version;for(const r in ye.$root){const a=ye.$root[r];if(a.required){let h=null;h=r==="version"?t:a.type==="array"?[]:{},h!=null&&(n[r]=h)}}return n},S.ax=qu,S.ay=qn,S.az=function(n){n=n.slice();const t=Object.create(null);for(let r=0;r<n.length;r++)t[n[r].id]=n[r];for(let r=0;r<n.length;r++)"ref"in n[r]&&(n[r]=Zs(n[r],t[n[r].ref]));return n},S.b=en,S.b0=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},S.b1=function(n,t,r){return n[0]=t[0]*r[0],n[1]=t[1]*r[1],n[2]=t[2]*r[2],n[3]=t[3]*r[3],n},S.b2=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]},S.b3=Je,S.b4=T_,S.b5=b_,S.b6=function(n,t,r,a,h){var m,g=1/Math.tan(t/2);return n[0]=g/r,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,h!=null&&h!==1/0?(n[10]=(h+a)*(m=1/(a-h)),n[14]=2*h*a*m):(n[10]=-1,n[14]=-2*a),n},S.b7=function(n,t,r){var a=Math.sin(r),h=Math.cos(r),m=t[4],g=t[5],_=t[6],w=t[7],k=t[8],E=t[9],P=t[10],A=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=m*h+k*a,n[5]=g*h+E*a,n[6]=_*h+P*a,n[7]=w*h+A*a,n[8]=k*h-m*a,n[9]=E*h-g*a,n[10]=P*h-_*a,n[11]=A*h-w*a,n},S.b8=ue,S.b9=Se,S.bA=Ky,S.bB=function(n){return n.message===Bt},S.bC=Yo,S.bD=wn,S.ba=function(n){return n*Math.PI/180},S.bb=function(n,t){const{x:r,y:a}=hc.fromLngLat(t);return!(n<0||n>25||a<0||a>=1||r<0||r>=1)},S.bc=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},S.bd=class extends C{},S.be=Lf,S.bf=wb,S.bh=bi,S.bi=function(n,t){Li.REGISTERED_PROTOCOLS[n]=t},S.bj=function(n){delete Li.REGISTERED_PROTOCOLS[n]},S.bk=function(n,t){const r={};for(let h=0;h<n.length;h++){const m=t&&t[n[h].id]||Dh(n[h]);t&&(t[n[h].id]=m);let g=r[m];g||(g=r[m]=[]),g.push(n[h])}const a=[];for(const h in r)a.push(r[h]);return a},S.bl=qe,S.bm=k_,S.bn=C_,S.bo=o_,S.bp=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=yi/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const t=n.bucket.layers[0],r=t.layout,a=t._unevaluatedLayout._values,h={layoutIconSize:a["icon-size"].possiblyEvaluate(new Ht(n.bucket.zoom+1),n.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new Ht(n.bucket.zoom+1),n.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new Ht(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:E}=n.bucket.textSizeData;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new Ht(k),n.canonical),a["text-size"].possiblyEvaluate(new Ht(E),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:E}=n.bucket.iconSizeData;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new Ht(k),n.canonical),a["icon-size"].possiblyEvaluate(new Ht(E),n.canonical)]}const m=r.get("text-line-height")*vi,g=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",_=r.get("text-keep-upright"),w=r.get("text-size");for(const k of n.bucket.features){const E=r.get("text-font").evaluate(k,{},n.canonical).join(","),P=w.evaluate(k,{},n.canonical),A=h.layoutTextSize.evaluate(k,{},n.canonical),R=h.layoutIconSize.evaluate(k,{},n.canonical),j={horizontal:{},vertical:void 0},O=k.text;let G,J=[0,0];if(O){const he=O.toString(),_e=r.get("text-letter-spacing").evaluate(k,{},n.canonical)*vi,Te=Qp(he)?_e:0,Ve=r.get("text-anchor").evaluate(k,{},n.canonical),st=N_(t,k,n.canonical);if(!st){const Ge=r.get("text-radial-offset").evaluate(k,{},n.canonical);J=Ge?O_(Ve,[Ge*vi,Bf]):r.get("text-offset").evaluate(k,{},n.canonical).map(Ze=>Ze*vi)}let Oe=g?"center":r.get("text-justify").evaluate(k,{},n.canonical);const Fe=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(k,{},n.canonical)*vi:1/0,Qe=()=>{n.bucket.allowVerticalPlacement&&Gu(he)&&(j.vertical=td(O,n.glyphMap,n.glyphPositions,n.imagePositions,E,Fe,m,Ve,"left",Te,J,S.ah.vertical,!0,A,P))};if(!g&&st){const Ge=new Set;if(Oe==="auto")for(let xe=0;xe<st.values.length;xe+=2)Ge.add(jf(st.values[xe]));else Ge.add(Oe);let Ze=!1;for(const xe of Ge)if(!j.horizontal[xe])if(Ze)j.horizontal[xe]=j.horizontal[0];else{const et=td(O,n.glyphMap,n.glyphPositions,n.imagePositions,E,Fe,m,"center",xe,Te,J,S.ah.horizontal,!1,A,P);et&&(j.horizontal[xe]=et,Ze=et.positionedLines.length===1)}Qe()}else{Oe==="auto"&&(Oe=jf(Ve));const Ge=td(O,n.glyphMap,n.glyphPositions,n.imagePositions,E,Fe,m,Ve,Oe,Te,J,S.ah.horizontal,!1,A,P);Ge&&(j.horizontal[Oe]=Ge),Qe(),Gu(he)&&g&&_&&(j.vertical=td(O,n.glyphMap,n.glyphPositions,n.imagePositions,E,Fe,m,Ve,Oe,Te,J,S.ah.vertical,!1,A,P))}}let pe=!1;if(k.icon&&k.icon.name){const he=n.imageMap[k.icon.name];he&&(G=nb(n.imagePositions[k.icon.name],r.get("icon-offset").evaluate(k,{},n.canonical),r.get("icon-anchor").evaluate(k,{},n.canonical)),pe=!!he.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=pe:n.bucket.sdfIcons!==pe&&oi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(he.pixelRatio!==n.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const re=U_(j.horizontal)||j.vertical;n.bucket.iconsInText=!!re&&re.iconsInText,(re||G)&&vb(n.bucket,k,j,G,n.imageMap,h,A,R,J,pe,n.canonical)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},S.bq=bf,S.br=vf,S.bs=wf,S.bt=ms,S.bu=Tf,S.bv=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},S.bw=function(n,t,r,a,h){return d(this,void 0,void 0,function*(){if(ne())try{return yield dt(n,t,r,a,h)}catch{}return function(m,g,_,w,k){const E=m.width,P=m.height;pt&&kt||(pt=new OffscreenCanvas(E,P),kt=pt.getContext("2d",{willReadFrequently:!0})),pt.width=E,pt.height=P,kt.drawImage(m,0,0,E,P);const A=kt.getImageData(g,_,w,k);return kt.clearRect(0,0,E,P),A.data}(n,t,r,a,h)})},S.bx=I_,S.by=U,S.bz=ee,S.c=Zn,S.d=n=>d(void 0,void 0,void 0,function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),S.e=He,S.f=n=>new Promise((t,r)=>{const a=new Image;a.onload=()=>{t(a),URL.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(()=>{a.src=We})},a.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(n)],{type:"image/png"});a.src=n.byteLength?URL.createObjectURL(h):We}),S.g=tn,S.h=(n,t)=>lo(He(n,{type:"json"}),t),S.i=$n,S.j=qr,S.k=Zr,S.l=(n,t)=>lo(He(n,{type:"arrayBuffer"}),t),S.m=lo,S.n=function(n){return new Tf(n).readFields(Kw,[])},S.o=tc,S.p=r_,S.q=f,S.r=Jp,S.s=uo,S.t=$u,S.u=So,S.v=ye,S.w=oi,S.x=function([n,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:n*Math.cos(t)*Math.sin(r),y:n*Math.sin(t)*Math.sin(r),z:n*Math.cos(r)}},S.y=on,S.z=Ht}),x("worker",["./shared"],function(S){class d{constructor(L){this.keyCache={},L&&this.replace(L)}replace(L){this._layerConfigs={},this._layers={},this.update(L,[])}update(L,D){for(const H of L){this._layerConfigs[H.id]=H;const oe=this._layers[H.id]=S.aA(H);oe._featureFilter=S.a7(oe.filter),this.keyCache[H.id]&&delete this.keyCache[H.id]}for(const H of D)delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H];this.familiesBySource={};const V=S.bk(Object.values(this._layerConfigs),this.keyCache);for(const H of V){const oe=H.map(ge=>this._layers[ge.id]),ae=oe[0];if(ae.visibility==="none")continue;const de=ae.source||"";let te=this.familiesBySource[de];te||(te=this.familiesBySource[de]={});const ve=ae.sourceLayer||"_geojsonTileLayer";let be=te[ve];be||(be=te[ve]=[]),be.push(oe)}}}class U{constructor(L){const D={},V=[];for(const de in L){const te=L[de],ve=D[de]={};for(const be in te){const ge=te[+be];if(!ge||ge.bitmap.width===0||ge.bitmap.height===0)continue;const ze={x:0,y:0,w:ge.bitmap.width+2,h:ge.bitmap.height+2};V.push(ze),ve[be]={rect:ze,metrics:ge.metrics}}}const{w:H,h:oe}=S.p(V),ae=new S.o({width:H||1,height:oe||1});for(const de in L){const te=L[de];for(const ve in te){const be=te[+ve];if(!be||be.bitmap.width===0||be.bitmap.height===0)continue;const ge=D[de][ve].rect;S.o.copy(be.bitmap,ae,{x:0,y:0},{x:ge.x+1,y:ge.y+1},be.bitmap)}}this.image=ae,this.positions=D}}S.bl("GlyphAtlas",U);class ee{constructor(L){this.tileID=new S.S(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId,this.inFlightDependencies=[]}parse(L,D,V,H){return S._(this,void 0,void 0,function*(){this.status="parsing",this.data=L,this.collisionBoxArray=new S.a5;const oe=new S.bm(Object.keys(L.layers).sort()),ae=new S.bn(this.tileID,this.promoteId);ae.bucketLayerIDs=[];const de={},te={featureIndex:ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},ve=D.familiesBySource[this.source];for(const _t in ve){const jt=L.layers[_t];if(!jt)continue;jt.version===1&&S.w(`Vector tile source "${this.source}" layer "${_t}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Yt=oe.encode(_t),Si=[];for(let Pi=0;Pi<jt.length;Pi++){const Gi=jt.feature(Pi),Vo=ae.getId(Gi,_t);Si.push({feature:Gi,id:Vo,index:Pi,sourceLayerIndex:Yt})}for(const Pi of ve[_t]){const Gi=Pi[0];Gi.source!==this.source&&S.w(`layer.source = ${Gi.source} does not equal this.source = ${this.source}`),Gi.minzoom&&this.zoom<Math.floor(Gi.minzoom)||Gi.maxzoom&&this.zoom>=Gi.maxzoom||Gi.visibility!=="none"&&(me(Pi,this.zoom,V),(de[Gi.id]=Gi.createBucket({index:ae.bucketLayerIDs.length,layers:Pi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Yt,sourceID:this.source})).populate(Si,te,this.tileID.canonical),ae.bucketLayerIDs.push(Pi.map(Vo=>Vo.id)))}}const be=S.aF(te.glyphDependencies,_t=>Object.keys(_t).map(Number));this.inFlightDependencies.forEach(_t=>_t==null?void 0:_t.abort()),this.inFlightDependencies=[];let ge=Promise.resolve({});if(Object.keys(be).length){const _t=new AbortController;this.inFlightDependencies.push(_t),ge=H.sendAsync({type:"GG",data:{stacks:be,source:this.source,tileID:this.tileID,type:"glyphs"}},_t)}const ze=Object.keys(te.iconDependencies);let tt=Promise.resolve({});if(ze.length){const _t=new AbortController;this.inFlightDependencies.push(_t),tt=H.sendAsync({type:"GI",data:{icons:ze,source:this.source,tileID:this.tileID,type:"icons"}},_t)}const rt=Object.keys(te.patternDependencies);let Et=Promise.resolve({});if(rt.length){const _t=new AbortController;this.inFlightDependencies.push(_t),Et=H.sendAsync({type:"GI",data:{icons:rt,source:this.source,tileID:this.tileID,type:"patterns"}},_t)}const[mt,Ct,bt]=yield Promise.all([ge,tt,Et]),mi=new U(mt),ti=new S.bo(Ct,bt);for(const _t in de){const jt=de[_t];jt instanceof S.a6?(me(jt.layers,this.zoom,V),S.bp({bucket:jt,glyphMap:mt,glyphPositions:mi.positions,imageMap:Ct,imagePositions:ti.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):jt.hasPattern&&(jt instanceof S.bq||jt instanceof S.br||jt instanceof S.bs)&&(me(jt.layers,this.zoom,V),jt.addFeatures(te,this.tileID.canonical,ti.patternPositions))}return this.status="done",{buckets:Object.values(de).filter(_t=>!_t.isEmpty()),featureIndex:ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:mi.image,imageAtlas:ti,glyphMap:this.returnDependencies?mt:null,iconMap:this.returnDependencies?Ct:null,glyphPositions:this.returnDependencies?mi.positions:null}})}}function me(K,L,D){const V=new S.z(L);for(const H of K)H.recalculate(V,D)}class X{constructor(L,D,V){this.actor=L,this.layerIndex=D,this.availableImages=V,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(L,D){return S._(this,void 0,void 0,function*(){const V=yield S.l(L.request,D);try{return{vectorTile:new S.bt.VectorTile(new S.bu(V.data)),rawData:V.data,cacheControl:V.cacheControl,expires:V.expires}}catch(H){const oe=new Uint8Array(V.data);let ae=`Unable to parse the tile at ${L.request.url}, `;throw ae+=oe[0]===31&&oe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${H.message}`,new Error(ae)}})}loadTile(L){return S._(this,void 0,void 0,function*(){const D=L.uid,V=!!(L&&L.request&&L.request.collectResourceTiming)&&new S.bv(L.request),H=new ee(L);this.loading[D]=H;const oe=new AbortController;H.abort=oe;try{const ae=yield this.loadVectorTile(L,oe);if(delete this.loading[D],!ae)return null;const de=ae.rawData,te={};ae.expires&&(te.expires=ae.expires),ae.cacheControl&&(te.cacheControl=ae.cacheControl);const ve={};if(V){const ge=V.finish();ge&&(ve.resourceTiming=JSON.parse(JSON.stringify(ge)))}H.vectorTile=ae.vectorTile;const be=H.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[D]=H,this.fetching[D]={rawTileData:de,cacheControl:te,resourceTiming:ve};try{const ge=yield be;return S.e({rawTileData:de.slice(0)},ge,te,ve)}finally{delete this.fetching[D]}}catch(ae){throw delete this.loading[D],H.status="done",this.loaded[D]=H,ae}})}reloadTile(L){return S._(this,void 0,void 0,function*(){const D=L.uid;if(!this.loaded||!this.loaded[D])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const V=this.loaded[D];if(V.showCollisionBoxes=L.showCollisionBoxes,V.status==="parsing"){const H=yield V.parse(V.vectorTile,this.layerIndex,this.availableImages,this.actor);let oe;if(this.fetching[D]){const{rawTileData:ae,cacheControl:de,resourceTiming:te}=this.fetching[D];delete this.fetching[D],oe=S.e({rawTileData:ae.slice(0)},H,de,te)}else oe=H;return oe}if(V.status==="done"&&V.vectorTile)return V.parse(V.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(L){return S._(this,void 0,void 0,function*(){const D=this.loading,V=L.uid;D&&D[V]&&D[V].abort&&(D[V].abort.abort(),delete D[V])})}removeTile(L){return S._(this,void 0,void 0,function*(){this.loaded&&this.loaded[L.uid]&&delete this.loaded[L.uid]})}}class Z{constructor(){this.loaded={}}loadTile(L){return S._(this,void 0,void 0,function*(){const{uid:D,encoding:V,rawImageData:H,redFactor:oe,greenFactor:ae,blueFactor:de,baseShift:te}=L,ve=H.width+2,be=H.height+2,ge=S.b(H)?new S.R({width:ve,height:be},yield S.bw(H,-1,-1,ve,be)):H,ze=new S.bx(D,ge,V,oe,ae,de,te);return this.loaded=this.loaded||{},this.loaded[D]=ze,ze})}removeTile(L){const D=this.loaded,V=L.uid;D&&D[V]&&delete D[V]}}function ke(K,L){if(K.length!==0){Ee(K[0],L);for(var D=1;D<K.length;D++)Ee(K[D],!L)}}function Ee(K,L){for(var D=0,V=0,H=0,oe=K.length,ae=oe-1;H<oe;ae=H++){var de=(K[H][0]-K[ae][0])*(K[ae][1]+K[H][1]),te=D+de;V+=Math.abs(D)>=Math.abs(de)?D-te+de:de-te+D,D=te}D+V>=0!=!!L&&K.reverse()}var Ie=S.by(function K(L,D){var V,H=L&&L.type;if(H==="FeatureCollection")for(V=0;V<L.features.length;V++)K(L.features[V],D);else if(H==="GeometryCollection")for(V=0;V<L.geometries.length;V++)K(L.geometries[V],D);else if(H==="Feature")K(L.geometry,D);else if(H==="Polygon")ke(L.coordinates,D);else if(H==="MultiPolygon")for(V=0;V<L.coordinates.length;V++)ke(L.coordinates[V],D);return L});const $e=S.bt.VectorTileFeature.prototype.toGeoJSON;var le={exports:{}},ne=S.bz,ue=S.bt.VectorTileFeature,Se=je;function je(K,L){this.options=L||{},this.features=K,this.length=K.length}function Je(K,L){this.id=typeof K.id=="number"?K.id:void 0,this.type=K.type,this.rawGeometry=K.type===1?[K.geometry]:K.geometry,this.properties=K.tags,this.extent=L||4096}je.prototype.feature=function(K){return new Je(this.features[K],this.options.extent)},Je.prototype.loadGeometry=function(){var K=this.rawGeometry;this.geometry=[];for(var L=0;L<K.length;L++){for(var D=K[L],V=[],H=0;H<D.length;H++)V.push(new ne(D[H][0],D[H][1]));this.geometry.push(V)}return this.geometry},Je.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var K=this.geometry,L=1/0,D=-1/0,V=1/0,H=-1/0,oe=0;oe<K.length;oe++)for(var ae=K[oe],de=0;de<ae.length;de++){var te=ae[de];L=Math.min(L,te.x),D=Math.max(D,te.x),V=Math.min(V,te.y),H=Math.max(H,te.y)}return[L,V,D,H]},Je.prototype.toGeoJSON=ue.prototype.toGeoJSON;var He=S.bA,ot=Se;function Lt(K){var L=new He;return function(D,V){for(var H in D.layers)V.writeMessage(3,vt,D.layers[H])}(K,L),L.finish()}function vt(K,L){var D;L.writeVarintField(15,K.version||1),L.writeStringField(1,K.name||""),L.writeVarintField(5,K.extent||4096);var V={keys:[],values:[],keycache:{},valuecache:{}};for(D=0;D<K.length;D++)V.feature=K.feature(D),L.writeMessage(2,xt,V);var H=V.keys;for(D=0;D<H.length;D++)L.writeStringField(3,H[D]);var oe=V.values;for(D=0;D<oe.length;D++)L.writeMessage(4,dr,oe[D])}function xt(K,L){var D=K.feature;D.id!==void 0&&L.writeVarintField(1,D.id),L.writeMessage(2,hr,K),L.writeVarintField(3,D.type),L.writeMessage(4,$n,D)}function hr(K,L){var D=K.feature,V=K.keys,H=K.values,oe=K.keycache,ae=K.valuecache;for(var de in D.properties){var te=D.properties[de],ve=oe[de];if(te!==null){ve===void 0&&(V.push(de),oe[de]=ve=V.length-1),L.writeVarint(ve);var be=typeof te;be!=="string"&&be!=="boolean"&&be!=="number"&&(te=JSON.stringify(te));var ge=be+":"+te,ze=ae[ge];ze===void 0&&(H.push(te),ae[ge]=ze=H.length-1),L.writeVarint(ze)}}}function oi(K,L){return(L<<3)+(7&K)}function wi(K){return K<<1^K>>31}function $n(K,L){for(var D=K.loadGeometry(),V=K.type,H=0,oe=0,ae=D.length,de=0;de<ae;de++){var te=D[de],ve=1;V===1&&(ve=te.length),L.writeVarint(oi(1,ve));for(var be=V===3?te.length-1:te.length,ge=0;ge<be;ge++){ge===1&&V!==1&&L.writeVarint(oi(2,be-1));var ze=te[ge].x-H,tt=te[ge].y-oe;L.writeVarint(wi(ze)),L.writeVarint(wi(tt)),H+=ze,oe+=tt}V===3&&L.writeVarint(oi(7,1))}}function dr(K,L){var D=typeof K;D==="string"?L.writeStringField(1,K):D==="boolean"?L.writeBooleanField(7,K):D==="number"&&(K%1!=0?L.writeDoubleField(3,K):K<0?L.writeSVarintField(6,K):L.writeVarintField(5,K))}le.exports=Lt,le.exports.fromVectorTileJs=Lt,le.exports.fromGeojsonVt=function(K,L){L=L||{};var D={};for(var V in K)D[V]=new ot(K[V].features,L),D[V].name=V,D[V].version=L.version,D[V].extent=L.extent;return Lt({layers:D})},le.exports.GeoJSONWrapper=ot;var en=S.by(le.exports);const We={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:K=>K},dt=Math.fround||(pt=new Float32Array(1),K=>(pt[0]=+K,pt[0]));var pt;const kt=3,Bt=5,Zn=6;class Li{constructor(L){this.options=Object.assign(Object.create(We),L),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(L){const{log:D,minZoom:V,maxZoom:H}=this.options;D&&console.time("total time");const oe=`prepare ${L.length} points`;D&&console.time(oe),this.points=L;const ae=[];for(let te=0;te<L.length;te++){const ve=L[te];if(!ve.geometry)continue;const[be,ge]=ve.geometry.coordinates,ze=dt(bi(be)),tt=dt(qn(ge));ae.push(ze,tt,1/0,te,-1,1),this.options.reduce&&ae.push(0)}let de=this.trees[H+1]=this._createTree(ae);D&&console.timeEnd(oe);for(let te=H;te>=V;te--){const ve=+Date.now();de=this.trees[te]=this._createTree(this._cluster(de,te)),D&&console.log("z%d: %d clusters in %dms",te,de.numItems,+Date.now()-ve)}return D&&console.timeEnd("total time"),this}getClusters(L,D){let V=((L[0]+180)%360+360)%360-180;const H=Math.max(-90,Math.min(90,L[1]));let oe=L[2]===180?180:((L[2]+180)%360+360)%360-180;const ae=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)V=-180,oe=180;else if(V>oe){const ge=this.getClusters([V,H,180,ae],D),ze=this.getClusters([-180,H,oe,ae],D);return ge.concat(ze)}const de=this.trees[this._limitZoom(D)],te=de.range(bi(V),qn(ae),bi(oe),qn(H)),ve=de.data,be=[];for(const ge of te){const ze=this.stride*ge;be.push(ve[ze+Bt]>1?tn(ve,ze,this.clusterProps):this.points[ve[ze+kt]])}return be}getChildren(L){const D=this._getOriginId(L),V=this._getOriginZoom(L),H="No cluster with the specified id.",oe=this.trees[V];if(!oe)throw new Error(H);const ae=oe.data;if(D*this.stride>=ae.length)throw new Error(H);const de=this.options.radius/(this.options.extent*Math.pow(2,V-1)),te=oe.within(ae[D*this.stride],ae[D*this.stride+1],de),ve=[];for(const be of te){const ge=be*this.stride;ae[ge+4]===L&&ve.push(ae[ge+Bt]>1?tn(ae,ge,this.clusterProps):this.points[ae[ge+kt]])}if(ve.length===0)throw new Error(H);return ve}getLeaves(L,D,V){const H=[];return this._appendLeaves(H,L,D=D||10,V=V||0,0),H}getTile(L,D,V){const H=this.trees[this._limitZoom(L)],oe=Math.pow(2,L),{extent:ae,radius:de}=this.options,te=de/ae,ve=(V-te)/oe,be=(V+1+te)/oe,ge={features:[]};return this._addTileFeatures(H.range((D-te)/oe,ve,(D+1+te)/oe,be),H.data,D,V,oe,ge),D===0&&this._addTileFeatures(H.range(1-te/oe,ve,1,be),H.data,oe,V,oe,ge),D===oe-1&&this._addTileFeatures(H.range(0,ve,te/oe,be),H.data,-1,V,oe,ge),ge.features.length?ge:null}getClusterExpansionZoom(L){let D=this._getOriginZoom(L)-1;for(;D<=this.options.maxZoom;){const V=this.getChildren(L);if(D++,V.length!==1)break;L=V[0].properties.cluster_id}return D}_appendLeaves(L,D,V,H,oe){const ae=this.getChildren(D);for(const de of ae){const te=de.properties;if(te&&te.cluster?oe+te.point_count<=H?oe+=te.point_count:oe=this._appendLeaves(L,te.cluster_id,V,H,oe):oe<H?oe++:L.push(de),L.length===V)break}return oe}_createTree(L){const D=new S.av(L.length/this.stride|0,this.options.nodeSize,Float32Array);for(let V=0;V<L.length;V+=this.stride)D.add(L[V],L[V+1]);return D.finish(),D.data=L,D}_addTileFeatures(L,D,V,H,oe,ae){for(const de of L){const te=de*this.stride,ve=D[te+Bt]>1;let be,ge,ze;if(ve)be=nn(D,te,this.clusterProps),ge=D[te],ze=D[te+1];else{const Et=this.points[D[te+kt]];be=Et.properties;const[mt,Ct]=Et.geometry.coordinates;ge=bi(mt),ze=qn(Ct)}const tt={type:1,geometry:[[Math.round(this.options.extent*(ge*oe-V)),Math.round(this.options.extent*(ze*oe-H))]],tags:be};let rt;rt=ve||this.options.generateId?D[te+kt]:this.points[D[te+kt]].id,rt!==void 0&&(tt.id=rt),ae.features.push(tt)}}_limitZoom(L){return Math.max(this.options.minZoom,Math.min(Math.floor(+L),this.options.maxZoom+1))}_cluster(L,D){const{radius:V,extent:H,reduce:oe,minPoints:ae}=this.options,de=V/(H*Math.pow(2,D)),te=L.data,ve=[],be=this.stride;for(let ge=0;ge<te.length;ge+=be){if(te[ge+2]<=D)continue;te[ge+2]=D;const ze=te[ge],tt=te[ge+1],rt=L.within(te[ge],te[ge+1],de),Et=te[ge+Bt];let mt=Et;for(const Ct of rt){const bt=Ct*be;te[bt+2]>D&&(mt+=te[bt+Bt])}if(mt>Et&&mt>=ae){let Ct,bt=ze*Et,mi=tt*Et,ti=-1;const _t=((ge/be|0)<<5)+(D+1)+this.points.length;for(const jt of rt){const Yt=jt*be;if(te[Yt+2]<=D)continue;te[Yt+2]=D;const Si=te[Yt+Bt];bt+=te[Yt]*Si,mi+=te[Yt+1]*Si,te[Yt+4]=_t,oe&&(Ct||(Ct=this._map(te,ge,!0),ti=this.clusterProps.length,this.clusterProps.push(Ct)),oe(Ct,this._map(te,Yt)))}te[ge+4]=_t,ve.push(bt/mt,mi/mt,1/0,_t,-1,mt),oe&&ve.push(ti)}else{for(let Ct=0;Ct<be;Ct++)ve.push(te[ge+Ct]);if(mt>1)for(const Ct of rt){const bt=Ct*be;if(!(te[bt+2]<=D)){te[bt+2]=D;for(let mi=0;mi<be;mi++)ve.push(te[bt+mi])}}}}return ve}_getOriginId(L){return L-this.points.length>>5}_getOriginZoom(L){return(L-this.points.length)%32}_map(L,D,V){if(L[D+Bt]>1){const ae=this.clusterProps[L[D+Zn]];return V?Object.assign({},ae):ae}const H=this.points[L[D+kt]].properties,oe=this.options.map(H);return V&&oe===H?Object.assign({},oe):oe}}function tn(K,L,D){return{type:"Feature",id:K[L+kt],properties:nn(K,L,D),geometry:{type:"Point",coordinates:[(V=K[L],360*(V-.5)),lo(K[L+1])]}};var V}function nn(K,L,D){const V=K[L+Bt],H=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V,oe=K[L+Zn],ae=oe===-1?{}:Object.assign({},D[oe]);return Object.assign(ae,{cluster:!0,cluster_id:K[L+kt],point_count:V,point_count_abbreviated:H})}function bi(K){return K/360+.5}function qn(K){const L=Math.sin(K*Math.PI/180),D=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return D<0?0:D>1?1:D}function lo(K){const L=(180-360*K)*Math.PI/180;return 360*Math.atan(Math.exp(L))/Math.PI-90}function uo(K,L,D,V){let H=V;const oe=L+(D-L>>1);let ae,de=D-L;const te=K[L],ve=K[L+1],be=K[D],ge=K[D+1];for(let ze=L+3;ze<D;ze+=3){const tt=$s(K[ze],K[ze+1],te,ve,be,ge);if(tt>H)ae=ze,H=tt;else if(tt===H){const rt=Math.abs(ze-oe);rt<de&&(ae=ze,de=rt)}}H>V&&(ae-L>3&&uo(K,L,ae,V),K[ae+2]=H,D-ae>3&&uo(K,ae,D,V))}function $s(K,L,D,V,H,oe){let ae=H-D,de=oe-V;if(ae!==0||de!==0){const te=((K-D)*ae+(L-V)*de)/(ae*ae+de*de);te>1?(D=H,V=oe):te>0&&(D+=ae*te,V+=de*te)}return ae=K-D,de=L-V,ae*ae+de*de}function Pr(K,L,D,V){const H={id:K??null,type:L,geometry:D,tags:V,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(L==="Point"||L==="MultiPoint"||L==="LineString")Zr(H,D);else if(L==="Polygon")Zr(H,D[0]);else if(L==="MultiLineString")for(const oe of D)Zr(H,oe);else if(L==="MultiPolygon")for(const oe of D)Zr(H,oe[0]);return H}function Zr(K,L){for(let D=0;D<L.length;D+=3)K.minX=Math.min(K.minX,L[D]),K.minY=Math.min(K.minY,L[D+1]),K.maxX=Math.max(K.maxX,L[D]),K.maxY=Math.max(K.maxY,L[D+1])}function qr(K,L,D,V){if(!L.geometry)return;const H=L.geometry.coordinates;if(H&&H.length===0)return;const oe=L.geometry.type,ae=Math.pow(D.tolerance/((1<<D.maxZoom)*D.extent),2);let de=[],te=L.id;if(D.promoteId?te=L.properties[D.promoteId]:D.generateId&&(te=V||0),oe==="Point")Oo(H,de);else if(oe==="MultiPoint")for(const ve of H)Oo(ve,de);else if(oe==="LineString")ye(H,de,ae,!1);else if(oe==="MultiLineString"){if(D.lineMetrics){for(const ve of H)de=[],ye(ve,de,ae,!1),K.push(Pr(te,"LineString",de,L.properties));return}co(H,de,ae,!1)}else if(oe==="Polygon")co(H,de,ae,!0);else{if(oe!=="MultiPolygon"){if(oe==="GeometryCollection"){for(const ve of L.geometry.geometries)qr(K,{id:te,geometry:ve,properties:L.properties},D,V);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ve of H){const be=[];co(ve,be,ae,!0),de.push(be)}}K.push(Pr(te,oe,de,L.properties))}function Oo(K,L){L.push(Zs(K[0]),At(K[1]),0)}function ye(K,L,D,V){let H,oe,ae=0;for(let te=0;te<K.length;te++){const ve=Zs(K[te][0]),be=At(K[te][1]);L.push(ve,be,0),te>0&&(ae+=V?(H*be-ve*oe)/2:Math.sqrt(Math.pow(ve-H,2)+Math.pow(be-oe,2))),H=ve,oe=be}const de=L.length-3;L[2]=1,uo(L,0,de,D),L[de+2]=1,L.size=Math.abs(ae),L.start=0,L.end=L.size}function co(K,L,D,V){for(let H=0;H<K.length;H++){const oe=[];ye(K[H],oe,D,V),L.push(oe)}}function Zs(K){return K/360+.5}function At(K){const L=Math.sin(K*Math.PI/180),D=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return D<0?0:D>1?1:D}function ei(K,L,D,V,H,oe,ae,de){if(V/=L,oe>=(D/=L)&&ae<V)return K;if(ae<D||oe>=V)return null;const te=[];for(const ve of K){const be=ve.geometry;let ge=ve.type;const ze=H===0?ve.minX:ve.minY,tt=H===0?ve.maxX:ve.maxY;if(ze>=D&&tt<V){te.push(ve);continue}if(tt<D||ze>=V)continue;let rt=[];if(ge==="Point"||ge==="MultiPoint")qs(be,rt,D,V,H);else if(ge==="LineString")Gr(be,rt,D,V,H,!1,de.lineMetrics);else if(ge==="MultiLineString")No(be,rt,D,V,H,!1);else if(ge==="Polygon")No(be,rt,D,V,H,!0);else if(ge==="MultiPolygon")for(const Et of be){const mt=[];No(Et,mt,D,V,H,!0),mt.length&&rt.push(mt)}if(rt.length){if(de.lineMetrics&&ge==="LineString"){for(const Et of rt)te.push(Pr(ve.id,ge,Et,ve.tags));continue}ge!=="LineString"&&ge!=="MultiLineString"||(rt.length===1?(ge="LineString",rt=rt[0]):ge="MultiLineString"),ge!=="Point"&&ge!=="MultiPoint"||(ge=rt.length===3?"Point":"MultiPoint"),te.push(Pr(ve.id,ge,rt,ve.tags))}}return te.length?te:null}function qs(K,L,D,V,H){for(let oe=0;oe<K.length;oe+=3){const ae=K[oe+H];ae>=D&&ae<=V&&Pn(L,K[oe],K[oe+1],K[oe+2])}}function Gr(K,L,D,V,H,oe,ae){let de=Mr(K);const te=H===0?Gs:Hs;let ve,be,ge=K.start;for(let mt=0;mt<K.length-3;mt+=3){const Ct=K[mt],bt=K[mt+1],mi=K[mt+2],ti=K[mt+3],_t=K[mt+4],jt=H===0?Ct:bt,Yt=H===0?ti:_t;let Si=!1;ae&&(ve=Math.sqrt(Math.pow(Ct-ti,2)+Math.pow(bt-_t,2))),jt<D?Yt>D&&(be=te(de,Ct,bt,ti,_t,D),ae&&(de.start=ge+ve*be)):jt>V?Yt<V&&(be=te(de,Ct,bt,ti,_t,V),ae&&(de.start=ge+ve*be)):Pn(de,Ct,bt,mi),Yt<D&&jt>=D&&(be=te(de,Ct,bt,ti,_t,D),Si=!0),Yt>V&&jt<=V&&(be=te(de,Ct,bt,ti,_t,V),Si=!0),!oe&&Si&&(ae&&(de.end=ge+ve*be),L.push(de),de=Mr(K)),ae&&(ge+=ve)}let ze=K.length-3;const tt=K[ze],rt=K[ze+1],Et=H===0?tt:rt;Et>=D&&Et<=V&&Pn(de,tt,rt,K[ze+2]),ze=de.length-3,oe&&ze>=3&&(de[ze]!==de[0]||de[ze+1]!==de[1])&&Pn(de,de[0],de[1],de[2]),de.length&&L.push(de)}function Mr(K){const L=[];return L.size=K.size,L.start=K.start,L.end=K.end,L}function No(K,L,D,V,H,oe){for(const ae of K)Gr(ae,L,D,V,H,oe,!1)}function Pn(K,L,D,V){K.push(L,D,V)}function Gs(K,L,D,V,H,oe){const ae=(oe-L)/(V-L);return Pn(K,oe,D+(H-D)*ae,1),ae}function Hs(K,L,D,V,H,oe){const ae=(oe-D)/(H-D);return Pn(K,L+(V-L)*ae,oe,1),ae}function Pe(K,L){const D=[];for(let V=0;V<K.length;V++){const H=K[V],oe=H.type;let ae;if(oe==="Point"||oe==="MultiPoint"||oe==="LineString")ae=pr(H.geometry,L);else if(oe==="MultiLineString"||oe==="Polygon"){ae=[];for(const de of H.geometry)ae.push(pr(de,L))}else if(oe==="MultiPolygon"){ae=[];for(const de of H.geometry){const te=[];for(const ve of de)te.push(pr(ve,L));ae.push(te)}}D.push(Pr(H.id,oe,ae,H.tags))}return D}function pr(K,L){const D=[];D.size=K.size,K.start!==void 0&&(D.start=K.start,D.end=K.end);for(let V=0;V<K.length;V+=3)D.push(K[V]+L,K[V+1],K[V+2]);return D}function qi(K,L){if(K.transformed)return K;const D=1<<K.z,V=K.x,H=K.y;for(const oe of K.features){const ae=oe.geometry,de=oe.type;if(oe.geometry=[],de===1)for(let te=0;te<ae.length;te+=2)oe.geometry.push(fr(ae[te],ae[te+1],L,D,V,H));else for(let te=0;te<ae.length;te++){const ve=[];for(let be=0;be<ae[te].length;be+=2)ve.push(fr(ae[te][be],ae[te][be+1],L,D,V,H));oe.geometry.push(ve)}}return K.transformed=!0,K}function fr(K,L,D,V,H,oe){return[Math.round(D*(K*V-H)),Math.round(D*(L*V-oe))]}function Hr(K,L,D,V,H){const oe=L===H.maxZoom?0:H.tolerance/((1<<L)*H.extent),ae={features:[],numPoints:0,numSimplified:0,numFeatures:K.length,source:null,x:D,y:V,z:L,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const de of K)Le(ae,de,oe,H);return ae}function Le(K,L,D,V){const H=L.geometry,oe=L.type,ae=[];if(K.minX=Math.min(K.minX,L.minX),K.minY=Math.min(K.minY,L.minY),K.maxX=Math.max(K.maxX,L.maxX),K.maxY=Math.max(K.maxY,L.maxY),oe==="Point"||oe==="MultiPoint")for(let de=0;de<H.length;de+=3)ae.push(H[de],H[de+1]),K.numPoints++,K.numSimplified++;else if(oe==="LineString")yt(ae,H,K,D,!1,!1);else if(oe==="MultiLineString"||oe==="Polygon")for(let de=0;de<H.length;de++)yt(ae,H[de],K,D,oe==="Polygon",de===0);else if(oe==="MultiPolygon")for(let de=0;de<H.length;de++){const te=H[de];for(let ve=0;ve<te.length;ve++)yt(ae,te[ve],K,D,!0,ve===0)}if(ae.length){let de=L.tags||null;if(oe==="LineString"&&V.lineMetrics){de={};for(const ve in L.tags)de[ve]=L.tags[ve];de.mapbox_clip_start=H.start/H.size,de.mapbox_clip_end=H.end/H.size}const te={geometry:ae,type:oe==="Polygon"||oe==="MultiPolygon"?3:oe==="LineString"||oe==="MultiLineString"?2:1,tags:de};L.id!==null&&(te.id=L.id),K.features.push(te)}}function yt(K,L,D,V,H,oe){const ae=V*V;if(V>0&&L.size<(H?ae:V))return void(D.numPoints+=L.length/3);const de=[];for(let te=0;te<L.length;te+=3)(V===0||L[te+2]>ae)&&(D.numSimplified++,de.push(L[te],L[te+1])),D.numPoints++;H&&function(te,ve){let be=0;for(let ge=0,ze=te.length,tt=ze-2;ge<ze;tt=ge,ge+=2)be+=(te[ge]-te[tt])*(te[ge+1]+te[tt+1]);if(be>0===ve)for(let ge=0,ze=te.length;ge<ze/2;ge+=2){const tt=te[ge],rt=te[ge+1];te[ge]=te[ze-2-ge],te[ge+1]=te[ze-1-ge],te[ze-2-ge]=tt,te[ze-1-ge]=rt}}(de,oe),K.push(de)}const lt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class rn{constructor(L,D){const V=(D=this.options=function(oe,ae){for(const de in ae)oe[de]=ae[de];return oe}(Object.create(lt),D)).debug;if(V&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");let H=function(oe,ae){const de=[];if(oe.type==="FeatureCollection")for(let te=0;te<oe.features.length;te++)qr(de,oe.features[te],ae,te);else qr(de,oe.type==="Feature"?oe:{geometry:oe},ae);return de}(L,D);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),H=function(oe,ae){const de=ae.buffer/ae.extent;let te=oe;const ve=ei(oe,1,-1-de,de,0,-1,2,ae),be=ei(oe,1,1-de,2+de,0,-1,2,ae);return(ve||be)&&(te=ei(oe,1,-de,1+de,0,-1,2,ae)||[],ve&&(te=Pe(ve,1).concat(te)),be&&(te=te.concat(Pe(be,-1)))),te}(H,D),H.length&&this.splitTile(H,0,0,0),V&&(H.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(L,D,V,H,oe,ae,de){const te=[L,D,V,H],ve=this.options,be=ve.debug;for(;te.length;){H=te.pop(),V=te.pop(),D=te.pop(),L=te.pop();const ge=1<<D,ze=Gn(D,V,H);let tt=this.tiles[ze];if(!tt&&(be>1&&console.time("creation"),tt=this.tiles[ze]=Hr(L,D,V,H,ve),this.tileCoords.push({z:D,x:V,y:H}),be)){be>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,V,H,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));const Si=`z${D}`;this.stats[Si]=(this.stats[Si]||0)+1,this.total++}if(tt.source=L,oe==null){if(D===ve.indexMaxZoom||tt.numPoints<=ve.indexMaxPoints)continue}else{if(D===ve.maxZoom||D===oe)continue;if(oe!=null){const Si=oe-D;if(V!==ae>>Si||H!==de>>Si)continue}}if(tt.source=null,L.length===0)continue;be>1&&console.time("clipping");const rt=.5*ve.buffer/ve.extent,Et=.5-rt,mt=.5+rt,Ct=1+rt;let bt=null,mi=null,ti=null,_t=null,jt=ei(L,ge,V-rt,V+mt,0,tt.minX,tt.maxX,ve),Yt=ei(L,ge,V+Et,V+Ct,0,tt.minX,tt.maxX,ve);L=null,jt&&(bt=ei(jt,ge,H-rt,H+mt,1,tt.minY,tt.maxY,ve),mi=ei(jt,ge,H+Et,H+Ct,1,tt.minY,tt.maxY,ve),jt=null),Yt&&(ti=ei(Yt,ge,H-rt,H+mt,1,tt.minY,tt.maxY,ve),_t=ei(Yt,ge,H+Et,H+Ct,1,tt.minY,tt.maxY,ve),Yt=null),be>1&&console.timeEnd("clipping"),te.push(bt||[],D+1,2*V,2*H),te.push(mi||[],D+1,2*V,2*H+1),te.push(ti||[],D+1,2*V+1,2*H),te.push(_t||[],D+1,2*V+1,2*H+1)}}getTile(L,D,V){L=+L,D=+D,V=+V;const H=this.options,{extent:oe,debug:ae}=H;if(L<0||L>24)return null;const de=1<<L,te=Gn(L,D=D+de&de-1,V);if(this.tiles[te])return qi(this.tiles[te],oe);ae>1&&console.log("drilling down to z%d-%d-%d",L,D,V);let ve,be=L,ge=D,ze=V;for(;!ve&&be>0;)be--,ge>>=1,ze>>=1,ve=this.tiles[Gn(be,ge,ze)];return ve&&ve.source?(ae>1&&(console.log("found parent tile z%d-%d-%d",be,ge,ze),console.time("drilling down")),this.splitTile(ve.source,be,ge,ze,L,D,V),ae>1&&console.timeEnd("drilling down"),this.tiles[te]?qi(this.tiles[te],oe):null):null}}function Gn(K,L,D){return 32*((1<<K)*D+L)+K}function ft(K,L){return L?K.properties[L]:K.id}function mr(K,L){if(K==null)return!0;if(K.type==="Feature")return ft(K,L)!=null;if(K.type==="FeatureCollection"){const D=new Set;for(const V of K.features){const H=ft(V,L);if(H==null||D.has(H))return!1;D.add(H)}return!0}return!1}function zr(K,L){const D=new Map;if(K!=null)if(K.type==="Feature")D.set(ft(K,L),K);else for(const V of K.features)D.set(ft(V,L),V);return D}class Wr extends X{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(L,D){return S._(this,void 0,void 0,function*(){const V=L.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const H=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!H)return null;const oe=new class{constructor(de){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=S.X,this.length=de.length,this._features=de}feature(de){return new class{constructor(te){this._feature=te,this.extent=S.X,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){const te=[];for(const ve of this._feature.geometry)te.push([new S.P(ve[0],ve[1])]);return te}{const te=[];for(const ve of this._feature.geometry){const be=[];for(const ge of ve)be.push(new S.P(ge[0],ge[1]));te.push(be)}return te}}toGeoJSON(te,ve,be){return $e.call(this,te,ve,be)}}(this._features[de])}}(H.features);let ae=en(oe);return ae.byteOffset===0&&ae.byteLength===ae.buffer.byteLength||(ae=new Uint8Array(ae)),{vectorTile:oe,rawData:ae.buffer}})}loadData(L){return S._(this,void 0,void 0,function*(){var D;(D=this._pendingRequest)===null||D===void 0||D.abort();const V=!!(L&&L.request&&L.request.collectResourceTiming)&&new S.bv(L.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(L,this._pendingRequest),this._geoJSONIndex=L.cluster?new Li(function({superclusterOptions:ae,clusterProperties:de}){if(!de||!ae)return ae;const te={},ve={},be={accumulated:null,zoom:0},ge={properties:null},ze=Object.keys(de);for(const tt of ze){const[rt,Et]=de[tt],mt=S.bC(Et),Ct=S.bC(typeof rt=="string"?[rt,["accumulated"],["get",tt]]:rt);te[tt]=mt.value,ve[tt]=Ct.value}return ae.map=tt=>{ge.properties=tt;const rt={};for(const Et of ze)rt[Et]=te[Et].evaluate(be,ge);return rt},ae.reduce=(tt,rt)=>{ge.properties=rt;for(const Et of ze)be.accumulated=tt[Et],tt[Et]=ve[Et].evaluate(be,ge)},ae}(L)).load((yield this._pendingData).features):(H=yield this._pendingData,new rn(H,L.geojsonVtOptions)),this.loaded={};const oe={};if(V){const ae=V.finish();ae&&(oe.resourceTiming={},oe.resourceTiming[L.source]=JSON.parse(JSON.stringify(ae)))}return oe}catch(oe){if(delete this._pendingRequest,S.bB(oe))return{abandoned:!0};throw oe}var H})}getData(){return S._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(L){const D=this.loaded;return D&&D[L.uid]?super.reloadTile(L):this.loadTile(L)}loadAndProcessGeoJSON(L,D){return S._(this,void 0,void 0,function*(){let V=yield this.loadGeoJSON(L,D);if(delete this._pendingRequest,typeof V!="object")throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(Ie(V,!0),L.filter){const H=S.bC(L.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(H.result==="error")throw new Error(H.value.map(ae=>`${ae.key}: ${ae.message}`).join(", "));V={type:"FeatureCollection",features:V.features.filter(ae=>H.value.evaluate({zoom:0},ae))}}return V})}loadGeoJSON(L,D){return S._(this,void 0,void 0,function*(){const{promoteId:V}=L;if(L.request){const H=yield S.h(L.request,D);return this._dataUpdateable=mr(H.data,V)?zr(H.data,V):void 0,H.data}if(typeof L.data=="string")try{const H=JSON.parse(L.data);return this._dataUpdateable=mr(H,V)?zr(H,V):void 0,H}catch{throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`)}if(!L.dataDiff)throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${L.source}`);return function(H,oe,ae){var de,te,ve,be;if(oe.removeAll&&H.clear(),oe.remove)for(const ge of oe.remove)H.delete(ge);if(oe.add)for(const ge of oe.add){const ze=ft(ge,ae);ze!=null&&H.set(ze,ge)}if(oe.update)for(const ge of oe.update){let ze=H.get(ge.id);if(ze==null)continue;const tt=!ge.removeAllProperties&&(((de=ge.removeProperties)===null||de===void 0?void 0:de.length)>0||((te=ge.addOrUpdateProperties)===null||te===void 0?void 0:te.length)>0);if((ge.newGeometry||ge.removeAllProperties||tt)&&(ze=Object.assign({},ze),H.set(ge.id,ze),tt&&(ze.properties=Object.assign({},ze.properties))),ge.newGeometry&&(ze.geometry=ge.newGeometry),ge.removeAllProperties)ze.properties={};else if(((ve=ge.removeProperties)===null||ve===void 0?void 0:ve.length)>0)for(const rt of ge.removeProperties)Object.prototype.hasOwnProperty.call(ze.properties,rt)&&delete ze.properties[rt];if(((be=ge.addOrUpdateProperties)===null||be===void 0?void 0:be.length)>0)for(const{key:rt,value:Et}of ge.addOrUpdateProperties)ze.properties[rt]=Et}}(this._dataUpdateable,L.dataDiff,V),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(L){return S._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(L){return this._geoJSONIndex.getClusterExpansionZoom(L.clusterId)}getClusterChildren(L){return this._geoJSONIndex.getChildren(L.clusterId)}getClusterLeaves(L){return this._geoJSONIndex.getLeaves(L.clusterId,L.limit,L.offset)}}class gr{constructor(L){this.self=L,this.actor=new S.F(L),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(D,V)=>{if(this.externalWorkerSourceTypes[D])throw new Error(`Worker source with name "${D}" already registered.`);this.externalWorkerSourceTypes[D]=V},this.self.addProtocol=S.bi,this.self.removeProtocol=S.bj,this.self.registerRTLTextPlugin=D=>{if(S.bD.isParsed())throw new Error("RTL text plugin already registered.");S.bD.setMethods(D)},this.actor.registerMessageHandler("LDT",(D,V)=>this._getDEMWorkerSource(D,V.source).loadTile(V)),this.actor.registerMessageHandler("RDT",(D,V)=>S._(this,void 0,void 0,function*(){this._getDEMWorkerSource(D,V.source).removeTile(V)})),this.actor.registerMessageHandler("GCEZ",(D,V)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(D,V.type,V.source).getClusterExpansionZoom(V)})),this.actor.registerMessageHandler("GCC",(D,V)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(D,V.type,V.source).getClusterChildren(V)})),this.actor.registerMessageHandler("GCL",(D,V)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(D,V.type,V.source).getClusterLeaves(V)})),this.actor.registerMessageHandler("LD",(D,V)=>this._getWorkerSource(D,V.type,V.source).loadData(V)),this.actor.registerMessageHandler("GD",(D,V)=>this._getWorkerSource(D,V.type,V.source).getData()),this.actor.registerMessageHandler("LT",(D,V)=>this._getWorkerSource(D,V.type,V.source).loadTile(V)),this.actor.registerMessageHandler("RT",(D,V)=>this._getWorkerSource(D,V.type,V.source).reloadTile(V)),this.actor.registerMessageHandler("AT",(D,V)=>this._getWorkerSource(D,V.type,V.source).abortTile(V)),this.actor.registerMessageHandler("RMT",(D,V)=>this._getWorkerSource(D,V.type,V.source).removeTile(V)),this.actor.registerMessageHandler("RS",(D,V)=>S._(this,void 0,void 0,function*(){if(!this.workerSources[D]||!this.workerSources[D][V.type]||!this.workerSources[D][V.type][V.source])return;const H=this.workerSources[D][V.type][V.source];delete this.workerSources[D][V.type][V.source],H.removeSource!==void 0&&H.removeSource(V)})),this.actor.registerMessageHandler("RM",D=>S._(this,void 0,void 0,function*(){delete this.layerIndexes[D],delete this.availableImages[D],delete this.workerSources[D],delete this.demWorkerSources[D]})),this.actor.registerMessageHandler("SR",(D,V)=>S._(this,void 0,void 0,function*(){this.referrer=V})),this.actor.registerMessageHandler("SRPS",(D,V)=>this._syncRTLPluginState(D,V)),this.actor.registerMessageHandler("IS",(D,V)=>S._(this,void 0,void 0,function*(){this.self.importScripts(V)})),this.actor.registerMessageHandler("SI",(D,V)=>this._setImages(D,V)),this.actor.registerMessageHandler("UL",(D,V)=>S._(this,void 0,void 0,function*(){this._getLayerIndex(D).update(V.layers,V.removedIds)})),this.actor.registerMessageHandler("SL",(D,V)=>S._(this,void 0,void 0,function*(){this._getLayerIndex(D).replace(V)}))}_setImages(L,D){return S._(this,void 0,void 0,function*(){this.availableImages[L]=D;for(const V in this.workerSources[L]){const H=this.workerSources[L][V];for(const oe in H)H[oe].availableImages=D}})}_syncRTLPluginState(L,D){return S._(this,void 0,void 0,function*(){if(S.bD.isParsed())return S.bD.getState();if(D.pluginStatus!=="loading")return S.bD.setState(D),D;const V=D.pluginURL;if(this.self.importScripts(V),S.bD.isParsed()){const H={pluginStatus:"loaded",pluginURL:V};return S.bD.setState(H),H}throw S.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${V}`)})}_getAvailableImages(L){let D=this.availableImages[L];return D||(D=[]),D}_getLayerIndex(L){let D=this.layerIndexes[L];return D||(D=this.layerIndexes[L]=new d),D}_getWorkerSource(L,D,V){if(this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][D]||(this.workerSources[L][D]={}),!this.workerSources[L][D][V]){const H={sendAsync:(oe,ae)=>(oe.targetMapId=L,this.actor.sendAsync(oe,ae))};switch(D){case"vector":this.workerSources[L][D][V]=new X(H,this._getLayerIndex(L),this._getAvailableImages(L));break;case"geojson":this.workerSources[L][D][V]=new Wr(H,this._getLayerIndex(L),this._getAvailableImages(L));break;default:this.workerSources[L][D][V]=new this.externalWorkerSourceTypes[D](H,this._getLayerIndex(L),this._getAvailableImages(L))}}return this.workerSources[L][D][V]}_getDEMWorkerSource(L,D){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][D]||(this.demWorkerSources[L][D]=new Z),this.demWorkerSources[L][D]}}return S.i(self)&&(self.worker=new gr(self)),gr}),x("index",["exports","./shared"],function(S,d){var U="4.7.0";let ee,me;const X={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:f=>new Promise((e,s)=>{const l=requestAnimationFrame(e);f.signal.addEventListener("abort",()=>{cancelAnimationFrame(l),s(d.c())})}),getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),s=e.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,s.drawImage(f,0,0,f.width,f.height),s},resolveURL:f=>(ee||(ee=document.createElement("a")),ee.href=f,ee.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(me==null&&(me=matchMedia("(prefers-reduced-motion: reduce)")),me.matches)}};class Z{static testProp(e){if(!Z.docStyle)return e[0];for(let s=0;s<e.length;s++)if(e[s]in Z.docStyle)return e[s];return e[0]}static create(e,s,l){const u=window.document.createElement(e);return s!==void 0&&(u.className=s),l&&l.appendChild(u),u}static createNS(e,s){return window.document.createElementNS(e,s)}static disableDrag(){Z.docStyle&&Z.selectProp&&(Z.userSelect=Z.docStyle[Z.selectProp],Z.docStyle[Z.selectProp]="none")}static enableDrag(){Z.docStyle&&Z.selectProp&&(Z.docStyle[Z.selectProp]=Z.userSelect)}static setTransform(e,s){e.style[Z.transformProp]=s}static addEventListener(e,s,l,u={}){e.addEventListener(s,l,"passive"in u?u:u.capture)}static removeEventListener(e,s,l,u={}){e.removeEventListener(s,l,"passive"in u?u:u.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",Z.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Z.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",Z.suppressClickInternal,!0)},0)}static getScale(e){const s=e.getBoundingClientRect();return{x:s.width/e.offsetWidth||1,y:s.height/e.offsetHeight||1,boundingClientRect:s}}static getPoint(e,s,l){const u=s.boundingClientRect;return new d.P((l.clientX-u.left)/s.x-e.clientLeft,(l.clientY-u.top)/s.y-e.clientTop)}static mousePos(e,s){const l=Z.getScale(e);return Z.getPoint(e,l,s)}static touchPos(e,s){const l=[],u=Z.getScale(e);for(let p=0;p<s.length;p++)l.push(Z.getPoint(e,u,s[p]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}Z.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,Z.selectProp=Z.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Z.transformProp=Z.testProp(["transform","WebkitTransform"]);const ke={supported:!1,testSupport:function(f){!$e&&Ie&&(le?ne(f):Ee=f)}};let Ee,Ie,$e=!1,le=!1;function ne(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Ie),f.isContextLost())return;ke.supported=!0}catch{}f.deleteTexture(e),$e=!0}var ue;typeof document<"u"&&(Ie=document.createElement("img"),Ie.onload=()=>{Ee&&ne(Ee),Ee=null,le=!0},Ie.onerror=()=>{$e=!0,Ee=null},Ie.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,s,l,u;f.resetRequestQueue=()=>{e=[],s=0,l=0,u={}},f.addThrottleControl=I=>{const C=l++;return u[C]=I,C},f.removeThrottleControl=I=>{delete u[I],v()},f.getImage=(I,C,M=!0)=>new Promise((z,F)=>{ke.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),d.e(I,{type:"image"}),e.push({abortController:C,requestParameters:I,supportImageRefresh:M,state:"queued",onError:N=>{F(N)},onSuccess:N=>{z(N)}}),v()});const p=I=>d._(this,void 0,void 0,function*(){I.state="running";const{requestParameters:C,supportImageRefresh:M,onError:z,onSuccess:F,abortController:N}=I,$=M===!1&&!d.i(self)&&!d.g(C.url)&&(!C.headers||Object.keys(C.headers).reduce((Q,ie)=>Q&&ie==="accept",!0));s++;const W=$?b(C,N):d.m(C,N);try{const Q=yield W;delete I.abortController,I.state="completed",Q.data instanceof HTMLImageElement||d.b(Q.data)?F(Q):Q.data&&F({data:yield(Y=Q.data,typeof createImageBitmap=="function"?d.d(Y):d.f(Y)),cacheControl:Q.cacheControl,expires:Q.expires})}catch(Q){delete I.abortController,z(Q)}finally{s--,v()}var Y}),v=()=>{const I=(()=>{for(const C of Object.keys(u))if(u[C]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let C=s;C<I&&e.length>0;C++){const M=e.shift();M.abortController.signal.aborted?C--:p(M)}},b=(I,C)=>new Promise((M,z)=>{const F=new Image,N=I.url,$=I.credentials;$&&$==="include"?F.crossOrigin="use-credentials":($&&$==="same-origin"||!d.s(N))&&(F.crossOrigin="anonymous"),C.signal.addEventListener("abort",()=>{F.src="",z(d.c())}),F.fetchPriority="high",F.onload=()=>{F.onerror=F.onload=null,M({data:F})},F.onerror=()=>{F.onerror=F.onload=null,C.signal.aborted||z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},F.src=N})}(ue||(ue={})),ue.resetRequestQueue();class Se{constructor(e){this._transformRequestFn=e}transformRequest(e,s){return this._transformRequestFn&&this._transformRequestFn(e,s)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function je(f){var e=new d.A(3);return e[0]=f[0],e[1]=f[1],e[2]=f[2],e}var Je,He=function(f,e,s){return f[0]=e[0]-s[0],f[1]=e[1]-s[1],f[2]=e[2]-s[2],f};Je=new d.A(3),d.A!=Float32Array&&(Je[0]=0,Je[1]=0,Je[2]=0);var ot=function(f){var e=f[0],s=f[1];return e*e+s*s};function Lt(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const s=[];for(const{id:l,url:u}of f){const p=`${l}${u}`;s.indexOf(p)===-1&&(s.push(p),e.push({id:l,url:u}))}}return e}function vt(f,e,s){const l=f.split("?");return l[0]+=`${e}${s}`,l.join("?")}(function(){var f=new d.A(2);d.A!=Float32Array&&(f[0]=0,f[1]=0)})();class xt{constructor(e,s,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(s,u)}update(e,s,l){const{width:u,height:p}=e,v=!(this.size&&this.size[0]===u&&this.size[1]===p||l),{context:b}=this,{gl:I}=b;if(this.useMipmap=!!(s&&s.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!s||s.premultiply!==!1)),v)this.size=[u,p],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,e):I.texImage2D(I.TEXTURE_2D,0,this.format,u,p,0,this.format,I.UNSIGNED_BYTE,e.data);else{const{x:C,y:M}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?I.texSubImage2D(I.TEXTURE_2D,0,C,M,I.RGBA,I.UNSIGNED_BYTE,e):I.texSubImage2D(I.TEXTURE_2D,0,C,M,u,p,I.RGBA,I.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)}bind(e,s,l){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),l!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,l||e),this.filter=e),s!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function hr(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class oi extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:s,promiseResolve:l}of this.requestors)l(this._getImagesForIds(s));this.requestors=[]}}getImage(e){const s=this.images[e];if(s&&!s.data&&s.spriteData){const l=s.spriteData;s.data=new d.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),s.spriteData=null}return s}addImage(e,s){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,s)&&(this.images[e]=s)}_validate(e,s){let l=!0;const u=s.data||s.spriteData;return this._validateStretch(s.stretchX,u&&u.width)||(this.fire(new d.j(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(s.stretchY,u&&u.height)||(this.fire(new d.j(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(s.content,s)||(this.fire(new d.j(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,s){if(!e)return!0;let l=0;for(const u of e){if(u[0]<l||u[1]<u[0]||s<u[1])return!1;l=u[1]}return!0}_validateContent(e,s){if(!e)return!0;if(e.length!==4)return!1;const l=s.spriteData,u=l&&l.width||s.data.width,p=l&&l.height||s.data.height;return!(e[0]<0||u<e[0]||e[1]<0||p<e[1]||e[2]<0||u<e[2]||e[3]<0||p<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,s,l=!0){const u=this.getImage(e);if(l&&(u.data.width!==s.data.width||u.data.height!==s.data.height))throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=u.version+1,this.images[e]=s,this.updatedImages[e]=!0}removeImage(e){const s=this.images[e];delete this.images[e],delete this.patterns[e],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((s,l)=>{let u=!0;if(!this.isLoaded())for(const p of e)this.images[p]||(u=!1);this.isLoaded()||u?s(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:s})})}_getImagesForIds(e){const s={};for(const l of e){let u=this.getImage(l);u||(this.fire(new d.k("styleimagemissing",{id:l})),u=this.getImage(l)),u?s[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,textFitWidth:u.textFitWidth,textFitHeight:u.textFitHeight,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:d.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:e,height:s}=this.atlasImage;return{width:e,height:s}}getPattern(e){const s=this.patterns[e],l=this.getImage(e);if(!l)return null;if(s&&s.position.version===l.version)return s.position;if(s)s.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},p=new d.I(u,l);this.patterns[e]={bin:u,position:p}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const s=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new xt(e,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const p in this.patterns)e.push(this.patterns[p].bin);const{w:s,h:l}=d.p(e),u=this.atlasImage;u.resize({width:s||1,height:l||1});for(const p in this.patterns){const{bin:v}=this.patterns[p],b=v.x+1,I=v.y+1,C=this.getImage(p).data,M=C.width,z=C.height;d.R.copy(C,u,{x:0,y:0},{x:b,y:I},{width:M,height:z}),d.R.copy(C,u,{x:0,y:z-1},{x:b,y:I-1},{width:M,height:1}),d.R.copy(C,u,{x:0,y:0},{x:b,y:I+z},{width:M,height:1}),d.R.copy(C,u,{x:M-1,y:0},{x:b-1,y:I},{width:1,height:z}),d.R.copy(C,u,{x:0,y:0},{x:b+M,y:I},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const s of e){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const l=this.getImage(s);l||d.w(`Image with ID: "${s}" was not found`),hr(l)&&this.updateImage(s,l)}}}const wi=1e20;function $n(f,e,s,l,u,p,v,b,I){for(let C=e;C<e+l;C++)dr(f,s*p+C,p,u,v,b,I);for(let C=s;C<s+u;C++)dr(f,C*p+e,1,l,v,b,I)}function dr(f,e,s,l,u,p,v){p[0]=0,v[0]=-wi,v[1]=wi,u[0]=f[e];for(let b=1,I=0,C=0;b<l;b++){u[b]=f[e+b*s];const M=b*b;do{const z=p[I];C=(u[b]-u[z]+M-z*z)/(b-z)/2}while(C<=v[I]&&--I>-1);I++,p[I]=b,v[I]=C,v[I+1]=wi}for(let b=0,I=0;b<l;b++){for(;v[I+1]<b;)I++;const C=p[I],M=b-C;f[e+b*s]=u[C]+M*M}}class en{constructor(e,s){this.requestManager=e,this.localIdeographFontFamily=s,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return d._(this,void 0,void 0,function*(){const s=[];for(const p in e)for(const v of e[p])s.push(this._getAndCacheGlyphsPromise(p,v));const l=yield Promise.all(s),u={};for(const{stack:p,id:v,glyph:b}of l)u[p]||(u[p]={}),u[p][v]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics};return u})}_getAndCacheGlyphsPromise(e,s){return d._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let u=l.glyphs[s];if(u!==void 0)return{stack:e,id:s,glyph:u};if(u=this._tinySDF(l,e,s),u)return l.glyphs[s]=u,{stack:e,id:s,glyph:u};const p=Math.floor(s/256);if(256*p>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[p])return{stack:e,id:s,glyph:u};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[p]){const b=en.loadGlyphRange(e,p,this.url,this.requestManager);l.requests[p]=b}const v=yield l.requests[p];for(const b in v)this._doesCharSupportLocalGlyph(+b)||(l.glyphs[+b]=v[+b]);return l.ranges[p]=!0,{stack:e,id:s,glyph:v[s]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,s,l){const u=this.localIdeographFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let p=e.tinySDF;if(!p){let b="400";/bold/i.test(s)?b="900":/medium/i.test(s)?b="500":/light/i.test(s)&&(b="200"),p=e.tinySDF=new en.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:u,fontWeight:b})}const v=p.draw(String.fromCharCode(l));return{id:l,bitmap:new d.o({width:v.width||60,height:v.height||60},v.data),metrics:{width:v.glyphWidth/2||24,height:v.glyphHeight/2||24,left:v.glyphLeft/2+.5||0,top:v.glyphTop/2-27.5||-8,advance:v.glyphAdvance/2||24,isDoubleResolution:!0}}}}en.loadGlyphRange=function(f,e,s,l){return d._(this,void 0,void 0,function*(){const u=256*e,p=u+255,v=l.transformRequest(s.replace("{fontstack}",f).replace("{range}",`${u}-${p}`),"Glyphs"),b=yield d.l(v,new AbortController);if(!b||!b.data)throw new Error(`Could not load glyph range. range: ${e}, ${u}-${p}`);const I={};for(const C of d.n(b.data))I[C.id]=C;return I})},en.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:s=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=s;const b=this.size=f+4*e,I=this._createCanvas(b),C=this.ctx=I.getContext("2d",{willReadFrequently:!0});C.font=`${v} ${p} ${f}px ${u}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(f),v=Math.ceil(s),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-u))),I=Math.min(this.size-this.buffer,v+Math.ceil(l)),C=b+2*this.buffer,M=I+2*this.buffer,z=Math.max(C*M,0),F=new Uint8ClampedArray(z),N={data:F,width:C,height:M,glyphWidth:b,glyphHeight:I,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(b===0||I===0)return N;const{ctx:$,buffer:W,gridInner:Y,gridOuter:Q}=this;$.clearRect(W,W,b,I),$.fillText(f,W,W+v);const ie=$.getImageData(W,W,b,I);Q.fill(wi,0,z),Y.fill(0,0,z);for(let q=0;q<I;q++)for(let se=0;se<b;se++){const ce=ie.data[4*(q*b+se)+3]/255;if(ce===0)continue;const fe=(q+W)*C+se+W;if(ce===1)Q[fe]=0,Y[fe]=wi;else{const we=.5-ce;Q[fe]=we>0?we*we:0,Y[fe]=we<0?we*we:0}}$n(Q,0,0,C,M,C,this.f,this.v,this.z),$n(Y,W,W,b,I,C,this.f,this.v,this.z);for(let q=0;q<z;q++){const se=Math.sqrt(Q[q])-Math.sqrt(Y[q]);F[q]=Math.round(255-255*(se/this.radius+this.cutoff))}return N}};class We{constructor(){this.specification=d.v.light.position}possiblyEvaluate(e,s){return d.x(e.expression.evaluate(s))}interpolate(e,s,l){return{x:d.y.number(e.x,s.x,l),y:d.y.number(e.y,s.y,l),z:d.y.number(e.z,s.z,l)}}}let dt;class pt extends d.E{constructor(e){super(),dt=dt||new d.q({anchor:new d.D(d.v.light.anchor),position:new We,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(dt),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,s={}){if(!this._validate(d.r,e,s))for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,l){return(!l||l.validate!==!1)&&d.t(this,e.call(d.u,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}const kt=new d.q({"sky-color":new d.D(d.v.sky["sky-color"]),"horizon-color":new d.D(d.v.sky["horizon-color"]),"fog-color":new d.D(d.v.sky["fog-color"]),"fog-ground-blend":new d.D(d.v.sky["fog-ground-blend"]),"horizon-fog-blend":new d.D(d.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new d.D(d.v.sky["sky-horizon-blend"]),"atmosphere-blend":new d.D(d.v.sky["atmosphere-blend"])});class Bt extends d.E{constructor(e){super(),this._transitionable=new d.T(kt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.z(0))}setSky(e,s={}){if(!this._validate(d.B,e,s)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,l={}){return(l==null?void 0:l.validate)!==!1&&d.t(this,e.call(d.u,d.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:d.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Zn{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,s){const l=e.join(",")+String(s);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,s)),this.dashEntry[l]}getDashRanges(e,s,l){const u=[];let p=e.length%2==1?-e[e.length-1]*l:0,v=e[0]*l,b=!0;u.push({left:p,right:v,isDash:b,zeroLength:e[0]===0});let I=e[0];for(let C=1;C<e.length;C++){b=!b;const M=e[C];p=I*l,I+=M,v=I*l,u.push({left:p,right:v,isDash:b,zeroLength:M===0})}return u}addRoundDash(e,s,l){const u=s/2;for(let p=-l;p<=l;p++){const v=this.width*(this.nextRow+l+p);let b=0,I=e[b];for(let C=0;C<this.width;C++){C/I.right>1&&(I=e[++b]);const M=Math.abs(C-I.left),z=Math.abs(C-I.right),F=Math.min(M,z);let N;const $=p/l*(u+1);if(I.isDash){const W=u-Math.abs($);N=Math.sqrt(F*F+W*W)}else N=u-Math.sqrt(F*F+$*$);this.data[v+C]=Math.max(0,Math.min(255,N+128))}}}addRegularDash(e){for(let b=e.length-1;b>=0;--b){const I=e[b],C=e[b+1];I.zeroLength?e.splice(b,1):C&&C.isDash===I.isDash&&(C.left=I.left,e.splice(b,1))}const s=e[0],l=e[e.length-1];s.isDash===l.isDash&&(s.left=l.left-this.width,l.right=s.right+this.width);const u=this.width*this.nextRow;let p=0,v=e[p];for(let b=0;b<this.width;b++){b/v.right>1&&(v=e[++p]);const I=Math.abs(b-v.left),C=Math.abs(b-v.right),M=Math.min(I,C);this.data[u+b]=Math.max(0,Math.min(255,(v.isDash?M:-M)+128))}}addDash(e,s){const l=s?7:0,u=2*l+1;if(this.nextRow+u>this.height)return d.w("LineAtlas out of space"),null;let p=0;for(let b=0;b<e.length;b++)p+=e[b];if(p!==0){const b=this.width/p,I=this.getDashRanges(e,this.width,b);s?this.addRoundDash(I,b,l):this.addRegularDash(I)}const v={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:p};return this.nextRow+=u,this.dirty=!0,v}bind(e){const s=e.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const Li="maplibre_preloaded_worker_pool";class tn{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<tn.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Li]}numActive(){return Object.keys(this.active).length}}const nn=Math.floor(X.hardwareConcurrency/2);let bi,qn;function lo(){return bi||(bi=new tn),bi}tn.workerCount=d.C(globalThis)?Math.max(Math.min(nn,3),1):1;class uo{constructor(e,s){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=s;const l=this.workerPool.acquire(s);for(let u=0;u<l.length;u++){const p=new d.F(l[u],s);p.name=`Worker ${u}`,this.actors.push(p)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,s){const l=[];for(const u of this.actors)l.push(u.sendAsync({type:e,data:s}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,s){for(const l of this.actors)l.registerMessageHandler(e,s)}}function $s(){return qn||(qn=new uo(lo(),d.G),qn.registerMessageHandler("GR",(f,e,s)=>d.m(e,s))),qn}function Pr(f,e){const s=d.H();return d.J(s,s,[1,1,0]),d.K(s,s,[.5*f.width,.5*f.height,1]),d.L(s,s,f.calculatePosMatrix(e.toUnwrapped()))}function Zr(f,e,s,l,u,p){const v=function(z,F,N){if(z)for(const $ of z){const W=F[$];if(W&&W.source===N&&W.type==="fill-extrusion")return!0}else for(const $ in F){const W=F[$];if(W.source===N&&W.type==="fill-extrusion")return!0}return!1}(u&&u.layers,e,f.id),b=p.maxPitchScaleFactor(),I=f.tilesIn(l,b,v);I.sort(qr);const C=[];for(const z of I)C.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(e,s,f._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,u,p,b,Pr(f.transform,z.tileID))});const M=function(z){const F={},N={};for(const $ of z){const W=$.queryResults,Y=$.wrappedTileID,Q=N[Y]=N[Y]||{};for(const ie in W){const q=W[ie],se=Q[ie]=Q[ie]||{},ce=F[ie]=F[ie]||[];for(const fe of q)se[fe.featureIndex]||(se[fe.featureIndex]=!0,ce.push(fe))}}return F}(C);for(const z in M)M[z].forEach(F=>{const N=F.feature,$=f.getFeatureState(N.layer["source-layer"],N.id);N.source=N.layer.source,N.layer["source-layer"]&&(N.sourceLayer=N.layer["source-layer"]),N.state=$});return M}function qr(f,e){const s=f.tileID,l=e.tileID;return s.overscaledZ-l.overscaledZ||s.canonical.y-l.canonical.y||s.wrap-l.wrap||s.canonical.x-l.canonical.x}function Oo(f,e,s){return d._(this,void 0,void 0,function*(){let l=f;if(f.url?l=(yield d.h(e.transformRequest(f.url,"Source"),s)).data:yield X.frameAsync(s),!l)return null;const u=d.M(d.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(u.vectorLayerIds=l.vector_layers.map(p=>p.id)),u})}class ye{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof d.N?new d.N(e.lng,e.lat):d.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof d.N?new d.N(e.lng,e.lat):d.N.convert(e),this}extend(e){const s=this._sw,l=this._ne;let u,p;if(e instanceof d.N)u=e,p=e;else{if(!(e instanceof ye))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ye.convert(e)):this.extend(d.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(d.N.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return s||l?(s.lng=Math.min(u.lng,s.lng),s.lat=Math.min(u.lat,s.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new d.N(u.lng,u.lat),this._ne=new d.N(p.lng,p.lat)),this}getCenter(){return new d.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.N(this.getWest(),this.getNorth())}getSouthEast(){return new d.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:l}=d.N.convert(e);let u=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return e instanceof ye?e:e&&new ye(e)}static fromLngLat(e,s=0){const l=360*s/40075017,u=l/Math.cos(Math.PI/180*e.lat);return new ye(new d.N(e.lng-u,e.lat-l),new d.N(e.lng+u,e.lat+l))}adjustAntiMeridian(){const e=new d.N(this._sw.lng,this._sw.lat),s=new d.N(this._ne.lng,this._ne.lat);return new ye(e,e.lng>s.lng?new d.N(s.lng+360,s.lat):s)}}class co{constructor(e,s,l){this.bounds=ye.convert(this.validateBounds(e)),this.minzoom=s||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const s=Math.pow(2,e.z),l=Math.floor(d.O(this.bounds.getWest())*s),u=Math.floor(d.Q(this.bounds.getNorth())*s),p=Math.ceil(d.O(this.bounds.getEast())*s),v=Math.ceil(d.Q(this.bounds.getSouth())*s);return e.x>=l&&e.x<p&&e.y>=u&&e.y<v}}class Zs extends d.E{constructor(e,s,l,u){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.M(s,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Oo(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(d.e(this,e),e.bounds&&(this.tileBounds=new co(e.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new d.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(e){return d._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(s,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.request.collectResourceTiming=this._collectResourceTiming;let u="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((p,v)=>{e.reloadPromise={resolve:p,reject:v}})}else e.actor=this.dispatcher.getActor(),u="LT";e.abortController=new AbortController;try{const p=yield e.actor.sendAsync({type:u,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,p)}catch(p){if(delete e.abortController,e.aborted)return;if(p&&p.status!==404)throw p;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,s){if(s&&s.resourceTiming&&(e.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&e.setExpiryData(s),e.loadVectorData(s,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class At extends d.E{constructor(e,s,l,u){super(),this.id=e,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},s),d.e(this,d.M(s,["url","scheme","tileSize"]))}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Oo(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(d.e(this,e),e.bounds&&(this.tileBounds=new co(e.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new d.j(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return d.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return d._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield ue.getImage(this.map._requestManager.transformRequest(s,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const u=this.map.painter.context,p=u.gl,v=l.data;e.texture=this.map.painter.getTileTexture(v.width),e.texture?e.texture.update(v,{useMipmap:!0}):(e.texture=new xt(u,v,p.RGBA,{useMipmap:!0}),e.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class ei extends At{constructor(e,s,l,u){super(e,s,l,u),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(e){return d._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(s,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const u=yield ue.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){const p=u.data;this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const v=d.b(p)&&d.U()?p:yield this.readImageNow(p),b={type:this.type,uid:e.uid,source:this.id,rawImageData:v,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const I=yield e.actor.sendAsync({type:"LDT",data:b});e.dem=I,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}readImageNow(e){return d._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&d.V()){const s=e.width+2,l=e.height+2;try{return new d.R({width:s,height:l},yield d.W(e,-1,-1,s,l))}catch{}}return X.getImageData(e,1)})}_getNeighboringTiles(e){const s=e.canonical,l=Math.pow(2,s.z),u=(s.x-1+l)%l,p=s.x===0?e.wrap-1:e.wrap,v=(s.x+1+l)%l,b=s.x+1===l?e.wrap+1:e.wrap,I={};return I[new d.S(e.overscaledZ,p,s.z,u,s.y).key]={backfilled:!1},I[new d.S(e.overscaledZ,b,s.z,v,s.y).key]={backfilled:!1},s.y>0&&(I[new d.S(e.overscaledZ,p,s.z,u,s.y-1).key]={backfilled:!1},I[new d.S(e.overscaledZ,e.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},I[new d.S(e.overscaledZ,b,s.z,v,s.y-1).key]={backfilled:!1}),s.y+1<l&&(I[new d.S(e.overscaledZ,p,s.z,u,s.y+1).key]={backfilled:!1},I[new d.S(e.overscaledZ,e.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},I[new d.S(e.overscaledZ,b,s.z,v,s.y+1).key]={backfilled:!1}),I}unloadTile(e){return d._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class qs extends d.E{constructor(e,s,l,u){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(u),this._data=s.data,this._options=d.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const p=d.X/this.tileSize;s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&d.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=d.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*p,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*p,extent:d.X,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:d.X,radius:(s.clusterRadius||50)*p,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return d._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return d._(this,void 0,void 0,function*(){const e=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,s,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:s,offset:l}})}_updateWorkerData(e){return d._(this,void 0,void 0,function*(){const s=d.e({type:this.type},this.workerOptions);e?s.dataDiff=e:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(X.resolveURL(this._data),"Source"),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.k("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:s});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new d.k("dataabort",{dataType:"source"}));let u=null;l.resourceTiming&&l.resourceTiming[this.id]&&(u=l.resourceTiming[this.id].slice(0));const p={dataType:"source"};this._collectResourceTiming&&u&&u.length>0&&d.e(p,{resourceTiming:u}),this.fire(new d.k("data",Object.assign(Object.assign({},p),{sourceDataType:"metadata"}))),this.fire(new d.k("data",Object.assign(Object.assign({},p),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new d.k("dataabort",{dataType:"source"}));this.fire(new d.j(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return d._(this,void 0,void 0,function*(){const s=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const u=yield this.actor.sendAsync({type:s,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(u,this.map.painter,s==="RT")})}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Gr=d.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Mr extends d.E{constructor(e,s,l,u){super(),this.id=e,this.dispatcher=l,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=s}load(e){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield ue.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,e&&(this.coordinates=e),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new d.j(s))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const s=e.map(d.Z.fromLngLat);this.tileID=function(u){let p=1/0,v=1/0,b=-1/0,I=-1/0;for(const F of u)p=Math.min(p,F.x),v=Math.min(v,F.y),b=Math.max(b,F.x),I=Math.max(I,F.y);const C=Math.max(b-p,I-v),M=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),z=Math.pow(2,M);return new d.a1(M,Math.floor((p+b)/2*z),Math.floor((v+I)/2*z))}(s),this.minzoom=this.maxzoom=this.tileID.z;const l=s.map(u=>this.tileID.getTilePoint(u)._round());return this._boundsArray=new d.$,this._boundsArray.emplaceBack(l[0].x,l[0].y,0,0),this._boundsArray.emplaceBack(l[1].x,l[1].y,d.X,0),this._boundsArray.emplaceBack(l[3].x,l[3].y,0,d.X),this._boundsArray.emplaceBack(l[2].x,l[2].y,d.X,d.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,s=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Gr.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new xt(e,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return d._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class No extends Mr{constructor(e,s,l,u){super(e,s,l,u),this.roundZoom=!0,this.type="video",this.options=s}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const s of e.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield d.a3(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new d.j(s))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const s=this.video.seekable;e<s.start(0)||e>s.end(0)?this.fire(new d.j(new d.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,s=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Gr.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new xt(e,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Pn extends Mr{constructor(e,s,l,u){super(e,s,l,u),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(v=>typeof v!="number"))||this.fire(new d.j(new d.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.j(new d.a2(`sources.${e}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new d.j(new d.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new d.j(new d.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.j(new d.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return d._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,l=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Gr.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new xt(s,this.canvas,l.RGBA,{premultiply:!0});let u=!1;for(const p in this.tiles){const v=this.tiles[p];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,u=!0)}u&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Gs={},Hs=f=>{switch(f){case"geojson":return qs;case"image":return Mr;case"raster":return At;case"raster-dem":return ei;case"vector":return Zs;case"video":return No;case"canvas":return Pn}return Gs[f]},Pe="RTLPluginLoaded";class pr extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=$s()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(s=>{throw this.status="error",s})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return d._(this,arguments,void 0,function*(s,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=X.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return d._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.k(Pe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let qi=null;function fr(){return qi||(qi=new pr),qi}class Hr{constructor(e,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=d.a4(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const s=e+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,s,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,p){const v={};if(!p)return v;for(const b of u){const I=b.layerIds.map(C=>p.getLayer(C)).filter(Boolean);if(I.length!==0){b.layers=I,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(C=>I.filter(M=>M.id===C)[0]));for(const C of I)v[C.id]=b}}return v}(e.buckets,s.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof d.a6){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof d.a6&&p.hasRTLText){this.hasRTLText=!0,fr().lazyLoad();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new d.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new xt(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new xt(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,l,u,p,v,b,I,C,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:p,scale:v,tileSize:this.tileSize,pixelPosMatrix:M,transform:I,params:b,queryPadding:this.queryPadding*C},e,s,l):{}}querySourceFeatures(e,s){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),p=s&&s.sourceLayer?s.sourceLayer:"",v=u._geojsonTileLayer||u[p];if(!v)return;const b=d.a7(s&&s.filter),{z:I,x:C,y:M}=this.tileID.canonical,z={z:I,x:C,y:M};for(let F=0;F<v.length;F++){const N=v.feature(F);if(b.needGeometry){const Y=d.a8(N,!0);if(!b.filter(new d.z(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!b.filter(new d.z(this.tileID.overscaledZ),N))continue;const $=l.getId(N,p),W=new d.a9(N,I,C,M,$);W.tile=z,e.push(W)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const l=d.aa(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(s)if(this.expirationTime<s)u=!0;else{const p=this.expirationTime-s;p?this.expirationTime=l+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!s.style.hasLayer(u))continue;const p=this.buckets[u],v=p.layers[0].sourceLayer||"_geojsonTileLayer",b=l[v],I=e[v];if(!b||!I||Object.keys(I).length===0)continue;p.update(I,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const C=s&&s.style&&s.style.getLayer(u);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<X.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=X.now()+e}setDependencies(e,s){const l={};for(const u of s)l[u]=!0;this.dependencies[e]=l}hasDependency(e,s){for(const l of e){const u=this.dependencies[l];if(u){for(const p of s)if(u[p])return!0}}return!1}}class Le{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:s,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},l)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const l=e.wrapped().key,u=s===void 0?0:this.data[l].indexOf(s),p=this.data[l][u];return this.data[l].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||s.push(u);for(const l of s)this.remove(l.value.tileID,l)}}class yt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,l){const u=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},d.e(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const p in this.state[e][u])l[p]||(this.deletedStates[e][u][p]=null)}else for(const p in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][p]===null&&delete this.deletedStates[e][u][p]}removeFeatureState(e,s,l){if(this.deletedStates[e]===null)return;const u=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&s!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(s!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,s){const l=String(s),u=d.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][s];if(p===null)return{};for(const v in p)delete u[v]}return u}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const v in this.stateChanges[u])this.state[u][v]||(this.state[u][v]={}),d.e(this.state[u][v],this.stateChanges[u][v]),p[v]=this.state[u][v];l[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(this.deletedStates[u]===null)for(const v in this.state[u])p[v]={},this.state[u][v]={};else for(const v in this.deletedStates[u]){if(this.deletedStates[u][v]===null)this.state[u][v]={};else for(const b of Object.keys(this.deletedStates[u][v]))delete this.state[u][v][b];p[v]=this.state[u][v]}l[u]=l[u]||{},d.e(l[u],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,s)}}class lt extends d.E{constructor(e,s,l){super(),this.id=e,this.dispatcher=l,this.on("data",u=>this._dataHandler(u)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((u,p,v,b)=>{const I=new(Hs(p.type))(u,p,v,b);if(I.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${I.id}`);return I})(e,s,l,this),this._tiles={},this._cache=new Le(0,u=>this._unloadTile(u)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new yt,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const s=this._tiles[e];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,s,l){return d._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,s,l)}catch(u){e.state="errored",u.status!==404?this._source.fire(new d.j(u,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new d.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const l=this._tiles[s];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(rn).map(e=>e.key)}getRenderableIds(e){const s=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&s.push(this._tiles[l]);return e?s.sort((l,u)=>{const p=l.tileID,v=u.tileID,b=new d.P(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),I=new d.P(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-v.overscaledZ||I.y-b.y||I.x-b.x}).map(l=>l.tileID.key):s.map(l=>l.tileID).sort(rn).map(l=>l.key)}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}}_reloadTile(e,s){return d._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=s),yield this._loadTile(l,e,s))})}_tileLoaded(e,s,l){e.timeAdded=X.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new d.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const s=this.getRenderableIds();for(let u=0;u<s.length;u++){const p=s[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const v=this.getTileByID(p);l(e,v),l(v,e)}}function l(u,p){u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0;let v=p.tileID.canonical.x-u.tileID.canonical.x;const b=p.tileID.canonical.y-u.tileID.canonical.y,I=Math.pow(2,u.tileID.canonical.z),C=p.tileID.key;v===0&&b===0||Math.abs(b)>1||(Math.abs(v)>1&&(Math.abs(v+I)===1?v+=I:Math.abs(v-I)===1&&(v-=I)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,v,b),u.neighboringTiles&&u.neighboringTiles[C]&&(u.neighboringTiles[C].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,l,u){for(const p in this._tiles){let v=this._tiles[p];if(u[p]||!v.hasData()||v.tileID.overscaledZ<=s||v.tileID.overscaledZ>l)continue;let b=v.tileID;for(;v&&v.tileID.overscaledZ>s+1;){const C=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[C.key],v&&v.hasData()&&(b=C)}let I=b;for(;I.overscaledZ>s;)if(I=I.scaledTo(I.overscaledZ-1),e[I.key]){u[b.key]=b;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=s?l:null}for(let l=e.overscaledZ-1;l>=s;l--){const u=e.scaledTo(l),p=this._getLoadedTile(u);if(p)return p}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const s=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,u=Math.floor(s*l*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(p)}handleWrapJump(e){const s=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,s){const l={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+s),l[p.tileID.key]=p}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(u,this._tiles[u])}}_updateCoveredAndRetainedTiles(e,s,l,u,p,v){const b={},I={},C=Object.keys(e),M=X.now();for(const z of C){const F=e[z],N=this._tiles[z];if(!N||N.fadeEndTime!==0&&N.fadeEndTime<=M)continue;const $=this.findLoadedParent(F,s),W=this.findLoadedSibling(F),Y=$||W||null;Y&&(this._addTile(Y.tileID),b[Y.tileID.key]=Y.tileID),I[z]=F}this._retainLoadedChildren(I,u,l,e);for(const z in b)e[z]||(this._coveredTiles[z]=!0,e[z]=b[z]);if(v){const z={},F={};for(const N of p)this._tiles[N.key].hasData()?z[N.key]=N:F[N.key]=N;for(const N in F){const $=F[N].children(this._source.maxzoom);this._tiles[$[0].key]&&this._tiles[$[1].key]&&this._tiles[$[2].key]&&this._tiles[$[3].key]&&(z[$[0].key]=e[$[0].key]=$[0],z[$[1].key]=e[$[1].key]=$[1],z[$[2].key]=e[$[2].key]=$[2],z[$[3].key]=e[$[3].key]=$[3],delete F[N])}for(const N in F){const $=F[N],W=this.findLoadedParent($,this._source.minzoom),Y=this.findLoadedSibling($),Q=W||Y||null;if(Q){z[Q.tileID.key]=e[Q.tileID.key]=Q.tileID;for(const ie in z)z[ie].isChildOf(Q.tileID)&&delete z[ie]}}for(const N in this._tiles)z[N]||(this._coveredTiles[N]=!0)}}update(e,s){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=s,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new d.S(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(l=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(l=l.filter(M=>this._source.hasTile(M)))):l=[];const u=e.coveringZoomLevel(this._source),p=Math.max(u-lt.maxOverzooming,this._source.minzoom),v=Math.max(u+lt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const z of l)if(z.canonical.z>this._source.minzoom){const F=z.scaledTo(z.canonical.z-1);M[F.key]=F;const N=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));M[N.key]=N}l=l.concat(Object.values(M))}const b=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new d.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(l,u);Gn(this._source.type)&&this._updateCoveredAndRetainedTiles(I,p,v,u,l,s);for(const M in I)this._tiles[M].clearFadeHold();const C=d.ab(this._tiles,I);for(const M of C){const z=this._tiles[M];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,s){var l;const u={},p={},v=Math.max(s-lt.maxOverzooming,this._source.minzoom),b=Math.max(s+lt.maxUnderzooming,this._source.minzoom),I={};for(const C of e){const M=this._addTile(C);u[C.key]=C,M.hasData()||s<this._source.maxzoom&&(I[C.key]=C)}this._retainLoadedChildren(I,s,b,u);for(const C of e){let M=this._tiles[C.key];if(M.hasData())continue;if(s+1>this._source.maxzoom){const F=C.children(this._source.maxzoom)[0],N=this.getTile(F);if(N&&N.hasData()){u[F.key]=F;continue}}else{const F=C.children(this._source.maxzoom);if(u[F[0].key]&&u[F[1].key]&&u[F[2].key]&&u[F[3].key])continue}let z=M.wasRequested();for(let F=C.overscaledZ-1;F>=v;--F){const N=C.scaledTo(F);if(p[N.key])break;if(p[N.key]=!0,M=this.getTile(N),!M&&z&&(M=this._addTile(N)),M){const $=M.hasData();if(($||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||z)&&(u[N.key]=N),z=M.wasRequested(),$)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}s.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;u=p}for(const p of s)this._loadedParentTiles[p]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const s=this._tiles[e].tileID,l=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=l}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const l=s;return s||(s=new Hr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(s,e.key,s.state)),s.uses++,this._tiles[e.key]=s,l||this._source.fire(new d.k("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=s.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(e){const s=e.sourceDataType;e.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&s==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,s,l){const u=[],p=this.transform;if(!p)return u;const v=l?p.getCameraQueryGeometry(e):e,b=e.map($=>p.pointCoordinate($,this.terrain)),I=v.map($=>p.pointCoordinate($,this.terrain)),C=this.getIds();let M=1/0,z=1/0,F=-1/0,N=-1/0;for(const $ of I)M=Math.min(M,$.x),z=Math.min(z,$.y),F=Math.max(F,$.x),N=Math.max(N,$.y);for(let $=0;$<C.length;$++){const W=this._tiles[C[$]];if(W.holdingForFade())continue;const Y=W.tileID,Q=Math.pow(2,p.zoom-W.tileID.overscaledZ),ie=s*W.queryPadding*d.X/W.tileSize/Q,q=[Y.getTilePoint(new d.Z(M,z)),Y.getTilePoint(new d.Z(F,N))];if(q[0].x-ie<d.X&&q[0].y-ie<d.X&&q[1].x+ie>=0&&q[1].y+ie>=0){const se=b.map(fe=>Y.getTilePoint(fe)),ce=I.map(fe=>Y.getTilePoint(fe));u.push({tile:W,tileID:Y,queryGeometry:se,cameraQueryGeometry:ce,scale:Q})}}return u}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);for(const l of s)l.posMatrix=this.transform.calculatePosMatrix(l.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(Gn(this._source.type)){const e=X.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=e)return!0}return!1}setFeatureState(e,s,l){this._state.updateState(e=e||"_geojsonTileLayer",s,l)}removeFeatureState(e,s,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,l)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,l){const u=this._tiles[e];u&&u.setDependencies(s,l)}reloadTilesForDependencies(e,s){for(const l in this._tiles)this._tiles[l].hasDependency(e,s)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,s))}}function rn(f,e){const s=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-s||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function Gn(f){return f==="raster"||f==="image"||f==="video"}lt.maxOverzooming=10,lt.maxUnderzooming=3;class ft{constructor(e,s){this.reset(e,s)}reset(e,s){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=d.ac(e,0,1);let s=1,l=this._distances[s];const u=e*this.paddedLength+this.padding;for(;l<u&&s<this._distances.length;)l=this._distances[++s];const p=s-1,v=this._distances[p],b=l-v,I=b>0?(u-v)/b:0;return this.points[p].mult(1-I).add(this.points[s].mult(I))}}function mr(f,e){let s=!0;return f==="always"||f!=="never"&&e!=="never"||(s=!1),s}class zr{constructor(e,s,l){const u=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(s/l);for(let v=0;v<this.xCellCount*this.yCellCount;v++)u.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=s,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,s,l,u,p){this._forEachCell(s,l,u,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(p)}insertCircle(e,s,l,u){this._forEachCell(s-u,l-u,s+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(s),this.circles.push(l),this.circles.push(u)}_insertBoxCell(e,s,l,u,p,v){this.boxCells[p].push(v)}_insertCircleCell(e,s,l,u,p,v){this.circleCells[p].push(v)}_query(e,s,l,u,p,v,b){if(l<0||e>this.width||u<0||s>this.height)return[];const I=[];if(e<=0&&s<=0&&this.width<=l&&this.height<=u){if(p)return[{key:null,x1:e,y1:s,x2:l,y2:u}];for(let C=0;C<this.boxKeys.length;C++)I.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const M=this.circles[3*C],z=this.circles[3*C+1],F=this.circles[3*C+2];I.push({key:this.circleKeys[C],x1:M-F,y1:z-F,x2:M+F,y2:z+F})}}else this._forEachCell(e,s,l,u,this._queryCell,I,{hitTest:p,overlapMode:v,seenUids:{box:{},circle:{}}},b);return I}query(e,s,l,u){return this._query(e,s,l,u,!1,null)}hitTest(e,s,l,u,p,v){return this._query(e,s,l,u,!0,p,v).length>0}hitTestCircle(e,s,l,u,p){const v=e-l,b=e+l,I=s-l,C=s+l;if(b<0||v>this.width||C<0||I>this.height)return!1;const M=[];return this._forEachCell(v,I,b,C,this._queryCellCircle,M,{hitTest:!0,overlapMode:u,circle:{x:e,y:s,radius:l},seenUids:{box:{},circle:{}}},p),M.length>0}_queryCell(e,s,l,u,p,v,b,I){const{seenUids:C,hitTest:M,overlapMode:z}=b,F=this.boxCells[p];if(F!==null){const $=this.bboxes;for(const W of F)if(!C.box[W]){C.box[W]=!0;const Y=4*W,Q=this.boxKeys[W];if(e<=$[Y+2]&&s<=$[Y+3]&&l>=$[Y+0]&&u>=$[Y+1]&&(!I||I(Q))&&(!M||!mr(z,Q.overlapMode))&&(v.push({key:Q,x1:$[Y],y1:$[Y+1],x2:$[Y+2],y2:$[Y+3]}),M))return!0}}const N=this.circleCells[p];if(N!==null){const $=this.circles;for(const W of N)if(!C.circle[W]){C.circle[W]=!0;const Y=3*W,Q=this.circleKeys[W];if(this._circleAndRectCollide($[Y],$[Y+1],$[Y+2],e,s,l,u)&&(!I||I(Q))&&(!M||!mr(z,Q.overlapMode))){const ie=$[Y],q=$[Y+1],se=$[Y+2];if(v.push({key:Q,x1:ie-se,y1:q-se,x2:ie+se,y2:q+se}),M)return!0}}}return!1}_queryCellCircle(e,s,l,u,p,v,b,I){const{circle:C,seenUids:M,overlapMode:z}=b,F=this.boxCells[p];if(F!==null){const $=this.bboxes;for(const W of F)if(!M.box[W]){M.box[W]=!0;const Y=4*W,Q=this.boxKeys[W];if(this._circleAndRectCollide(C.x,C.y,C.radius,$[Y+0],$[Y+1],$[Y+2],$[Y+3])&&(!I||I(Q))&&!mr(z,Q.overlapMode))return v.push(!0),!0}}const N=this.circleCells[p];if(N!==null){const $=this.circles;for(const W of N)if(!M.circle[W]){M.circle[W]=!0;const Y=3*W,Q=this.circleKeys[W];if(this._circlesCollide($[Y],$[Y+1],$[Y+2],C.x,C.y,C.radius)&&(!I||I(Q))&&!mr(z,Q.overlapMode))return v.push(!0),!0}}}_forEachCell(e,s,l,u,p,v,b,I){const C=this._convertToXCellCoord(e),M=this._convertToYCellCoord(s),z=this._convertToXCellCoord(l),F=this._convertToYCellCoord(u);for(let N=C;N<=z;N++)for(let $=M;$<=F;$++)if(p.call(this,e,s,l,u,this.xCellCount*$+N,v,b,I))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,s,l,u,p,v){const b=u-e,I=p-s,C=l+v;return C*C>b*b+I*I}_circleAndRectCollide(e,s,l,u,p,v,b){const I=(v-u)/2,C=Math.abs(e-(u+I));if(C>I+l)return!1;const M=(b-p)/2,z=Math.abs(s-(p+M));if(z>M+l)return!1;if(C<=I||z<=M)return!0;const F=C-I,N=z-M;return F*F+N*N<=l*l}}function Wr(f,e,s,l,u){const p=d.H();return e?(d.K(p,p,[1/u,1/u,1]),s||d.ad(p,p,l.angle)):d.L(p,l.labelPlaneMatrix,f),p}function gr(f,e,s,l,u){if(e){const p=d.ae(f);return d.K(p,p,[u,u,1]),s||d.ad(p,p,-l.angle),p}return l.glCoordMatrix}function K(f,e,s,l){let u;l?(u=[f,e,l(f,e),1],d.af(u,u,s)):(u=[f,e,0,1],Et(u,u,s));const p=u[3];return{point:new d.P(u[0]/p,u[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function L(f,e){return .5+f/e*.5}function D(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function V(f,e,s,l,u,p,v,b,I,C,M,z,F,N,$){const W=l?f.textSizeData:f.iconSizeData,Y=d.ag(W,s.transform.zoom),Q=[256/s.width*2+1,256/s.height*2+1],ie=l?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ie.clear();const q=f.lineVertexArray,se=l?f.text.placedSymbolArray:f.icon.placedSymbolArray,ce=s.transform.width/s.transform.height;let fe=!1;for(let we=0;we<se.length;we++){const Ce=se.get(we);if(Ce.hidden||Ce.writingMode===d.ah.vertical&&!fe){rt(Ce.numGlyphs,ie);continue}fe=!1;const Be=K(Ce.anchorX,Ce.anchorY,e,$);if(!D(Be.point,Q)){rt(Ce.numGlyphs,ie);continue}const Ue=L(s.transform.cameraToCenterDistance,Be.signedDistanceFromCamera),De=d.ai(W,Y,Ce),Ae=v?De/Ue:De*Ue,Ke={getElevation:$,labelPlaneMatrix:u,lineVertexArray:q,pitchWithMap:v,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:C,tileAnchorPoint:new d.P(Ce.anchorX,Ce.anchorY),unwrappedTileID:M,width:z,height:F,translation:N},ht=ae(Ke,Ce,Ae,!1,b,e,p,f.glyphOffsetArray,ie,ce,I);fe=ht.useVertical,(ht.notEnoughRoom||fe||ht.needsFlipping&&ae(Ke,Ce,Ae,!0,b,e,p,f.glyphOffsetArray,ie,ce,I).notEnoughRoom)&&rt(Ce.numGlyphs,ie)}l?f.text.dynamicLayoutVertexBuffer.updateData(ie):f.icon.dynamicLayoutVertexBuffer.updateData(ie)}function H(f,e,s,l,u,p,v,b){const I=p.glyphStartIndex+p.numGlyphs,C=p.lineStartIndex,M=p.lineStartIndex+p.lineLength,z=e.getoffsetX(p.glyphStartIndex),F=e.getoffsetX(I-1),N=ze(f*z,s,l,u,p.segment,C,M,b,v);if(!N)return null;const $=ze(f*F,s,l,u,p.segment,C,M,b,v);return $?b.projectionCache.anyProjectionOccluded?null:{first:N,last:$}:null}function oe(f,e,s,l){return f===d.ah.horizontal&&Math.abs(s.y-e.y)>Math.abs(s.x-e.x)*l?{useVertical:!0}:(f===d.ah.vertical?e.y<s.y:e.x>s.x)?{needsFlipping:!0}:null}function ae(f,e,s,l,u,p,v,b,I,C,M){const z=s/24,F=e.lineOffsetX*z,N=e.lineOffsetY*z;let $;if(e.numGlyphs>1){const W=e.glyphStartIndex+e.numGlyphs,Y=e.lineStartIndex,Q=e.lineStartIndex+e.lineLength,ie=H(z,b,F,N,l,e,M,f);if(!ie)return{notEnoughRoom:!0};const q=K(ie.first.point.x,ie.first.point.y,v,f.getElevation).point,se=K(ie.last.point.x,ie.last.point.y,v,f.getElevation).point;if(u&&!l){const ce=oe(e.writingMode,q,se,C);if(ce)return ce}$=[ie.first];for(let ce=e.glyphStartIndex+1;ce<W-1;ce++)$.push(ze(z*b.getoffsetX(ce),F,N,l,e.segment,Y,Q,f,M));$.push(ie.last)}else{if(u&&!l){const Y=K(f.tileAnchorPoint.x,f.tileAnchorPoint.y,p,f.getElevation).point,Q=e.lineStartIndex+e.segment+1,ie=new d.P(f.lineVertexArray.getx(Q),f.lineVertexArray.gety(Q)),q=K(ie.x,ie.y,p,f.getElevation),se=q.signedDistanceFromCamera>0?q.point:function(fe,we,Ce,Be,Ue,De){return de(fe,we,Ce,1,Ue,De)}(f.tileAnchorPoint,ie,Y,0,p,f),ce=oe(e.writingMode,Y,se,C);if(ce)return ce}const W=ze(z*b.getoffsetX(e.glyphStartIndex),F,N,l,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,f,M);if(!W||f.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};$=[W]}for(const W of $)d.aj(I,W.point,W.angle);return{}}function de(f,e,s,l,u,p){const v=f.add(f.sub(e)._unit()),b=u!==void 0?K(v.x,v.y,u,p.getElevation).point:ve(v.x,v.y,p).point,I=s.sub(b);return s.add(I._mult(l/I.mag()))}function te(f,e,s){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const u=new d.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),p=ve(u.x,u.y,e);if(p.signedDistanceFromCamera>0)return l.projections[f]=p.point,l.anyProjectionOccluded=l.anyProjectionOccluded||p.isOccluded,p.point;const v=f-s.direction;return function(b,I,C,M,z){return de(b,I,C,M,void 0,z)}(s.distanceFromAnchor===0?e.tileAnchorPoint:new d.P(e.lineVertexArray.getx(v),e.lineVertexArray.gety(v)),u,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,e)}function ve(f,e,s){const l=f+s.translation[0],u=e+s.translation[1];let p;return!s.pitchWithMap&&s.projection.useSpecialProjectionForSymbols?(p=s.projection.projectTileCoordinates(l,u,s.unwrappedTileID,s.getElevation),p.point.x=(.5*p.point.x+.5)*s.width,p.point.y=(.5*-p.point.y+.5)*s.height):(p=K(l,u,s.labelPlaneMatrix,s.getElevation),p.isOccluded=!1),p}function be(f,e,s){return f._unit()._perp()._mult(e*s)}function ge(f,e,s,l,u,p,v,b,I){if(b.projectionCache.offsets[f])return b.projectionCache.offsets[f];const C=s.add(e);if(f+I.direction<l||f+I.direction>=u)return b.projectionCache.offsets[f]=C,C;const M=te(f+I.direction,b,I),z=be(M.sub(s),v,I.direction),F=s.add(z),N=M.add(z);return b.projectionCache.offsets[f]=d.ak(p,C,F,N)||C,b.projectionCache.offsets[f]}function ze(f,e,s,l,u,p,v,b,I){const C=l?f-e:f+e;let M=C>0?1:-1,z=0;l&&(M*=-1,z=Math.PI),M<0&&(z+=Math.PI);let F,N=M>0?p+u:p+u+1;b.projectionCache.cachedAnchorPoint?F=b.projectionCache.cachedAnchorPoint:(F=ve(b.tileAnchorPoint.x,b.tileAnchorPoint.y,b).point,b.projectionCache.cachedAnchorPoint=F);let $,W,Y=F,Q=F,ie=0,q=0;const se=Math.abs(C),ce=[];let fe;for(;ie+q<=se;){if(N+=M,N<p||N>=v)return null;ie+=q,Q=Y,W=$;const Be={absOffsetX:se,direction:M,distanceFromAnchor:ie,previousVertex:Q};if(Y=te(N,b,Be),s===0)ce.push(Q),fe=Y.sub(Q);else{let Ue;const De=Y.sub(Q);Ue=De.mag()===0?be(te(N+M,b,Be).sub(Y),s,M):be(De,s,M),W||(W=Q.add(Ue)),$=ge(N,Ue,Y,p,v,W,s,b,Be),ce.push(W),fe=$.sub(W)}q=fe.mag()}const we=fe._mult((se-ie)/q)._add(W||Q),Ce=z+Math.atan2(Y.y-Q.y,Y.x-Q.x);return ce.push(we),{point:we,angle:I?Ce:0,path:ce}}const tt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function rt(f,e){for(let s=0;s<f;s++){const l=e.length;e.resize(l+4),e.float32.set(tt,3*l)}}function Et(f,e,s){const l=e[0],u=e[1];return f[0]=s[0]*l+s[4]*u+s[12],f[1]=s[1]*l+s[5]*u+s[13],f[3]=s[3]*l+s[7]*u+s[15],f}const mt=100;class Ct{constructor(e,s,l=new zr(e.width+200,e.height+200,25),u=new zr(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=s,this.grid=l,this.ignoredGrid=u,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+mt,this.screenBottomBoundary=e.height+mt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,s,l,u,p,v,b,I,C,M,z){const F=e.anchorPointX+I[0],N=e.anchorPointY+I[1],$=this.projectAndGetPerspectiveRatio(u,F,N,p,M),W=l*$.perspectiveRatio;let Y;if(v||b)Y=this._projectCollisionBox(e,W,u,p,v,b,I,$,M,z);else{const ce=$.point.x+(z?z.x*W:0),fe=$.point.y+(z?z.y*W:0);Y={allPointsOccluded:!1,box:[ce+e.x1*W,fe+e.y1*W,ce+e.x2*W,fe+e.y2*W]}}const[Q,ie,q,se]=Y.box;return this.mapProjection.useSpecialProjectionForSymbols&&(v?Y.allPointsOccluded:this.mapProjection.isOccluded(F,N,p))||$.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Q,ie,q,se)||s!=="always"&&this.grid.hitTest(Q,ie,q,se,s,C)?{box:[Q,ie,q,se],placeable:!1,offscreen:!1}:{box:[Q,ie,q,se],placeable:!0,offscreen:this.isOffscreen(Q,ie,q,se)}}placeCollisionCircles(e,s,l,u,p,v,b,I,C,M,z,F,N,$,W,Y){const Q=[],ie=new d.P(s.anchorX,s.anchorY),q=this.getPerspectiveRatio(v,ie.x,ie.y,b,Y),se=(z?p/q:p*q)/d.ap,ce={getElevation:Y,labelPlaneMatrix:I,lineVertexArray:l,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ie,unwrappedTileID:b,width:this.transform.width,height:this.transform.height,translation:W},fe=H(se,u,s.lineOffsetX*se,s.lineOffsetY*se,!1,s,!1,ce);let we=!1,Ce=!1,Be=!0;if(fe){const Ue=.5*N*q+$,De=new d.P(-100,-100),Ae=new d.P(this.screenRightBoundary,this.screenBottomBoundary),Ke=new ft,ht=fe.first,Re=fe.last;let Ne=[];for(let gt=ht.path.length-1;gt>=1;gt--)Ne.push(ht.path[gt]);for(let gt=1;gt<Re.path.length;gt++)Ne.push(Re.path[gt]);const ut=2.5*Ue;if(C){const gt=this.projectPathToScreenSpace(Ne,ce,C);Ne=gt.some(St=>St.signedDistanceFromCamera<=0)?[]:gt.map(St=>St.point)}let Wt=[];if(Ne.length>0){const gt=Ne[0].clone(),St=Ne[0].clone();for(let Xt=1;Xt<Ne.length;Xt++)gt.x=Math.min(gt.x,Ne[Xt].x),gt.y=Math.min(gt.y,Ne[Xt].y),St.x=Math.max(St.x,Ne[Xt].x),St.y=Math.max(St.y,Ne[Xt].y);Wt=gt.x>=De.x&&St.x<=Ae.x&&gt.y>=De.y&&St.y<=Ae.y?[Ne]:St.x<De.x||gt.x>Ae.x||St.y<De.y||gt.y>Ae.y?[]:d.al([Ne],De.x,De.y,Ae.x,Ae.y)}for(const gt of Wt){Ke.reset(gt,.25*Ue);let St=0;St=Ke.length<=.5*Ue?1:Math.ceil(Ke.paddedLength/ut)+1;for(let Xt=0;Xt<St;Xt++){const Fi=Xt/Math.max(St-1,1),Yn=Ke.lerp(Fi),Kt=Yn.x+mt,an=Yn.y+mt;Q.push(Kt,an,Ue,0);const Hi=Kt-Ue,Bi=an-Ue,Wi=Kt+Ue,xr=an+Ue;if(Be=Be&&this.isOffscreen(Hi,Bi,Wi,xr),Ce=Ce||this.isInsideGrid(Hi,Bi,Wi,xr),e!=="always"&&this.grid.hitTestCircle(Kt,an,Ue,e,F)&&(we=!0,!M))return{circles:[],offscreen:!1,collisionDetected:we}}}}return{circles:!M&&we||!Ce||q<this.perspectiveRatioCutoff?[]:Q,offscreen:Be,collisionDetected:we}}projectPathToScreenSpace(e,s,l){return e.map(u=>K(u.x,u.y,l,s.getElevation))}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let l=1/0,u=1/0,p=-1/0,v=-1/0;for(const M of e){const z=new d.P(M.x+mt,M.y+mt);l=Math.min(l,z.x),u=Math.min(u,z.y),p=Math.max(p,z.x),v=Math.max(v,z.y),s.push(z)}const b=this.grid.query(l,u,p,v).concat(this.ignoredGrid.query(l,u,p,v)),I={},C={};for(const M of b){const z=M.key;if(I[z.bucketInstanceId]===void 0&&(I[z.bucketInstanceId]={}),I[z.bucketInstanceId][z.featureIndex])continue;const F=[new d.P(M.x1,M.y1),new d.P(M.x2,M.y1),new d.P(M.x2,M.y2),new d.P(M.x1,M.y2)];d.am(s,F)&&(I[z.bucketInstanceId][z.featureIndex]=!0,C[z.bucketInstanceId]===void 0&&(C[z.bucketInstanceId]=[]),C[z.bucketInstanceId].push(z.featureIndex))}return C}insertCollisionBox(e,s,l,u,p,v){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:p,collisionGroupID:v,overlapMode:s},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,s,l,u,p,v){const b=l?this.ignoredGrid:this.grid,I={bucketInstanceId:u,featureIndex:p,collisionGroupID:v,overlapMode:s};for(let C=0;C<e.length;C+=4)b.insertCircle(I,e[C],e[C+1],e[C+2])}projectAndGetPerspectiveRatio(e,s,l,u,p){let v;p?(v=[s,l,p(s,l),1],d.af(v,v,e)):(v=[s,l,0,1],Et(v,v,e));const b=v[3];return{point:new d.P((v[0]/b+1)/2*this.transform.width+mt,(-v[1]/b+1)/2*this.transform.height+mt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b*.5,isOccluded:!1,signedDistanceFromCamera:b}}getPerspectiveRatio(e,s,l,u,p){const v=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(s,l,u,p):K(s,l,e,p);return .5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5}isOffscreen(e,s,l,u){return l<mt||e>=this.screenRightBoundary||u<mt||s>this.screenBottomBoundary}isInsideGrid(e,s,l,u){return l>=0&&e<this.gridRightBoundary&&u>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const e=d.an([]);return d.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,s,l,u,p,v,b,I,C,M){let z=new d.P(1,0),F=new d.P(0,1);const N=new d.P(e.anchorPointX+b[0],e.anchorPointY+b[1]);if(v&&!p){const Be=this.projectAndGetPerspectiveRatio(l,N.x+1,N.y,u,C).point.sub(I.point).unit(),Ue=Math.atan(Be.y/Be.x)+(Be.x<0?Math.PI:0),De=Math.sin(Ue),Ae=Math.cos(Ue);z=new d.P(Ae,De),F=new d.P(-De,Ae)}else if(!v&&p){const Be=-this.transform.angle,Ue=Math.sin(Be),De=Math.cos(Be);z=new d.P(De,Ue),F=new d.P(-Ue,De)}let $=I.point,W=s;if(p){$=N;const Be=this.transform.zoom-Math.floor(this.transform.zoom);W=Math.pow(2,-Be),W*=this.mapProjection.getPitchedTextCorrection(this.transform,N,u),M||(W*=d.ac(.5+I.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}M&&($=$.add(z.mult(M.x*W)).add(F.mult(M.y*W)));const Y=e.x1*W,Q=e.x2*W,ie=(Y+Q)/2,q=e.y1*W,se=e.y2*W,ce=(q+se)/2,fe=[{offsetX:Y,offsetY:q},{offsetX:ie,offsetY:q},{offsetX:Q,offsetY:q},{offsetX:Q,offsetY:ce},{offsetX:Q,offsetY:se},{offsetX:ie,offsetY:se},{offsetX:Y,offsetY:se},{offsetX:Y,offsetY:ce}];let we=[];for(const{offsetX:Be,offsetY:Ue}of fe)we.push(new d.P($.x+z.x*Be+F.x*Ue,$.y+z.y*Be+F.y*Ue));let Ce=!1;if(p){const Be=we.map(Ue=>this.projectAndGetPerspectiveRatio(l,Ue.x,Ue.y,u,C));Ce=Be.some(Ue=>!Ue.isOccluded),we=Be.map(Ue=>Ue.point)}else Ce=!0;return{box:d.ao(we),allPointsOccluded:!Ce}}}function bt(f,e,s){return e*(d.X/(f.tileSize*Math.pow(2,s-f.tileID.overscaledZ)))}class mi{constructor(e,s,l,u){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?s:-s))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class ti{constructor(e,s,l,u,p){this.text=new mi(e?e.text:null,s,l,p),this.icon=new mi(e?e.icon:null,s,u,p)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _t{constructor(e,s,l){this.text=e,this.icon=s,this.skipFade=l}}class jt{constructor(){this.invProjMatrix=d.H(),this.viewportMatrix=d.H(),this.circles=[]}}class Yt{constructor(e,s,l,u,p){this.bucketInstanceId=e,this.featureIndex=s,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=p}}class Si{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const s=++this.maxGroupID;this.collisionGroups[e]={ID:s,predicate:l=>l.collisionGroupID===s}}return this.collisionGroups[e]}}function Pi(f,e,s,l,u){const{horizontalAlign:p,verticalAlign:v}=d.au(f);return new d.P(-(p-.5)*e+l[0]*u,-(v-.5)*s+l[1]*u)}class Gi{constructor(e,s,l,u,p,v){this.transform=e.clone(),this.terrain=l,this.collisionIndex=new Ct(this.transform,s),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Si(p),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const s=this.terrain;return s?(l,u)=>s.getElevation(e,l,u):null}getBucketParts(e,s,l,u){const p=l.getBucket(s),v=l.latestFeatureIndex;if(!p||!v||s.id!==p.layerIds[0])return;const b=l.collisionBoxArray,I=p.layers[0].layout,C=p.layers[0].paint,M=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),z=l.tileSize/d.X,F=l.tileID.toUnwrapped(),N=this.transform.calculatePosMatrix(F),$=I.get("text-pitch-alignment")==="map",W=I.get("text-rotation-alignment")==="map",Y=bt(l,1,this.transform.zoom),Q=this.collisionIndex.mapProjection.translatePosition(this.transform,l,C.get("text-translate"),C.get("text-translate-anchor")),ie=this.collisionIndex.mapProjection.translatePosition(this.transform,l,C.get("icon-translate"),C.get("icon-translate-anchor")),q=Wr(N,$,W,this.transform,Y);let se=null;if($){const fe=gr(N,$,W,this.transform,Y);se=d.L([],this.transform.labelPlaneMatrix,fe)}this.retainedQueryData[p.bucketInstanceId]=new Yt(p.bucketInstanceId,v,p.sourceLayerIndex,p.index,l.tileID);const ce={bucket:p,layout:I,translationText:Q,translationIcon:ie,posMatrix:N,unwrappedTileID:F,textLabelPlaneMatrix:q,labelToScreenMatrix:se,scale:M,textPixelRatio:z,holdingForFade:l.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:d.ag(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(u)for(const fe of p.sortKeyRanges){const{sortKey:we,symbolInstanceStart:Ce,symbolInstanceEnd:Be}=fe;e.push({sortKey:we,symbolInstanceStart:Ce,symbolInstanceEnd:Be,parameters:ce})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(e,s,l,u,p,v,b,I,C,M,z,F,N,$,W,Y,Q,ie,q){const se=d.aq[e.textAnchor],ce=[e.textOffset0,e.textOffset1],fe=Pi(se,l,u,ce,p),we=this.collisionIndex.placeCollisionBox(s,F,I,C,M,b,v,Y,z.predicate,q,fe);if((!ie||this.collisionIndex.placeCollisionBox(ie,F,I,C,M,b,v,Q,z.predicate,q,fe).placeable)&&we.placeable){let Ce;if(this.prevPlacement&&this.prevPlacement.variableOffsets[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID].text&&(Ce=this.prevPlacement.variableOffsets[N.crossTileID].anchor),N.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[N.crossTileID]={textOffset:ce,width:l,height:u,anchor:se,textBoxScale:p,prevAnchor:Ce},this.markUsedJustification($,se,N,W),$.allowVerticalPlacement&&(this.markUsedOrientation($,W,N),this.placedOrientations[N.crossTileID]=W),{shift:fe,placedGlyphBoxes:we}}}placeLayerBucketPart(e,s,l){const{bucket:u,layout:p,translationText:v,translationIcon:b,posMatrix:I,unwrappedTileID:C,textLabelPlaneMatrix:M,labelToScreenMatrix:z,textPixelRatio:F,holdingForFade:N,collisionBoxArray:$,partiallyEvaluatedTextSize:W,collisionGroup:Y}=e.parameters,Q=p.get("text-optional"),ie=p.get("icon-optional"),q=d.ar(p,"text-overlap","text-allow-overlap"),se=q==="always",ce=d.ar(p,"icon-overlap","icon-allow-overlap"),fe=ce==="always",we=p.get("text-rotation-alignment")==="map",Ce=p.get("text-pitch-alignment")==="map",Be=p.get("icon-text-fit")!=="none",Ue=p.get("symbol-z-order")==="viewport-y",De=se&&(fe||!u.hasIconData()||ie),Ae=fe&&(se||!u.hasTextData()||Q);!u.collisionArrays&&$&&u.deserializeCollisionBoxes($);const Ke=this._getTerrainElevationFunc(this.retainedQueryData[u.bucketInstanceId].tileID),ht=(Re,Ne,ut)=>{var Wt,gt;if(s[Re.crossTileID])return;if(N)return void(this.placements[Re.crossTileID]=new _t(!1,!1,!1));let St=!1,Xt=!1,Fi=!0,Yn=null,Kt={box:null,placeable:!1,offscreen:null},an={box:null,placeable:!1,offscreen:null},Hi=null,Bi=null,Wi=null,xr=0,us=0,fl=0;Ne.textFeatureIndex?xr=Ne.textFeatureIndex:Re.useRuntimeCollisionCircles&&(xr=Re.featureIndex),Ne.verticalTextFeatureIndex&&(us=Ne.verticalTextFeatureIndex);const cs=Ne.textBox;if(cs){const Rn=Mi=>{let ji=d.ah.horizontal;if(u.allowVerticalPlacement&&!Mi&&this.prevPlacement){const bn=this.prevPlacement.placedOrientations[Re.crossTileID];bn&&(this.placedOrientations[Re.crossTileID]=bn,ji=bn,this.markUsedOrientation(u,ji,Re))}return ji},Fn=(Mi,ji)=>{if(u.allowVerticalPlacement&&Re.numVerticalGlyphVertices>0&&Ne.verticalTextBox){for(const bn of u.writingModes)if(bn===d.ah.vertical?(Kt=ji(),an=Kt):Kt=Mi(),Kt&&Kt.placeable)break}else Kt=Mi()},Jr=Re.textAnchorOffsetStartIndex,Qn=Re.textAnchorOffsetEndIndex;if(Qn===Jr){const Mi=(ji,bn)=>{const It=this.collisionIndex.placeCollisionBox(ji,q,F,I,C,Ce,we,v,Y.predicate,Ke);return It&&It.placeable&&(this.markUsedOrientation(u,bn,Re),this.placedOrientations[Re.crossTileID]=bn),It};Fn(()=>Mi(cs,d.ah.horizontal),()=>{const ji=Ne.verticalTextBox;return u.allowVerticalPlacement&&Re.numVerticalGlyphVertices>0&&ji?Mi(ji,d.ah.vertical):{box:null,offscreen:null}}),Rn(Kt&&Kt.placeable)}else{let Mi=d.aq[(gt=(Wt=this.prevPlacement)===null||Wt===void 0?void 0:Wt.variableOffsets[Re.crossTileID])===null||gt===void 0?void 0:gt.anchor];const ji=(It,To,hs)=>{const ds=It.x2-It.x1,Uh=It.y2-It.y1,of=Re.textBoxScale,$h=Be&&ce==="never"?To:null;let Yr=null,Zh=q==="never"?1:2,gl="never";Mi&&Zh++;for(let da=0;da<Zh;da++){for(let yl=Jr;yl<Qn;yl++){const _l=u.textAnchorOffsets.get(yl);if(Mi&&_l.textAnchor!==Mi)continue;const ps=this.attemptAnchorPlacement(_l,It,ds,Uh,of,we,Ce,F,I,C,Y,gl,Re,u,hs,v,b,$h,Ke);if(ps&&(Yr=ps.placedGlyphBoxes,Yr&&Yr.placeable))return St=!0,Yn=ps.shift,Yr}Mi?Mi=null:gl=q}return l&&!Yr&&(Yr={box:this.collisionIndex.placeCollisionBox(cs,"always",F,I,C,Ce,we,v,Y.predicate,Ke,new d.P(0,0)).box,offscreen:!1,placeable:!1}),Yr};Fn(()=>ji(cs,Ne.iconBox,d.ah.horizontal),()=>{const It=Ne.verticalTextBox;return u.allowVerticalPlacement&&(!Kt||!Kt.placeable)&&Re.numVerticalGlyphVertices>0&&It?ji(It,Ne.verticalIconBox,d.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Kt&&(St=Kt.placeable,Fi=Kt.offscreen);const bn=Rn(Kt&&Kt.placeable);if(!St&&this.prevPlacement){const It=this.prevPlacement.variableOffsets[Re.crossTileID];It&&(this.variableOffsets[Re.crossTileID]=It,this.markUsedJustification(u,It.anchor,Re,bn))}}}if(Hi=Kt,St=Hi&&Hi.placeable,Fi=Hi&&Hi.offscreen,Re.useRuntimeCollisionCircles){const Rn=u.text.placedSymbolArray.get(Re.centerJustifiedTextSymbolIndex),Fn=d.ai(u.textSizeData,W,Rn),Jr=p.get("text-padding");Bi=this.collisionIndex.placeCollisionCircles(q,Rn,u.lineVertexArray,u.glyphOffsetArray,Fn,I,C,M,z,l,Ce,Y.predicate,Re.collisionCircleDiameter,Jr,v,Ke),Bi.circles.length&&Bi.collisionDetected&&!l&&d.w("Collisions detected, but collision boxes are not shown"),St=se||Bi.circles.length>0&&!Bi.collisionDetected,Fi=Fi&&Bi.offscreen}if(Ne.iconFeatureIndex&&(fl=Ne.iconFeatureIndex),Ne.iconBox){const Rn=Fn=>this.collisionIndex.placeCollisionBox(Fn,ce,F,I,C,Ce,we,b,Y.predicate,Ke,Be&&Yn?Yn:void 0);an&&an.placeable&&Ne.verticalIconBox?(Wi=Rn(Ne.verticalIconBox),Xt=Wi.placeable):(Wi=Rn(Ne.iconBox),Xt=Wi.placeable),Fi=Fi&&Wi.offscreen}const Ln=Q||Re.numHorizontalGlyphVertices===0&&Re.numVerticalGlyphVertices===0,ml=ie||Re.numIconVertices===0;Ln||ml?ml?Ln||(Xt=Xt&&St):St=Xt&&St:Xt=St=Xt&&St;const Ju=Xt&&Wi.placeable;if(St&&Hi.placeable&&this.collisionIndex.insertCollisionBox(Hi.box,q,p.get("text-ignore-placement"),u.bucketInstanceId,an&&an.placeable&&us?us:xr,Y.ID),Ju&&this.collisionIndex.insertCollisionBox(Wi.box,ce,p.get("icon-ignore-placement"),u.bucketInstanceId,fl,Y.ID),Bi&&St&&this.collisionIndex.insertCollisionCircles(Bi.circles,q,p.get("text-ignore-placement"),u.bucketInstanceId,xr,Y.ID),l&&this.storeCollisionData(u.bucketInstanceId,ut,Ne,Hi,Wi,Bi),Re.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(u.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Re.crossTileID]=new _t(St||De,Xt||Ae,Fi||u.justReloaded),s[Re.crossTileID]=!0};if(Ue){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Re=u.getSortedSymbolIndexes(this.transform.angle);for(let Ne=Re.length-1;Ne>=0;--Ne){const ut=Re[Ne];ht(u.symbolInstances.get(ut),u.collisionArrays[ut],ut)}}else for(let Re=e.symbolInstanceStart;Re<e.symbolInstanceEnd;Re++)ht(u.symbolInstances.get(Re),u.collisionArrays[Re],Re);if(l&&u.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[u.bucketInstanceId];d.as(Re.invProjMatrix,I),Re.viewportMatrix=this.collisionIndex.getViewportMatrix()}u.justReloaded=!1}storeCollisionData(e,s,l,u,p,v){if(l.textBox||l.iconBox){let b,I;this.collisionBoxArrays.has(e)?b=this.collisionBoxArrays.get(e):(b=new Map,this.collisionBoxArrays.set(e,b)),b.has(s)?I=b.get(s):(I={text:null,icon:null},b.set(s,I)),l.textBox&&(I.text=u.box),l.iconBox&&(I.icon=p.box)}if(v){let b=this.collisionCircleArrays[e];b===void 0&&(b=this.collisionCircleArrays[e]=new jt);for(let I=0;I<v.circles.length;I+=4)b.circles.push(v.circles[I+0]),b.circles.push(v.circles[I+1]),b.circles.push(v.circles[I+2]),b.circles.push(v.collisionDetected?1:0)}}markUsedJustification(e,s,l,u){let p;p=u===d.ah.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[d.at(s)];const v=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const b of v)b>=0&&(e.text.placedSymbolArray.get(b).crossTileID=p>=0&&b!==p?0:l.crossTileID)}markUsedOrientation(e,s,l){const u=s===d.ah.horizontal||s===d.ah.horizontalOnly?s:0,p=s===d.ah.vertical?s:0,v=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const b of v)e.text.placedSymbolArray.get(b).placedOrientation=u;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=p)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let l=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const u=s?s.symbolFadeChange(e):1,p=s?s.opacities:{},v=s?s.variableOffsets:{},b=s?s.placedOrientations:{};for(const I in this.placements){const C=this.placements[I],M=p[I];M?(this.opacities[I]=new ti(M,u,C.text,C.icon),l=l||C.text!==M.text.placed||C.icon!==M.icon.placed):(this.opacities[I]=new ti(null,u,C.text,C.icon,C.skipFade),l=l||C.text||C.icon)}for(const I in p){const C=p[I];if(!this.opacities[I]){const M=new ti(C,u,!1,!1);M.isHidden()||(this.opacities[I]=M,l=l||C.text.placed||C.icon.placed)}}for(const I in v)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=v[I]);for(const I in b)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=b[I]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:e)}updateLayerOpacities(e,s){const l={};for(const u of s){const p=u.getBucket(e);p&&u.latestFeatureIndex&&e.id===p.layerIds[0]&&this.updateBucketOpacities(p,u.tileID,l,u.collisionBoxArray)}}updateBucketOpacities(e,s,l,u){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const p=e.layers[0],v=p.layout,b=new ti(null,0,!1,!1,!0),I=v.get("text-allow-overlap"),C=v.get("icon-allow-overlap"),M=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),z=v.get("text-rotation-alignment")==="map",F=v.get("text-pitch-alignment")==="map",N=v.get("icon-text-fit")!=="none",$=new ti(null,0,I&&(C||!e.hasIconData()||v.get("icon-optional")),C&&(I||!e.hasTextData()||v.get("text-optional")),!0);!e.collisionArrays&&u&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(u);const W=(Q,ie,q)=>{for(let se=0;se<ie/4;se++)Q.opacityVertexArray.emplaceBack(q);Q.hasVisibleVertices=Q.hasVisibleVertices||q!==Uo},Y=this.collisionBoxArrays.get(e.bucketInstanceId);for(let Q=0;Q<e.symbolInstances.length;Q++){const ie=e.symbolInstances.get(Q),{numHorizontalGlyphVertices:q,numVerticalGlyphVertices:se,crossTileID:ce}=ie;let fe=this.opacities[ce];l[ce]?fe=b:fe||(fe=$,this.opacities[ce]=fe),l[ce]=!0;const we=ie.numIconVertices>0,Ce=this.placedOrientations[ie.crossTileID],Be=Ce===d.ah.vertical,Ue=Ce===d.ah.horizontal||Ce===d.ah.horizontalOnly;if(q>0||se>0){const Ae=vn(fe.text);W(e.text,q,Be?Uo:Ae),W(e.text,se,Ue?Uo:Ae);const Ke=fe.text.isHidden();[ie.rightJustifiedTextSymbolIndex,ie.centerJustifiedTextSymbolIndex,ie.leftJustifiedTextSymbolIndex].forEach(Ne=>{Ne>=0&&(e.text.placedSymbolArray.get(Ne).hidden=Ke||Be?1:0)}),ie.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ie.verticalPlacedTextSymbolIndex).hidden=Ke||Ue?1:0);const ht=this.variableOffsets[ie.crossTileID];ht&&this.markUsedJustification(e,ht.anchor,ie,Ce);const Re=this.placedOrientations[ie.crossTileID];Re&&(this.markUsedJustification(e,"left",ie,Re),this.markUsedOrientation(e,Re,ie))}if(we){const Ae=vn(fe.icon),Ke=!(N&&ie.verticalPlacedIconSymbolIndex&&Be);ie.placedIconSymbolIndex>=0&&(W(e.icon,ie.numIconVertices,Ke?Ae:Uo),e.icon.placedSymbolArray.get(ie.placedIconSymbolIndex).hidden=fe.icon.isHidden()),ie.verticalPlacedIconSymbolIndex>=0&&(W(e.icon,ie.numVerticalIconVertices,Ke?Uo:Ae),e.icon.placedSymbolArray.get(ie.verticalPlacedIconSymbolIndex).hidden=fe.icon.isHidden())}const De=Y&&Y.has(Q)?Y.get(Q):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ae=e.collisionArrays[Q];if(Ae){let Ke=new d.P(0,0);if(Ae.textBox||Ae.verticalTextBox){let ht=!0;if(M){const Re=this.variableOffsets[ce];Re?(Ke=Pi(Re.anchor,Re.width,Re.height,Re.textOffset,Re.textBoxScale),z&&Ke._rotate(F?this.transform.angle:-this.transform.angle)):ht=!1}if(Ae.textBox||Ae.verticalTextBox){let Re;Ae.textBox&&(Re=Be),Ae.verticalTextBox&&(Re=Ue),Vo(e.textCollisionBox.collisionVertexArray,fe.text.placed,!ht||Re,De.text,Ke.x,Ke.y)}}if(Ae.iconBox||Ae.verticalIconBox){const ht=!!(!Ue&&Ae.verticalIconBox);let Re;Ae.iconBox&&(Re=ht),Ae.verticalIconBox&&(Re=!ht),Vo(e.iconCollisionBox.collisionVertexArray,fe.icon.placed,Re,De.icon,N?Ke.x:0,N?Ke.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const Q=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=Q.invProjMatrix,e.placementViewportMatrix=Q.viewportMatrix,e.collisionCircleArray=Q.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,s){const l=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Vo(f,e,s,l,u,p){l&&l.length!==0||(l=[0,0,0,0]);const v=l[0]-mt,b=l[1]-mt,I=l[2]-mt,C=l[3]-mt;f.emplaceBack(e?1:0,s?1:0,u||0,p||0,v,b),f.emplaceBack(e?1:0,s?1:0,u||0,p||0,I,b),f.emplaceBack(e?1:0,s?1:0,u||0,p||0,I,C),f.emplaceBack(e?1:0,s?1:0,u||0,p||0,v,C)}const Ot=Math.pow(2,25),lu=Math.pow(2,24),uu=Math.pow(2,17),yn=Math.pow(2,16),_n=Math.pow(2,9),Ap=Math.pow(2,8),Mn=Math.pow(2,1);function vn(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,s=Math.floor(127*f.opacity);return s*Ot+e*lu+s*uu+e*yn+s*_n+e*Ap+s*Mn+e}const Uo=0;function ho(){return{isOccluded:(f,e,s)=>!1,getPitchedTextCorrection:(f,e,s)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(f,e,s,l){throw new Error("Not implemented.")},translatePosition:(f,e,s,l)=>function(u,p,v,b,I=!1){if(!v[0]&&!v[1])return[0,0];const C=I?b==="map"?u.angle:0:b==="viewport"?-u.angle:0;if(C){const M=Math.sin(C),z=Math.cos(C);v=[v[0]*z-v[1]*M,v[0]*M+v[1]*z]}return[I?v[0]:bt(p,v[0],u.zoom),I?v[1]:bt(p,v[1],u.zoom)]}(f,e,s,l),getCircleRadiusCorrection:f=>1}}class gi{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,s,l,u,p){const v=this._bucketParts;for(;this._currentTileIndex<e.length;)if(s.getBucketParts(v,u,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((b,I)=>b.sortKey-I.sortKey));this._currentPartIndex<v.length;)if(s.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,p())return!0;return!1}}class Ws{constructor(e,s,l,u,p,v,b,I){this.placement=new Gi(e,ho(),s,v,b,I),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(e,s,l){const u=X.now(),p=()=>!this._forceFullPlacement&&X.now()-u>2;for(;this._currentPlacementIndex>=0;){const v=s[e[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=b)&&(!v.maxzoom||v.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new gi(v)),this._inProgressLayer.continuePlacement(l[v.source],this.placement,this._showCollisionBoxes,v,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Hn=512/d.X/2;class ci{constructor(e,s,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const u=new Map;for(let p=0;p<s.length;p++){const v=s.get(p),b=v.key,I=u.get(b);I?I.push(v):u.set(b,[v])}for(const[p,v]of u){const b={positions:v.map(I=>({x:Math.floor(I.anchorX*Hn),y:Math.floor(I.anchorY*Hn)})),crossTileIDs:v.map(I=>I.crossTileID)};if(b.positions.length>128){const I=new d.av(b.positions.length,16,Uint16Array);for(const{x:C,y:M}of b.positions)I.add(C,M);I.finish(),delete b.positions,b.index=I}this._symbolsByKey[p]=b}}getScaledCoordinates(e,s){const{x:l,y:u,z:p}=this.tileID.canonical,{x:v,y:b,z:I}=s.canonical,C=Hn/Math.pow(2,I-p),M=(b*d.X+e.anchorY)*C,z=u*d.X*Hn;return{x:Math.floor((v*d.X+e.anchorX)*C-l*d.X*Hn),y:Math.floor(M-z)}}findMatches(e,s,l){const u=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let p=0;p<e.length;p++){const v=e.get(p);if(v.crossTileID)continue;const b=this._symbolsByKey[v.key];if(!b)continue;const I=this.getScaledCoordinates(v,s);if(b.index){const C=b.index.range(I.x-u,I.y-u,I.x+u,I.y+u).sort();for(const M of C){const z=b.crossTileIDs[M];if(!l[z]){l[z]=!0,v.crossTileID=z;break}}}else if(b.positions)for(let C=0;C<b.positions.length;C++){const M=b.positions[C],z=b.crossTileIDs[C];if(Math.abs(M.x-I.x)<=u&&Math.abs(M.y-I.y)<=u&&!l[z]){l[z]=!0,v.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Ba{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const s=Math.round((e-this.lng)/360);if(s!==0)for(const l in this.indexes){const u=this.indexes[l],p={};for(const v in u){const b=u[v];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+s),p[b.tileID.key]=b}this.indexes[l]=p}this.lng=e}addBucket(e,s,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let p=0;p<s.symbolInstances.length;p++)s.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const u=this.usedCrossTileIDs[e.overscaledZ];for(const p in this.indexes){const v=this.indexes[p];if(Number(p)>e.overscaledZ)for(const b in v){const I=v[b];I.tileID.isChildOf(e)&&I.findMatches(s.symbolInstances,e,u)}else{const b=v[e.scaledTo(Number(p)).key];b&&b.findMatches(s.symbolInstances,e,u)}}for(let p=0;p<s.symbolInstances.length;p++){const v=s.symbolInstances.get(p);v.crossTileID||(v.crossTileID=l.generate(),u[v.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new ci(e,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(e,s){for(const l of s.getCrossTileIDsLists())for(const u of l)delete this.usedCrossTileIDs[e][u]}removeStaleBuckets(e){let s=!1;for(const l in this.indexes){const u=this.indexes[l];for(const p in u)e[u[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[p]),delete u[p],s=!0)}return s}}class cu{constructor(){this.layerIndexes={},this.crossTileIDs=new Ba,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,s,l){let u=this.layerIndexes[e.id];u===void 0&&(u=this.layerIndexes[e.id]=new Wn);let p=!1;const v={};u.handleWrapJump(l);for(const b of s){const I=b.getBucket(e);I&&e.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(b.tileID,I,this.crossTileIDs)&&(p=!0),v[I.bucketInstanceId]=!0)}return u.removeStaleBuckets(v)&&(p=!0),p}pruneUnusedLayers(e){const s={};e.forEach(l=>{s[l]=!0});for(const l in this.layerIndexes)s[l]||delete this.layerIndexes[l]}}const Xn=(f,e)=>d.t(f,e&&e.filter(s=>s.identifier!=="source.canvas")),Dp=d.aw();class ja extends d.E{constructor(e,s={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const u=this.sourceCaches[l].getSource().type;u!=="vector"&&u!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new uo(lo(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,u)=>this.getGlyphs(l,u)),this.dispatcher.registerMessageHandler("GI",(l,u)=>this.getImages(l,u)),this.imageManager=new oi,this.imageManager.setEventedParent(this),this.glyphManager=new en(e._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Zn(256,512),this.crossTileSymbolIndex=new cu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.ay()),fr().on(Pe,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.sourceCaches[l.sourceId];if(!u)return;const p=u.getSource();if(p&&p.vectorLayerIds)for(const v in this._layers){const b=this._layers[v];b.source===p.id&&this._validateLayer(b)}})}loadURL(e,s={},l){this.fire(new d.k("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const u=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const p=this._loadStyleRequest;d.h(u,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,s,l)}).catch(v=>{this._loadStyleRequest=null,v&&!p.signal.aborted&&this.fire(new d.j(v))})}loadJSON(e,s={},l){this.fire(new d.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,X.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(e,s,l)}).catch(()=>{})}loadEmpty(){this.fire(new d.k("dataloading",{dataType:"style"})),this._load(Dp,{validate:!1})}_load(e,s,l){var u;const p=s.transformStyle?s.transformStyle(l,e):e;if(!s.validate||!Xn(this,d.u(p))){this._loaded=!0,this.stylesheet=p;for(const v in p.sources)this.addSource(v,p.sources[v],{validate:!1});p.sprite?this._loadSprite(p.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(p.glyphs),this._createLayers(),this.light=new pt(this.stylesheet.light),this.sky=new Bt(this.stylesheet.sky),this.map.setTerrain((u=this.stylesheet.terrain)!==null&&u!==void 0?u:null),this.fire(new d.k("data",{dataType:"style"})),this.fire(new d.k("style.load"))}}_createLayers(){const e=d.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of e){const l=d.aA(s);l.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=l}}_loadSprite(e,s=!1,l=void 0){let u;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(p,v,b,I){return d._(this,void 0,void 0,function*(){const C=Lt(p),M=b>1?"@2x":"",z={},F={};for(const{id:N,url:$}of C){const W=v.transformRequest(vt($,M,".json"),"SpriteJSON");z[N]=d.h(W,I);const Y=v.transformRequest(vt($,M,".png"),"SpriteImage");F[N]=ue.getImage(Y,I)}return yield Promise.all([...Object.values(z),...Object.values(F)]),function(N,$){return d._(this,void 0,void 0,function*(){const W={};for(const Y in N){W[Y]={};const Q=X.getImageCanvasContext((yield $[Y]).data),ie=(yield N[Y]).data;for(const q in ie){const{width:se,height:ce,x:fe,y:we,sdf:Ce,pixelRatio:Be,stretchX:Ue,stretchY:De,content:Ae,textFitWidth:Ke,textFitHeight:ht}=ie[q];W[Y][q]={data:null,pixelRatio:Be,sdf:Ce,stretchX:Ue,stretchY:De,content:Ae,textFitWidth:Ke,textFitHeight:ht,spriteData:{width:se,height:ce,x:fe,y:we,context:Q}}}}return W})}(z,F)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(p=>{if(this._spriteRequest=null,p)for(const v in p){this._spritesImagesIds[v]=[];const b=this._spritesImagesIds[v]?this._spritesImagesIds[v].filter(I=>!(I in p)):[];for(const I of b)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in p[v]){const C=v==="default"?I:`${v}:${I}`;this._spritesImagesIds[v].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,p[v][I],!1):this.imageManager.addImage(C,p[v][I]),s&&(this._changedImages[C]=!0)}}}).catch(p=>{this._spriteRequest=null,u=p,this.fire(new d.j(u))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"})),l&&l(u)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}_validateLayer(e){const s=this.sourceCaches[e.source];if(!s)return;const l=e.sourceLayer;if(!l)return;const u=s.getSource();(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(l)===-1)&&this.fire(new d.j(new Error(`Source layer "${l}" does not exist on source "${u.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,s=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(s?d.aB(l):l);const u=[];for(const p of e)if(l[p]){const v=s?d.aB(l[p]):l[p];u.push(v)}return u}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const s=Object.keys(this._layers);for(const l of s){const u=this._layers[l];u.type!=="custom"&&(e[l]=u.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const s=this._changed;if(s){const u=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(u.length||p.length)&&this._updateWorkerLayers(u,p);for(const v in this._updatedSources){const b=this._updatedSources[v];if(b==="reload")this._reloadSource(v);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(v)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const v in this._updatedPaintProps)this._layers[v].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const u in this.sourceCaches){const p=this.sourceCaches[u];l[u]=p.used,p.used=!1}for(const u of this._order){const p=this._layers[u];p.recalculate(e,this._availableImages),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}for(const u in l){const p=this.sourceCaches[u];!!l[u]!=!!p.used&&p.fire(new d.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:u}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,s&&this.fire(new d.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,s={}){var l;this._checkLoaded();const u=this.serialize();if(e=s.transformStyle?s.transformStyle(u,e):e,((l=s.validate)===null||l===void 0||l)&&Xn(this,d.u(e)))return!1;(e=d.aB(e)).layers=d.az(e.layers);const p=d.aC(u,e),v=this._getOperationsToPerform(p);if(v.unimplemented.length>0)throw new Error(`Unimplemented: ${v.unimplemented.join(", ")}.`);if(v.operations.length===0)return!1;for(const b of v.operations)b();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const s=[],l=[];for(const u of e)switch(u.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":s.push(()=>this.addLayer.apply(this,u.args));break;case"removeLayer":s.push(()=>this.removeLayer.apply(this,u.args));break;case"setPaintProperty":s.push(()=>this.setPaintProperty.apply(this,u.args));break;case"setLayoutProperty":s.push(()=>this.setLayoutProperty.apply(this,u.args));break;case"setFilter":s.push(()=>this.setFilter.apply(this,u.args));break;case"addSource":s.push(()=>this.addSource.apply(this,u.args));break;case"removeSource":s.push(()=>this.removeSource.apply(this,u.args));break;case"setLayerZoomRange":s.push(()=>this.setLayerZoomRange.apply(this,u.args));break;case"setLight":s.push(()=>this.setLight.apply(this,u.args));break;case"setGeoJSONSourceData":s.push(()=>this.setGeoJSONSourceData.apply(this,u.args));break;case"setGlyphs":s.push(()=>this.setGlyphs.apply(this,u.args));break;case"setSprite":s.push(()=>this.setSprite.apply(this,u.args));break;case"setSky":s.push(()=>this.setSky.apply(this,u.args));break;case"setTerrain":s.push(()=>this.map.setTerrain.apply(this,u.args));break;case"setTransition":s.push(()=>{});break;default:l.push(u.command)}return{operations:s,unimplemented:l}}addImage(e,s){if(this.getImage(e))return this.fire(new d.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,s),this._afterImageUpdated(e)}updateImage(e,s){this.imageManager.updateImage(e,s)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new d.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,s,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(d.u.source,`sources.${e}`,s,null,l))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const u=this.sourceCaches[e]=new lt(e,s,this.dispatcher);u.style=this,u.setEventedParent(this,()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:e})),u.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new d.j(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const s=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],s.fire(new d.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,s){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(s),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,s,l={}){this._checkLoaded();const u=e.id;if(this.getLayer(u))return void this.fire(new d.j(new Error(`Layer "${u}" already exists on this map.`)));let p;if(e.type==="custom"){if(Xn(this,d.aD(e)))return;p=d.aA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(u,e.source),e=d.aB(e),e=d.e(e,{source:u})),this._validate(d.u.layer,`layers.${u}`,e,{arrayIndex:-1},l))return;p=d.aA(e),this._validateLayer(p),p.setEventedParent(this,{layer:{id:u}})}const v=s?this._order.indexOf(s):this._order.length;if(s&&v===-1)this.fire(new d.j(new Error(`Cannot add layer "${u}" before non-existing layer "${s}".`)));else{if(this._order.splice(v,0,u),this._layerOrderChanged=!0,this._layers[u]=p,this._removedLayers[u]&&p.source&&p.type!=="custom"){const b=this._removedLayers[u];delete this._removedLayers[u],b.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map)}}moveLayer(e,s){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new d.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===s)return;const l=this._order.indexOf(e);this._order.splice(l,1);const u=s?this._order.indexOf(s):this._order.length;s&&u===-1?this.fire(new d.j(new Error(`Cannot move layer "${e}" before non-existing layer "${s}".`))):(this._order.splice(u,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const s=this._layers[e];if(!s)return void this.fire(new d.j(new Error(`Cannot remove non-existing layer "${e}".`)));s.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=s,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],s.onRemove&&s.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,s,l){this._checkLoaded();const u=this.getLayer(e);u?u.minzoom===s&&u.maxzoom===l||(s!=null&&(u.minzoom=s),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new d.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,s,l={}){this._checkLoaded();const u=this.getLayer(e);if(u){if(!d.aE(u.filter,s))return s==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(d.u.filter,`layers.${u.id}.filter`,s,null,l)||(u.filter=d.aB(s),this._updateLayer(u)))}else this.fire(new d.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return d.aB(this.getLayer(e).filter)}setLayoutProperty(e,s,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?d.aE(p.getLayoutProperty(s),l)||(p.setLayoutProperty(s,l,u),this._updateLayer(p)):this.fire(new d.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,s){const l=this.getLayer(e);if(l)return l.getLayoutProperty(s);this.fire(new d.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,s,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?d.aE(p.getPaintProperty(s),l)||(p.setPaintProperty(s,l,u)&&this._updateLayer(p),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new d.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,s){return this.getLayer(e).getPaintProperty(s)}setFeatureState(e,s){this._checkLoaded();const l=e.source,u=e.sourceLayer,p=this.sourceCaches[l];if(p===void 0)return void this.fire(new d.j(new Error(`The source '${l}' does not exist in the map's style.`)));const v=p.getSource().type;v==="geojson"&&u?this.fire(new d.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||u?(e.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),p.setFeatureState(u,e.id,s)):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,s){this._checkLoaded();const l=e.source,u=this.sourceCaches[l];if(u===void 0)return void this.fire(new d.j(new Error(`The source '${l}' does not exist in the map's style.`)));const p=u.getSource().type,v=p==="vector"?e.sourceLayer:void 0;p!=="vector"||v?s&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new d.j(new Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(v,e.id,s):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const s=e.source,l=e.sourceLayer,u=this.sourceCaches[s];if(u!==void 0)return u.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),u.getFeatureState(l,e.id)):void this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.j(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=d.aF(this.sourceCaches,p=>p.serialize()),s=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,u=this.stylesheet;return d.aG({version:u.version,name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,sources:e,layers:s,terrain:l},p=>p!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const s=v=>this._layers[v].type==="fill-extrusion",l={},u=[];for(let v=this._order.length-1;v>=0;v--){const b=this._order[v];if(s(b)){l[b]=v;for(const I of e){const C=I[b];if(C)for(const M of C)u.push(M)}}}u.sort((v,b)=>b.intersectionZ-v.intersectionZ);const p=[];for(let v=this._order.length-1;v>=0;v--){const b=this._order[v];if(s(b))for(let I=u.length-1;I>=0;I--){const C=u[I].feature;if(l[C.layer.id]<v)break;p.push(C),u.pop()}else for(const I of e){const C=I[b];if(C)for(const M of C)p.push(M.feature)}}return p}queryRenderedFeatures(e,s,l){s&&s.filter&&this._validate(d.u.filter,"queryRenderedFeatures.filter",s.filter,null,s);const u={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new d.j(new Error("parameters.layers must be an Array."))),[];for(const b of s.layers){const I=this._layers[b];if(!I)return this.fire(new d.j(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];u[I.source]=!0}}const p=[];s.availableImages=this._availableImages;const v=this._serializedAllLayers();for(const b in this.sourceCaches)s.layers&&!u[b]||p.push(Zr(this.sourceCaches[b],this._layers,v,e,s,l));return this.placement&&p.push(function(b,I,C,M,z,F,N){const $={},W=F.queryRenderedSymbols(M),Y=[];for(const Q of Object.keys(W).map(Number))Y.push(N[Q]);Y.sort(qr);for(const Q of Y){const ie=Q.featureIndex.lookupSymbolFeatures(W[Q.bucketInstanceId],I,Q.bucketIndex,Q.sourceLayerIndex,z.filter,z.layers,z.availableImages,b);for(const q in ie){const se=$[q]=$[q]||[],ce=ie[q];ce.sort((fe,we)=>{const Ce=Q.featureSortOrder;if(Ce){const Be=Ce.indexOf(fe.featureIndex);return Ce.indexOf(we.featureIndex)-Be}return we.featureIndex-fe.featureIndex});for(const fe of ce)se.push(fe)}}for(const Q in $)$[Q].forEach(ie=>{const q=ie.feature,se=C[b[Q].source].getFeatureState(q.layer["source-layer"],q.id);q.source=q.layer.source,q.layer["source-layer"]&&(q.sourceLayer=q.layer["source-layer"]),q.state=se});return $}(this._layers,v,this.sourceCaches,e,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(e,s){s&&s.filter&&this._validate(d.u.filter,"querySourceFeatures.filter",s.filter,null,s);const l=this.sourceCaches[e];return l?function(u,p){const v=u.getRenderableIds().map(C=>u.getTileByID(C)),b=[],I={};for(let C=0;C<v.length;C++){const M=v[C],z=M.tileID.canonical.key;I[z]||(I[z]=!0,M.querySourceFeatures(b,p))}return b}(l,s):[]}getLight(){return this.light.getLight()}setLight(e,s={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const v in e)if(!d.aE(e[v],l[v])){u=!0;break}if(!u)return;const p={now:X.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,s),this.light.updateTransitions(p)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,s={}){const l=this.getSky();let u=!1;if(!e&&!l)return;if(e&&!l)u=!0;else if(!e&&l)u=!0;else for(const v in e)if(!d.aE(e[v],l[v])){u=!0;break}if(!u)return;const p={now:X.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,s),this.sky.updateTransitions(p)}_validate(e,s,l,u,p={}){return(!p||p.validate!==!1)&&Xn(this,e.call(d.u,d.e({key:s,style:this.serialize(),value:l,styleSpec:d.v},u)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),fr().off(Pe,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const l=this.sourceCaches[s];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const s in this.sourceCaches)this.sourceCaches[s].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,s,l,u,p=!1){let v=!1,b=!1;const I={};for(const C of this._order){const M=this._layers[C];if(M.type!=="symbol")continue;if(!I[M.source]){const F=this.sourceCaches[M.source];I[M.source]=F.getRenderableIds(!0).map(N=>F.getTileByID(N)).sort((N,$)=>$.tileID.overscaledZ-N.tileID.overscaledZ||(N.tileID.isLessThan($.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(M,I[M.source],e.center.lng);v=v||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((p=p||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(X.now(),e.zoom))&&(this.pauseablePlacement=new Ws(e,this.map.terrain,this._order,p,s,l,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(X.now()),b=!0),v&&this.pauseablePlacement.placement.setStale()),b||v)for(const C of this._order){const M=this._layers[C];M.type==="symbol"&&this.placement.updateLayerOpacities(M,I[M.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(X.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,s){return d._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[s.source];return u&&u.setDependencies(s.tileID.key,s.type,s.icons),l})}getGlyphs(e,s){return d._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(s.stacks),u=this.sourceCaches[s.source];return u&&u.setDependencies(s.tileID.key,s.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,s={}){this._checkLoaded(),e&&this._validate(d.u.glyphs,"glyphs",e,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,s,l={},u){this._checkLoaded();const p=[{id:e,url:s}],v=[...Lt(this.stylesheet.sprite),...p];this._validate(d.u.sprite,"sprite",v,null,l)||(this.stylesheet.sprite=v,this._loadSprite(p,!0,u))}removeSprite(e){this._checkLoaded();const s=Lt(this.stylesheet.sprite);if(s.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;s.splice(s.findIndex(l=>l.id===e),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}else this.fire(new d.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Lt(this.stylesheet.sprite)}setSprite(e,s={},l){this._checkLoaded(),e&&this._validate(d.u.sprite,"sprite",e,null,s)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var po=d.Y([{name:"a_pos",type:"Int16",components:2}]);const Xr={prelude:Dt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Dt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Dt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Dt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Dt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Dt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Dt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Dt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Dt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Dt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Dt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Dt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Dt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Dt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Dt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Dt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Dt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Dt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Dt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Dt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Dt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Dt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Dt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Dt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Dt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Dt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Dt(f,e){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/attribute ([\w]+) ([\w]+)/g),u=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),p=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=p?p.concat(u):u,b={};return{fragmentSource:f=f.replace(s,(I,C,M,z,F)=>(b[F]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${M} ${z} ${F};
#else
uniform ${M} ${z} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${M} ${z} ${F} = u_${F};
#endif
`)),vertexSource:e=e.replace(s,(I,C,M,z,F)=>{const N=z==="float"?"vec2":"vec4",$=F.match(/color/)?"color":N;return b[F]?C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${M} ${N} a_${F};
varying ${M} ${z} ${F};
#else
uniform ${M} ${z} u_${F};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${M} ${z} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${$}(a_${F}, u_${F}_t);
#else
    ${M} ${z} ${F} = u_${F};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${M} ${N} a_${F};
#else
uniform ${M} ${z} u_${F};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${M} ${z} ${F} = a_${F};
#else
    ${M} ${z} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${M} ${z} ${F} = unpack_mix_${$}(a_${F}, u_${F}_t);
#else
    ${M} ${z} ${F} = u_${F};
#endif
`}),staticAttributes:l,staticUniforms:v}}class hu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,s,l,u,p,v,b,I,C){this.context=e;let M=this.boundPaintVertexBuffers.length!==u.length;for(let z=0;!M&&z<u.length;z++)this.boundPaintVertexBuffers[z]!==u[z]&&(M=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==l||M||this.boundIndexBuffer!==p||this.boundVertexOffset!==v||this.boundDynamicVertexBuffer!==b||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==C?this.freshBind(s,l,u,p,v,b,I,C):(e.bindVertexArray.set(this.vao),b&&b.bind(),p&&p.dynamicDraw&&p.bind(),I&&I.bind(),C&&C.bind())}freshBind(e,s,l,u,p,v,b,I){const C=e.numAttributes,M=this.context,z=M.gl;this.vao&&this.destroy(),this.vao=M.createVertexArray(),M.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=I,s.enableAttributes(z,e);for(const F of l)F.enableAttributes(z,e);v&&v.enableAttributes(z,e),b&&b.enableAttributes(z,e),I&&I.enableAttributes(z,e),s.bind(),s.setVertexAttribPointers(z,e,p);for(const F of l)F.bind(),F.setVertexAttribPointers(z,e,p);v&&(v.bind(),v.setVertexAttribPointers(z,e,p)),u&&u.bind(),b&&(b.bind(),b.setVertexAttribPointers(z,e,p)),I&&(I.bind(),I.setVertexAttribPointers(z,e,p)),M.currentNumAttributes=C}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const du=(f,e,s,l,u)=>({u_matrix:f,u_texture:0,u_ele_delta:e,u_fog_matrix:s,u_fog_color:l?l.properties.get("fog-color"):d.aM.white,u_fog_ground_blend:l?l.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:l?l.calculateFogBlendOpacity(u):0,u_horizon_color:l?l.properties.get("horizon-color"):d.aM.white,u_horizon_fog_blend:l?l.properties.get("horizon-fog-blend"):1});function $o(f){const e=[];for(let s=0;s<f.length;s++){if(f[s]===null)continue;const l=f[s].split(" ");e.push(l.pop())}return e}class pu{constructor(e,s,l,u,p,v){const b=e.gl;this.program=b.createProgram();const I=$o(s.staticAttributes),C=l?l.getBinderAttributes():[],M=I.concat(C),z=Xr.prelude.staticUniforms?$o(Xr.prelude.staticUniforms):[],F=s.staticUniforms?$o(s.staticUniforms):[],N=l?l.getBinderUniforms():[],$=z.concat(F).concat(N),W=[];for(const fe of $)W.indexOf(fe)<0&&W.push(fe);const Y=l?l.defines():[];p&&Y.push("#define OVERDRAW_INSPECTOR;"),v&&Y.push("#define TERRAIN3D;");const Q=Y.concat(Xr.prelude.fragmentSource,s.fragmentSource).join(`
`),ie=Y.concat(Xr.prelude.vertexSource,s.vertexSource).join(`
`),q=b.createShader(b.FRAGMENT_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(q,Q),b.compileShader(q),!b.getShaderParameter(q,b.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${b.getShaderInfoLog(q)}`);b.attachShader(this.program,q);const se=b.createShader(b.VERTEX_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(se,ie),b.compileShader(se),!b.getShaderParameter(se,b.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${b.getShaderInfoLog(se)}`);b.attachShader(this.program,se),this.attributes={};const ce={};this.numAttributes=M.length;for(let fe=0;fe<this.numAttributes;fe++)M[fe]&&(b.bindAttribLocation(this.program,fe,M[fe]),this.attributes[M[fe]]=fe);if(b.linkProgram(this.program),!b.getProgramParameter(this.program,b.LINK_STATUS))throw new Error(`Program failed to link: ${b.getProgramInfoLog(this.program)}`);b.deleteShader(se),b.deleteShader(q);for(let fe=0;fe<W.length;fe++){const we=W[fe];if(we&&!ce[we]){const Ce=b.getUniformLocation(this.program,we);Ce&&(ce[we]=Ce)}}this.fixedUniforms=u(e,ce),this.terrainUniforms=((fe,we)=>({u_depth:new d.aH(fe,we.u_depth),u_terrain:new d.aH(fe,we.u_terrain),u_terrain_dim:new d.aI(fe,we.u_terrain_dim),u_terrain_matrix:new d.aJ(fe,we.u_terrain_matrix),u_terrain_unpack:new d.aK(fe,we.u_terrain_unpack),u_terrain_exaggeration:new d.aI(fe,we.u_terrain_exaggeration)}))(e,ce),this.binderUniforms=l?l.getUniforms(e,ce):[]}draw(e,s,l,u,p,v,b,I,C,M,z,F,N,$,W,Y,Q,ie){const q=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(u),e.setColorMode(p),e.setCullFace(v),I){e.activeTexture.set(q.TEXTURE2),q.bindTexture(q.TEXTURE_2D,I.depthTexture),e.activeTexture.set(q.TEXTURE3),q.bindTexture(q.TEXTURE_2D,I.texture);for(const ce in this.terrainUniforms)this.terrainUniforms[ce].set(I[ce])}for(const ce in this.fixedUniforms)this.fixedUniforms[ce].set(b[ce]);W&&W.setUniforms(e,this.binderUniforms,N,{zoom:$});let se=0;switch(s){case q.LINES:se=2;break;case q.TRIANGLES:se=3;break;case q.LINE_STRIP:se=1}for(const ce of F.get()){const fe=ce.vaos||(ce.vaos={});(fe[C]||(fe[C]=new hu)).bind(e,this,M,W?W.getPaintVertexBuffers():[],z,ce.vertexOffset,Y,Q,ie),q.drawElements(s,ce.primitiveLength*se,q.UNSIGNED_SHORT,ce.primitiveOffset*se*2)}}}function Oa(f,e,s){const l=1/bt(s,1,e.transform.tileZoom),u=Math.pow(2,s.tileID.overscaledZ),p=s.tileSize*Math.pow(2,e.transform.tileZoom)/u,v=p*(s.tileID.canonical.x+s.tileID.wrap*u),b=p*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[v>>16,b>>16],u_pixel_coord_lower:[65535&v,65535&b]}}const Xs=(f,e,s,l)=>{const u=e.style.light,p=u.properties.get("position"),v=[p.x,p.y,p.z],b=function(){var C=new d.A(9);return d.A!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[5]=0,C[6]=0,C[7]=0),C[0]=1,C[4]=1,C[8]=1,C}();u.properties.get("anchor")==="viewport"&&function(C,M){var z=Math.sin(M),F=Math.cos(M);C[0]=F,C[1]=z,C[2]=0,C[3]=-z,C[4]=F,C[5]=0,C[6]=0,C[7]=0,C[8]=1}(b,-e.transform.angle),function(C,M,z){var F=M[0],N=M[1],$=M[2];C[0]=F*z[0]+N*z[3]+$*z[6],C[1]=F*z[1]+N*z[4]+$*z[7],C[2]=F*z[2]+N*z[5]+$*z[8]}(v,v,b);const I=u.properties.get("color");return{u_matrix:f,u_lightpos:v,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+s,u_opacity:l}},Na=(f,e,s,l,u,p,v)=>d.e(Xs(f,e,s,l),Oa(p,e,v),{u_height_factor:-Math.pow(2,u.overscaledZ)/v.tileSize/8}),Zo=f=>({u_matrix:f}),uh=(f,e,s,l)=>d.e(Zo(f),Oa(s,e,l)),Lp=(f,e)=>({u_matrix:f,u_world:e}),ch=(f,e,s,l,u)=>d.e(uh(f,e,s,l),{u_world:u}),Rp=(f,e,s,l)=>{const u=f.transform;let p,v;if(l.paint.get("circle-pitch-alignment")==="map"){const b=bt(s,1,u.zoom);p=!0,v=[b,b]}else p=!1,v=u.pixelsToGLUnits;return{u_camera_to_center_distance:u.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_matrix:f.translatePosMatrix(e.posMatrix,s,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+p,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:v}},fo=(f,e,s)=>({u_matrix:f,u_inv_matrix:e,u_camera_to_center_distance:s.cameraToCenterDistance,u_viewport_size:[s.width,s.height]}),Ks=(f,e,s=1)=>({u_matrix:f,u_color:e,u_overlay:0,u_overlay_scale:s}),on=f=>({u_matrix:f}),sn=(f,e,s,l)=>({u_matrix:f,u_extrude_scale:bt(e,1,s),u_intensity:l}),Va=(f,e,s,l)=>{const u=d.H();d.aP(u,0,f.width,f.height,0,0,1);const p=f.context.gl;return{u_matrix:u,u_world:[p.drawingBufferWidth,p.drawingBufferHeight],u_image:s,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}};function Ua(f,e){const s=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new d.Z(0,l/s).toLngLat().lat,new d.Z(0,(l+1)/s).toLngLat().lat]}const $a=(f,e,s,l)=>{const u=f.transform;return{u_matrix:ph(f,e,s,l),u_ratio:1/bt(e,1,u.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},hh=(f,e,s,l,u)=>d.e($a(f,e,s,u),{u_image:0,u_image_height:l}),qo=(f,e,s,l,u)=>{const p=f.transform,v=dh(e,p);return{u_matrix:ph(f,e,s,u),u_texsize:e.imageAtlasTexture.size,u_ratio:1/bt(e,1,p.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[v,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Fp=(f,e,s,l,u,p)=>{const v=f.lineAtlas,b=dh(e,f.transform),I=s.layout.get("line-cap")==="round",C=v.getDash(l.from,I),M=v.getDash(l.to,I),z=C.width*u.fromScale,F=M.width*u.toScale;return d.e($a(f,e,s,p),{u_patternscale_a:[b/z,-C.height/2],u_patternscale_b:[b/F,-M.height/2],u_sdfgamma:v.width/(256*Math.min(z,F)*f.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:M.y,u_mix:u.t})};function dh(f,e){return 1/bt(f,1,e.tileZoom)}function ph(f,e,s,l){return f.translatePosMatrix(l?l.posMatrix:e.tileID.posMatrix,e,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const Bp=(f,e,s,l,u)=>{return{u_matrix:f,u_tl_parent:e,u_scale_parent:s,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(v=u.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(p=u.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:jp(u.paint.get("raster-hue-rotate"))};var p,v};function jp(f){f*=Math.PI/180;const e=Math.sin(f),s=Math.cos(f);return[(2*s+1)/3,(-Math.sqrt(3)*e-s+1)/3,(Math.sqrt(3)*e-s+1)/3]}const fh=(f,e,s,l,u,p,v,b,I,C,M,z,F,N)=>{const $=v.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:$.width/$.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:I,u_coord_matrix:C,u_is_text:+z,u_pitch_with_map:+l,u_is_along_line:u,u_is_variable_anchor:p,u_texsize:F,u_texture:0,u_translation:M,u_pitched_scale:N}},Js=(f,e,s,l,u,p,v,b,I,C,M,z,F,N,$)=>{const W=v.transform;return d.e(fh(f,e,s,l,u,p,v,b,I,C,M,z,F,$),{u_gamma_scale:l?Math.cos(W._pitch)*W.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:+N})},fu=(f,e,s,l,u,p,v,b,I,C,M,z,F,N)=>d.e(Js(f,e,s,l,u,p,v,b,I,C,M,!0,z,!0,N),{u_texsize_icon:F,u_texture_icon:1}),Za=(f,e,s)=>({u_matrix:f,u_opacity:e,u_color:s}),mu=(f,e,s,l,u,p)=>d.e(function(v,b,I,C){const M=I.imageManager.getPattern(v.from.toString()),z=I.imageManager.getPattern(v.to.toString()),{width:F,height:N}=I.imageManager.getPixelSize(),$=Math.pow(2,C.tileID.overscaledZ),W=C.tileSize*Math.pow(2,I.transform.tileZoom)/$,Y=W*(C.tileID.canonical.x+C.tileID.wrap*$),Q=W*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[F,N],u_mix:b.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/bt(C,1,I.transform.tileZoom),u_pixel_coord_upper:[Y>>16,Q>>16],u_pixel_coord_lower:[65535&Y,65535&Q]}}(l,p,s,u),{u_matrix:f,u_opacity:e}),gu={fillExtrusion:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_lightpos:new d.aN(f,e.u_lightpos),u_lightintensity:new d.aI(f,e.u_lightintensity),u_lightcolor:new d.aN(f,e.u_lightcolor),u_vertical_gradient:new d.aI(f,e.u_vertical_gradient),u_opacity:new d.aI(f,e.u_opacity)}),fillExtrusionPattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_lightpos:new d.aN(f,e.u_lightpos),u_lightintensity:new d.aI(f,e.u_lightintensity),u_lightcolor:new d.aN(f,e.u_lightcolor),u_vertical_gradient:new d.aI(f,e.u_vertical_gradient),u_height_factor:new d.aI(f,e.u_height_factor),u_image:new d.aH(f,e.u_image),u_texsize:new d.aO(f,e.u_texsize),u_pixel_coord_upper:new d.aO(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(f,e.u_pixel_coord_lower),u_scale:new d.aN(f,e.u_scale),u_fade:new d.aI(f,e.u_fade),u_opacity:new d.aI(f,e.u_opacity)}),fill:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix)}),fillPattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_image:new d.aH(f,e.u_image),u_texsize:new d.aO(f,e.u_texsize),u_pixel_coord_upper:new d.aO(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(f,e.u_pixel_coord_lower),u_scale:new d.aN(f,e.u_scale),u_fade:new d.aI(f,e.u_fade)}),fillOutline:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_world:new d.aO(f,e.u_world)}),fillOutlinePattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_world:new d.aO(f,e.u_world),u_image:new d.aH(f,e.u_image),u_texsize:new d.aO(f,e.u_texsize),u_pixel_coord_upper:new d.aO(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(f,e.u_pixel_coord_lower),u_scale:new d.aN(f,e.u_scale),u_fade:new d.aI(f,e.u_fade)}),circle:(f,e)=>({u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_scale_with_map:new d.aH(f,e.u_scale_with_map),u_pitch_with_map:new d.aH(f,e.u_pitch_with_map),u_extrude_scale:new d.aO(f,e.u_extrude_scale),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_matrix:new d.aJ(f,e.u_matrix)}),collisionBox:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_pixel_extrude_scale:new d.aO(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_inv_matrix:new d.aJ(f,e.u_inv_matrix),u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_viewport_size:new d.aO(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new d.aL(f,e.u_color),u_matrix:new d.aJ(f,e.u_matrix),u_overlay:new d.aH(f,e.u_overlay),u_overlay_scale:new d.aI(f,e.u_overlay_scale)}),clippingMask:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix)}),heatmap:(f,e)=>({u_extrude_scale:new d.aI(f,e.u_extrude_scale),u_intensity:new d.aI(f,e.u_intensity),u_matrix:new d.aJ(f,e.u_matrix)}),heatmapTexture:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_world:new d.aO(f,e.u_world),u_image:new d.aH(f,e.u_image),u_color_ramp:new d.aH(f,e.u_color_ramp),u_opacity:new d.aI(f,e.u_opacity)}),hillshade:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_image:new d.aH(f,e.u_image),u_latrange:new d.aO(f,e.u_latrange),u_light:new d.aO(f,e.u_light),u_shadow:new d.aL(f,e.u_shadow),u_highlight:new d.aL(f,e.u_highlight),u_accent:new d.aL(f,e.u_accent)}),hillshadePrepare:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_image:new d.aH(f,e.u_image),u_dimension:new d.aO(f,e.u_dimension),u_zoom:new d.aI(f,e.u_zoom),u_unpack:new d.aK(f,e.u_unpack)}),line:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_ratio:new d.aI(f,e.u_ratio),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.aO(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_ratio:new d.aI(f,e.u_ratio),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.aO(f,e.u_units_to_pixels),u_image:new d.aH(f,e.u_image),u_image_height:new d.aI(f,e.u_image_height)}),linePattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_texsize:new d.aO(f,e.u_texsize),u_ratio:new d.aI(f,e.u_ratio),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_image:new d.aH(f,e.u_image),u_units_to_pixels:new d.aO(f,e.u_units_to_pixels),u_scale:new d.aN(f,e.u_scale),u_fade:new d.aI(f,e.u_fade)}),lineSDF:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_ratio:new d.aI(f,e.u_ratio),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.aO(f,e.u_units_to_pixels),u_patternscale_a:new d.aO(f,e.u_patternscale_a),u_patternscale_b:new d.aO(f,e.u_patternscale_b),u_sdfgamma:new d.aI(f,e.u_sdfgamma),u_image:new d.aH(f,e.u_image),u_tex_y_a:new d.aI(f,e.u_tex_y_a),u_tex_y_b:new d.aI(f,e.u_tex_y_b),u_mix:new d.aI(f,e.u_mix)}),raster:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_tl_parent:new d.aO(f,e.u_tl_parent),u_scale_parent:new d.aI(f,e.u_scale_parent),u_buffer_scale:new d.aI(f,e.u_buffer_scale),u_fade_t:new d.aI(f,e.u_fade_t),u_opacity:new d.aI(f,e.u_opacity),u_image0:new d.aH(f,e.u_image0),u_image1:new d.aH(f,e.u_image1),u_brightness_low:new d.aI(f,e.u_brightness_low),u_brightness_high:new d.aI(f,e.u_brightness_high),u_saturation_factor:new d.aI(f,e.u_saturation_factor),u_contrast_factor:new d.aI(f,e.u_contrast_factor),u_spin_weights:new d.aN(f,e.u_spin_weights)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new d.aH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(f,e.u_is_size_feature_constant),u_size_t:new d.aI(f,e.u_size_t),u_size:new d.aI(f,e.u_size),u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_pitch:new d.aI(f,e.u_pitch),u_rotate_symbol:new d.aH(f,e.u_rotate_symbol),u_aspect_ratio:new d.aI(f,e.u_aspect_ratio),u_fade_change:new d.aI(f,e.u_fade_change),u_matrix:new d.aJ(f,e.u_matrix),u_label_plane_matrix:new d.aJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.aJ(f,e.u_coord_matrix),u_is_text:new d.aH(f,e.u_is_text),u_pitch_with_map:new d.aH(f,e.u_pitch_with_map),u_is_along_line:new d.aH(f,e.u_is_along_line),u_is_variable_anchor:new d.aH(f,e.u_is_variable_anchor),u_texsize:new d.aO(f,e.u_texsize),u_texture:new d.aH(f,e.u_texture),u_translation:new d.aO(f,e.u_translation),u_pitched_scale:new d.aI(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new d.aH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(f,e.u_is_size_feature_constant),u_size_t:new d.aI(f,e.u_size_t),u_size:new d.aI(f,e.u_size),u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_pitch:new d.aI(f,e.u_pitch),u_rotate_symbol:new d.aH(f,e.u_rotate_symbol),u_aspect_ratio:new d.aI(f,e.u_aspect_ratio),u_fade_change:new d.aI(f,e.u_fade_change),u_matrix:new d.aJ(f,e.u_matrix),u_label_plane_matrix:new d.aJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.aJ(f,e.u_coord_matrix),u_is_text:new d.aH(f,e.u_is_text),u_pitch_with_map:new d.aH(f,e.u_pitch_with_map),u_is_along_line:new d.aH(f,e.u_is_along_line),u_is_variable_anchor:new d.aH(f,e.u_is_variable_anchor),u_texsize:new d.aO(f,e.u_texsize),u_texture:new d.aH(f,e.u_texture),u_gamma_scale:new d.aI(f,e.u_gamma_scale),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_is_halo:new d.aH(f,e.u_is_halo),u_translation:new d.aO(f,e.u_translation),u_pitched_scale:new d.aI(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new d.aH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(f,e.u_is_size_feature_constant),u_size_t:new d.aI(f,e.u_size_t),u_size:new d.aI(f,e.u_size),u_camera_to_center_distance:new d.aI(f,e.u_camera_to_center_distance),u_pitch:new d.aI(f,e.u_pitch),u_rotate_symbol:new d.aH(f,e.u_rotate_symbol),u_aspect_ratio:new d.aI(f,e.u_aspect_ratio),u_fade_change:new d.aI(f,e.u_fade_change),u_matrix:new d.aJ(f,e.u_matrix),u_label_plane_matrix:new d.aJ(f,e.u_label_plane_matrix),u_coord_matrix:new d.aJ(f,e.u_coord_matrix),u_is_text:new d.aH(f,e.u_is_text),u_pitch_with_map:new d.aH(f,e.u_pitch_with_map),u_is_along_line:new d.aH(f,e.u_is_along_line),u_is_variable_anchor:new d.aH(f,e.u_is_variable_anchor),u_texsize:new d.aO(f,e.u_texsize),u_texsize_icon:new d.aO(f,e.u_texsize_icon),u_texture:new d.aH(f,e.u_texture),u_texture_icon:new d.aH(f,e.u_texture_icon),u_gamma_scale:new d.aI(f,e.u_gamma_scale),u_device_pixel_ratio:new d.aI(f,e.u_device_pixel_ratio),u_is_halo:new d.aH(f,e.u_is_halo),u_translation:new d.aO(f,e.u_translation),u_pitched_scale:new d.aI(f,e.u_pitched_scale)}),background:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_opacity:new d.aI(f,e.u_opacity),u_color:new d.aL(f,e.u_color)}),backgroundPattern:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_opacity:new d.aI(f,e.u_opacity),u_image:new d.aH(f,e.u_image),u_pattern_tl_a:new d.aO(f,e.u_pattern_tl_a),u_pattern_br_a:new d.aO(f,e.u_pattern_br_a),u_pattern_tl_b:new d.aO(f,e.u_pattern_tl_b),u_pattern_br_b:new d.aO(f,e.u_pattern_br_b),u_texsize:new d.aO(f,e.u_texsize),u_mix:new d.aI(f,e.u_mix),u_pattern_size_a:new d.aO(f,e.u_pattern_size_a),u_pattern_size_b:new d.aO(f,e.u_pattern_size_b),u_scale_a:new d.aI(f,e.u_scale_a),u_scale_b:new d.aI(f,e.u_scale_b),u_pixel_coord_upper:new d.aO(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new d.aI(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_texture:new d.aH(f,e.u_texture),u_ele_delta:new d.aI(f,e.u_ele_delta),u_fog_matrix:new d.aJ(f,e.u_fog_matrix),u_fog_color:new d.aL(f,e.u_fog_color),u_fog_ground_blend:new d.aI(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new d.aI(f,e.u_fog_ground_blend_opacity),u_horizon_color:new d.aL(f,e.u_horizon_color),u_horizon_fog_blend:new d.aI(f,e.u_horizon_fog_blend)}),terrainDepth:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_ele_delta:new d.aI(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_matrix:new d.aJ(f,e.u_matrix),u_texture:new d.aH(f,e.u_texture),u_terrain_coords_id:new d.aI(f,e.u_terrain_coords_id),u_ele_delta:new d.aI(f,e.u_ele_delta)}),sky:(f,e)=>({u_sky_color:new d.aL(f,e.u_sky_color),u_horizon_color:new d.aL(f,e.u_horizon_color),u_horizon:new d.aI(f,e.u_horizon),u_sky_horizon_blend:new d.aI(f,e.u_sky_horizon_blend)})};class yr{constructor(e,s,l){this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Op={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class yu{constructor(e,s,l,u){this.length=s.length,this.attributes=l,this.itemSize=s.bytesPerElement,this.dynamicDraw=u,this.context=e;const p=e.gl;this.buffer=p.createBuffer(),e.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,s){for(let l=0;l<this.attributes.length;l++){const u=s.attributes[this.attributes[l].name];u!==void 0&&e.enableVertexAttribArray(u)}}setVertexAttribPointers(e,s,l){for(let u=0;u<this.attributes.length;u++){const p=this.attributes[u],v=s.attributes[p.name];v!==void 0&&e.vertexAttribPointer(v,p.components,e[Op[p.type]],!1,this.itemSize,p.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const mo=new WeakMap;function Kr(f){var e;if(mo.has(f))return mo.get(f);{const s=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return mo.set(f,s),s}}class Rt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qa extends Rt{getDefault(){return d.aM.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Np extends Rt{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Go extends Rt{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Vp extends Rt{getDefault(){return[!0,!0,!0,!0]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class mh extends Rt{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Up extends Rt{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class gh extends Rt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const s=this.current;(e.func!==s.func||e.ref!==s.ref||e.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class _u extends Rt{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class yh extends Rt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=e,this.dirty=!1}}class _h extends Rt{getDefault(){return[0,1]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class vh extends Rt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=e,this.dirty=!1}}class xh extends Rt{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class go extends Rt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.BLEND):s.disable(s.BLEND),this.current=e,this.dirty=!1}}class wh extends Rt{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class $p extends Rt{getDefault(){return d.aM.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class bh extends Rt{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Ys extends Rt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=e,this.dirty=!1}}class Zp extends Rt{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Ga extends Rt{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class qp extends Rt{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Gp extends Rt{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Sh extends Rt{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Th extends Rt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Ih extends Rt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class vu extends Rt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class kh extends Rt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ha extends Rt{getDefault(){return null}set(e){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ar extends Rt{getDefault(){return null}set(e){var s;if(e===this.current&&!this.dirty)return;const l=this.gl;Kr(l)?l.bindVertexArray(e):(s=l.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class xu extends Rt{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class wu extends Rt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class bu extends Rt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Wa extends Rt{constructor(e,s){super(e),this.context=e,this.parent=s}getDefault(){return null}}class Su extends Wa{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class yo extends Wa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Tu extends Wa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Hp{constructor(e,s,l,u,p){this.context=e,this.width=s,this.height=l;const v=e.gl,b=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new Su(e,b),u)this.depthAttachment=p?new Tu(e,b):new yo(e,b);else if(p)throw new Error("Stencil cannot be set without depth");if(v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,s=this.colorAttachment.get();if(s&&e.deleteTexture(s),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class si{constructor(e,s,l){this.blendFunction=e,this.blendColor=s,this.mask=l}}si.Replace=[1,0],si.disabled=new si(si.Replace,d.aM.transparent,[!1,!1,!1,!1]),si.unblended=new si(si.Replace,d.aM.transparent,[!0,!0,!0,!0]),si.alphaBlended=new si([1,771],d.aM.transparent,[!0,!0,!0,!0]);class Wp{constructor(e){var s,l;if(this.gl=e,this.clearColor=new qa(this),this.clearDepth=new Np(this),this.clearStencil=new Go(this),this.colorMask=new Vp(this),this.depthMask=new mh(this),this.stencilMask=new Up(this),this.stencilFunc=new gh(this),this.stencilOp=new _u(this),this.stencilTest=new yh(this),this.depthRange=new _h(this),this.depthTest=new vh(this),this.depthFunc=new xh(this),this.blend=new go(this),this.blendFunc=new wh(this),this.blendColor=new $p(this),this.blendEquation=new bh(this),this.cullFace=new Ys(this),this.cullFaceSide=new Zp(this),this.frontFace=new Ga(this),this.program=new qp(this),this.activeTexture=new Gp(this),this.viewport=new Sh(this),this.bindFramebuffer=new Th(this),this.bindRenderbuffer=new Ih(this),this.bindTexture=new vu(this),this.bindVertexBuffer=new kh(this),this.bindElementBuffer=new Ha(this),this.bindVertexArray=new Ar(this),this.pixelStoreUnpack=new xu(this),this.pixelStoreUnpackPremultiplyAlpha=new wu(this),this.pixelStoreUnpackFlipY=new bu(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Kr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const u=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=e.RGBA16F)!==null&&s!==void 0?s:u==null?void 0:u.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:u==null?void 0:u.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const u=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=u==null?void 0:u.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,s){return new yr(this,e,s)}createVertexBuffer(e,s,l){return new yu(this,e,s,l)}createRenderbuffer(e,s,l){const u=this.gl,p=u.createRenderbuffer();return this.bindRenderbuffer.set(p),u.renderbufferStorage(u.RENDERBUFFER,e,s,l),this.bindRenderbuffer.set(null),p}createFramebuffer(e,s,l,u){return new Hp(this,e,s,l,u)}clear({color:e,depth:s,stencil:l}){const u=this.gl;let p=0;e&&(p|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(p|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),l!==void 0&&(p|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(p)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){d.aE(e.blendFunction,si.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Kr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var s;return Kr(this.gl)?this.gl.deleteVertexArray(e):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class wt{constructor(e,s,l){this.func=e,this.mask=s,this.range=l}}wt.ReadOnly=!1,wt.ReadWrite=!0,wt.disabled=new wt(519,wt.ReadOnly,[0,1]);const Xa=7680;class Zt{constructor(e,s,l,u,p,v){this.test=e,this.ref=s,this.mask=l,this.fail=u,this.depthFail=p,this.pass=v}}Zt.disabled=new Zt({func:519,mask:0},0,0,Xa,Xa,Xa);class Nt{constructor(e,s,l){this.enable=e,this.mode=s,this.frontFace=l}}let _o;function Qs(f,e,s,l,u){const p=f.context,v=p.gl,b=f.useProgram("collisionBox"),I=[];let C=0,M=0;for(let Q=0;Q<l.length;Q++){const ie=l[Q],q=e.getTile(ie).getBucket(s);if(!q)continue;const se=u?q.textCollisionBox:q.iconCollisionBox,ce=q.collisionCircleArray;if(ce.length>0){const fe=d.H();d.aQ(fe,q.placementInvProjMatrix,f.transform.glCoordMatrix),d.aQ(fe,fe,q.placementViewportMatrix),I.push({circleArray:ce,circleOffset:M,transform:ie.posMatrix,invTransform:fe,coord:ie}),C+=ce.length/4,M=C}se&&b.draw(p,v.LINES,wt.disabled,Zt.disabled,f.colorModeForRenderPass(),Nt.disabled,{u_matrix:ie.posMatrix,u_pixel_extrude_scale:[1/(z=f.transform).width,1/z.height]},f.style.map.terrain&&f.style.map.terrain.getTerrainData(ie),s.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,null,f.transform.zoom,null,null,se.collisionVertexBuffer)}var z;if(!u||!I.length)return;const F=f.useProgram("collisionCircle"),N=new d.aR;N.resize(4*C),N._trim();let $=0;for(const Q of I)for(let ie=0;ie<Q.circleArray.length/4;ie++){const q=4*ie,se=Q.circleArray[q+0],ce=Q.circleArray[q+1],fe=Q.circleArray[q+2],we=Q.circleArray[q+3];N.emplace($++,se,ce,fe,we,0),N.emplace($++,se,ce,fe,we,1),N.emplace($++,se,ce,fe,we,2),N.emplace($++,se,ce,fe,we,3)}(!_o||_o.length<2*C)&&(_o=function(Q){const ie=2*Q,q=new d.aT;q.resize(ie),q._trim();for(let se=0;se<ie;se++){const ce=6*se;q.uint16[ce+0]=4*se+0,q.uint16[ce+1]=4*se+1,q.uint16[ce+2]=4*se+2,q.uint16[ce+3]=4*se+2,q.uint16[ce+4]=4*se+3,q.uint16[ce+5]=4*se+0}return q}(C));const W=p.createIndexBuffer(_o,!0),Y=p.createVertexBuffer(N,d.aS.members,!0);for(const Q of I){const ie=fo(Q.transform,Q.invTransform,f.transform);F.draw(p,v.TRIANGLES,wt.disabled,Zt.disabled,f.colorModeForRenderPass(),Nt.disabled,ie,f.style.map.terrain&&f.style.map.terrain.getTerrainData(Q.coord),s.id,Y,W,d.a0.simpleSegment(0,2*Q.circleOffset,Q.circleArray.length,Q.circleArray.length/2),null,f.transform.zoom,null,null,null)}Y.destroy(),W.destroy()}Nt.disabled=new Nt(!1,1029,2305),Nt.backCCW=new Nt(!0,1029,2305);const ea=d.an(new Float32Array(16));function Iu(f,e,s,l,u,p){const{horizontalAlign:v,verticalAlign:b}=d.au(f);return new d.P((-(v-.5)*e/u+l[0])*p,(-(b-.5)*s/u+l[1])*p)}function vo(f,e,s,l,u,p){const v=e.tileAnchorPoint.add(new d.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let b=l.mult(p);s||(b=b.rotate(-u));const I=v.add(b);return K(I.x,I.y,e.labelPlaneMatrix,e.getElevation).point}if(s){const b=ve(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),I=Math.atan(b.y/b.x)+(b.x<0?Math.PI:0);return f.add(l.rotate(I))}return f.add(l)}function Ho(f,e,s,l,u,p,v,b,I,C,M,z,F,N){const $=f.text.placedSymbolArray,W=f.text.dynamicLayoutVertexArray,Y=f.icon.dynamicLayoutVertexArray,Q={};W.clear();for(let ie=0;ie<$.length;ie++){const q=$.get(ie),se=q.hidden||!q.crossTileID||f.allowVerticalPlacement&&!q.placedOrientation?null:l[q.crossTileID];if(se){const ce=new d.P(q.anchorX,q.anchorY),fe={getElevation:N,width:u.width,height:u.height,labelPlaneMatrix:p,lineVertexArray:null,pitchWithMap:s,projection:M,projectionCache:null,tileAnchorPoint:ce,translation:z,unwrappedTileID:F},we=s?K(ce.x,ce.y,v,N):ve(ce.x,ce.y,fe),Ce=L(u.cameraToCenterDistance,we.signedDistanceFromCamera);let Be=d.ai(f.textSizeData,I,q)*Ce/d.ap;s&&(Be*=f.tilePixelRatio/b);const{width:Ue,height:De,anchor:Ae,textOffset:Ke,textBoxScale:ht}=se,Re=Iu(Ae,Ue,De,Ke,ht,Be),Ne=M.getPitchedTextCorrection(u,ce.add(new d.P(z[0],z[1])),F),ut=vo(we.point,fe,e,Re,u.angle,Ne),Wt=f.allowVerticalPlacement&&q.placedOrientation===d.ah.vertical?Math.PI/2:0;for(let gt=0;gt<q.numGlyphs;gt++)d.aj(W,ut,Wt);C&&q.associatedIconIndex>=0&&(Q[q.associatedIconIndex]={shiftedAnchor:ut,angle:Wt})}else rt(q.numGlyphs,W)}if(C){Y.clear();const ie=f.icon.placedSymbolArray;for(let q=0;q<ie.length;q++){const se=ie.get(q);if(se.hidden)rt(se.numGlyphs,Y);else{const ce=Q[q];if(ce)for(let fe=0;fe<se.numGlyphs;fe++)d.aj(Y,ce.shiftedAnchor,ce.angle);else rt(se.numGlyphs,Y)}}f.icon.dynamicLayoutVertexBuffer.updateData(Y)}f.text.dynamicLayoutVertexBuffer.updateData(W)}function zn(f,e,s){return s.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function ku(f,e,s,l,u,p,v,b,I,C,M,z){const F=f.context,N=F.gl,$=f.transform,W=ho(),Y=b==="map",Q=I==="map",ie=b!=="viewport"&&s.layout.get("symbol-placement")!=="point",q=Y&&!Q&&!ie,se=!Q&&ie,ce=!s.layout.get("symbol-sort-key").isConstant();let fe=!1;const we=f.depthModeForSublayer(0,wt.ReadOnly),Ce=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Be=[],Ue=W.getCircleRadiusCorrection($);for(const De of l){const Ae=e.getTile(De),Ke=Ae.getBucket(s);if(!Ke)continue;const ht=u?Ke.text:Ke.icon;if(!ht||!ht.segments.get().length||!ht.hasVisibleVertices)continue;const Re=ht.programConfigurations.get(s.id),Ne=u||Ke.sdfIcons,ut=u?Ke.textSizeData:Ke.iconSizeData,Wt=Q||$.pitch!==0,gt=f.useProgram(zn(Ne,u,Ke),Re),St=d.ag(ut,$.zoom),Xt=f.style.map.terrain&&f.style.map.terrain.getTerrainData(De);let Fi,Yn,Kt,an,Hi=[0,0],Bi=null;if(u)Yn=Ae.glyphAtlasTexture,Kt=N.LINEAR,Fi=Ae.glyphAtlasTexture.size,Ke.iconsInText&&(Hi=Ae.imageAtlasTexture.size,Bi=Ae.imageAtlasTexture,an=Wt||f.options.rotating||f.options.zooming||ut.kind==="composite"||ut.kind==="camera"?N.LINEAR:N.NEAREST);else{const It=s.layout.get("icon-size").constantOr(0)!==1||Ke.iconsNeedLinear;Yn=Ae.imageAtlasTexture,Kt=Ne||f.options.rotating||f.options.zooming||It||Wt?N.LINEAR:N.NEAREST,Fi=Ae.imageAtlasTexture.size}const Wi=bt(Ae,1,f.transform.zoom),xr=se?De.posMatrix:ea,us=Wr(xr,Q,Y,f.transform,Wi),fl=gr(xr,Q,Y,f.transform,Wi),cs=gr(De.posMatrix,Q,Y,f.transform,Wi),Ln=W.translatePosition(f.transform,Ae,p,v),ml=Ce&&Ke.hasTextData(),Ju=s.layout.get("icon-text-fit")!=="none"&&ml&&Ke.hasIconData();if(ie){const It=f.style.map.terrain?(hs,ds)=>f.style.map.terrain.getElevation(De,hs,ds):null,To=s.layout.get("text-rotation-alignment")==="map";V(Ke,De.posMatrix,f,u,us,cs,Q,C,To,W,De.toUnwrapped(),$.width,$.height,Ln,It)}const Rn=De.posMatrix,Fn=u&&Ce||Ju,Jr=ie||Fn?ea:us,Qn=fl,Mi=Ne&&s.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ji;ji=Ne?Ke.iconsInText?fu(ut.kind,St,q,Q,ie,Fn,f,Rn,Jr,Qn,Ln,Fi,Hi,Ue):Js(ut.kind,St,q,Q,ie,Fn,f,Rn,Jr,Qn,Ln,u,Fi,!0,Ue):fh(ut.kind,St,q,Q,ie,Fn,f,Rn,Jr,Qn,Ln,u,Fi,Ue);const bn={program:gt,buffers:ht,uniformValues:ji,atlasTexture:Yn,atlasTextureIcon:Bi,atlasInterpolation:Kt,atlasInterpolationIcon:an,isSDF:Ne,hasHalo:Mi};if(ce&&Ke.canOverlap){fe=!0;const It=ht.segments.get();for(const To of It)Be.push({segments:new d.a0([To]),sortKey:To.sortKey,state:bn,terrainData:Xt})}else Be.push({segments:ht.segments,sortKey:0,state:bn,terrainData:Xt})}fe&&Be.sort((De,Ae)=>De.sortKey-Ae.sortKey);for(const De of Be){const Ae=De.state;if(F.activeTexture.set(N.TEXTURE0),Ae.atlasTexture.bind(Ae.atlasInterpolation,N.CLAMP_TO_EDGE),Ae.atlasTextureIcon&&(F.activeTexture.set(N.TEXTURE1),Ae.atlasTextureIcon&&Ae.atlasTextureIcon.bind(Ae.atlasInterpolationIcon,N.CLAMP_TO_EDGE)),Ae.isSDF){const Ke=Ae.uniformValues;Ae.hasHalo&&(Ke.u_is_halo=1,Eu(Ae.buffers,De.segments,s,f,Ae.program,we,M,z,Ke,De.terrainData)),Ke.u_is_halo=0}Eu(Ae.buffers,De.segments,s,f,Ae.program,we,M,z,Ae.uniformValues,De.terrainData)}}function Eu(f,e,s,l,u,p,v,b,I,C){const M=l.context;u.draw(M,M.gl.TRIANGLES,p,v,b,Nt.disabled,I,C,s.id,f.layoutVertexBuffer,f.indexBuffer,e,s.paint,l.transform.zoom,f.programConfigurations.get(s.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function Cu(f,e,s,l){const u=f.context,p=u.gl,v=Zt.disabled,b=new si([p.ONE,p.ONE],d.aM.transparent,[!0,!0,!0,!0]),I=e.getBucket(s);if(!I)return;const C=l.key;let M=s.heatmapFbos.get(C);M||(M=ta(u,e.tileSize,e.tileSize),s.heatmapFbos.set(C,M)),u.bindFramebuffer.set(M.framebuffer),u.viewport.set([0,0,e.tileSize,e.tileSize]),u.clear({color:d.aM.transparent});const z=I.programConfigurations.get(s.id),F=f.useProgram("heatmap",z),N=f.style.map.terrain.getTerrainData(l);F.draw(u,p.TRIANGLES,wt.disabled,v,b,Nt.disabled,sn(l.posMatrix,e,f.transform.zoom,s.paint.get("heatmap-intensity")),N,s.id,I.layoutVertexBuffer,I.indexBuffer,I.segments,s.paint,f.transform.zoom,z)}function xo(f,e,s){const l=f.context,u=l.gl;l.setColorMode(f.colorModeForRenderPass());const p=ia(l,e),v=s.key,b=e.heatmapFbos.get(v);b&&(l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,b.colorAttachment.get()),l.activeTexture.set(u.TEXTURE1),p.bind(u.LINEAR,u.CLAMP_TO_EDGE),f.useProgram("heatmapTexture").draw(l,u.TRIANGLES,wt.disabled,Zt.disabled,f.colorModeForRenderPass(),Nt.disabled,Va(f,e,0,1),null,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,f.transform.zoom),b.destroy(),e.heatmapFbos.delete(v))}function ta(f,e,s){var l,u;const p=f.gl,v=p.createTexture();p.bindTexture(p.TEXTURE_2D,v),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);const b=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:p.UNSIGNED_BYTE,I=(u=f.RGBA16F)!==null&&u!==void 0?u:p.RGBA;p.texImage2D(p.TEXTURE_2D,0,I,e,s,0,p.RGBA,b,null);const C=f.createFramebuffer(e,s,!1,!1);return C.colorAttachment.set(v),C}function ia(f,e){return e.colorRampTexture||(e.colorRampTexture=new xt(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function Wo(f,e,s,l,u){if(!s||!l||!l.imageAtlas)return;const p=l.imageAtlas.patternPositions;let v=p[s.to.toString()],b=p[s.from.toString()];if(!v&&b&&(v=b),!b&&v&&(b=v),!v||!b){const I=u.getPaintProperty(e);v=p[I],b=p[I]}v&&b&&f.setConstantPatternPositions(v,b)}function na(f,e,s,l,u,p,v){const b=f.context.gl,I="fill-pattern",C=s.paint.get(I),M=C&&C.constantOr(1),z=s.getCrossfadeParameters();let F,N,$,W,Y;v?(N=M&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=b.LINES):(N=M?"fillPattern":"fill",F=b.TRIANGLES);const Q=C.constantOr(null);for(const ie of l){const q=e.getTile(ie);if(M&&!q.patternsLoaded())continue;const se=q.getBucket(s);if(!se)continue;const ce=se.programConfigurations.get(s.id),fe=f.useProgram(N,ce),we=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ie);M&&(f.context.activeTexture.set(b.TEXTURE0),q.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),ce.updatePaintBuffers(z)),Wo(ce,I,Q,q,s);const Ce=we?ie:null,Be=f.translatePosMatrix(Ce?Ce.posMatrix:ie.posMatrix,q,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(v){W=se.indexBuffer2,Y=se.segments2;const Ue=[b.drawingBufferWidth,b.drawingBufferHeight];$=N==="fillOutlinePattern"&&M?ch(Be,f,z,q,Ue):Lp(Be,Ue)}else W=se.indexBuffer,Y=se.segments,$=M?uh(Be,f,z,q):Zo(Be);fe.draw(f.context,F,u,f.stencilModeForClipping(ie),p,Nt.disabled,$,we,s.id,se.layoutVertexBuffer,W,Y,s.paint,f.transform.zoom,ce)}}function Ka(f,e,s,l,u,p,v){const b=f.context,I=b.gl,C="fill-extrusion-pattern",M=s.paint.get(C),z=M.constantOr(1),F=s.getCrossfadeParameters(),N=s.paint.get("fill-extrusion-opacity"),$=M.constantOr(null);for(const W of l){const Y=e.getTile(W),Q=Y.getBucket(s);if(!Q)continue;const ie=f.style.map.terrain&&f.style.map.terrain.getTerrainData(W),q=Q.programConfigurations.get(s.id),se=f.useProgram(z?"fillExtrusionPattern":"fillExtrusion",q);z&&(f.context.activeTexture.set(I.TEXTURE0),Y.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),q.updatePaintBuffers(F)),Wo(q,C,$,Y,s);const ce=f.translatePosMatrix(W.posMatrix,Y,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),fe=s.paint.get("fill-extrusion-vertical-gradient"),we=z?Na(ce,f,fe,N,W,F,Y):Xs(ce,f,fe,N);se.draw(b,b.gl.TRIANGLES,u,p,v,Nt.backCCW,we,ie,s.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,s.paint,f.transform.zoom,q,f.style.map.terrain&&Q.centroidVertexBuffer)}}function Xo(f,e,s,l,u,p,v){const b=f.context,I=b.gl,C=s.fbo;if(!C)return;const M=f.useProgram("hillshade"),z=f.style.map.terrain&&f.style.map.terrain.getTerrainData(e);b.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,C.colorAttachment.get()),M.draw(b,I.TRIANGLES,u,p,v,Nt.disabled,((F,N,$,W)=>{const Y=$.paint.get("hillshade-shadow-color"),Q=$.paint.get("hillshade-highlight-color"),ie=$.paint.get("hillshade-accent-color");let q=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(q-=F.transform.angle);const se=!F.options.moving;return{u_matrix:W?W.posMatrix:F.transform.calculatePosMatrix(N.tileID.toUnwrapped(),se),u_image:0,u_latrange:Ua(0,N.tileID),u_light:[$.paint.get("hillshade-exaggeration"),q],u_shadow:Y,u_highlight:Q,u_accent:ie}})(f,s,l,z?e:null),z,l.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}function Ko(f,e,s,l,u,p){const v=f.context,b=v.gl,I=e.dem;if(I&&I.data){const C=I.dim,M=I.stride,z=I.getPixels();if(v.activeTexture.set(b.TEXTURE1),v.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||f.getTileTexture(M),e.demTexture){const N=e.demTexture;N.update(z,{premultiply:!1}),N.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else e.demTexture=new xt(v,z,b.RGBA,{premultiply:!1}),e.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);v.activeTexture.set(b.TEXTURE0);let F=e.fbo;if(!F){const N=new xt(v,{width:C,height:C,data:null},b.RGBA);N.bind(b.LINEAR,b.CLAMP_TO_EDGE),F=e.fbo=v.createFramebuffer(C,C,!0,!1),F.colorAttachment.set(N.texture)}v.bindFramebuffer.set(F.framebuffer),v.viewport.set([0,0,C,C]),f.useProgram("hillshadePrepare").draw(v,b.TRIANGLES,l,u,p,Nt.disabled,((N,$)=>{const W=$.stride,Y=d.H();return d.aP(Y,0,d.X,-d.X,0,0,1),d.J(Y,Y,[0,-d.X,0]),{u_matrix:Y,u_image:1,u_dimension:[W,W],u_zoom:N.overscaledZ,u_unpack:$.getUnpackVector()}})(e.tileID,I),null,s.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function Eh(f,e,s,l,u,p){const v=l.paint.get("raster-fade-duration");if(!p&&v>0){const b=X.now(),I=(b-f.timeAdded)/v,C=e?(b-e.timeAdded)/v:-1,M=s.getSource(),z=u.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),F=!e||Math.abs(e.tileID.overscaledZ-z)>Math.abs(f.tileID.overscaledZ-z),N=F&&f.refreshedUponExpiration?1:d.ac(F?I:1-C,0,1);return f.refreshedUponExpiration&&I>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}const Pu=new d.aM(1,0,0,1),Mt=new d.aM(0,1,0,1),Ja=new d.aM(0,0,1,1),Xp=new d.aM(1,0,1,1),Ch=new d.aM(0,1,1,1);function Jo(f,e,s,l){Ya(f,0,e+s/2,f.transform.width,s,l)}function Ph(f,e,s,l){Ya(f,e-s/2,0,s,f.transform.height,l)}function Ya(f,e,s,l,u,p){const v=f.context,b=v.gl;b.enable(b.SCISSOR_TEST),b.scissor(e*f.pixelRatio,s*f.pixelRatio,l*f.pixelRatio,u*f.pixelRatio),v.clear({color:p}),b.disable(b.SCISSOR_TEST)}function Mh(f,e,s){const l=f.context,u=l.gl,p=s.posMatrix,v=f.useProgram("debug"),b=wt.disabled,I=Zt.disabled,C=f.colorModeForRenderPass(),M="$debug",z=f.style.map.terrain&&f.style.map.terrain.getTerrainData(s);l.activeTexture.set(u.TEXTURE0);const F=e.getTileByID(s.key).latestRawTileData,N=Math.floor((F&&F.byteLength||0)/1024),$=e.getTile(s).tileSize,W=512/Math.min($,512)*(s.overscaledZ/f.transform.zoom)*.5;let Y=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(Y+=` => ${s.overscaledZ}`),function(Q,ie){Q.initDebugOverlayCanvas();const q=Q.debugOverlayCanvas,se=Q.context.gl,ce=Q.debugOverlayCanvas.getContext("2d");ce.clearRect(0,0,q.width,q.height),ce.shadowColor="white",ce.shadowBlur=2,ce.lineWidth=1.5,ce.strokeStyle="white",ce.textBaseline="top",ce.font="bold 36px Open Sans, sans-serif",ce.fillText(ie,5,5),ce.strokeText(ie,5,5),Q.debugOverlayTexture.update(q),Q.debugOverlayTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE)}(f,`${Y} ${N}kB`),v.draw(l,u.TRIANGLES,b,I,si.alphaBlended,Nt.disabled,Ks(p,d.aM.transparent,W),null,M,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),v.draw(l,u.LINE_STRIP,b,I,C,Nt.disabled,Ks(p,d.aM.red),z,M,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function zh(f,e,s){const l=f.context,u=l.gl,p=f.colorModeForRenderPass(),v=new wt(u.LEQUAL,wt.ReadWrite,f.depthRangeFor3D),b=f.useProgram("terrain"),I=e.getTerrainMesh();l.bindFramebuffer.set(null),l.viewport.set([0,0,f.width,f.height]);for(const C of s){const M=f.renderToTexture.getTexture(C),z=e.getTerrainData(C.tileID);l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,M.texture);const F=f.transform.calculatePosMatrix(C.tileID.toUnwrapped()),N=e.getMeshFrameDelta(f.transform.zoom),$=f.transform.calculateFogMatrix(C.tileID.toUnwrapped()),W=du(F,N,$,f.style.sky,f.transform.pitch);b.draw(l,u.TRIANGLES,v,Zt.disabled,p,Nt.backCCW,W,z,"terrain",I.vertexBuffer,I.indexBuffer,I.segments)}}class Qa{constructor(e,s,l){this.vertexBuffer=e,this.indexBuffer=s,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class el{constructor(e,s){this.context=new Wp(e),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=lt.maxUnderzooming+lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new cu}resize(e,s,l){if(this.width=Math.floor(e*l),this.height=Math.floor(s*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){const e=this.context,s=new d.aX;s.emplaceBack(0,0),s.emplaceBack(d.X,0),s.emplaceBack(0,d.X),s.emplaceBack(d.X,d.X),this.tileExtentBuffer=e.createVertexBuffer(s,po.members),this.tileExtentSegments=d.a0.simpleSegment(0,0,4,2);const l=new d.aX;l.emplaceBack(0,0),l.emplaceBack(d.X,0),l.emplaceBack(0,d.X),l.emplaceBack(d.X,d.X),this.debugBuffer=e.createVertexBuffer(l,po.members),this.debugSegments=d.a0.simpleSegment(0,0,4,5);const u=new d.$;u.emplaceBack(0,0,0,0),u.emplaceBack(d.X,0,d.X,0),u.emplaceBack(0,d.X,0,d.X),u.emplaceBack(d.X,d.X,d.X,d.X),this.rasterBoundsBuffer=e.createVertexBuffer(u,Gr.members),this.rasterBoundsSegments=d.a0.simpleSegment(0,0,4,2);const p=new d.aX;p.emplaceBack(0,0),p.emplaceBack(1,0),p.emplaceBack(0,1),p.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(p,po.members),this.viewportSegments=d.a0.simpleSegment(0,0,4,2);const v=new d.aZ;v.emplaceBack(0),v.emplaceBack(1),v.emplaceBack(3),v.emplaceBack(2),v.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(v);const b=new d.aY;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(b);const I=this.context.gl;this.stencilClearMode=new Zt({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)}clearStencil(){const e=this.context,s=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=d.H();d.aP(l,0,this.width,this.height,0,0,1),d.K(l,l,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,s.TRIANGLES,wt.disabled,this.stencilClearMode,si.disabled,Nt.disabled,on(l),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,s){if(this.currentStencilSource===e.source||!e.isTileClipped()||!s||!s.length)return;this.currentStencilSource=e.source;const l=this.context,u=l.gl;this.nextStencilID+s.length>256&&this.clearStencil(),l.setColorMode(si.disabled),l.setDepthMode(wt.disabled);const p=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const v of s){const b=this._tileClippingMaskIDs[v.key]=this.nextStencilID++,I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(v);p.draw(l,u.TRIANGLES,wt.disabled,new Zt({func:u.ALWAYS,mask:0},b,255,u.KEEP,u.KEEP,u.REPLACE),si.disabled,Nt.disabled,on(v.posMatrix),I,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,s=this.context.gl;return new Zt({func:s.NOTEQUAL,mask:255},e,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(e){const s=this.context.gl;return new Zt({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(e){const s=this.context.gl,l=e.sort((v,b)=>b.overscaledZ-v.overscaledZ),u=l[l.length-1].overscaledZ,p=l[0].overscaledZ-u+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const v={};for(let b=0;b<p;b++)v[b+u]=new Zt({func:s.GEQUAL,mask:255},b+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=p,[v,l]}return[{[u]:Zt.disabled},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new si([e.CONSTANT_COLOR,e.ONE],new d.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?si.unblended:si.alphaBlended}depthModeForSublayer(e,s,l){if(!this.opaquePassEnabledForLayer())return wt.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new wt(l||this.context.gl.LEQUAL,s,[u,u])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,s){this.style=e,this.options=s,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(X.now()),this.imageManager.beginFrame();const l=this.style._order,u=this.style.sourceCaches,p={},v={},b={};for(const I in u){const C=u[I];C.used&&C.prepare(this.context),p[I]=C.getVisibleCoordinates(),v[I]=p[I].slice().reverse(),b[I]=C.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<l.length;I++)if(this.style._layers[l[I]].is3D()){this.opaquePassCutoff=I;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const I of l){const C=this.style._layers[I];if(!C.hasOffscreenPass()||C.isHidden(this.transform.zoom))continue;const M=v[C.source];(C.type==="custom"||M.length)&&this.renderLayer(this,u[C.source],C,M)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?d.aM.black:d.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(I,C){const M=I.context,z=M.gl,F=((Q,ie,q)=>({u_sky_color:Q.properties.get("sky-color"),u_horizon_color:Q.properties.get("horizon-color"),u_horizon:(ie.height/2+ie.getHorizon())*q,u_sky_horizon_blend:Q.properties.get("sky-horizon-blend")*ie.height/2*q}))(C,I.style.map.transform,I.pixelRatio),N=new wt(z.LEQUAL,wt.ReadWrite,[0,1]),$=Zt.disabled,W=I.colorModeForRenderPass(),Y=I.useProgram("sky");if(!C.mesh){const Q=new d.aX;Q.emplaceBack(-1,-1),Q.emplaceBack(1,-1),Q.emplaceBack(1,1),Q.emplaceBack(-1,1);const ie=new d.aY;ie.emplaceBack(0,1,2),ie.emplaceBack(0,2,3),C.mesh=new Qa(M.createVertexBuffer(Q,po.members),M.createIndexBuffer(ie),d.a0.simpleSegment(0,0,Q.length,ie.length))}Y.draw(M,z.TRIANGLES,N,$,W,Nt.disabled,F,void 0,"sky",C.mesh.vertexBuffer,C.mesh.indexBuffer,C.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[l[this.currentLayer]],C=u[I.source],M=p[I.source];this._renderTileClippingMasks(I,M),this.renderLayer(this,C,I,M)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){const I=this.style._layers[l[this.currentLayer]],C=u[I.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(I))continue;const M=(I.type==="symbol"?b:v)[I.source];this._renderTileClippingMasks(I,p[I.source]),this.renderLayer(this,C,I,M)}if(this.options.showTileBoundaries){const I=function(C,M){let z=null;const F=Object.values(C._layers).flatMap(Y=>Y.source&&!Y.isHidden(M)?[C.sourceCaches[Y.source]]:[]),N=F.filter(Y=>Y.getSource().type==="vector"),$=F.filter(Y=>Y.getSource().type!=="vector"),W=Y=>{(!z||z.getSource().maxzoom<Y.getSource().maxzoom)&&(z=Y)};return N.forEach(Y=>W(Y)),z||$.forEach(Y=>W(Y)),z}(this.style,this.transform.zoom);I&&function(C,M,z){for(let F=0;F<z.length;F++)Mh(C,M,z[F])}(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const C=I.transform.padding;Jo(I,I.transform.height-(C.top||0),3,Pu),Jo(I,C.bottom||0,3,Mt),Ph(I,C.left||0,3,Ja),Ph(I,I.transform.width-(C.right||0),3,Xp);const M=I.transform.centerPoint;(function(z,F,N,$){Ya(z,F-1,N-10,2,20,$),Ya(z,F-10,N-1,20,2,$)})(I,M.x,I.transform.height-M.y,Ch)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let u=this.terrainFacilitator.dirty;u||(u=e?!d.a_(s,l):!d.a$(s,l)),u||(u=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),u&&(d.b0(s,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(p,v){const b=p.context,I=b.gl,C=si.unblended,M=new wt(I.LEQUAL,wt.ReadWrite,[0,1]),z=v.getTerrainMesh(),F=v.sourceCache.getRenderableTiles(),N=p.useProgram("terrainDepth");b.bindFramebuffer.set(v.getFramebuffer("depth").framebuffer),b.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),b.clear({color:d.aM.transparent,depth:1});for(const $ of F){const W=v.getTerrainData($.tileID),Y={u_matrix:p.transform.calculatePosMatrix($.tileID.toUnwrapped()),u_ele_delta:v.getMeshFrameDelta(p.transform.zoom)};N.draw(b,I.TRIANGLES,M,Zt.disabled,C,Nt.backCCW,Y,W,"terrain",z.vertexBuffer,z.indexBuffer,z.segments)}b.bindFramebuffer.set(null),b.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain),function(p,v){const b=p.context,I=b.gl,C=si.unblended,M=new wt(I.LEQUAL,wt.ReadWrite,[0,1]),z=v.getTerrainMesh(),F=v.getCoordsTexture(),N=v.sourceCache.getRenderableTiles(),$=p.useProgram("terrainCoords");b.bindFramebuffer.set(v.getFramebuffer("coords").framebuffer),b.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),b.clear({color:d.aM.transparent,depth:1}),v.coordsIndex=[];for(const W of N){const Y=v.getTerrainData(W.tileID);b.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,F.texture);const Q={u_matrix:p.transform.calculatePosMatrix(W.tileID.toUnwrapped()),u_terrain_coords_id:(255-v.coordsIndex.length)/255,u_texture:0,u_ele_delta:v.getMeshFrameDelta(p.transform.zoom)};$.draw(b,I.TRIANGLES,M,Zt.disabled,C,Nt.backCCW,Q,Y,"terrain",z.vertexBuffer,z.indexBuffer,z.segments),v.coordsIndex.push(W.tileID.key)}b.bindFramebuffer.set(null),b.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain))}renderLayer(e,s,l,u){if(!l.isHidden(this.transform.zoom)&&(l.type==="background"||l.type==="custom"||(u||[]).length))switch(this.id=l.id,l.type){case"symbol":(function(p,v,b,I,C){if(p.renderPass!=="translucent")return;const M=Zt.disabled,z=p.colorModeForRenderPass();(b._unevaluatedLayout.hasValue("text-variable-anchor")||b._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(F,N,$,W,Y,Q,ie,q,se){const ce=N.transform,fe=ho(),we=Y==="map",Ce=Q==="map";for(const Be of F){const Ue=W.getTile(Be),De=Ue.getBucket($);if(!De||!De.text||!De.text.segments.get().length)continue;const Ae=d.ag(De.textSizeData,ce.zoom),Ke=bt(Ue,1,N.transform.zoom),ht=Wr(Be.posMatrix,Ce,we,N.transform,Ke),Re=$.layout.get("icon-text-fit")!=="none"&&De.hasIconData();if(Ae){const Ne=Math.pow(2,ce.zoom-Ue.tileID.overscaledZ),ut=N.style.map.terrain?(gt,St)=>N.style.map.terrain.getElevation(Be,gt,St):null,Wt=fe.translatePosition(ce,Ue,ie,q);Ho(De,we,Ce,se,ce,ht,Be.posMatrix,Ne,Ae,Re,fe,Wt,Be.toUnwrapped(),ut)}}}(I,p,b,v,b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),C),b.paint.get("icon-opacity").constantOr(1)!==0&&ku(p,v,b,I,!1,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),b.layout.get("icon-rotation-alignment"),b.layout.get("icon-pitch-alignment"),b.layout.get("icon-keep-upright"),M,z),b.paint.get("text-opacity").constantOr(1)!==0&&ku(p,v,b,I,!0,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.layout.get("text-keep-upright"),M,z),v.map.showCollisionBoxes&&(Qs(p,v,b,I,!0),Qs(p,v,b,I,!1))})(e,s,l,u,this.style.placement.variableOffsets);break;case"circle":(function(p,v,b,I){if(p.renderPass!=="translucent")return;const C=b.paint.get("circle-opacity"),M=b.paint.get("circle-stroke-width"),z=b.paint.get("circle-stroke-opacity"),F=!b.layout.get("circle-sort-key").isConstant();if(C.constantOr(1)===0&&(M.constantOr(1)===0||z.constantOr(1)===0))return;const N=p.context,$=N.gl,W=p.depthModeForSublayer(0,wt.ReadOnly),Y=Zt.disabled,Q=p.colorModeForRenderPass(),ie=[];for(let q=0;q<I.length;q++){const se=I[q],ce=v.getTile(se),fe=ce.getBucket(b);if(!fe)continue;const we=fe.programConfigurations.get(b.id),Ce=p.useProgram("circle",we),Be=fe.layoutVertexBuffer,Ue=fe.indexBuffer,De=p.style.map.terrain&&p.style.map.terrain.getTerrainData(se),Ae={programConfiguration:we,program:Ce,layoutVertexBuffer:Be,indexBuffer:Ue,uniformValues:Rp(p,se,ce,b),terrainData:De};if(F){const Ke=fe.segments.get();for(const ht of Ke)ie.push({segments:new d.a0([ht]),sortKey:ht.sortKey,state:Ae})}else ie.push({segments:fe.segments,sortKey:0,state:Ae})}F&&ie.sort((q,se)=>q.sortKey-se.sortKey);for(const q of ie){const{programConfiguration:se,program:ce,layoutVertexBuffer:fe,indexBuffer:we,uniformValues:Ce,terrainData:Be}=q.state;ce.draw(N,$.TRIANGLES,W,Y,Q,Nt.disabled,Ce,Be,b.id,fe,we,q.segments,b.paint,p.transform.zoom,se)}})(e,s,l,u);break;case"heatmap":(function(p,v,b,I){if(b.paint.get("heatmap-opacity")===0)return;const C=p.context;if(p.style.map.terrain){for(const M of I){const z=v.getTile(M);v.hasRenderableParent(M)||(p.renderPass==="offscreen"?Cu(p,z,b,M):p.renderPass==="translucent"&&xo(p,b,M))}C.viewport.set([0,0,p.width,p.height])}else p.renderPass==="offscreen"?function(M,z,F,N){const $=M.context,W=$.gl,Y=Zt.disabled,Q=new si([W.ONE,W.ONE],d.aM.transparent,[!0,!0,!0,!0]);(function(ie,q,se){const ce=ie.gl;ie.activeTexture.set(ce.TEXTURE1),ie.viewport.set([0,0,q.width/4,q.height/4]);let fe=se.heatmapFbos.get(d.aU);fe?(ce.bindTexture(ce.TEXTURE_2D,fe.colorAttachment.get()),ie.bindFramebuffer.set(fe.framebuffer)):(fe=ta(ie,q.width/4,q.height/4),se.heatmapFbos.set(d.aU,fe))})($,M,F),$.clear({color:d.aM.transparent});for(let ie=0;ie<N.length;ie++){const q=N[ie];if(z.hasRenderableParent(q))continue;const se=z.getTile(q),ce=se.getBucket(F);if(!ce)continue;const fe=ce.programConfigurations.get(F.id),we=M.useProgram("heatmap",fe),{zoom:Ce}=M.transform;we.draw($,W.TRIANGLES,wt.disabled,Y,Q,Nt.disabled,sn(q.posMatrix,se,Ce,F.paint.get("heatmap-intensity")),null,F.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,F.paint,M.transform.zoom,fe)}$.viewport.set([0,0,M.width,M.height])}(p,v,b,I):p.renderPass==="translucent"&&function(M,z){const F=M.context,N=F.gl;F.setColorMode(M.colorModeForRenderPass());const $=z.heatmapFbos.get(d.aU);$&&(F.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,$.colorAttachment.get()),F.activeTexture.set(N.TEXTURE1),ia(F,z).bind(N.LINEAR,N.CLAMP_TO_EDGE),M.useProgram("heatmapTexture").draw(F,N.TRIANGLES,wt.disabled,Zt.disabled,M.colorModeForRenderPass(),Nt.disabled,Va(M,z,0,1),null,z.id,M.viewportBuffer,M.quadTriangleIndexBuffer,M.viewportSegments,z.paint,M.transform.zoom))}(p,b)})(e,s,l,u);break;case"line":(function(p,v,b,I){if(p.renderPass!=="translucent")return;const C=b.paint.get("line-opacity"),M=b.paint.get("line-width");if(C.constantOr(1)===0||M.constantOr(1)===0)return;const z=p.depthModeForSublayer(0,wt.ReadOnly),F=p.colorModeForRenderPass(),N=b.paint.get("line-dasharray"),$=b.paint.get("line-pattern"),W=$.constantOr(1),Y=b.paint.get("line-gradient"),Q=b.getCrossfadeParameters(),ie=W?"linePattern":N?"lineSDF":Y?"lineGradient":"line",q=p.context,se=q.gl;let ce=!0;for(const fe of I){const we=v.getTile(fe);if(W&&!we.patternsLoaded())continue;const Ce=we.getBucket(b);if(!Ce)continue;const Be=Ce.programConfigurations.get(b.id),Ue=p.context.program.get(),De=p.useProgram(ie,Be),Ae=ce||De.program!==Ue,Ke=p.style.map.terrain&&p.style.map.terrain.getTerrainData(fe),ht=$.constantOr(null);if(ht&&we.imageAtlas){const ut=we.imageAtlas,Wt=ut.patternPositions[ht.to.toString()],gt=ut.patternPositions[ht.from.toString()];Wt&&gt&&Be.setConstantPatternPositions(Wt,gt)}const Re=Ke?fe:null,Ne=W?qo(p,we,b,Q,Re):N?Fp(p,we,b,N,Q,Re):Y?hh(p,we,b,Ce.lineClipsArray.length,Re):$a(p,we,b,Re);if(W)q.activeTexture.set(se.TEXTURE0),we.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Be.updatePaintBuffers(Q);else if(N&&(Ae||p.lineAtlas.dirty))q.activeTexture.set(se.TEXTURE0),p.lineAtlas.bind(q);else if(Y){const ut=Ce.gradients[b.id];let Wt=ut.texture;if(b.gradientVersion!==ut.version){let gt=256;if(b.stepInterpolant){const St=v.getSource().maxzoom,Xt=fe.canonical.z===St?Math.ceil(1<<p.transform.maxZoom-fe.canonical.z):1;gt=d.ac(d.aV(Ce.maxLineLength/d.X*1024*Xt),256,q.maxTextureSize)}ut.gradient=d.aW({expression:b.gradientExpression(),evaluationKey:"lineProgress",resolution:gt,image:ut.gradient||void 0,clips:Ce.lineClipsArray}),ut.texture?ut.texture.update(ut.gradient):ut.texture=new xt(q,ut.gradient,se.RGBA),ut.version=b.gradientVersion,Wt=ut.texture}q.activeTexture.set(se.TEXTURE0),Wt.bind(b.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}De.draw(q,se.TRIANGLES,z,p.stencilModeForClipping(fe),F,Nt.disabled,Ne,Ke,b.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,b.paint,p.transform.zoom,Be,Ce.layoutVertexBuffer2),ce=!1}})(e,s,l,u);break;case"fill":(function(p,v,b,I){const C=b.paint.get("fill-color"),M=b.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const z=p.colorModeForRenderPass(),F=b.paint.get("fill-pattern"),N=p.opaquePassEnabledForLayer()&&!F.constantOr(1)&&C.constantOr(d.aM.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===N){const $=p.depthModeForSublayer(1,p.renderPass==="opaque"?wt.ReadWrite:wt.ReadOnly);na(p,v,b,I,$,z,!1)}if(p.renderPass==="translucent"&&b.paint.get("fill-antialias")){const $=p.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,wt.ReadOnly);na(p,v,b,I,$,z,!0)}})(e,s,l,u);break;case"fill-extrusion":(function(p,v,b,I){const C=b.paint.get("fill-extrusion-opacity");if(C!==0&&p.renderPass==="translucent"){const M=new wt(p.context.gl.LEQUAL,wt.ReadWrite,p.depthRangeFor3D);if(C!==1||b.paint.get("fill-extrusion-pattern").constantOr(1))Ka(p,v,b,I,M,Zt.disabled,si.disabled),Ka(p,v,b,I,M,p.stencilModeFor3D(),p.colorModeForRenderPass());else{const z=p.colorModeForRenderPass();Ka(p,v,b,I,M,Zt.disabled,z)}}})(e,s,l,u);break;case"hillshade":(function(p,v,b,I){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent")return;const C=p.context,M=p.depthModeForSublayer(0,wt.ReadOnly),z=p.colorModeForRenderPass(),[F,N]=p.renderPass==="translucent"?p.stencilConfigForOverlap(I):[{},I];for(const $ of N){const W=v.getTile($);W.needsHillshadePrepare!==void 0&&W.needsHillshadePrepare&&p.renderPass==="offscreen"?Ko(p,W,b,M,Zt.disabled,z):p.renderPass==="translucent"&&Xo(p,$,W,b,M,F[$.overscaledZ],z)}C.viewport.set([0,0,p.width,p.height])})(e,s,l,u);break;case"raster":(function(p,v,b,I){if(p.renderPass!=="translucent"||b.paint.get("raster-opacity")===0||!I.length)return;const C=p.context,M=C.gl,z=v.getSource(),F=p.useProgram("raster"),N=p.colorModeForRenderPass(),[$,W]=z instanceof Mr?[{},I]:p.stencilConfigForOverlap(I),Y=W[W.length-1].overscaledZ,Q=!p.options.moving;for(const ie of W){const q=p.depthModeForSublayer(ie.overscaledZ-Y,b.paint.get("raster-opacity")===1?wt.ReadWrite:wt.ReadOnly,M.LESS),se=v.getTile(ie);se.registerFadeDuration(b.paint.get("raster-fade-duration"));const ce=v.findLoadedParent(ie,0),fe=v.findLoadedSibling(ie),we=Eh(se,ce||fe||null,v,b,p.transform,p.style.map.terrain);let Ce,Be;const Ue=b.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;C.activeTexture.set(M.TEXTURE0),se.texture.bind(Ue,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(M.TEXTURE1),ce?(ce.texture.bind(Ue,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),Ce=Math.pow(2,ce.tileID.overscaledZ-se.tileID.overscaledZ),Be=[se.tileID.canonical.x*Ce%1,se.tileID.canonical.y*Ce%1]):se.texture.bind(Ue,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),se.texture.useMipmap&&C.extTextureFilterAnisotropic&&p.transform.pitch>20&&M.texParameterf(M.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax);const De=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ie),Ae=De?ie:null,Ke=Ae?Ae.posMatrix:p.transform.calculatePosMatrix(ie.toUnwrapped(),Q),ht=Bp(Ke,Be||[0,0],Ce||1,we,b);z instanceof Mr?F.draw(C,M.TRIANGLES,q,Zt.disabled,N,Nt.disabled,ht,De,b.id,z.boundsBuffer,p.quadTriangleIndexBuffer,z.boundsSegments):F.draw(C,M.TRIANGLES,q,$[ie.overscaledZ],N,Nt.disabled,ht,De,b.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}})(e,s,l,u);break;case"background":(function(p,v,b,I){const C=b.paint.get("background-color"),M=b.paint.get("background-opacity");if(M===0)return;const z=p.context,F=z.gl,N=p.transform,$=N.tileSize,W=b.paint.get("background-pattern");if(p.isPatternMissing(W))return;const Y=!W&&C.a===1&&M===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==Y)return;const Q=Zt.disabled,ie=p.depthModeForSublayer(0,Y==="opaque"?wt.ReadWrite:wt.ReadOnly),q=p.colorModeForRenderPass(),se=p.useProgram(W?"backgroundPattern":"background"),ce=I||N.coveringTiles({tileSize:$,terrain:p.style.map.terrain});W&&(z.activeTexture.set(F.TEXTURE0),p.imageManager.bind(p.context));const fe=b.getCrossfadeParameters();for(const we of ce){const Ce=I?we.posMatrix:p.transform.calculatePosMatrix(we.toUnwrapped()),Be=W?mu(Ce,M,p,W,{tileID:we,tileSize:$},fe):Za(Ce,M,C),Ue=p.style.map.terrain&&p.style.map.terrain.getTerrainData(we);se.draw(z,F.TRIANGLES,ie,Q,q,Nt.disabled,Be,Ue,b.id,p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}})(e,0,l,u);break;case"custom":(function(p,v,b){const I=p.context,C=b.implementation;if(p.renderPass==="offscreen"){const M=C.prerender;M&&(p.setCustomLayerDefaults(),I.setColorMode(p.colorModeForRenderPass()),M.call(C,I.gl,p.transform.customLayerMatrix()),I.setDirty(),p.setBaseState())}else if(p.renderPass==="translucent"){p.setCustomLayerDefaults(),I.setColorMode(p.colorModeForRenderPass()),I.setStencilMode(Zt.disabled);const M=C.renderingMode==="3d"?new wt(p.context.gl.LEQUAL,wt.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,wt.ReadOnly);I.setDepthMode(M),C.render(I.gl,p.transform.customLayerMatrix(),{farZ:p.transform.farZ,nearZ:p.transform.nearZ,fov:p.transform._fov,modelViewProjectionMatrix:p.transform.modelViewProjectionMatrix,projectionMatrix:p.transform.projectionMatrix}),I.setDirty(),p.setBaseState(),I.bindFramebuffer.set(null)}})(e,0,l)}}translatePosMatrix(e,s,l,u,p){if(!l[0]&&!l[1])return e;const v=p?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(v){const C=Math.sin(v),M=Math.cos(v);l=[l[0]*M-l[1]*C,l[0]*C+l[1]*M]}const b=[p?l[0]:bt(s,l[0],this.transform.zoom),p?l[1]:bt(s,l[1],this.transform.zoom),0],I=new Float32Array(16);return d.J(I,e,b),I}saveTileTexture(e){const s=this._tileTextures[e.size[0]];s?s.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const s=this._tileTextures[e];return s&&s.length>0?s.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const s=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!s||!l}useProgram(e,s){this.cache=this.cache||{};const l=e+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[l]||(this.cache[l]=new pu(this.context,Xr[e],s,gu[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new xt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:s}=this.context.gl;return this.width!==e||this.height!==s}}class Yo{constructor(e,s){this.points=e,this.planes=s}static fromInvProjectionMatrix(e,s,l){const u=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const I=1/(b=d.af([],b,e))[3]/s*u;return d.b1(b,b,[I,I,1/b[3],I])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const I=function(F,N){var $=N[0],W=N[1],Y=N[2],Q=$*$+W*W+Y*Y;return Q>0&&(Q=1/Math.sqrt(Q)),F[0]=N[0]*Q,F[1]=N[1]*Q,F[2]=N[2]*Q,F}([],function(F,N,$){var W=N[0],Y=N[1],Q=N[2],ie=$[0],q=$[1],se=$[2];return F[0]=Y*se-Q*q,F[1]=Q*ie-W*se,F[2]=W*q-Y*ie,F}([],He([],p[b[0]],p[b[1]]),He([],p[b[2]],p[b[1]]))),C=-((M=I)[0]*(z=p[b[1]])[0]+M[1]*z[1]+M[2]*z[2]);var M,z;return I.concat(C)});return new Yo(p,v)}}class Qo{constructor(e,s){this.min=e,this.max=s,this.center=function(l,u,p){return l[0]=.5*u[0],l[1]=.5*u[1],l[2]=.5*u[2],l}([],function(l,u,p){return l[0]=u[0]+p[0],l[1]=u[1]+p[1],l[2]=u[2]+p[2],l}([],this.min,this.max))}quadrant(e){const s=[e%2==0,e<2],l=je(this.min),u=je(this.max);for(let p=0;p<s.length;p++)l[p]=s[p]?this.min[p]:this.center[p],u[p]=s[p]?this.center[p]:this.max[p];return u[2]=this.max[2],new Qo(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let l=!0;for(let u=0;u<e.planes.length;u++){const p=e.planes[u];let v=0;for(let b=0;b<s.length;b++)d.b2(p,s[b])>=0&&v++;if(v===0)return 0;v!==s.length&&(l=!1)}if(l)return 2;for(let u=0;u<3;u++){let p=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let b=0;b<e.points.length;b++){const I=e.points[b][u]-this.min[u];p=Math.min(p,I),v=Math.max(v,I)}if(v<0||p>this.max[u]-this.min[u])return 0}return 1}}class es{constructor(e=0,s=0,l=0,u=0){if(isNaN(e)||e<0||isNaN(s)||s<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=s,this.left=l,this.right=u}interpolate(e,s,l){return s.top!=null&&e.top!=null&&(this.top=d.y.number(e.top,s.top,l)),s.bottom!=null&&e.bottom!=null&&(this.bottom=d.y.number(e.bottom,s.bottom,l)),s.left!=null&&e.left!=null&&(this.left=d.y.number(e.left,s.left,l)),s.right!=null&&e.right!=null&&(this.right=d.y.number(e.right,s.right,l)),this}getCenter(e,s){const l=d.ac((this.left+e-this.right)/2,0,e),u=d.ac((this.top+s-this.bottom)/2,0,s);return new d.P(l,u)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new es(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Mu=85.051129;class ts{constructor(e,s,l,u,p){this.tileSize=512,this._renderWorldCopies=p===void 0||!!p,this._minZoom=e||0,this._maxZoom=s||22,this._minPitch=l??0,this._maxPitch=u??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new es,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new ts(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.lngRange=e.lngRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const s=-d.b3(e,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=function(){var l=new d.A(4);return d.A!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l}(),function(l,u,p){var v=u[0],b=u[1],I=u[2],C=u[3],M=Math.sin(p),z=Math.cos(p);l[0]=v*z+I*M,l[1]=b*z+C*M,l[2]=v*-M+I*z,l[3]=b*-M+C*z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const s=d.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const s=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,s,l){this._unmodified=!1,this._edgeInsets.interpolate(e,s,l),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const s=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(e){const s=[new d.b4(0,e)];if(this._renderWorldCopies){const l=this.pointCoordinate(new d.P(0,0)),u=this.pointCoordinate(new d.P(this.width,0)),p=this.pointCoordinate(new d.P(this.width,this.height)),v=this.pointCoordinate(new d.P(0,this.height)),b=Math.floor(Math.min(l.x,u.x,p.x,v.x)),I=Math.floor(Math.max(l.x,u.x,p.x,v.x)),C=1;for(let M=b-C;M<=I+C;M++)M!==0&&s.push(new d.b4(M,e))}return s}coveringTiles(e){var s,l;let u=this.coveringZoomLevel(e);const p=u;if(e.minzoom!==void 0&&u<e.minzoom)return[];e.maxzoom!==void 0&&u>e.maxzoom&&(u=e.maxzoom);const v=this.pointCoordinate(this.getCameraPoint()),b=d.Z.fromLngLat(this.center),I=Math.pow(2,u),C=[I*v.x,I*v.y,0],M=[I*b.x,I*b.y,0],z=Yo.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,u);let F=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(F=u);const N=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,$=q=>({aabb:new Qo([q*I,0,0],[(q+1)*I,I,0]),zoom:0,x:0,y:0,wrap:q,fullyVisible:!1}),W=[],Y=[],Q=u,ie=e.reparseOverscaled?p:u;if(this._renderWorldCopies)for(let q=1;q<=3;q++)W.push($(-q)),W.push($(q));for(W.push($(0));W.length>0;){const q=W.pop(),se=q.x,ce=q.y;let fe=q.fullyVisible;if(!fe){const De=q.aabb.intersects(z);if(De===0)continue;fe=De===2}const we=e.terrain?C:M,Ce=q.aabb.distanceX(we),Be=q.aabb.distanceY(we),Ue=Math.max(Math.abs(Ce),Math.abs(Be));if(q.zoom===Q||Ue>N+(1<<Q-q.zoom)-2&&q.zoom>=F){const De=Q-q.zoom,Ae=C[0]-.5-(se<<De),Ke=C[1]-.5-(ce<<De);Y.push({tileID:new d.S(q.zoom===Q?ie:q.zoom,q.wrap,q.zoom,se,ce),distanceSq:ot([M[0]-.5-se,M[1]-.5-ce]),tileDistanceToCamera:Math.sqrt(Ae*Ae+Ke*Ke)})}else for(let De=0;De<4;De++){const Ae=(se<<1)+De%2,Ke=(ce<<1)+(De>>1),ht=q.zoom+1;let Re=q.aabb.quadrant(De);if(e.terrain){const Ne=new d.S(ht,q.wrap,ht,Ae,Ke),ut=e.terrain.getMinMaxElevation(Ne),Wt=(s=ut.minElevation)!==null&&s!==void 0?s:this.elevation,gt=(l=ut.maxElevation)!==null&&l!==void 0?l:this.elevation;Re=new Qo([Re.min[0],Re.min[1],Wt],[Re.max[0],Re.max[1],gt])}W.push({aabb:Re,zoom:ht,x:Ae,y:Ke,wrap:q.wrap,fullyVisible:fe})}}return Y.sort((q,se)=>q.distanceSq-se.distanceSq).map(q=>q.tileID)}resize(e,s){this.width=e,this.height=s,this.pixelsToGLUnits=[2/e,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const s=d.ac(e.lat,-85.051129,Mu);return new d.P(d.O(e.lng)*this.worldSize,d.Q(s)*this.worldSize)}unproject(e){return new d.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const s=this.elevation,l=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,u=this.pointLocation(this.centerPoint,e),p=e.getElevationForLngLatZoom(u,this.tileZoom);if(!(this.elevation-p))return;const v=l+s-p,b=Math.cos(this._pitch)*this.cameraToCenterDistance/v/d.b5(1,u.lat),I=this.scaleZoom(b/this.tileSize);this._elevation=p,this._center=u,this.zoom=I}setLocationAtPoint(e,s){const l=this.pointCoordinate(s),u=this.pointCoordinate(this.centerPoint),p=this.locationCoordinate(e),v=new d.Z(p.x-(l.x-u.x),p.y-(l.y-u.y));this.center=this.coordinateLocation(v),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,s){return s?this.coordinatePoint(this.locationCoordinate(e),s.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,s){return this.coordinateLocation(this.pointCoordinate(e,s))}locationCoordinate(e){return d.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,s){if(s){const F=s.pointCoordinate(e);if(F!=null)return F}const l=[e.x,e.y,0,1],u=[e.x,e.y,1,1];d.af(l,l,this.pixelMatrixInverse),d.af(u,u,this.pixelMatrixInverse);const p=l[3],v=u[3],b=l[1]/p,I=u[1]/v,C=l[2]/p,M=u[2]/v,z=C===M?0:(0-C)/(M-C);return new d.Z(d.y.number(l[0]/p,u[0]/v,z)/this.worldSize,d.y.number(b,I,z)/this.worldSize)}coordinatePoint(e,s=0,l=this.pixelMatrix){const u=[e.x*this.worldSize,e.y*this.worldSize,s,1];return d.af(u,u,l),new d.P(u[0]/u[3],u[1]/u[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return new ye().extend(this.pointLocation(new d.P(0,e))).extend(this.pointLocation(new d.P(this.width,e))).extend(this.pointLocation(new d.P(this.width,this.height))).extend(this.pointLocation(new d.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ye([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Mu])}calculateTileMatrix(e){const s=e.canonical,l=this.worldSize/this.zoomScale(s.z),u=s.x+Math.pow(2,s.z)*e.wrap,p=d.an(new Float64Array(16));return d.J(p,p,[u*l,s.y*l,0]),d.K(p,p,[l/d.X,l/d.X,1]),p}calculatePosMatrix(e,s=!1){const l=e.key,u=s?this._alignedPosMatrixCache:this._posMatrixCache;if(u[l])return u[l];const p=this.calculateTileMatrix(e);return d.L(p,s?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,p),u[l]=new Float32Array(p),u[l]}calculateFogMatrix(e){const s=e.key,l=this._fogMatrixCache;if(l[s])return l[s];const u=this.calculateTileMatrix(e);return d.L(u,this.fogMatrix,u),l[s]=new Float32Array(u),l[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,s){s=d.ac(+s,this.minZoom,this.maxZoom);const l={center:new d.N(e.lng,e.lat),zoom:s};let u=this.lngRange;if(!this._renderWorldCopies&&u===null){const q=179.9999999999;u=[-q,q]}const p=this.tileSize*this.zoomScale(l.zoom);let v=0,b=p,I=0,C=p,M=0,z=0;const{x:F,y:N}=this.size;if(this.latRange){const q=this.latRange;v=d.Q(q[1])*p,b=d.Q(q[0])*p,b-v<N&&(M=N/(b-v))}u&&(I=d.b3(d.O(u[0])*p,0,p),C=d.b3(d.O(u[1])*p,0,p),C<I&&(C+=p),C-I<F&&(z=F/(C-I)));const{x:$,y:W}=this.project.call({worldSize:p},e);let Y,Q;const ie=Math.max(z||0,M||0);if(ie){const q=new d.P(z?(C+I)/2:$,M?(b+v)/2:W);return l.center=this.unproject.call({worldSize:p},q).wrap(),l.zoom+=this.scaleZoom(ie),l}if(this.latRange){const q=N/2;W-q<v&&(Q=v+q),W+q>b&&(Q=b-q)}if(u){const q=(I+C)/2;let se=$;this._renderWorldCopies&&(se=d.b3($,q-p/2,q+p/2));const ce=F/2;se-ce<I&&(Y=I+ce),se+ce>C&&(Y=C-ce)}if(Y!==void 0||Q!==void 0){const q=new d.P(Y??$,Q??W);l.center=this.unproject.call({worldSize:p},q).wrap()}return l}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:s,zoom:l}=this.getConstrained(this.center,this.zoom);this.center=s,this.zoom=l,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,s=this.point.x,l=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=d.b5(1,this.center.lat)*this.worldSize;let u=d.an(new Float64Array(16));d.K(u,u,[this.width/2,-this.height/2,1]),d.J(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=d.an(new Float64Array(16)),d.K(u,u,[1,-1,1]),d.J(u,u,[-1,-1,0]),d.K(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u;const p=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),v=Math.min(this.elevation,this.minElevationForCurrentTile),b=p-v*this._pixelPerMeter/Math.cos(this._pitch),I=v<0?b:p,C=Math.PI/2+this._pitch,M=this._fov*(.5+e.y/this.height),z=Math.sin(M)*I/Math.sin(d.ac(Math.PI-C-M,.01,Math.PI-.01)),F=this.getHorizon(),N=2*Math.atan(F/this.cameraToCenterDistance)*(.5+e.y/(2*F)),$=Math.sin(N)*I/Math.sin(d.ac(Math.PI-C-N,.01,Math.PI-.01)),W=Math.min(z,$);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*W+I),this.nearZ=this.height/50,u=new Float64Array(16),d.b6(u,this._fov,this.width/this.height,this.nearZ,this.farZ),u[8]=2*-e.x/this.width,u[9]=2*e.y/this.height,this.projectionMatrix=d.ae(u),d.K(u,u,[1,-1,1]),d.J(u,u,[0,0,-this.cameraToCenterDistance]),d.b7(u,u,this._pitch),d.ad(u,u,this.angle),d.J(u,u,[-s,-l,0]),this.mercatorMatrix=d.K([],u,[this.worldSize,this.worldSize,this.worldSize]),d.K(u,u,[1,1,this._pixelPerMeter]),this.pixelMatrix=d.L(new Float64Array(16),this.labelPlaneMatrix,u),d.J(u,u,[0,0,-this.elevation]),this.modelViewProjectionMatrix=u,this.invModelViewProjectionMatrix=d.as([],u),this.fogMatrix=new Float64Array(16),d.b6(this.fogMatrix,this._fov,this.width/this.height,p,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,d.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),d.b7(this.fogMatrix,this.fogMatrix,this._pitch),d.ad(this.fogMatrix,this.fogMatrix,this.angle),d.J(this.fogMatrix,this.fogMatrix,[-s,-l,0]),d.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=d.L(new Float64Array(16),this.labelPlaneMatrix,u);const Y=this.width%2/2,Q=this.height%2/2,ie=Math.cos(this.angle),q=Math.sin(this.angle),se=s-Math.round(s)+ie*Y+q*Q,ce=l-Math.round(l)+ie*Q+q*Y,fe=new Float64Array(u);if(d.J(fe,fe,[se>.5?se-1:se,ce>.5?ce-1:ce,0]),this.alignedModelViewProjectionMatrix=fe,u=d.as(new Float64Array(16),this.pixelMatrix),!u)throw new Error("failed to invert matrix");this.pixelMatrixInverse=u,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new d.P(0,0)),s=[e.x*this.worldSize,e.y*this.worldSize,0,1];return d.af(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(0,e))}getCameraQueryGeometry(e){const s=this.getCameraPoint();if(e.length===1)return[e[0],s];{let l=s.x,u=s.y,p=s.x,v=s.y;for(const b of e)l=Math.min(l,b.x),u=Math.min(u,b.y),p=Math.max(p,b.x),v=Math.max(v,b.y);return[new d.P(l,u),new d.P(p,u),new d.P(p,v),new d.P(l,v),new d.P(l,u)]}}lngLatToCameraDepth(e,s){const l=this.locationCoordinate(e),u=[l.x*this.worldSize,l.y*this.worldSize,s,1];return d.af(u,u,this.modelViewProjectionMatrix),u[2]/u[3]}}function ra(f,e){let s,l=!1,u=null,p=null;const v=()=>{u=null,l&&(f.apply(p,s),u=setTimeout(v,e),l=!1)};return(...b)=>(l=!0,p=this,s=b,u||v(),u)}class tl{constructor(e){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let l;return s.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(l=u)}),(l&&l[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(s.length>=3&&!s.some(l=>isNaN(l))){const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:l,pitch:+(s[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.+)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const l=s.join("/");let u=l;u.split("&").length>0&&(u=u.split("&")[0]),this._hashName&&(u=`${this._hashName}=${l}`);let p=window.location.hash.replace(u,"");p.startsWith("#&")?p=p.slice(0,1)+p.slice(2):p==="#"&&(p="");let v=window.location.href.replace(/(#.+)?$/,p);v=v.replace("&&","&"),window.history.replaceState(window.history.state,null,v)},this._updateHash=ra(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const s=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,u),v=Math.round(s.lng*p)/p,b=Math.round(s.lat*p)/p,I=this._map.getBearing(),C=this._map.getPitch();let M="";if(M+=e?`/${v}/${b}/${l}`:`${l}/${b}/${v}`,(I||C)&&(M+="/"+Math.round(10*I)/10),C&&(M+=`/${Math.round(C)}`),this._hashName){const z=this._hashName;let F=!1;const N=window.location.hash.slice(1).split("&").map($=>{const W=$.split("=")[0];return W===z?(F=!0,`${W}=${M}`):$}).filter($=>$);return F||N.push(`${z}=${M}`),`#${N.join("&")}`}return`#${M}`}}const il={linearity:.3,easing:d.b8(0,0,.3,1)},zu=d.e({deceleration:2500,maxSpeed:1400},il),Kp=d.e({deceleration:20,maxSpeed:1400},il),Ah=d.e({deceleration:1e3,maxSpeed:360},il),nl=d.e({deceleration:1e3,maxSpeed:90},il);class Au{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:X.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,s=X.now();for(;e.length>0&&s-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)s.zoom+=p.zoomDelta||0,s.bearing+=p.bearingDelta||0,s.pitch+=p.pitchDelta||0,p.panDelta&&s.pan._add(p.panDelta),p.around&&(s.around=p.around),p.pinchAround&&(s.pinchAround=p.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(s.pan.mag()){const p=sa(s.pan.mag(),l,d.e({},zu,e||{}));u.offset=s.pan.mult(p.amount/s.pan.mag()),u.center=this._map.transform.center,oa(u,p)}if(s.zoom){const p=sa(s.zoom,l,Kp);u.zoom=this._map.transform.zoom+p.amount,oa(u,p)}if(s.bearing){const p=sa(s.bearing,l,Ah);u.bearing=this._map.transform.bearing+d.ac(p.amount,-179,179),oa(u,p)}if(s.pitch){const p=sa(s.pitch,l,nl);u.pitch=this._map.transform.pitch+p.amount,oa(u,p)}if(u.zoom||u.bearing){const p=s.pinchAround===void 0?s.around:s.pinchAround;u.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),d.e(u,{noMoveStart:!0})}}function oa(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function sa(f,e,s){const{maxSpeed:l,linearity:u,deceleration:p}=s,v=d.ac(f*u/(e/1e3),-l,l),b=Math.abs(v)/(p*u);return{easing:s.easing,duration:1e3*b,amount:v*(b/2)}}class Ri extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,l,u={}){const p=Z.mousePos(s.getCanvas(),l),v=s.unproject(p);super(e,d.e({point:p,lngLat:v,originalEvent:l},u)),this._defaultPrevented=!1,this.target=s}}class wo extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,l){const u=e==="touchend"?l.changedTouches:l.touches,p=Z.touchPos(s.getCanvasContainer(),u),v=p.map(I=>s.unproject(I)),b=p.reduce((I,C,M,z)=>I.add(C.div(z.length)),new d.P(0,0));super(e,{points:p,point:b,lngLats:v,lngLat:s.unproject(b),originalEvent:l}),this._defaultPrevented=!1}}class Dh extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class Lh{constructor(e,s){this._map=e,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Dh(e.type,this._map,e))}mousedown(e,s){return this._mousedownPos=s,this._firePreventable(new Ri(e.type,this._map,e))}mouseup(e){this._map.fire(new Ri(e.type,this._map,e))}click(e,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Ri(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ri(e.type,this._map,e))}mouseover(e){this._map.fire(new Ri(e.type,this._map,e))}mouseout(e){this._map.fire(new Ri(e.type,this._map,e))}touchstart(e){return this._firePreventable(new wo(e.type,this._map,e))}touchmove(e){this._map.fire(new wo(e.type,this._map,e))}touchend(e){this._map.fire(new wo(e.type,this._map,e))}touchcancel(e){this._map.fire(new wo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ai{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ri(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ri("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ri(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Kn{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(d.P.convert(e),this._map.terrain)}}class xn{constructor(e,s){this._map=e,this._tr=new Kn(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,s){this.isEnabled()&&e.shiftKey&&e.button===0&&(Z.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(e,s){if(!this._active)return;const l=s;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const u=this._startPos;this._lastPos=l,this._box||(this._box=Z.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const p=Math.min(u.x,l.x),v=Math.max(u.x,l.x),b=Math.min(u.y,l.y),I=Math.max(u.y,l.y);Z.setTransform(this._box,`translate(${p}px,${b}px)`),this._box.style.width=v-p+"px",this._box.style.height=I-b+"px"}mouseupWindow(e,s){if(!this._active||e.button!==0)return;const l=this._startPos,u=s;if(this.reset(),Z.suppressClick(),l.x!==u.x||l.y!==u.y)return this._map.fire(new d.k("boxzoomend",{originalEvent:e})),{cameraAnimation:p=>p.fitScreenCoordinates(l,u,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(Z.remove(this._box),this._box=null),Z.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,s){return this._map.fire(new d.k(e,{originalEvent:s}))}}function aa(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const s={};for(let l=0;l<f.length;l++)s[f[l].identifier]=e[l];return s}class Du{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,s,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const p=new d.P(0,0);for(const v of u)p._add(v);return p.div(u.length)}(s),this.touches=aa(l,s)))}touchmove(e,s,l){if(this.aborted||!this.centroid)return;const u=aa(l,s);for(const p in this.touches){const v=u[p];(!v||v.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(e,s,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class rl{constructor(e){this.singleTap=new Du(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,s,l){this.singleTap.touchstart(e,s,l)}touchmove(e,s,l){this.singleTap.touchmove(e,s,l)}touchend(e,s,l){const u=this.singleTap.touchend(e,s,l);if(u){const p=e.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(u)<30;if(p&&v||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class is{constructor(e){this._tr=new Kn(e),this._zoomIn=new rl({numTouches:1,numTaps:2}),this._zoomOut=new rl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,s,l){this._zoomIn.touchstart(e,s,l),this._zoomOut.touchstart(e,s,l)}touchmove(e,s,l){this._zoomIn.touchmove(e,s,l),this._zoomOut.touchmove(e,s,l)}touchend(e,s,l){const u=this._zoomIn.touchend(e,s,l),p=this._zoomOut.touchend(e,s,l),v=this._tr;return u?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:v.zoom+1,around:v.unproject(u)},{originalEvent:e})}):p?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:v.zoom-1,around:v.unproject(p)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dr{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const s=this._moveFunction(...e);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(e,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,s){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const u=s.length?s[0]:s;return!this._moved&&u.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=u,this._move(l,u))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&Z.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Lu={0:1,2:2};class ol{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const s=Z.mouseButton(e);this._eventButton=s}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(s,l){const u=Lu[l];return s.buttons===void 0||(s.buttons&u)!==u}(e,this._eventButton)}isValidEndEvent(e){return Z.mouseButton(e)===this._eventButton}}class Ru{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const sl=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}},Fu=({enable:f,clickTolerance:e,bearingDegreesPerPixelMoved:s=.8})=>{const l=new ol({checkCorrectEvent:u=>Z.mouseButton(u)===0&&u.ctrlKey||Z.mouseButton(u)===2});return new Dr({clickTolerance:e,move:(u,p)=>({bearingDelta:(p.x-u.x)*s}),moveStateManager:l,enable:f,assignEvents:sl})},Bu=({enable:f,clickTolerance:e,pitchDegreesPerPixelMoved:s=-.5})=>{const l=new ol({checkCorrectEvent:u=>Z.mouseButton(u)===0&&u.ctrlKey||Z.mouseButton(u)===2});return new Dr({clickTolerance:e,move:(u,p)=>({pitchDelta:(p.y-u.y)*s}),moveStateManager:l,enable:f,assignEvents:sl})};class bo{constructor(e,s){this._clickTolerance=e.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,s,l){return this._calculateTransform(e,s,l)}touchmove(e,s,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,s,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,s,l){this._calculateTransform(e,s,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,s,l){l.length>0&&(this._active=!0);const u=aa(l,s),p=new d.P(0,0),v=new d.P(0,0);let b=0;for(const C in u){const M=u[C],z=this._touches[C];z&&(p._add(M),v._add(M.sub(z)),b++,u[C]=M)}if(this._touches=u,this._shouldBePrevented(b)||!v.mag())return;const I=v.div(b);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(b),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class al{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,s,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([s[0],s[1]]))}touchmove(e,s,l){if(!this._firstTwoTouches)return;e.preventDefault();const[u,p]=this._firstTwoTouches,v=la(l,s,u),b=la(l,s,p);if(!v||!b)return;const I=this._aroundCenter?null:v.add(b).div(2);return this._move([v,b],I,e)}touchend(e,s,l){if(!this._firstTwoTouches)return;const[u,p]=this._firstTwoTouches,v=la(l,s,u),b=la(l,s,p);v&&b||(this._active&&Z.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function la(f,e,s){for(let l=0;l<f.length;l++)if(f[l].identifier===s)return e[l]}function ju(f,e){return Math.log(f/e)/Math.LN2}class Ou extends al{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,s){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(ju(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ju(this._distance,l),pinchAround:s}}}function Nu(f,e){return 180*f.angleWith(e)/Math.PI}class Vu extends al{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,s,l){const u=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Nu(this._vector,u),pinchAround:s}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const s=25/(Math.PI*this._minDiameter)*360,l=Nu(e,this._startVector);return Math.abs(l)<s}}function ll(f){return Math.abs(f.y)>Math.abs(f.x)}class ns extends al{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,s,l){super.touchstart(e,s,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,ll(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,s,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const u=e[0].sub(this._lastPoints[0]),p=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(u,p,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+p.y)/2*-.5}):void 0}gestureBeginsVertically(e,s,l){if(this._valid!==void 0)return this._valid;const u=e.mag()>=2,p=s.mag()>=2;if(!u&&!p)return;if(!u||!p)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const v=e.y>0==s.y>0;return ll(e)&&ll(s)&&v}}const Rh={panStep:100,bearingStep:15,pitchStep:10};class An{constructor(e){this._tr=new Kn(e);const s=Rh;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let s=0,l=0,u=0,p=0,v=0;switch(e.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),p=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),p=1);break;case 38:e.shiftKey?u=1:(e.preventDefault(),v=-1);break;case 40:e.shiftKey?u=-1:(e.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:b=>{const I=this._tr;b.easeTo({duration:300,easeId:"keyboardHandler",easing:_r,zoom:s?Math.round(I.zoom)+s*(e.shiftKey?2:1):I.zoom,bearing:I.bearing+l*this._bearingStep,pitch:I.pitch+u*this._pitchStep,offset:[-p*this._panStep,-v*this._panStep],center:I.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _r(f){return f*(2-f)}const Uu=4.000244140625;class Jn{constructor(e,s){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Kn(e),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let s=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=X.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,s!==0&&s%Uu==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(u*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),e.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=e,this._delta-=s,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=Z.mousePos(this._map.getCanvas(),e),l=this._tr;this._around=s.y>l.transform.height/2-l.transform.getHorizon()?d.N.convert(this._aroundCenter?l.center:l.unproject(s)):d.N.convert(l.center),this._aroundPoint=l.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>Uu?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&C!==0&&(C=1/C);const M=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(M*C))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,l=this._startZoom,u=this._easing;let p,v=!1;const b=X.now()-this._lastWheelEventTime;if(this._type==="wheel"&&l&&u&&b){const I=Math.min(b/200,1),C=u(I);p=d.y.number(l,s,C),I<1?this._frameId||(this._frameId=!0):v=!0}else p=s,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!v,zoomDelta:p-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let s=d.b9;if(this._prevEase){const l=this._prevEase,u=(X.now()-l.start)/l.duration,p=l.easing(u+.01)-l.easing(u),v=.27/Math.sqrt(p*p+1e-4)*.01,b=Math.sqrt(.0729-v*v);s=d.b8(v,b,.25,1)}return this._prevEase={start:X.now(),duration:e,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class So{constructor(e,s){this._clickZoom=e,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Jp{constructor(e){this._tr=new Kn(e),this.reset()}reset(){this._active=!1}dblclick(e,s){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yp{constructor(){this._tap=new rl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,s,l){if(!this._swipePoint)if(this._tapTime){const u=s[0],p=e.timeStamp-this._tapTime<500,v=this._tapPoint.dist(u)<30;p&&v?l.length>0&&(this._swipePoint=u,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,s,l)}touchmove(e,s,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=s[0],p=u.y-this._swipePoint.y;return this._swipePoint=u,e.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(e,s,l)}touchend(e,s,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const u=this._tap.touchend(e,s,l);u&&(this._tapTime=e.timeStamp,this._tapPoint=u)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fh{constructor(e,s,l){this._el=e,this._mousePan=s,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Bh{constructor(e,s,l){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=s,this._mousePitch=l}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class $u{constructor(e,s,l,u){this._el=e,this._touchZoom=s,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class rs{constructor(e,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=Z.create("div","maplibregl-cooperative-gesture-screen",e);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),u=document.createElement("div");u.className="maplibregl-desktop-message",u.textContent=s,this._container.appendChild(u);const p=document.createElement("div");p.className="maplibregl-mobile-message",p.textContent=l,this._container.appendChild(p),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(Z.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,s){this._enabled&&(this._map.fire(new d.k("cooperativegestureprevented",{gestureType:e,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Dn=f=>f.zoom||f.drag||f.pitch||f.rotate;class qe extends d.k{}function ul(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Zu{constructor(e,s){this.handleWindowEvent=u=>{this.handleEvent(u,`${u.type}Window`)},this.handleEvent=(u,p)=>{if(u.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const v=u.type==="renderFrame"?void 0:u,b={needsRenderFrame:!1},I={},C={},M=u.touches,z=M?this._getMapTouches(M):void 0,F=z?Z.touchPos(this._map.getCanvas(),z):Z.mousePos(this._map.getCanvas(),u);for(const{handlerName:W,handler:Y,allowed:Q}of this._handlers){if(!Y.isEnabled())continue;let ie;this._blockedByActive(C,Q,W)?Y.reset():Y[p||u.type]&&(ie=Y[p||u.type](u,F,z),this.mergeHandlerResult(b,I,ie,W,v),ie&&ie.needsRenderFrame&&this._triggerRenderFrame()),(ie||Y.isActive())&&(C[W]=Y)}const N={};for(const W in this._previousActiveHandlers)C[W]||(N[W]=v);this._previousActiveHandlers=C,(Object.keys(N).length||ul(b))&&(this._changes.push([b,I,N]),this._triggerRenderFrame()),(Object.keys(C).length||ul(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=b;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Au(e),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[u,p,v]of this._listeners)Z.addEventListener(u,p,u===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(const[e,s,l]of this._listeners)Z.removeEventListener(e,s,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const s=this._map,l=s.getCanvasContainer();this._add("mapEvent",new Lh(s,e));const u=s.boxZoom=new xn(s,e);this._add("boxZoom",u),e.interactive&&e.boxZoom&&u.enable();const p=s.cooperativeGestures=new rs(s,e.cooperativeGestures);this._add("cooperativeGestures",p),e.cooperativeGestures&&p.enable();const v=new is(s),b=new Jp(s);s.doubleClickZoom=new So(b,v),this._add("tapZoom",v),this._add("clickZoom",b),e.interactive&&e.doubleClickZoom&&s.doubleClickZoom.enable();const I=new Yp;this._add("tapDragZoom",I);const C=s.touchPitch=new ns(s);this._add("touchPitch",C),e.interactive&&e.touchPitch&&s.touchPitch.enable(e.touchPitch);const M=Fu(e),z=Bu(e);s.dragRotate=new Bh(e,M,z),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]),e.interactive&&e.dragRotate&&s.dragRotate.enable();const F=(({enable:ie,clickTolerance:q})=>{const se=new ol({checkCorrectEvent:ce=>Z.mouseButton(ce)===0&&!ce.ctrlKey});return new Dr({clickTolerance:q,move:(ce,fe)=>({around:fe,panDelta:fe.sub(ce)}),activateOnStart:!0,moveStateManager:se,enable:ie,assignEvents:sl})})(e),N=new bo(e,s);s.dragPan=new Fh(l,F,N),this._add("mousePan",F),this._add("touchPan",N,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&s.dragPan.enable(e.dragPan);const $=new Vu,W=new Ou;s.touchZoomRotate=new $u(l,W,$,I),this._add("touchRotate",$,["touchPan","touchZoom"]),this._add("touchZoom",W,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&s.touchZoomRotate.enable(e.touchZoomRotate);const Y=s.scrollZoom=new Jn(s,()=>this._triggerRenderFrame());this._add("scrollZoom",Y,["mousePan"]),e.interactive&&e.scrollZoom&&s.scrollZoom.enable(e.scrollZoom);const Q=s.keyboard=new An(s);this._add("keyboard",Q),e.interactive&&e.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new ai(s))}_add(e,s,l){this._handlers.push({handlerName:e,handler:s,allowed:l}),this._handlersById[e]=s}stop(e){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Dn(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,s,l){for(const u in e)if(u!==l&&(!s||s.indexOf(u)<0))return!0;return!1}_getMapTouches(e){const s=[];for(const l of e)this._el.contains(l.target)&&s.push(l);return s}mergeHandlerResult(e,s,l,u,p){if(!l)return;d.e(e,l);const v={handlerName:u,originalEvent:l.originalEvent||p};l.zoomDelta!==void 0&&(s.zoom=v),l.panDelta!==void 0&&(s.drag=v),l.pitchDelta!==void 0&&(s.pitch=v),l.bearingDelta!==void 0&&(s.rotate=v)}_applyChanges(){const e={},s={},l={};for(const[u,p,v]of this._changes)u.panDelta&&(e.panDelta=(e.panDelta||new d.P(0,0))._add(u.panDelta)),u.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+u.pitchDelta),u.around!==void 0&&(e.around=u.around),u.pinchAround!==void 0&&(e.pinchAround=u.pinchAround),u.noInertia&&(e.noInertia=u.noInertia),d.e(s,p),d.e(l,v);this._updateMapTransform(e,s,l),this._changes=[]}_updateMapTransform(e,s,l){const u=this._map,p=u._getTransformForUpdate(),v=u.terrain;if(!(ul(e)||v&&this._terrainMovement))return this._fireEvents(s,l,!0);let{panDelta:b,zoomDelta:I,bearingDelta:C,pitchDelta:M,around:z,pinchAround:F}=e;F!==void 0&&(z=F),u._stop(!0),z=z||u.transform.centerPoint;const N=p.pointLocation(b?z.sub(b):z);C&&(p.bearing+=C),M&&(p.pitch+=M),I&&(p.zoom+=I),v?this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?p.center=p.pointLocation(p.centerPoint.sub(b)):p.setLocationAtPoint(N,z):(this._terrainMovement=!0,this._map._elevationFreeze=!0,p.setLocationAtPoint(N,z)):p.setLocationAtPoint(N,z),u._applyUpdatedTransform(p),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(s,l,!0)}_fireEvents(e,s,l){const u=Dn(this._eventsInProgress),p=Dn(e),v={};for(const z in e){const{originalEvent:F}=e[z];this._eventsInProgress[z]||(v[`${z}start`]=F),this._eventsInProgress[z]=e[z]}!u&&p&&this._fireEvent("movestart",p.originalEvent);for(const z in v)this._fireEvent(z,v[z]);p&&this._fireEvent("move",p.originalEvent);for(const z in e){const{originalEvent:F}=e[z];this._fireEvent(z,F)}const b={};let I;for(const z in this._eventsInProgress){const{handlerName:F,originalEvent:N}=this._eventsInProgress[z];this._handlersById[F].isActive()||(delete this._eventsInProgress[z],I=s[F]||N,b[`${z}end`]=I)}for(const z in b)this._fireEvent(z,b[z]);const C=Dn(this._eventsInProgress),M=(u||p)&&!C;if(M&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const z=this._map._getTransformForUpdate();z.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(z)}if(l&&M){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),F=N=>N!==0&&-this._bearingSnap<N&&N<this._bearingSnap;!z||!z.essential&&X.prefersReducedMotion?(this._map.fire(new d.k("moveend",{originalEvent:I})),F(this._map.getBearing())&&this._map.resetNorth()):(F(z.bearing||this._map.getBearing())&&(z.bearing=0),z.freezeElevation=!0,this._map.easeTo(z,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(e,s){this._map.fire(new d.k(e,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new qe("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class jh extends d.E{constructor(e,s){super(),this._renderFrameCallback=()=>{const l=Math.min((X.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=s.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new d.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,s){return this.jumpTo({center:e},s)}panBy(e,s,l){return e=d.P.convert(e).mult(-1),this.panTo(this.transform.center,d.e({offset:e},s),l)}panTo(e,s,l){return this.easeTo(d.e({center:e},s),l)}getZoom(){return this.transform.zoom}setZoom(e,s){return this.jumpTo({zoom:e},s),this}zoomTo(e,s,l){return this.easeTo(d.e({zoom:e},s),l)}zoomIn(e,s){return this.zoomTo(this.getZoom()+1,e,s),this}zoomOut(e,s){return this.zoomTo(this.getZoom()-1,e,s),this}getBearing(){return this.transform.bearing}setBearing(e,s){return this.jumpTo({bearing:e},s),this}getPadding(){return this.transform.padding}setPadding(e,s){return this.jumpTo({padding:e},s),this}rotateTo(e,s,l){return this.easeTo(d.e({bearing:e},s),l)}resetNorth(e,s){return this.rotateTo(0,d.e({duration:1e3},e),s),this}resetNorthPitch(e,s){return this.easeTo(d.e({bearing:0,pitch:0,duration:1e3},e),s),this}snapToNorth(e,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,s):this}getPitch(){return this.transform.pitch}setPitch(e,s){return this.jumpTo({pitch:e},s),this}cameraForBounds(e,s){e=ye.convert(e).adjustAntiMeridian();const l=s&&s.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,s)}_cameraForBoxAndBearing(e,s,l,u){const p={top:0,bottom:0,right:0,left:0};if(typeof(u=d.e({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const De=u.padding;u.padding={top:De,bottom:De,right:De,left:De}}u.padding=d.e(p,u.padding);const v=this.transform,b=v.padding,I=new ye(e,s),C=v.project(I.getNorthWest()),M=v.project(I.getNorthEast()),z=v.project(I.getSouthEast()),F=v.project(I.getSouthWest()),N=d.ba(-l),$=C.rotate(N),W=M.rotate(N),Y=z.rotate(N),Q=F.rotate(N),ie=new d.P(Math.max($.x,W.x,Q.x,Y.x),Math.max($.y,W.y,Q.y,Y.y)),q=new d.P(Math.min($.x,W.x,Q.x,Y.x),Math.min($.y,W.y,Q.y,Y.y)),se=ie.sub(q),ce=(v.width-(b.left+b.right+u.padding.left+u.padding.right))/se.x,fe=(v.height-(b.top+b.bottom+u.padding.top+u.padding.bottom))/se.y;if(fe<0||ce<0)return void d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const we=Math.min(v.scaleZoom(v.scale*Math.min(ce,fe)),u.maxZoom),Ce=d.P.convert(u.offset),Be=new d.P((u.padding.left-u.padding.right)/2,(u.padding.top-u.padding.bottom)/2).rotate(d.ba(l)),Ue=Ce.add(Be).mult(v.scale/v.zoomScale(we));return{center:v.unproject(C.add(z).div(2).sub(Ue)),zoom:we,bearing:l}}fitBounds(e,s,l){return this._fitInternal(this.cameraForBounds(e,s),s,l)}fitScreenCoordinates(e,s,l,u,p){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.P.convert(e)),this.transform.pointLocation(d.P.convert(s)),l,u),u,p)}_fitInternal(e,s,l){return e?(delete(s=d.e(e,s)).padding,s.linear?this.easeTo(s,l):this.flyTo(s,l)):this}jumpTo(e,s){this.stop();const l=this._getTransformForUpdate();let u=!1,p=!1,v=!1;return"zoom"in e&&l.zoom!==+e.zoom&&(u=!0,l.zoom=+e.zoom),e.center!==void 0&&(l.center=d.N.convert(e.center)),"bearing"in e&&l.bearing!==+e.bearing&&(p=!0,l.bearing=+e.bearing),"pitch"in e&&l.pitch!==+e.pitch&&(v=!0,l.pitch=+e.pitch),e.padding==null||l.isPaddingEqual(e.padding)||(l.padding=e.padding),this._applyUpdatedTransform(l),this.fire(new d.k("movestart",s)).fire(new d.k("move",s)),u&&this.fire(new d.k("zoomstart",s)).fire(new d.k("zoom",s)).fire(new d.k("zoomend",s)),p&&this.fire(new d.k("rotatestart",s)).fire(new d.k("rotate",s)).fire(new d.k("rotateend",s)),v&&this.fire(new d.k("pitchstart",s)).fire(new d.k("pitch",s)).fire(new d.k("pitchend",s)),this.fire(new d.k("moveend",s))}calculateCameraOptionsFromTo(e,s,l,u=0){const p=d.Z.fromLngLat(e,s),v=d.Z.fromLngLat(l,u),b=v.x-p.x,I=v.y-p.y,C=v.z-p.z,M=Math.hypot(b,I,C);if(M===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(b,I),F=this.transform.scaleZoom(this.transform.cameraToCenterDistance/M/this.transform.tileSize),N=180*Math.atan2(b,-I)/Math.PI;let $=180*Math.acos(z/M)/Math.PI;return $=C<0?90-$:90+$,{center:v.toLngLat(),zoom:F,pitch:$,bearing:N}}easeTo(e,s){var l;this._stop(!1,e.easeId),((e=d.e({offset:[0,0],duration:500,easing:d.b9},e)).animate===!1||!e.essential&&X.prefersReducedMotion)&&(e.duration=0);const u=this._getTransformForUpdate(),p=u.zoom,v=u.bearing,b=u.pitch,I=u.padding,C="bearing"in e?this._normalizeBearing(e.bearing,v):v,M="pitch"in e?+e.pitch:b,z="padding"in e?e.padding:u.padding,F=d.P.convert(e.offset);let N=u.centerPoint.add(F);const $=u.pointLocation(N),{center:W,zoom:Y}=u.getConstrained(d.N.convert(e.center||$),(l=e.zoom)!==null&&l!==void 0?l:p);this._normalizeCenter(W,u);const Q=u.project($),ie=u.project(W).sub(Q),q=u.zoomScale(Y-p);let se,ce;e.around&&(se=d.N.convert(e.around),ce=u.locationPoint(se));const fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Y!==p,this._rotating=this._rotating||v!==C,this._pitching=this._pitching||M!==b,this._padding=!u.isPaddingEqual(z),this._easeId=e.easeId,this._prepareEase(s,e.noMoveStart,fe),this.terrain&&this._prepareElevation(W),this._ease(we=>{if(this._zooming&&(u.zoom=d.y.number(p,Y,we)),this._rotating&&(u.bearing=d.y.number(v,C,we)),this._pitching&&(u.pitch=d.y.number(b,M,we)),this._padding&&(u.interpolatePadding(I,z,we),N=u.centerPoint.add(F)),this.terrain&&!e.freezeElevation&&this._updateElevation(we),se)u.setLocationAtPoint(se,ce);else{const Ce=u.zoomScale(u.zoom-p),Be=Y>p?Math.min(2,q):Math.max(.5,q),Ue=Math.pow(Be,1-we),De=u.unproject(Q.add(ie.mult(we*Ue)).mult(Ce));u.setLocationAtPoint(u.renderWorldCopies?De.wrap():De,N)}this._applyUpdatedTransform(u),this._fireMoveEvents(s)},we=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s,we)},e),this}_prepareEase(e,s,l={}){this._moving=!0,s||l.moving||this.fire(new d.k("movestart",e)),this._zooming&&!l.zooming&&this.fire(new d.k("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new d.k("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new d.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&s!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(s-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=s}this.transform.elevation=d.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){const s=e.getCameraPosition(),l=this.terrain.getElevationForLngLatZoom(s.lngLat,e.zoom);if(s.altitude<l){const u=this.calculateCameraOptionsFromTo(s.lngLat,l,e.center,e.elevation);return{pitch:u.pitch,zoom:u.zoom}}return{}}_applyUpdatedTransform(e){const s=[];if(this.terrain&&s.push(u=>this._elevateCameraIfInsideTerrain(u)),this.transformCameraUpdate&&s.push(u=>this.transformCameraUpdate(u)),!s.length)return;const l=e.clone();for(const u of s){const p=l.clone(),{center:v,zoom:b,pitch:I,bearing:C,elevation:M}=u(p);v&&(p.center=v),b!==void 0&&(p.zoom=b),I!==void 0&&(p.pitch=I),C!==void 0&&(p.bearing=C),M!==void 0&&(p.elevation=M),l.apply(p)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new d.k("move",e)),this._zooming&&this.fire(new d.k("zoom",e)),this._rotating&&this.fire(new d.k("rotate",e)),this._pitching&&this.fire(new d.k("pitch",e))}_afterEase(e,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const l=this._zooming,u=this._rotating,p=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,l&&this.fire(new d.k("zoomend",e)),u&&this.fire(new d.k("rotateend",e)),p&&this.fire(new d.k("pitchend",e)),this.fire(new d.k("moveend",e))}flyTo(e,s){var l;if(!e.essential&&X.prefersReducedMotion){const Ne=d.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ne,s)}this.stop(),e=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.b9},e);const u=this._getTransformForUpdate(),p=u.zoom,v=u.bearing,b=u.pitch,I=u.padding,C="bearing"in e?this._normalizeBearing(e.bearing,v):v,M="pitch"in e?+e.pitch:b,z="padding"in e?e.padding:u.padding,F=d.P.convert(e.offset);let N=u.centerPoint.add(F);const $=u.pointLocation(N),{center:W,zoom:Y}=u.getConstrained(d.N.convert(e.center||$),(l=e.zoom)!==null&&l!==void 0?l:p);this._normalizeCenter(W,u);const Q=u.zoomScale(Y-p),ie=u.project($),q=u.project(W).sub(ie);let se=e.curve;const ce=Math.max(u.width,u.height),fe=ce/Q,we=q.mag();if("minZoom"in e){const Ne=d.ac(Math.min(e.minZoom,p,Y),u.minZoom,u.maxZoom),ut=ce/u.zoomScale(Ne-p);se=Math.sqrt(ut/we*2)}const Ce=se*se;function Be(Ne){const ut=(fe*fe-ce*ce+(Ne?-1:1)*Ce*Ce*we*we)/(2*(Ne?fe:ce)*Ce*we);return Math.log(Math.sqrt(ut*ut+1)-ut)}function Ue(Ne){return(Math.exp(Ne)-Math.exp(-Ne))/2}function De(Ne){return(Math.exp(Ne)+Math.exp(-Ne))/2}const Ae=Be(!1);let Ke=function(Ne){return De(Ae)/De(Ae+se*Ne)},ht=function(Ne){return ce*((De(Ae)*(Ue(ut=Ae+se*Ne)/De(ut))-Ue(Ae))/Ce)/we;var ut},Re=(Be(!0)-Ae)/se;if(Math.abs(we)<1e-6||!isFinite(Re)){if(Math.abs(ce-fe)<1e-6)return this.easeTo(e,s);const Ne=fe<ce?-1:1;Re=Math.abs(Math.log(fe/ce))/se,ht=()=>0,Ke=ut=>Math.exp(Ne*se*ut)}return e.duration="duration"in e?+e.duration:1e3*Re/("screenSpeed"in e?+e.screenSpeed/se:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=v!==C,this._pitching=M!==b,this._padding=!u.isPaddingEqual(z),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(W),this._ease(Ne=>{const ut=Ne*Re,Wt=1/Ke(ut);u.zoom=Ne===1?Y:p+u.scaleZoom(Wt),this._rotating&&(u.bearing=d.y.number(v,C,Ne)),this._pitching&&(u.pitch=d.y.number(b,M,Ne)),this._padding&&(u.interpolatePadding(I,z,Ne),N=u.centerPoint.add(F)),this.terrain&&!e.freezeElevation&&this._updateElevation(Ne);const gt=Ne===1?W:u.unproject(ie.add(q.mult(ht(ut))).mult(Wt));u.setLocationAtPoint(u.renderWorldCopies?gt.wrap():gt,N),this._applyUpdatedTransform(u),this._fireMoveEvents(s)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,s){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,s)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,s,l){l.animate===!1||l.duration===0?(e(1),s()):(this._easeStart=X.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,s){e=d.b3(e,-180,180);const l=Math.abs(e-s);return Math.abs(e-360-s)<l&&(e-=360),Math.abs(e+360-s)<l&&(e+=360),e}_normalizeCenter(e,s){if(!s.renderWorldCopies||s.lngRange)return;const l=e.lng-s.center.lng;e.lng+=l>180?-360:l<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(d.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const os={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ss{constructor(e=os){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=Z.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=Z.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Z.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Z.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,s){const l=this._map._getUIString(`AttributionControl.${s}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(u=>typeof u!="string"?"":u)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const s=this._map.style.sourceCaches;for(const u in s){const p=s[u];if(p.used||p.usedForTerrain){const v=p.getSource();v.attribution&&e.indexOf(v.attribution)<0&&e.push(v.attribution)}}e=e.filter(u=>String(u).trim()),e.sort((u,p)=>u.length-p.length),e=e.filter((u,p)=>{for(let v=p+1;v<e.length;v++)if(e[v].indexOf(u)>=0)return!1;return!0});const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class qu{constructor(e={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const l=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=Z.create("div","maplibregl-ctrl");const s=Z.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Z.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Tt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const s=++this._id;return this._queue.push({callback:e,id:s,cancelled:!1}),s}remove(e){const s=this._currentlyRunning,l=s?this._queue.concat(s):this._queue;for(const u of l)if(u.id===e)return void(u.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const l of s)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Gu=d.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Qp extends d.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,s){this.sourceCache.update(e,s),this._renderableTilesKeys=[];const l={};for(const u of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))l[u.key]=!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.posMatrix=new Float64Array(16),d.aP(u.posMatrix,0,d.X,0,d.X,0,1),this._tiles[u.key]=new Hr(u,this.tileSize));for(const u in this._tiles)l[u]||delete this._tiles[u]}freeRtt(e){for(const s in this._tiles){const l=this._tiles[s];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const s={};for(const l of this._renderableTilesKeys){const u=this._tiles[l].tileID;if(u.canonical.equals(e.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16),d.aP(p.posMatrix,0,d.X,0,d.X,0,1),s[l]=p}else if(u.canonical.isChildOf(e.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16);const v=u.canonical.z-e.canonical.z,b=u.canonical.x-(u.canonical.x>>v<<v),I=u.canonical.y-(u.canonical.y>>v<<v),C=d.X>>v;d.aP(p.posMatrix,0,C,0,C,0,1),d.J(p.posMatrix,p.posMatrix,[-b*C,-I*C,0]),s[l]=p}else if(e.canonical.isChildOf(u.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16);const v=e.canonical.z-u.canonical.z,b=e.canonical.x-(e.canonical.x>>v<<v),I=e.canonical.y-(e.canonical.y>>v<<v),C=d.X>>v;d.aP(p.posMatrix,0,d.X,0,d.X,0,1),d.J(p.posMatrix,p.posMatrix,[b*C,I*C,0]),d.K(p.posMatrix,p.posMatrix,[1/2**v,1/2**v,0]),s[l]=p}}return s}getSourceTile(e,s){const l=this.sourceCache._source;let u=e.overscaledZ-this.deltaZoom;if(u>l.maxzoom&&(u=l.maxzoom),u<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(u).key);let p=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!p||!p.dem)&&s)for(;u>=l.minzoom&&(!p||!p.dem);)p=this.sourceCache.getTileByID(e.scaledTo(u--).key);return p}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(s=>s.timeAdded>=e)}}class Hu{constructor(e,s,l){this.painter=e,this.sourceCache=new Qp(s),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,s,l,u=d.X){var p;if(!(s>=0&&s<u&&l>=0&&l<u))return 0;const v=this.getTerrainData(e),b=(p=v.tile)===null||p===void 0?void 0:p.dem;if(!b)return 0;const I=function($,W,Y){var Q=W[0],ie=W[1];return $[0]=Y[0]*Q+Y[4]*ie+Y[12],$[1]=Y[1]*Q+Y[5]*ie+Y[13],$}([],[s/u*d.X,l/u*d.X],v.u_terrain_matrix),C=[I[0]*b.dim,I[1]*b.dim],M=Math.floor(C[0]),z=Math.floor(C[1]),F=C[0]-M,N=C[1]-z;return b.get(M,z)*(1-F)*(1-N)+b.get(M+1,z)*F*(1-N)+b.get(M,z+1)*(1-F)*N+b.get(M+1,z+1)*F*N}getElevationForLngLatZoom(e,s){if(!d.bb(s,e.wrap()))return 0;const{tileID:l,mercatorX:u,mercatorY:p}=this._getOverscaledTileIDFromLngLatZoom(e,s);return this.getElevation(l,u%d.X,p%d.X,d.X)}getElevation(e,s,l,u=d.X){return this.getDEMElevation(e,s,l,u)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const u=this.painter.context,p=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new xt(u,p,u.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new xt(u,new d.R({width:1,height:1}),u.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.an([])}const s=this.sourceCache.getSourceTile(e,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const u=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new xt(u,s.dem.getPixels(),u.gl.RGBA,{premultiply:!1}),s.demTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const l=s&&s+s.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const u=this.sourceCache.sourceCache._source.maxzoom;let p=e.canonical.z-s.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=u?p=e.canonical.z-u:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const v=e.canonical.x-(e.canonical.x>>p<<p),b=e.canonical.y-(e.canonical.y>>p<<p),I=d.bc(new Float64Array(16),[1/(d.X<<p),1/(d.X<<p),0]);d.J(I,I,[v*d.X,b*d.X,0]),this._demMatrixCache[e.key]={matrix:I,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(e){const s=this.painter,l=s.width/devicePixelRatio,u=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new xt(s.context,{width:l,height:u,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new xt(s.context,{width:l,height:u,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(l,u,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,l,u))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let p=0,v=0;p<this._coordsTextureSize;p++)for(let b=0;b<this._coordsTextureSize;b++,v+=4)s[v+0]=255&b,s[v+1]=255&p,s[v+2]=b>>8<<4|p>>8,s[v+3]=0;const l=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),u=new xt(e,l,e.gl.RGBA,{premultiply:!1});return u.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=u,u}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),l=this.painter.context,u=l.gl,p=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),v=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),b=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),u.readPixels(p,b-v-1,1,1,u.RGBA,u.UNSIGNED_BYTE,s),l.bindFramebuffer.set(null);const I=s[0]+(s[2]>>4<<8),C=s[1]+((15&s[2])<<8),M=this.coordsIndex[255-s[3]],z=M&&this.sourceCache.getTileByID(M);if(!z)return null;const F=this._coordsTextureSize,N=(1<<z.tileID.canonical.z)*F;return new d.Z((z.tileID.canonical.x*F+I)/N+z.tileID.wrap,(z.tileID.canonical.y*F+C)/N,this.getElevation(z.tileID,I,C,F))}depthAtPoint(e){const s=new Uint8Array(4),l=this.painter.context,u=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,s),l.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,s=new d.bd,l=new d.aY,u=this.meshSize,p=d.X/u,v=u*u;for(let z=0;z<=u;z++)for(let F=0;F<=u;F++)s.emplaceBack(F*p,z*p,0);for(let z=0;z<v;z+=u+1)for(let F=0;F<u;F++)l.emplaceBack(F+z,u+F+z+1,u+F+z+2),l.emplaceBack(F+z,u+F+z+2,F+z+1);const b=s.length,I=b+2*(u+1);for(const z of[0,1])for(let F=0;F<=u;F++)for(const N of[0,1])s.emplaceBack(F*p,z*d.X,N);for(let z=0;z<2*u;z+=2)l.emplaceBack(I+z,I+z+1,I+z+3),l.emplaceBack(I+z,I+z+3,I+z+2),l.emplaceBack(b+z,b+z+3,b+z+1),l.emplaceBack(b+z,b+z+2,b+z+3);const C=s.length,M=C+2*(u+1);for(const z of[0,1])for(let F=0;F<=u;F++)for(const N of[0,1])s.emplaceBack(z*d.X,F*p,N);for(let z=0;z<2*u;z+=2)l.emplaceBack(C+z,C+z+1,C+z+3),l.emplaceBack(C+z,C+z+3,C+z+2),l.emplaceBack(M+z,M+z+3,M+z+1),l.emplaceBack(M+z,M+z+2,M+z+3);return this._mesh=new Qa(e.createVertexBuffer(s,Gu.members),e.createIndexBuffer(l),d.a0.simpleSegment(0,0,s.length,l.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*d.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,s){var l;const{tileID:u}=this._getOverscaledTileIDFromLngLatZoom(e,s);return(l=this.getMinMaxElevation(u).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const s=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return s&&s.dem&&(l.minElevation=s.dem.min*this.exaggeration,l.maxElevation=s.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,s){const l=d.Z.fromLngLat(e.wrap()),u=(1<<s)*d.X,p=l.x*u,v=l.y*u,b=Math.floor(p/d.X),I=Math.floor(v/d.X);return{tileID:new d.S(s,0,s,b,I),mercatorX:p,mercatorY:v}}}class ef{constructor(e,s,l){this._context=e,this._size=s,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new xt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(l.texture),{id:e,fbo:s,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>e.id!==s),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const as={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Oh{constructor(e,s){this.painter=e,this.terrain=s,this.pool=new ef(e.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(s)),this._coordsDescendingInv={};for(const l in e.sourceCaches){this._coordsDescendingInv[l]={};const u=e.sourceCaches[l].getVisibleCoordinates();for(const p of u){const v=this.terrain.sourceCache.getTerrainCoords(p);for(const b in v)this._coordsDescendingInv[l][b]||(this._coordsDescendingInv[l][b]=[]),this._coordsDescendingInv[l][b].push(v[b])}}this._coordsDescendingInvStr={};for(const l of e._order){const u=e._layers[l],p=u.source;if(as[u.type]&&!this._coordsDescendingInvStr[p]){this._coordsDescendingInvStr[p]={};for(const v in this._coordsDescendingInv[p])this._coordsDescendingInvStr[p][v]=this._coordsDescendingInv[p][v].map(b=>b.key).sort().join()}}for(const l of this._renderableTiles)for(const u in this._coordsDescendingInvStr){const p=this._coordsDescendingInvStr[u][l.tileID.key];p&&p!==l.rttCoords[u]&&(l.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const s=e.type,l=this.painter,u=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(as[s]&&(this._prevType&&as[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(e.id),!u))return!0;if(as[this._prevType]||as[s]&&u){this._prevType=s;const p=this._stacks.length-1,v=this._stacks[p]||[];for(const b of this._renderableTiles){if(this.pool.isFull()&&(zh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(b),b.rtt[p]){const C=this.pool.getObjectForId(b.rtt[p].id);if(C.stamp===b.rtt[p].stamp){this.pool.useObject(C);continue}}const I=this.pool.getOrCreateFreeObject();this.pool.useObject(I),this.pool.stampObject(I),b.rtt[p]={id:I.id,stamp:I.stamp},l.context.bindFramebuffer.set(I.fbo.framebuffer),l.context.clear({color:d.aM.transparent,stencil:0}),l.currentStencilSource=void 0;for(let C=0;C<v.length;C++){const M=l.style._layers[v[C]],z=M.source?this._coordsDescendingInv[M.source][b.tileID.key]:[b.tileID];l.context.viewport.set([0,0,I.fbo.width,I.fbo.height]),l._renderTileClippingMasks(M,z),l.renderLayer(l,l.style.sourceCaches[M.source],M,z),M.source&&(b.rttCoords[M.source]=this._coordsDescendingInvStr[M.source][b.tileID.key])}}return zh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),as[s]}return!1}}const Wu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Nh=U,tf={hash:!1,interactive:!0,bearingSnap:7,attributionControl:os,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Xu=f=>{f.touchstart=f.dragStart,f.touchmoveWindow=f.dragMove,f.touchend=f.dragEnd},nf={showCompass:!0,showZoom:!0,visualizePitch:!1};class rf{constructor(e,s,l=!1){this.mousedown=v=>{this.startMouse(d.e({},v,{ctrlKey:!0,preventDefault:()=>v.preventDefault()}),Z.mousePos(this.element,v)),Z.addEventListener(window,"mousemove",this.mousemove),Z.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=v=>{this.moveMouse(v,Z.mousePos(this.element,v))},this.mouseup=v=>{this.mouseRotate.dragEnd(v),this.mousePitch&&this.mousePitch.dragEnd(v),this.offTemp()},this.touchstart=v=>{v.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Z.touchPos(this.element,v.targetTouches)[0],this.startTouch(v,this._startPos),Z.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),Z.addEventListener(window,"touchend",this.touchend))},this.touchmove=v=>{v.targetTouches.length!==1?this.reset():(this._lastPos=Z.touchPos(this.element,v.targetTouches)[0],this.moveTouch(v,this._lastPos))},this.touchend=v=>{v.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const u=e.dragRotate._mouseRotate.getClickTolerance(),p=e.dragRotate._mousePitch.getClickTolerance();this.element=s,this.mouseRotate=Fu({clickTolerance:u,enable:!0}),this.touchRotate=(({enable:v,clickTolerance:b,bearingDegreesPerPixelMoved:I=.8})=>{const C=new Ru;return new Dr({clickTolerance:b,move:(M,z)=>({bearingDelta:(z.x-M.x)*I}),moveStateManager:C,enable:v,assignEvents:Xu})})({clickTolerance:u,enable:!0}),this.map=e,l&&(this.mousePitch=Bu({clickTolerance:p,enable:!0}),this.touchPitch=(({enable:v,clickTolerance:b,pitchDegreesPerPixelMoved:I=-.5})=>{const C=new Ru;return new Dr({clickTolerance:b,move:(M,z)=>({pitchDelta:(z.y-M.y)*I}),moveStateManager:C,enable:v,assignEvents:Xu})})({clickTolerance:p,enable:!0})),Z.addEventListener(s,"mousedown",this.mousedown),Z.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),Z.addEventListener(s,"touchcancel",this.reset)}startMouse(e,s){this.mouseRotate.dragStart(e,s),this.mousePitch&&this.mousePitch.dragStart(e,s),Z.disableDrag()}startTouch(e,s){this.touchRotate.dragStart(e,s),this.touchPitch&&this.touchPitch.dragStart(e,s),Z.disableDrag()}moveMouse(e,s){const l=this.map,{bearingDelta:u}=this.mouseRotate.dragMove(e,s)||{};if(u&&l.setBearing(l.getBearing()+u),this.mousePitch){const{pitchDelta:p}=this.mousePitch.dragMove(e,s)||{};p&&l.setPitch(l.getPitch()+p)}}moveTouch(e,s){const l=this.map,{bearingDelta:u}=this.touchRotate.dragMove(e,s)||{};if(u&&l.setBearing(l.getBearing()+u),this.touchPitch){const{pitchDelta:p}=this.touchPitch.dragMove(e,s)||{};p&&l.setPitch(l.getPitch()+p)}}off(){const e=this.element;Z.removeEventListener(e,"mousedown",this.mousedown),Z.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),Z.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Z.removeEventListener(window,"touchend",this.touchend),Z.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){Z.enableDrag(),Z.removeEventListener(window,"mousemove",this.mousemove),Z.removeEventListener(window,"mouseup",this.mouseup),Z.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Z.removeEventListener(window,"touchend",this.touchend)}}let wn;function Ht(f,e,s){const l=new d.N(f.lng,f.lat);if(f=new d.N(f.lng,f.lat),e){const u=new d.N(f.lng-360,f.lat),p=new d.N(f.lng+360,f.lat),v=s.locationPoint(f).distSqr(e);s.locationPoint(u).distSqr(e)<v?f=u:s.locationPoint(p).distSqr(e)<v&&(f=p)}for(;Math.abs(f.lng-s.center.lng)>180;){const u=s.locationPoint(f);if(u.x>=0&&u.y>=0&&u.x<=s.width&&u.y<=s.height)break;f.lng>s.center.lng?f.lng-=360:f.lng+=360}return f.lng!==l.lng&&s.locationPoint(f).y>s.height/2-s.getHorizon()?f:l}const ls={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function cl(f,e,s){const l=f.classList;for(const u in ls)l.remove(`maplibregl-${s}-anchor-${u}`);l.add(`maplibregl-${s}-anchor-${e}`)}class hl extends d.E{constructor(e){if(super(),this._onKeyPress=s=>{const l=s.code,u=s.charCode||s.keyCode;l!=="Space"&&l!=="Enter"&&u!==32&&u!==13||this.togglePopup()},this._onMapClick=s=>{const l=s.originalEvent.target,u=this._element;this._popup&&(l===u||u.contains(l))&&this.togglePopup()},this._update=s=>{var l;if(!this._map)return;const u=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Ht(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),Z.setTransform(this._element,`${ls[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${p}`),X.frameAsync(new AbortController).then(()=>{this._updateOpacity(s&&s.type==="moveend")}).catch(()=>{})},this._onMove=s=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.k("dragstart"))),this.fire(new d.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.k("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=d.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=Z.create("div");const s=Z.createNS("http://www.w3.org/2000/svg","svg"),l=41,u=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${l}px`),s.setAttributeNS(null,"width",`${u}px`),s.setAttributeNS(null,"viewBox",`0 0 ${u} ${l}`);const p=Z.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"stroke","none"),p.setAttributeNS(null,"stroke-width","1"),p.setAttributeNS(null,"fill","none"),p.setAttributeNS(null,"fill-rule","evenodd");const v=Z.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");const b=Z.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(3.0, 29.0)"),b.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Q of I){const ie=Z.createNS("http://www.w3.org/2000/svg","ellipse");ie.setAttributeNS(null,"opacity","0.04"),ie.setAttributeNS(null,"cx","10.5"),ie.setAttributeNS(null,"cy","5.80029008"),ie.setAttributeNS(null,"rx",Q.rx),ie.setAttributeNS(null,"ry",Q.ry),b.appendChild(ie)}const C=Z.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill",this._color);const M=Z.createNS("http://www.w3.org/2000/svg","path");M.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),C.appendChild(M);const z=Z.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"opacity","0.25"),z.setAttributeNS(null,"fill","#000000");const F=Z.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),z.appendChild(F);const N=Z.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(6.0, 7.0)"),N.setAttributeNS(null,"fill","#FFFFFF");const $=Z.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(8.0, 8.0)");const W=Z.createNS("http://www.w3.org/2000/svg","circle");W.setAttributeNS(null,"fill","#000000"),W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"cx","5.5"),W.setAttributeNS(null,"cy","5.5"),W.setAttributeNS(null,"r","5.4999962");const Y=Z.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#FFFFFF"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962"),$.appendChild(W),$.appendChild(Y),v.appendChild(b),v.appendChild(C),v.appendChild(z),v.appendChild(N),v.appendChild($),s.appendChild(v),s.setAttributeNS(null,"height",l*this._scale+"px"),s.setAttributeNS(null,"width",u*this._scale+"px"),this._element.appendChild(s),this._offset=d.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()}),cl(this._element,this._anchor,"marker"),e&&e.className)for(const s of e.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Z.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=d.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const u=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var s,l;if(!(!((s=this._map)===null||s===void 0)&&s.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const u=this._map,p=u.terrain.depthAtPoint(this._pos),v=u.terrain.getElevationForLngLatZoom(this._lngLat,u.transform.tileZoom);if(u.transform.lngLatToCameraDepth(this._lngLat,v)-p<.006)return void(this._element.style.opacity=this._opacity);const b=-this._offset.y/u.transform._pixelPerMeter,I=Math.sin(u.getPitch()*Math.PI/180)*b,C=u.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),M=u.transform.lngLatToCameraDepth(this._lngLat,v+I)-C>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&M&&this._popup.remove(),this._element.style.opacity=M?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=d.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,s){return e===void 0&&s===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const Vh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ua=0,ca=!1;const vr={maxWidth:100,unit:"metric"};function ha(f,e,s){const l=s&&s.maxWidth||100,u=f._container.clientHeight/2,p=f.unproject([0,u]),v=f.unproject([l,u]),b=p.distanceTo(v);if(s&&s.unit==="imperial"){const I=3.2808*b;I>5280?Xe(e,l,I/5280,f._getUIString("ScaleControl.Miles")):Xe(e,l,I,f._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?Xe(e,l,b/1852,f._getUIString("ScaleControl.NauticalMiles")):b>=1e3?Xe(e,l,b/1e3,f._getUIString("ScaleControl.Kilometers")):Xe(e,l,b,f._getUIString("ScaleControl.Meters"))}function Xe(f,e,s,l){const u=function(p){const v=Math.pow(10,`${Math.floor(p)}`.length-1);let b=p/v;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(I){const C=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*C)/C}(b),v*b}(s);f.style.width=e*(u/s)+"px",f.innerHTML=`${u}&nbsp;${l}`}const at={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},dl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function pl(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,f),"top-left":new d.P(e,e),"top-right":new d.P(-e,e),bottom:new d.P(0,-f),"bottom-left":new d.P(e,-e),"bottom-right":new d.P(-e,-e),left:new d.P(f,0),right:new d.P(-f,0)}}if(f instanceof d.P||Array.isArray(f)){const e=d.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:d.P.convert(f.center||[0,0]),top:d.P.convert(f.top||[0,0]),"top-left":d.P.convert(f["top-left"]||[0,0]),"top-right":d.P.convert(f["top-right"]||[0,0]),bottom:d.P.convert(f.bottom||[0,0]),"bottom-left":d.P.convert(f["bottom-left"]||[0,0]),"bottom-right":d.P.convert(f["bottom-right"]||[0,0]),left:d.P.convert(f.left||[0,0]),right:d.P.convert(f.right||[0,0])}}return pl(new d.P(0,0))}const Ku=U;S.AJAXError=d.bh,S.Evented=d.E,S.LngLat=d.N,S.MercatorCoordinate=d.Z,S.Point=d.P,S.addProtocol=d.bi,S.config=d.a,S.removeProtocol=d.bj,S.AttributionControl=ss,S.BoxZoomHandler=xn,S.CanvasSource=Pn,S.CooperativeGesturesHandler=rs,S.DoubleClickZoomHandler=So,S.DragPanHandler=Fh,S.DragRotateHandler=Bh,S.EdgeInsets=es,S.FullscreenControl=class extends d.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=s==null?void 0:s.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){Z.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=Z.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);Z.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},S.GeoJSONSource=qs,S.GeolocateControl=class extends d.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new d.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const s=new d.N(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,u=this._map.getBearing(),p=d.e({bearing:u},this.options.fitBoundsOptions),v=ye.fromLngLat(s,l);this._map.fitBounds(v,p,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const s=new d.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&ca)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=Z.create("button","maplibregl-ctrl-geolocate",this._container),Z.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new hl({element:this._dotElement}),this._circleElement=Z.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new hl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.k("trackuserlocationend")),this.fire(new d.k("userlocationlostfocus")))})}},this.options=d.e({},Vh,f)}onAdd(f){return this._map=f,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return d._(this,arguments,void 0,function*(e=!1){if(wn!==void 0&&!e)return wn;if(window.navigator.permissions===void 0)return wn=!!window.navigator.geolocation,wn;try{wn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{wn=!!window.navigator.geolocation}return wn})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Z.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ua=0,ca=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),s=f.coords;return e&&(s.longitude<e.getWest()||s.longitude>e.getEast()||s.latitude<e.getSouth()||s.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),s=f.getNorthEast(),l=e.distanceTo(s),u=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ua--,ca=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.k("trackuserlocationstart")),this.fire(new d.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ua++,ua>1?(f={maximumAge:6e5,timeout:0},ca=!0):(f=this.options.positionOptions,ca=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},S.Hash=tl,S.ImageSource=Mr,S.KeyboardHandler=An,S.LngLatBounds=ye,S.LogoControl=qu,S.Map=class extends jh{constructor(f){d.bf.mark(d.bg.create);const e=Object.assign(Object.assign({},tf),f);if(e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ts(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Tt,this._controls=[],this._mapId=d.a4(),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=e.preserveDrawingBuffer===!0,this._antialias=e.antialias===!0,this._trackResize=e.trackResize===!0,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles===!0,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions===!0,this._collectResourceTiming=e.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Wu),e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=e.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ue.addThrottleControl(()=>this.isMoving()),this._requestManager=new Se(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const l=ra(u=>{this._trackResize&&!this._removed&&(this.resize(u),this.redraw())},50);this._resizeObserver=new ResizeObserver(u=>{s?l(u):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Zu(this,e),this._hash=e.hash&&new tl(typeof e.hash=="string"&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,d.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new ss(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new qu,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new d.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new d.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new d.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new d.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(s,l.firstChild):l.appendChild(s),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new d.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,s,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,s,l)}resize(f){var e;const s=this._containerDimensions(),l=s[0],u=s[1],p=this._getClampedPixelRatio(l,u);if(this._resizeCanvas(l,u,p),this.painter.resize(l,u,p),this.painter.overLimit()){const b=this.painter.context.gl;this._maxCanvasSize=[b.drawingBufferWidth,b.drawingBufferHeight];const I=this._getClampedPixelRatio(l,u);this._resizeCanvas(l,u,I),this.painter.resize(l,u,I)}this.transform.resize(l,u),(e=this._requestedCameraState)===null||e===void 0||e.resize(l,u);const v=!this._moving;return v&&(this.stop(),this.fire(new d.k("movestart",f)).fire(new d.k("move",f))),this.fire(new d.k("resize",f)),v&&this.fire(new d.k("moveend",f)),this}_getClampedPixelRatio(f,e){const{0:s,1:l}=this._maxCanvasSize,u=this.getPixelRatio(),p=f*u,v=e*u;return Math.min(p>s?s/p:1,v>l?l/v:1)*u}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(ye.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this._update()}project(f){return this.transform.locationPoint(d.N.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.pointLocation(d.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,s){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:s,delegates:{mousemove:p=>{const v=e.filter(I=>this.getLayer(I)),b=v.length!==0?this.queryRenderedFeatures(p.point,{layers:v}):[];b.length?l||(l=!0,s.call(this,new Ri(f,this,p.originalEvent,{features:b}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:s,delegates:{mousemove:v=>{const b=e.filter(I=>this.getLayer(I));(b.length!==0?this.queryRenderedFeatures(v.point,{layers:b}):[]).length?l=!0:l&&(l=!1,s.call(this,new Ri(f,this,v.originalEvent)))},mouseout:v=>{l&&(l=!1,s.call(this,new Ri(f,this,v.originalEvent)))}}}}{const l=u=>{const p=e.filter(b=>this.getLayer(b)),v=p.length!==0?this.queryRenderedFeatures(u.point,{layers:p}):[];v.length&&(u.features=v,s.call(this,u),delete u.features)};return{layers:e,listener:s,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,s){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let u=0;u<l.length;u++){const p=l[u];if(p.listener===s&&p.layers.length===e.length&&p.layers.every(v=>e.includes(v))){for(const v in p.delegates)this.off(v,p.delegates[v]);return void l.splice(u,1)}}}on(f,e,s){if(s===void 0)return super.on(f,e);const l=this._createDelegatedListener(f,typeof e=="string"?[e]:e,s);this._saveDelegatedListener(f,l);for(const u in l.delegates)this.on(u,l.delegates[u]);return this}once(f,e,s){if(s===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,s);for(const p in u.delegates){const v=u.delegates[p];u.delegates[p]=(...b)=>{this._removeDelegatedListener(f,l,s),v(...b)}}this._saveDelegatedListener(f,u);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(f,e,s){return s===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,s),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let s;const l=f instanceof d.P||Array.isArray(f),u=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},u instanceof d.P||typeof u[0]=="number")s=[d.P.convert(u)];else{const p=d.P.convert(u[0]),v=d.P.convert(u[1]);s=[p,new d.P(v.x,p.y),v,new d.P(p.x,v.y),p]}return this.style.queryRenderedFeatures(s,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));const s=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new ja(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,s):this.style.loadJSON(f,e,s),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ja(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const s=this._requestManager.transformRequest(f,"Style");d.h(s,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new d.j(l))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(s){d.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new d.j(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const s in this.style._layers){const l=this.style._layers[s];l.type==="hillshade"&&l.source===f.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Hu(this.painter,e,f),this.painter.renderToTexture=new Oh(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=s=>{s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==f.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new d.k("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const s=f[e]._tiles;for(const l in s){const u=s[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,e,s={}){const{pixelRatio:l=1,sdf:u=!1,stretchX:p,stretchY:v,content:b,textFitWidth:I,textFitHeight:C}=s;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||d.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:z,data:F}=e,N=e;return this.style.addImage(f,{data:new d.R({width:M,height:z},new Uint8Array(F)),pixelRatio:l,stretchX:p,stretchY:v,content:b,textFitWidth:I,textFitHeight:C,sdf:u,version:0,userImage:N}),N.onAdd&&N.onAdd(this,f),this}}{const{width:M,height:z,data:F}=X.getImageData(e);this.style.addImage(f,{data:new d.R({width:M,height:z},F),pixelRatio:l,stretchX:p,stretchY:v,content:b,textFitWidth:I,textFitHeight:C,sdf:u,version:0})}}updateImage(f,e){const s=this.style.getImage(f);if(!s)return this.fire(new d.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||d.b(e)?X.getImageData(e):e,{width:u,height:p,data:v}=l;if(u===void 0||p===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(u!==s.data.width||p!==s.data.height)return this.fire(new d.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(e instanceof HTMLImageElement||d.b(e));return s.data.replace(v,b),this.style.updateImage(f,s),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new d.j(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return ue.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,s){return this.style.setLayerZoomRange(f,e,s),this._update(!0)}setFilter(f,e,s={}){return this.style.setFilter(f,e,s),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,s,l={}){return this.style.setPaintProperty(f,e,s,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,s,l={}){return this.style.setLayoutProperty(f,e,s,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,s,l=>{l||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,s=>{s||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f){return this._lazyInitEmptyStyle(),this.style.setSky(f),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=Z.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=Z.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),l=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],l);const u=this._controlContainer=Z.create("div","maplibregl-control-container",f),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{p[v]=Z.create("div",`maplibregl-ctrl-${v} `,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,s){this._canvas.width=Math.floor(s*f),this._canvas.height=Math.floor(s*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});const s=this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f);if(!s){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new el(s,this.transform),ke.testSupport(s)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const u=this.transform.zoom,p=X.now();this.style.zoomHistory.update(u,p);const v=new d.z(u,{now:p,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),b=v.crossFadingFactor();b===1&&b===this._crossFadingFactor||(s=!0,this._crossFadingFactor=b),this.style.update(v)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new d.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.bf.mark(d.bg.load),this.fire(new d.k("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const l=this._sourcesDirty||this._styleDirty||this._placementDirty;return l||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.k("idle")),!this._loaded||this._fullyLoaded||l||(this._fullyLoaded=!0,d.bf.mark(d.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ue.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Z.remove(this._canvasContainer),Z.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),d.bf.clearMetrics(),this._removed=!0,this.fire(new d.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,X.frameAsync(this._frameRequest).then(f=>{d.bf.frame(f),this._frameRequest=null,this._render(f)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return Nh}getCameraTargetElevation(){return this.transform.elevation}},S.MapMouseEvent=Ri,S.MapTouchEvent=wo,S.MapWheelEvent=Dh,S.Marker=hl,S.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),s=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,s)=>{const l=this._map._getUIString(`NavigationControl.${s}`);e.title=l,e.setAttribute("aria-label",l)},this.options=d.e({},nf,f),this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),Z.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),Z.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=Z.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new rf(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Z.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const s=Z.create("button",f,this._container);return s.type="button",s.addEventListener("click",e),s}},S.Popup=class extends d.E{constructor(f){super(),this.remove=()=>(this._content&&Z.remove(this._content),this._container&&(Z.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var s;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=Z.create("div","maplibregl-popup",this._map.getContainer()),this._tip=Z.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Ht(this._lngLat,this._flatPos,this._map.transform):(s=this._lngLat)===null||s===void 0?void 0:s.wrap(),this._trackPointer&&!e)return;const l=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let u=this.options.anchor;const p=pl(this.options.offset);if(!u){const b=this._container.offsetWidth,I=this._container.offsetHeight;let C;C=l.y+p.bottom.y<I?["top"]:l.y>this._map.transform.height-I?["bottom"]:[],l.x<b/2?C.push("left"):l.x>this._map.transform.width-b/2&&C.push("right"),u=C.length===0?"bottom":C.join("-")}let v=l.add(p[u]);this.options.subpixelPositioning||(v=v.round()),Z.setTransform(this._container,`${ls[u]} translate(${v.x}px,${v.y}px)`),cl(this._container,u,"popup")},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(at),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=d.N.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),s=document.createElement("body");let l;for(s.innerHTML=f;l=s.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Z.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=Z.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(dl);f&&f.focus()}},S.RasterDEMTileSource=ei,S.RasterTileSource=At,S.ScaleControl=class{constructor(f){this._onMove=()=>{ha(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,ha(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},vr),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Z.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},S.ScrollZoomHandler=Jn,S.Style=ja,S.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Z.create("button","maplibregl-ctrl-terrain",this._container),Z.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Z.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},S.TwoFingersTouchPitchHandler=ns,S.TwoFingersTouchRotateHandler=Vu,S.TwoFingersTouchZoomHandler=Ou,S.TwoFingersTouchZoomRotateHandler=$u,S.VectorTileSource=Zs,S.VideoSource=No,S.addSourceType=(f,e)=>d._(void 0,void 0,void 0,function*(){if(Hs(f))throw new Error(`A source type called "${f}" already exists.`);((s,l)=>{Gs[s]=l})(f,e)}),S.clearPrewarmedResources=function(){const f=bi;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Li),bi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},S.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},S.getRTLTextPluginStatus=function(){return fr().getRTLTextPluginStatus()},S.getVersion=function(){return Ku},S.getWorkerCount=function(){return tn.workerCount},S.getWorkerUrl=function(){return d.a.WORKER_URL},S.importScriptInWorkers=function(f){return $s().broadcast("IS",f)},S.prewarm=function(){lo().acquire(Li)},S.setMaxParallelImageRequests=function(f){d.a.MAX_PARALLEL_IMAGE_REQUESTS=f},S.setRTLTextPlugin=function(f,e){return fr().setRTLTextPlugin(f,e)},S.setWorkerCount=function(f){tn.workerCount=f},S.setWorkerUrl=function(f){d.a.WORKER_URL=f}});var T=c;return T})})(O1);var lI=O1.exports;const Tc=m0(lI);function uI(){return ru.useEffect(function(){const i="https://raw.githubusercontent.com/go2garret/maps/main/src/assets/json/openStreetMap.json",o=[121.06027390911558,14.581667728584403],c=new Tc.Map({container:"about-map",style:i,center:o,zoom:12,minZoom:2,maxZoom:18}),y=new Tc.ScaleControl({maxWidth:120,unit:"metric"});c.addControl(y);const x=new Tc.NavigationControl;c.addControl(x,"top-left");const T=new Tc.FullscreenControl({container:document.querySelector("root")});c.addControl(T);const S=document.createElement("div");S.className="map-location",new Tc.Marker({element:S}).setLngLat(o).addTo(c),c.on("dragend",function(){c.easeTo({center:o,essential:!0})}),c.on("zoomend",function(){c.easeTo({center:o,essential:!0})})},[]),B.jsx("div",{id:"about-map",className:"map"})}function cI(){return ru.useEffect(function(){const i=document.getElementById("climb");i.addEventListener("click",function(){window.scrollTo({top:0,left:0,behavior:"smooth"})}),window.addEventListener("scroll",function(){i.style.display=window.scrollY>0?"flex":"none"})},[]),B.jsx("div",{id:"climb",className:"button",children:""})}function hI(){localStorage.setItem("active_page","About");async function i(o){for(const c of o.entries())console.log(c)}return ru.useEffect(function(){const o=document.getElementById("help-form");o.addEventListener("submit",function(c){c.preventDefault();const y=new FormData(o);y.append("first-name",document.getElementById("help-first-name").value),y.append("last-name",document.getElementById("help-last-name").value),y.append("email-address",document.getElementById("help-email-address").value),y.append("country",document.getElementById("help-country").value),y.append("subject",document.getElementById("help-subject").value),y.append("message",document.getElementById("help-message").value),i(y),o.reset()})},[]),B.jsxs("div",{id:"about",className:"page",children:[B.jsx(Mp,{}),B.jsxs("div",{className:"body",children:[B.jsx("div",{children:B.jsxs("div",{children:["About ",B.jsx("span",{children:"SEED"}),"s"]})}),B.jsxs("div",{children:[B.jsxs("div",{children:["SEEDs is a project developed and maintained by ",B.jsx("a",{href:"https://geospectrum.com.ph",target:"_blank",children:"Geospectrum Analytics Services, Inc."})," It is is a web portal and GIS application that provides Local Government Units (LGUs) with a tool to effectively utilize the spatial and textual information about and within their locality."]}),B.jsx("br",{}),B.jsx("div",{children:"SEEDs is built using the Javascript programming language, through the full MERN stack of MongoDB, Express.js, React.js, and Node.js, with Vite.js for the front-end development. MongoDB is a document-oriented database used to store the web application's data. Node.js and its web framework, Express.js, handles server-side requests and processes while React.js handles client-side functionalities and the user interface. The full-stack three-tier JavaScript-based architecture of the web application allows for efficiency during project development and maintenance and scalability in data handling and project management. The project utilizes multiple APIs and various open-source JavaScript-based libraries, including Leaflet for the visualization of spatial data and Material UI for the general front-end layout and properties of SEEDs."}),B.jsx("br",{}),B.jsx("div",{children:"SEEDs is built using the Javascript programming language, through the full MERN stack of MongoDB, Express.js, React.js, and Node.js, with Vite.js for the front-end development. MongoDB is a document-oriented database used to store the web application's data. Node.js and its web framework, Express.js, handles server-side requests and processes while React.js handles client-side functionalities and the user interface. The full-stack three-tier JavaScript-based architecture of the web application allows for efficiency during project development and maintenance and scalability in data handling and project management. The project utilizes multiple APIs and various open-source JavaScript-based libraries, including Leaflet for the visualization of spatial data and Material UI for the general front-end layout and properties of SEEDs."})]}),B.jsx("div",{children:B.jsx("div",{children:"Message Us"})}),B.jsx("div",{children:B.jsxs("form",{id:"help-form",method:"post",children:[B.jsxs("div",{children:[B.jsx("div",{children:B.jsx("label",{htmlFor:"help-first-name",children:"First Name"})}),B.jsx("div",{children:B.jsx("input",{type:"text",id:"help-first-name",name:"first-name",placeholder:"",required:!0})})]}),B.jsxs("div",{children:[B.jsx("div",{children:B.jsx("label",{htmlFor:"help-last-name",children:"Last Name"})}),B.jsx("div",{children:B.jsx("input",{type:"text",id:"help-last-name",name:"last-name",placeholder:"",required:!0})})]}),B.jsxs("div",{children:[B.jsx("div",{children:B.jsx("label",{htmlFor:"help-email",children:"Email Address"})}),B.jsx("div",{children:B.jsx("input",{type:"email",id:"help-email-address",name:"email-address",placeholder:"",required:!0})})]}),B.jsxs("div",{children:[B.jsx("div",{children:B.jsx("label",{htmlFor:"help-country",children:"Country"})}),B.jsx("div",{children:B.jsxs("select",{id:"help-country",name:"country",children:[B.jsx("option",{value:"",children:"Please select a country."}),B.jsx("option",{value:"AF",children:"Afghanistan"}),B.jsx("option",{value:"AX",children:"Aland Islands"}),B.jsx("option",{value:"AL",children:"Albania"}),B.jsx("option",{value:"DZ",children:"Algeria"}),B.jsx("option",{value:"AS",children:"American Samoa"}),B.jsx("option",{value:"AD",children:"Andorra"}),B.jsx("option",{value:"AO",children:"Angola"}),B.jsx("option",{value:"AI",children:"Anguilla"}),B.jsx("option",{value:"AQ",children:"Antarctica"}),B.jsx("option",{value:"AG",children:"Antigua and Barbuda"}),B.jsx("option",{value:"AR",children:"Argentina"}),B.jsx("option",{value:"AM",children:"Armenia"}),B.jsx("option",{value:"AW",children:"Aruba"}),B.jsx("option",{value:"AU",children:"Australia"}),B.jsx("option",{value:"AT",children:"Austria"}),B.jsx("option",{value:"AZ",children:"Azerbaijan"}),B.jsx("option",{value:"BS",children:"Bahamas"}),B.jsx("option",{value:"BH",children:"Bahrain"}),B.jsx("option",{value:"BD",children:"Bangladesh"}),B.jsx("option",{value:"BB",children:"Barbados"}),B.jsx("option",{value:"BY",children:"Belarus"}),B.jsx("option",{value:"BE",children:"Belgium"}),B.jsx("option",{value:"BZ",children:"Belize"}),B.jsx("option",{value:"BJ",children:"Benin"}),B.jsx("option",{value:"BM",children:"Bermuda"}),B.jsx("option",{value:"BT",children:"Bhutan"}),B.jsx("option",{value:"BO",children:"Bolivia"}),B.jsx("option",{value:"BA",children:"Bosnia and Herzegovina"}),B.jsx("option",{value:"BW",children:"Botswana"}),B.jsx("option",{value:"BV",children:"Bouvet Island"}),B.jsx("option",{value:"BR",children:"Brazil"}),B.jsx("option",{value:"IO",children:"British Indian Ocean Territory"}),B.jsx("option",{value:"BN",children:"Brunei Darussalam"}),B.jsx("option",{value:"BG",children:"Bulgaria"}),B.jsx("option",{value:"BF",children:"Burkina Faso"}),B.jsx("option",{value:"BI",children:"Burundi"}),B.jsx("option",{value:"KH",children:"Cambodia"}),B.jsx("option",{value:"CM",children:"Cameroon"}),B.jsx("option",{value:"CA",children:"Canada"}),B.jsx("option",{value:"CV",children:"Cape Verde"}),B.jsx("option",{value:"KY",children:"Cayman Islands"}),B.jsx("option",{value:"CF",children:"Central African Republic"}),B.jsx("option",{value:"TD",children:"Chad"}),B.jsx("option",{value:"CL",children:"Chile"}),B.jsx("option",{value:"CN",children:"China"}),B.jsx("option",{value:"CX",children:"Christmas Island"}),B.jsx("option",{value:"CC",children:"Cocos (Keeling) Islands"}),B.jsx("option",{value:"CO",children:"Colombia"}),B.jsx("option",{value:"KM",children:"Comoros"}),B.jsx("option",{value:"CG",children:"Congo"}),B.jsx("option",{value:"CD",children:"Congo, Democratic Republic of the"}),B.jsx("option",{value:"CK",children:"Cook Islands"}),B.jsx("option",{value:"CR",children:"Costa Rica"}),B.jsx("option",{value:"CI",children:"Cte d'Ivoire"}),B.jsx("option",{value:"HR",children:"Croatia"}),B.jsx("option",{value:"CU",children:"Cuba"}),B.jsx("option",{value:"CW",children:"Curaao"}),B.jsx("option",{value:"CY",children:"Cyprus"}),B.jsx("option",{value:"CZ",children:"Czech Republic"}),B.jsx("option",{value:"DK",children:"Denmark"}),B.jsx("option",{value:"DJ",children:"Djibouti"}),B.jsx("option",{value:"DM",children:"Dominica"}),B.jsx("option",{value:"DO",children:"Dominican Republic"}),B.jsx("option",{value:"EC",children:"Ecuador"}),B.jsx("option",{value:"EG",children:"Egypt"}),B.jsx("option",{value:"SV",children:"El Salvador"}),B.jsx("option",{value:"GQ",children:"Equatorial Guinea"}),B.jsx("option",{value:"ER",children:"Eritrea"}),B.jsx("option",{value:"EE",children:"Estonia"}),B.jsx("option",{value:"ET",children:"Ethiopia"}),B.jsx("option",{value:"FK",children:"Falkland Islands (Malvinas)"}),B.jsx("option",{value:"FO",children:"Faroe Islands"}),B.jsx("option",{value:"FJ",children:"Fiji"}),B.jsx("option",{value:"FI",children:"Finland"}),B.jsx("option",{value:"FR",children:"France"}),B.jsx("option",{value:"GF",children:"French Guiana"}),B.jsx("option",{value:"PF",children:"French Polynesia"}),B.jsx("option",{value:"TF",children:"French Southern Territories"}),B.jsx("option",{value:"GA",children:"Gabon"}),B.jsx("option",{value:"GM",children:"Gambia"}),B.jsx("option",{value:"GE",children:"Georgia"}),B.jsx("option",{value:"DE",children:"Germany"}),B.jsx("option",{value:"GH",children:"Ghana"}),B.jsx("option",{value:"GI",children:"Gibraltar"}),B.jsx("option",{value:"GR",children:"Greece"}),B.jsx("option",{value:"GL",children:"Greenland"}),B.jsx("option",{value:"GD",children:"Grenada"}),B.jsx("option",{value:"GP",children:"Guadeloupe"}),B.jsx("option",{value:"GU",children:"Guam"}),B.jsx("option",{value:"GT",children:"Guatemala"}),B.jsx("option",{value:"GG",children:"Guernsey"}),B.jsx("option",{value:"GN",children:"Guinea"}),B.jsx("option",{value:"GW",children:"Guinea-Bissau"}),B.jsx("option",{value:"GY",children:"Guyana"}),B.jsx("option",{value:"HT",children:"Haiti"}),B.jsx("option",{value:"HM",children:"Heard Island and McDonald Islands"}),B.jsx("option",{value:"VA",children:"Holy See (Vatican City State)"}),B.jsx("option",{value:"HN",children:"Honduras"}),B.jsx("option",{value:"HK",children:"Hong Kong"}),B.jsx("option",{value:"HU",children:"Hungary"}),B.jsx("option",{value:"IS",children:"Iceland"}),B.jsx("option",{value:"IN",children:"India"}),B.jsx("option",{value:"ID",children:"Indonesia"}),B.jsx("option",{value:"IR",children:"Iran"}),B.jsx("option",{value:"IQ",children:"Iraq"}),B.jsx("option",{value:"IE",children:"Ireland"}),B.jsx("option",{value:"IM",children:"Isle of Man"}),B.jsx("option",{value:"IL",children:"Israel"}),B.jsx("option",{value:"IT",children:"Italy"}),B.jsx("option",{value:"JM",children:"Jamaica"}),B.jsx("option",{value:"JP",children:"Japan"}),B.jsx("option",{value:"JE",children:"Jersey"}),B.jsx("option",{value:"JO",children:"Jordan"}),B.jsx("option",{value:"KZ",children:"Kazakhstan"}),B.jsx("option",{value:"KE",children:"Kenya"}),B.jsx("option",{value:"KI",children:"Kiribati"}),B.jsx("option",{value:"XK",children:"Kosovo"}),B.jsx("option",{value:"KW",children:"Kuwait"}),B.jsx("option",{value:"KG",children:"Kyrgyzstan"}),B.jsx("option",{value:"LA",children:"Laos"}),B.jsx("option",{value:"LV",children:"Latvia"}),B.jsx("option",{value:"LB",children:"Lebanon"}),B.jsx("option",{value:"LS",children:"Lesotho"}),B.jsx("option",{value:"LR",children:"Liberia"}),B.jsx("option",{value:"LY",children:"Libyan Arab Jamahiriya"}),B.jsx("option",{value:"LI",children:"Liechtenstein"}),B.jsx("option",{value:"LT",children:"Lithuania"}),B.jsx("option",{value:"LU",children:"Luxembourg"}),B.jsx("option",{value:"MO",children:"Macao"}),B.jsx("option",{value:"MG",children:"Madagascar"}),B.jsx("option",{value:"MW",children:"Malawi"}),B.jsx("option",{value:"MY",children:"Malaysia"}),B.jsx("option",{value:"MV",children:"Maldives"}),B.jsx("option",{value:"ML",children:"Mali"}),B.jsx("option",{value:"MT",children:"Malta"}),B.jsx("option",{value:"MH",children:"Marshall Islands"}),B.jsx("option",{value:"MQ",children:"Martinique"}),B.jsx("option",{value:"MR",children:"Mauritania"}),B.jsx("option",{value:"MU",children:"Mauritius"}),B.jsx("option",{value:"YT",children:"Mayotte"}),B.jsx("option",{value:"MX",children:"Mexico"}),B.jsx("option",{value:"FM",children:"Micronesia, Federated States of"}),B.jsx("option",{value:"MD",children:"Moldova, Republic of"}),B.jsx("option",{value:"MC",children:"Monaco"}),B.jsx("option",{value:"MN",children:"Mongolia"}),B.jsx("option",{value:"ME",children:"Montenegro"}),B.jsx("option",{value:"MS",children:"Montserrat"}),B.jsx("option",{value:"MA",children:"Morocco"}),B.jsx("option",{value:"MZ",children:"Mozambique"}),B.jsx("option",{value:"MM",children:"Myanmar"}),B.jsx("option",{value:"NA",children:"Namibia"}),B.jsx("option",{value:"NR",children:"Nauru"}),B.jsx("option",{value:"NP",children:"Nepal"}),B.jsx("option",{value:"NL",children:"Netherlands"}),B.jsx("option",{value:"NC",children:"New Caledonia"}),B.jsx("option",{value:"NZ",children:"New Zealand"}),B.jsx("option",{value:"NI",children:"Nicaragua"}),B.jsx("option",{value:"NE",children:"Niger"}),B.jsx("option",{value:"NG",children:"Nigeria"}),B.jsx("option",{value:"NU",children:"Niue"}),B.jsx("option",{value:"NF",children:"Norfolk Island"}),B.jsx("option",{value:"KP",children:"North Korea"}),B.jsx("option",{value:"MK",children:"North Macedonia"}),B.jsx("option",{value:"MP",children:"Northern Mariana Islands"}),B.jsx("option",{value:"NO",children:"Norway"}),B.jsx("option",{value:"OM",children:"Oman"}),B.jsx("option",{value:"PK",children:"Pakistan"}),B.jsx("option",{value:"PW",children:"Palau"}),B.jsx("option",{value:"PS",children:"Palestine"}),B.jsx("option",{value:"PA",children:"Panama"}),B.jsx("option",{value:"PG",children:"Papua New Guinea"}),B.jsx("option",{value:"PY",children:"Paraguay"}),B.jsx("option",{value:"PE",children:"Peru"}),B.jsx("option",{value:"PH",children:"Philippines"}),B.jsx("option",{value:"PN",children:"Pitcairn"}),B.jsx("option",{value:"PL",children:"Poland"}),B.jsx("option",{value:"PT",children:"Portugal"}),B.jsx("option",{value:"PR",children:"Puerto Rico"}),B.jsx("option",{value:"QA",children:"Qatar"}),B.jsx("option",{value:"RE",children:"Reunion"}),B.jsx("option",{value:"RO",children:"Romania"}),B.jsx("option",{value:"RU",children:"Russia"}),B.jsx("option",{value:"RW",children:"Rwanda"}),B.jsx("option",{value:"BL",children:"Saint Barthelemy"}),B.jsx("option",{value:"SH",children:"Saint Helena"}),B.jsx("option",{value:"KN",children:"Saint Kitts and Nevis"}),B.jsx("option",{value:"LC",children:"Saint Lucia"}),B.jsx("option",{value:"MF",children:"Saint Martin"}),B.jsx("option",{value:"PM",children:"Saint Pierre and Miquelon"}),B.jsx("option",{value:"VC",children:"Saint Vincent and the Grenadines"}),B.jsx("option",{value:"WS",children:"Samoa"}),B.jsx("option",{value:"SM",children:"San Marino"}),B.jsx("option",{value:"ST",children:"So Tom and Prncipe"}),B.jsx("option",{value:"SA",children:"Saudi Arabia"}),B.jsx("option",{value:"SN",children:"Senegal"}),B.jsx("option",{value:"RS",children:"Serbia"}),B.jsx("option",{value:"CS",children:"Serbia and Montenegro"}),B.jsx("option",{value:"SC",children:"Seychelles"}),B.jsx("option",{value:"SL",children:"Sierra Leone"}),B.jsx("option",{value:"SG",children:"Singapore"}),B.jsx("option",{value:"SX",children:"Sint Maarten"}),B.jsx("option",{value:"SK",children:"Slovakia"}),B.jsx("option",{value:"SI",children:"Slovenia"}),B.jsx("option",{value:"SB",children:"Solomon Islands"}),B.jsx("option",{value:"SO",children:"Somalia"}),B.jsx("option",{value:"ZA",children:"South Africa"}),B.jsx("option",{value:"GS",children:"South Georgia and the South Sandwich Islands"}),B.jsx("option",{value:"KR",children:"South Korea"}),B.jsx("option",{value:"SS",children:"South Sudan"}),B.jsx("option",{value:"ES",children:"Spain"}),B.jsx("option",{value:"LK",children:"Sri Lanka"}),B.jsx("option",{value:"SD",children:"Sudan"}),B.jsx("option",{value:"SR",children:"Suriname"}),B.jsx("option",{value:"SJ",children:"Svalbard and Jan Mayen"}),B.jsx("option",{value:"SZ",children:"Swaziland"}),B.jsx("option",{value:"SE",children:"Sweden"}),B.jsx("option",{value:"CH",children:"Switzerland"}),B.jsx("option",{value:"SY",children:"Syria"}),B.jsx("option",{value:"TW",children:"Taiwan"}),B.jsx("option",{value:"TJ",children:"Tajikistan"}),B.jsx("option",{value:"TZ",children:"Tanzania, United Republic of"}),B.jsx("option",{value:"TH",children:"Thailand"}),B.jsx("option",{value:"TL",children:"Timor-Leste"}),B.jsx("option",{value:"TG",children:"Togo"}),B.jsx("option",{value:"TK",children:"Tokelau"}),B.jsx("option",{value:"TO",children:"Tonga"}),B.jsx("option",{value:"TT",children:"Trinidad and Tobago"}),B.jsx("option",{value:"TN",children:"Tunisia"}),B.jsx("option",{value:"TR",children:"Turkey"}),B.jsx("option",{value:"TM",children:"Turkmenistan"}),B.jsx("option",{value:"TC",children:"Turks and Caicos Islands"}),B.jsx("option",{value:"TV",children:"Tuvalu"}),B.jsx("option",{value:"UG",children:"Uganda"}),B.jsx("option",{value:"UA",children:"Ukraine"}),B.jsx("option",{value:"AE",children:"United Arab Emirates"}),B.jsx("option",{value:"GB",children:"United Kingdom"}),B.jsx("option",{value:"US",children:"United States"}),B.jsx("option",{value:"UM",children:"United States Minor Outlying Islands"}),B.jsx("option",{value:"UY",children:"Uruguay"}),B.jsx("option",{value:"UZ",children:"Uzbekistan"}),B.jsx("option",{value:"VU",children:"Vanuatu"}),B.jsx("option",{value:"VE",children:"Venezuela"}),B.jsx("option",{value:"VN",children:"Vietnam"}),B.jsx("option",{value:"VG",children:"Virgin Islands, British"}),B.jsx("option",{value:"VI",children:"Virgin Islands, U.S."}),B.jsx("option",{value:"WF",children:"Wallis and Futuna"}),B.jsx("option",{value:"EH",children:"Western Sahara"}),B.jsx("option",{value:"YE",children:"Yemen"}),B.jsx("option",{value:"ZM",children:"Zambia"}),B.jsx("option",{value:"ZW",children:"Zimbabwe"})]})})]}),B.jsxs("div",{children:[B.jsx("div",{children:B.jsx("label",{htmlFor:"help-subject",children:"Subject"})}),B.jsx("div",{children:B.jsx("input",{type:"text",id:"help-subject",name:"subject",placeholder:"",required:!0})})]}),B.jsxs("div",{children:[B.jsx("div",{children:B.jsx("label",{htmlFor:"help-message",children:"Message"})}),B.jsx("div",{children:B.jsx("textarea",{id:"help-message",name:"message",placeholder:"",rows:"8",required:!0})})]}),B.jsx("div",{children:B.jsx("input",{id:"help-submit",className:"button",type:"submit",value:"Submit"})})]})}),B.jsx("div",{children:B.jsx("div",{children:"Find Us"})}),B.jsxs("div",{children:[B.jsx(uI,{}),B.jsxs("div",{id:"about-details",children:[B.jsxs("div",{children:[B.jsx("div",{children:"Address"}),B.jsx("div",{children:"The Linden Suites, 37 San Miguel Avenue, Ortigas Center, Pasig City, Metro Manila, Philippines"})]}),B.jsxs("div",{children:[B.jsx("div",{children:"Email Address"}),B.jsx("div",{children:"seeds@geospectrum.com.ph"})]}),B.jsxs("div",{children:[B.jsx("div",{children:"Contact Number"}),B.jsx("div",{children:"+63917-7915536 / +63920-9113418 / +(632)-637-8026"})]})]})]}),B.jsx("div",{})]}),B.jsx(zp,{}),B.jsx(cI,{})]})}function dI(){return localStorage.setItem("active_page","Error"),B.jsxs("div",{id:"error",className:"page",children:[B.jsx(Mp,{}),B.jsx("div",{className:"body",children:B.jsx("div",{children:B.jsx("div",{children:"Error"})})}),B.jsx(zp,{})]})}function pI(){return console.log(`
SEEDs  2024

Powered by Geospectrum Analytics Services, Inc.

For more details about the development of the website and more information about Geospectrum Analytics Services, Inc., please visit https://www.geospectrum.com.ph/ or https://github.com/geospectrum-ph.
`),null}function fI(){return B.jsx(KT,{children:B.jsxs(ba,{path:"/",children:[B.jsx(ba,{index:!0,element:B.jsx(f0,{})}),B.jsx(ba,{path:"home",element:B.jsx(f0,{})}),B.jsx(ba,{path:"login",element:B.jsx(aI,{})}),B.jsx(ba,{path:"about",element:B.jsx(hI,{})}),B.jsx(ba,{path:"*",element:B.jsx(dI,{})})]})})}function mI(){return B.jsx(ru.StrictMode,{children:B.jsx(nI,{children:B.jsx("div",{id:"app",children:B.jsx(fI,{})})})})}window.addEventListener("load",function(){bm.createRoot(document.getElementById("root")).render(B.jsx(mI,{})),pI()});
